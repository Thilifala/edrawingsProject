<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="./style/edw.css">
    <link rel="stylesheet" href="./style/plmStyle.css">

    <script src="./model.js"></script>
    <script src="./util/jquery.js"></script>
    <script src="./util/jqueryUI.js"></script>
    <script src="./util/jqFullscreen.js"></script>
    <script src="./util/JSZip.js"></script>
    <script src="./util/jsZipUtils.js"></script>

    <script src="./util/edraw.js"></script>

    <script src="./util/polyfill.js"></script>
    <script src="./util/Bowser.js"></script>
    <script src="./util/SC.js"></script>
    <script src="./util/edrawTool.js"></script>

    <script src="./plmTest.js"></script>
    
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" /> 
<!-- For mobile debugging uncomment the lines below to enable eruda
-->
</head>

<body>
    <div id="plm-panel" class="plm-panel">
        <input type="button" id="btnPLMHideOthers" value="隐藏其它">
        <input type="button" id="btnPLMSelectFirst" value="选中第一个零件">
        <input type="button" id="btnPLMShowAll" value="显示全部">
        <input type="button" id="btnPLMHideShow" value="隐藏/显示">
        <input type="button" id="btnPLMExplosion" value="爆炸增大">
        <input type="button" id="btnSetViewOrientation" value="旋转">
        <input type="button" id="btnSetPoint" value="画点">

    </div>

    <div id="edrawings-viewer" class="edrawings-viewer-regular">
        <div id="edrawings-top-bar"
                class="top-bar edrawings-ui-main edrawings-ui-hide">
            <div id="edrawings-top-bar-content">
                <div id="edrawings-logo-block" class="edrawings-top-bar-left">
                    <div id="edrawings-logo" class="edrawings-logo-icon">
                    </div>
                </div>
                <div id="edrawings-filename-block"
                        class="edrawings-top-bar-left">
                    <span id="edrawings-filename-text"
                            class="unselectable">
                    </span>
                </div>
                <div id="edrawings-hud-bar"
                        class="edrawings-top-bar-left">
                    <div class="edrawings-arrow-wrapper">
                        <div class="edrawings-arrow-left"></div>
                    </div>
                    <div class="edrawings-arrow-wrapper">
                        <div class="edrawings-arrow-right"></div>
                    </div>
                    <div class="edrawings-hud-bar-content">
                        <!-- Reset actually has the behavior of a tool button so
                                use that as the class type instead of the HUD button
                                class. -->
                        <div id="edrawings-button-reset"
                                class="edrawings-tool-button edrawings-reset-icon edrawings-icon edrawings-ui-hide"
                                title="Reset"
                                data-i18n-title="Strings.Reset">
                        </div>
                        <div id="edrawings-button-animate"
                                class="edrawings-hud-button edrawings-animate-play-icon edrawings-icon edrawings-ui-hide"
                                title="Animate Views"
                                data-i18n-title="Strings.AnimateViews">
                        </div>
                        <div id="edrawings-button-zoomtofit"
                                class="edrawings-hud-button edrawings-zoomtofit-icon edrawings-hud-icon"
                                title="Zoom to Fit"
                            data-i18n-title="Strings.ZoomToFit">
                        </div>
                        <div id="edrawings-button-view-settings"
                                class="edrawings-hud-button edrawings-view-settings-icon edrawings-hud-icon"
                                title="View Settings"
                                data-i18n-title="Strings.ViewSettings">
                        </div>
                        <div id="edrawings-button-view"
                                class="edrawings-hud-button edrawings-view-icon edrawings-hud-dd-icon"
                                title="Views orientation"
                                data-i18n-title="Strings.ViewsOrientation">
                        </div>
                        <div id="edrawings-button-shaded"
                                class="edrawings-hud-button edrawings-display-icon edrawings-hud-dd-icon"
                                title="Display"
                                data-i18n-title="Strings.Display">
                        </div>
                        <div id="edrawings-button-languages"
                                class="edrawings-hud-button edrawings-languages-icon edrawings-hud-dd-icon"
                                title="Languages"
                                data-i18n-title="Strings.Languages">
                        </div>
                        <div id="edrawings-button-help"
                                class="edrawings-hud-button edrawings-help-icon edrawings-hud-icon"
                                title="Help"
                                data-i18n-title="Strings.Help">
                        </div>
                        <div id="edrawings-button-fs"
                                class="edrawings-hud-button edrawings-hud-icon"
                                title="Fullscreen"
                                data-i18n-title="Strings.Fullscreen">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="edrawings-config-bar" class="bottom-bar edrawings-ui-hide">


            <div id="config-tab-border"></div>
    <div class="edrawings-arrow-wrapper">
    <div class="edrawings-arrow-left"></div>
    </div>
    <div id="edrawings-config-tab-list" class="edrawings-fullwidth">
    </div>
    <div class="edrawings-arrow-wrapper">
    <div class="edrawings-arrow-right"></div>
    </div>
    <div id="edrawings-button-sheets"
        class="edrawings-sheets-control">
    <div id="edrawings-button-confignav"
            class="edrawings-tool-button bottom-button edrawings-modelview-panel-icon edrawings-icon"
            title="All" data-i18n-title="Strings.All">
    </div>
    </div>
        </div>

        <div id="edrawings-left-bar"
                class="edrawings-ui-main edrawings-tool-bar edrawings-ui-hide">
            <div class="edrawings-bottom-centered-icons">
                <div class="edrawings-arrow-wrapper">
                    <div class="edrawings-arrow-up"></div>
                </div>
                <div class="edrawings-arrow-wrapper">
                    <div class="edrawings-arrow-down"></div>
                </div>
                <div class="edrawings-tool-bar-content">
                    <div id="edrawings-button-component-tree"
                        class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-component-tree-icon edrawings-icon" 
                            title="Components"
                            data-i18n-title="Strings.Components">
                    </div>
                    <div id="edrawings-button-sheet-tree"
                            class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-sheet-tree-icon edrawings-icon" 
                            title="Sheets"
                            data-i18n-title="Strings.Sheets">
                    </div>
                    <div id="edrawings-button-layer-control"
                            class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-layer-icon edrawings-icon" 
                            title="Layers"
                            data-i18n-title="Strings.Layers">
                    </div>
                    <div id="edrawings-button-configurations"
                            class="edrawings-tool-button bottom-button edrawings-ui-hide edrawings-configurations-icon edrawings-icon"
                            title="Configurations"
                            data-i18n-title="Strings.Configurations">
                    </div>
                    <div id="edrawings-button-explode"
                            class="edrawings-tool-button bottom-button edrawings-icon-plugin edrawings-ui-hide edrawings-explode-icon edrawings-icon"
                            title="Explode"
                            data-i18n-title="Strings.Explode">
                    </div>
                    <div id="edrawings-button-section"
                            class="edrawings-tool-button bottom-button edrawings-ui-hide edrawings-section-icon edrawings-icon"
                            title="Section Views"
                            data-i18n-title="Strings.SectionViews">
                    </div>
                    <div id="edrawings-button-measure"
                            class="edrawings-tool-button bottom-button edrawings-disabled-button edrawings-icon-plugin edrawings-ui-hide edrawings-measure-icon edrawings-icon"
                            title="Measure"
                            data-i18n-title="Strings.Measure">
                    </div>
                    <div id="edrawings-button-move"
                            class="edrawings-tool-button bottom-button edrawings-icon-plugin edrawings-ui-hide edrawings-move-icon edrawings-icon"
                            title="Move"
                            data-i18n-title="Strings.Move">
                    </div>
                    <div id="edrawings-button-annot-control"
                            class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-annot-icon edrawings-icon"
                            title="Annotations"
                            data-i18n-title="Strings.Annotations">
                    </div>
                    <div id="edrawings-button-markup"
                            class="edrawings-tool-button bottom-button edrawings-ui-hide edrawings-markup-icon edrawings-icon"
                            title="Markup"
                            data-i18n-title="Strings.Markup">
                    </div>
                    <div id="edrawings-button-tables-control"
                            class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-table-icon edrawings-icon"
                            title="Tables"
                            data-i18n-title="Strings.Tables">
                    </div>
                    <div id="edrawings-button-debug"
                            class="bottom-button edrawings-tool-button edrawings-ui-hide edrawings-debug-icon edrawings-icon"
                            title="Debug"
                            data-i18n-title="Strings.Debug">
                    </div>
                </div>
            </div>
        </div>

        <div id="edrawings-section-menu" class="edrawings-submenu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
            <div class="edrawings-menu-panel-wrapper">
                <div id="edrawings-section-xy-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-xy-icon edrawings-icon" 
                        title="X/Y Plane"
                        data-i18n-title="Strings.XYPlane">
                </div>
                <div id="edrawings-section-yz-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-yz-icon edrawings-icon" 
                        title="Y/Z Plane"
                        data-i18n-title="Strings.YZPlane">
                </div>

                <div id="edrawings-section-xz-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-xz-icon edrawings-icon" 
                        title="X/Z Plane"
                        data-i18n-title="Strings.XZPlane">
                </div>

                <div id="edrawings-section-flip-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-flip-icon edrawings-icon" 
                        title="Flip"
                        data-i18n-title="Strings.Flip">
                </div>

                <div id="edrawings-section-normal-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-normal-to-icon edrawings-icon" 
                        title="View the from Section Plane"
                        data-i18n-title="Strings.ViewFromSectionPlane">
                </div>

                <div id="edrawings-section-show-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-show-icon edrawings-icon" 
                        style="display: none"
                        title="Show Section Plane"
                        data-i18n-title="Strings.Show.SectionPlane">
                </div>

                <hr />

                <div id="edrawings-section-capping-button"
                        class="bottom-button bottom-menu-button section-button edrawings-section-capping-icon edrawings-icon" 
                        title="Enable Capping"
                        data-i18n-title="Strings.EnableCapping">
                </div>
            </div>
            <div class="edrawings-menu-panel-arrow-collapse"></div>
        </div>

        <div id="edrawings-explode-menu" 
                class="edrawings-submenu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div id="edrawings-explode-up" 
            class="slide-bar-button edrawings-explode-up edrawings-bar-icon"
            title="Explode Up"
            data-i18n-title="Strings.ExplodeUp">
    </div>
    <div id="edrawings-explode-slider"></div>
    <div id="edrawings-explode-down" 
            class="slide-bar-button edrawings-explode-down edrawings-bar-icon"
            title="Explode Down"
            data-i18n-title="Strings.ExplodeDown">
    </div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide"></div>
        </div>

        <div id="edrawings-measure-panel" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title" data-i18n-inner="Strings.Measure">Measure</div>
        <div id="edrawings-measure-close"
                class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon">
        </div>
    </div>
    <div id="edrawings-measure-filters">
        <div class="bottom-button bottom-menu-button measure-filter-button"
                id="edrawings-measure-face-button" data-i18n-title="Strings.Select.Face" title="Select Face">
            <div id="edrawings-measure-face-button-on"
                    class="edrawings-icon measure-filter-image edrawings-select-face-icon">
            </div>
        </div>
        <div class="bottom-button bottom-menu-button measure-filter-button"
                id="edrawings-measure-edge-button" data-i18n-title="Strings.Select.Edge" title="Select Edge">
            <div id="edrawings-measure-edge-button-on"
                    class="edrawings-icon measure-filter-image edrawings-select-edge-icon">
            </div>
        </div>
        <div class="bottom-button bottom-menu-button measure-filter-button"
                id="edrawings-measure-vertex-button" data-i18n-title="Strings.Select.Vertex" title="Select Vertex">
            <div id="edrawings-measure-vertex-button-on"
                    class="edrawings-icon measure-filter-image edrawings-select-vertex-icon">
            </div>
        </div>
        <div class="bottom-button bottom-menu-button edrawings-measure-delta-button"
                id="edrawings-measure-delta-button" data-i18n-title="Strings.XYZMeasurements" title="XYZ Measurements">
            <div id="edrawings-measure-delta-button-on"
                    class="edrawings-icon measure-filter-image edrawings-show-xyz-icon">
            </div>
        </div>
        <div class="bottom-button bottom-menu-button edrawings-measure-pickpoint-button"
                id="edrawings-measure-pickpoint-button" data-i18n-title="Strings.PointToPoint" title="Point-to-Point">
            <div id="edrawings-measure-pickpoint-button-on"
                    class="edrawings-icon measure-filter-image edrawings-select-point-to-point-icon">
            </div>
        </div>
    </div>
    <div class="edrawings-measure-unit">
        <div class="edrawings-measure-unit-item">
            <label for="edrawings-measure-distant-unit" class="measure-unit-item-name" data-i18n-inner="Text.Distance">
                Distance:
            </label>
            <select class="measure-unit-selector"
                    id="edrawings-measure-distant-unit">
                <option data-i18n-inner="Units.Millimeters" value="millimeter">Millimeters</option>
                <option data-i18n-inner="Units.Centimeters" value="centimeter">Centimeters</option>
                <option data-i18n-inner="Units.Meters" value="meter">Meters</option>
                <option data-i18n-inner="Units.Inches" value="inch">Inches</option>
                <option data-i18n-inner="Units.Feet" value="foot">Feet</option>
                <option data-i18n-inner="Units.FeetAndInches" value="footAndInch">Feet and Inches</option>
            </select>
        </div>
        <div class="edrawings-measure-unit-item">
            <label for="edrawings-measure-angle-unit" class="measure-unit-item-name" data-i18n-inner="Text.Angle">
                Angle:
            </label>
            <select class="measure-unit-selector"
                    id="edrawings-measure-angle-unit">
                <option data-i18n-inner="Units.Degrees" value="degree">Degrees</option>
                <option data-i18n-inner="Units.Radians" value="radian">Radians</option>
            </select>
        </div>
    </div>
    <div id="edrawings-measure-submenu-list" class="edrawings-measure-messages">
    </div>
    <div class="edrawings-measure-messages">
        <span id="edrawings-measure-result">
        </span>
    </div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse"></div>
        </div>

        <div id="edrawings-markup-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
        </div>

        <div id="edrawings-component-tree-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title edrawings-comp-count" data-i18n-inner="Strings.Components">Components</div>
        <div id="edrawings-component-tree-setting" class="edrawings-menu-setting edrawings-menu-icon edrawings-settings-icon"></div>
        <div id="edrawings-component-tree-close" class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon"></div>
    </div>
    <div class="edrawings-menu-search">
        <input id="edrawings-search-component-input" class="edrawings-menu-search-input" data-i18n-placeholder="Strings.SearchText" placeholder="Enter text to filter list">
        <div id="component-search-cancel" class="edrawings-menu-search-cancel edrawings-search-cancel-icon"></div>
    </div>
    <div id="edrawings-component-tree-list" class="edrawings-submenu-list">
    </div>
    <div class="clearfix"></div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide"></div>
        </div>

        <div id="edrawings-debug-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
        </div>

        <div id="edrawings-sheet-tree-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title" data-i18n-inner="Strings.Sheets">Sheets</div>
        <div id="edrawings-sheet-tree-setting"
                class="edrawings-menu-setting edrawings-menu-icon edrawings-settings-icon">
        </div>
        <div id="edrawings-sheet-tree-close"
                class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon">
        </div>
    </div>
    <div id="edrawings-sheet-tree-list" class="edrawings-submenu-list"></div>
    <div class="clearfix"></div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide"></div>
        </div>

        <div id="edrawings-layer-control-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title" data-i18n-inner="Strings.Layers">Layers</div>
        <div id="edrawings-layer-control-setting" class="edrawings-menu-setting edrawings-menu-icon edrawings-settings-icon"></div>
        <div id="edrawings-layer-control-close" class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon"></div>
    </div>
    <div id="edrawings-layer-control-all" class="edrawings-submenu-list">
    </div>
    <div id="edrawings-layer-control-list" class="edrawings-submenu-list">
    </div>
    <div class="clearfix"></div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide"></div>
        </div>

        <div id="edrawings-annot-control-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
        </div>

        <div id="edrawings-tables-menu" 
                class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
        </div>

        <div id="edrawings-hud-view-settings-menu"
                class="edrawings-hud-menu edrawings-common-panel-props edrawings-ui-hide"
                style="top: 57px; left: 1365px">
            <table class="edrawings-hud-menu-table">
                <tbody>
                    <tr>
                        <td>
                            <div id="edrawings-button-view-ambient-occlusion"
                                    class="hud-menu-button edrawings-view-ambient-occl-icon edrawings-icon" 
                                    title="Ambient Occlusion"
                                    data-i18n-title="Strings.AmbientOcclusion">
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div id="edrawings-button-view-perspective"
                                    class="hud-menu-button edrawings-view-perspective-icon edrawings-icon" 
                                    title="Perspective"
                                    data-i18n-title="Strings.Perspective">
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="edrawings-hud-view-menu"
                class="edrawings-hud-menu edrawings-common-panel-props edrawings-ui-hide">
            <table class="edrawings-hud-menu-table">
                <tr>
                    <td></td>
                    <td>
                        <div id="edrawings-button-view-top"
                                class="hud-menu-button hover-active-button edrawings-icon edrawings-view-top-icon"
                                title="Top"
                                data-i18n-title="Strings.Top">
                        </div>
                    </td>
                    <td></td>
                    <td>
                        <div id="edrawings-button-view-iso"
                                class="hud-menu-button hover-active-button edrawings-view-iso-icon edrawings-icon"
                                title="Isometric"
                                data-i18n-title="Strings.Isometric">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="edrawings-button-view-left"
                                class="hud-menu-button hover-active-button edrawings-view-left-icon edrawings-icon"
                                title="Left"
                                data-i18n-title="Strings.Left">
                        </div>
                    </td>
                    <td>
                        <div id="edrawings-button-view-front"
                                class="hud-menu-button hover-active-button edrawings-view-front-icon edrawings-icon"
                                title="Front"
                                data-i18n-title="Strings.Front">
                        </div>
                    </td>
                    <td>
                        <div id="edrawings-button-view-right"
                                class="hud-menu-button hover-active-button edrawings-view-right-icon edrawings-icon"
                                title="Right"
                                data-i18n-title="Strings.Right">
                        </div>
                    </td>
                    <td>
                        <div id="edrawings-button-view-back"
                                class="hud-menu-button hover-active-button edrawings-view-back-icon edrawings-icon"
                                title="Back"
                                data-i18n-title="Strings.Back">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td>
                        <div id="edrawings-button-view-bottom"
                                class="hud-menu-button hover-active-button edrawings-view-bottom-icon edrawings-icon"
                                title="Bottom"
                                data-i18n-title="Strings.Bottom">
                        </div>
                    </td>
                    <td></td>
                    <td>
                        <div id="edrawings-face-normal-button"
                                class="hud-menu-button hover-active-button edrawings-view-face-normal-icon edrawings-icon edrawings-inactive"
                                title="View from Selected Face"
                                data-i18n-title="Strings.ViewFromSelectedFace">
                        </div>
                    </td>
                </tr>
            </table>
        </div>

        <div id="edrawings-hud-shaded-menu"
                class="edrawings-hud-menu edrawings-common-panel-props edrawings-ui-hide">
            <table class="edrawings-hud-menu-table">
                <tr>
                    <td>
                        <div id="edrawings-button-shaded-full"
                                class="hud-menu-button edrawings-shaded-icon edrawings-icon"
                                title="Shaded With Edges"
                                data-i18n-title="Strings.ShadedWithEdges">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="edrawings-button-shaded-noedges"
                                class="hud-menu-button edrawings-shaded-noedges-icon edraings-icon"
                                title="Shaded"
                                data-i18n-title="Strings.Shaded">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="edrawings-button-shaded-hlrr"
                                class="hud-menu-button edrawings-hlrr-icon edrawings-icon"
                                title="Hidden Lines Removed"
                                data-i18n-title="Strings.HiddenLinesRemoved">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="edrawings-button-shaded-hlrv"
                                class="hud-menu-button edrawings-hlrv-icon edrawings-icon"
                                title="Hidden Lines Visible"
                                data-i18n-title="Strings.HiddenLinesVisible">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div id="edrawings-button-shaded-wireframe"
                                class="hud-menu-button edrawings-wireframe-icon edrawings-icon"
                                title="Wireframe"
                                data-i18n-title="Strings.Wireframe">
                        </div>
                    </td>
                </tr>
            </table>
        </div>

        <div id="edrawings-hud-languages-menu"
                class="edrawings-hud-menu edrawings-common-panel-props edrawings-ui-hide">
            <div id="edrawings-lang-list" class="edrawings-submenu-list">
            </div>
        </div>

        <div id="edrawings-hud-help-menu"
                class="edrawings-hud-menu edrawings-common-panel-props edrawings-ui-hide">
            <div id="edrawings-hud-help-close" class="edrawings-hud-menu-close edrawings-menu-icon edrawings-close-icon"></div>
            <div class="edrawings-help-grid">
                <table class="edrawings-help-table">
                    <tr>
                        <td class="help-column-first">
                            <div class="help-table-button edrawings-help-refresh-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-second">
                            <div class="help-table-button edrawings-help-leftmouse-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-third">
                            <div class="help-table-button edrawings-help-touch-single-swipe-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="help-column-first">
                            <div class="help-table-button edrawings-help-pan-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-second">
                            <div class="help-table-button edrawings-help-rightmouse-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-third">
                            <div class="help-table-button edrawings-help-touch-double-swipe-icon edrawings-icons edrawings-help-icon">
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="help-column-first">
                            <div class="help-table-button edrawings-help-zoom-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-second">
                            <div class="help-table-button edrawings-help-scrollmouse-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-third">
                            <div class="help-table-button edrawings-help-touch-spread-icon edrawings-help-icon edrawings-icon">
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="help-column-first">
                            <div class="help-table-button edrawings-help-zoomtofit-icon edrawings-icon edrawings-help-icon">
                            </div>
                        </td>
                        <td class="help-column-second">
                            <div class="help-table-button edrawings-help-doubleclickmouse-icon edrawings-icon edrawingshelp-icon">
                            </div>
                        </td>
                        <td class="help-column-third">
                            <div class="help-table-button edrawings-help-touch-doubletap-icon edrawings-help-icon edrawings-icon">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <div id="edrawings-version"></div>
        </div>

        <div id="edrawings-configurations-menu" class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title" data-i18n-inner="Strings.Configurations"></div>
        <div class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon"></div>
    </div>
    <div class="edrawings-divided-container">
        <div class="edrawings-submenu-list">
        </div>
        <div class="edrawings-modelview-sub-container edrawings-ui-hide">
        <div class="edrawings-divider">
            <div id="edrawings-display-states" class="edrawings-inline" data-i18n-inner="Strings.DisplayStates"></div>
            <div id="edrawings-display-states-linked" class="edrawings-inline" data-i18n-inner="Text.Linked">
            </div>
        </div>
        <div class="edrawings-submenu-list">
        </div>
        </div>
    </div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide "></div>
        </div>

        <div id="edrawings-config-navigation" class="edrawings-submenu edrawings-menu edrawings-common-panel-props edrawings-collapsible edrawings-ui-hide">
    <div class="edrawings-menu-panel-wrapper">
    <div class="edrawings-menu-header">
        <div class="edrawings-menu-title" data-i18n-inner="Strings.Configurations"></div>
        <div class="edrawings-menu-close edrawings-menu-icon edrawings-close-icon"></div>
    </div>
    <div class="edrawings-divided-container">
        <div class="edrawings-submenu-list">
        </div>
        <div class="edrawings-modelview-sub-container edrawings-ui-hide">
        <div class="edrawings-divider">
            <div id="edrawings-display-states" class="edrawings-inline" data-i18n-inner="Strings.DisplayStates"></div>
            <div id="edrawings-display-states-linked" class="edrawings-inline" data-i18n-inner="Text.Linked">
            </div>
        </div>
        <div class="edrawings-submenu-list">
        </div>
        </div>
    </div>
    </div>
    <div class="edrawings-menu-panel-arrow-collapse edrawings-ui-hide "></div>
        </div>


        <ul id="edrawings-shortcut-menu" class="edrawings-common-panel-props edrawings-ui-hide"></ul>

        <div id="edrawings-dialog-panel" class="edrawings-dialog-panel">
    <div id="edrawings-dialog-panel-text">
    </div> 
        </div>

        <div id="viewerContainer">
            <div id="edrawings-canvas"></div>
        </div>

        <div class="edrawings-ticker-wrapper edrawings-ui-hide">
            <div class="edrawings-ticker"></div>
        </div>
    </div>

    <div id="WaitBanner">
        <div id="spin" class="edrawings-loading-spin">
        </div>
        <div class="edrawings-loading-logo-dark-text edrawings-logo-text-icon">
        </div>
    </div>

    <div id="edrawings-file">
    </div>

    <div id="edrawings-fileopen-background" class="edrawings-ui-hide">
    </div>

    <div id="TimeoutBanner" class="edrawings-ui-hide"
            style="margin-top: -65%">
        <table style="width: 100%; height: 100%">
            <tr style="vertical-align: central">
                <td style="text-align: center;">
                    <p class="edrawings-drop-title" data-i18n-inner="Messages.ConnectionTimeout">Connection timed-out.  Reload the page to continue.</p>
                </td>
            </tr>
        </table>
    </div>
</body>


<script>
var eDwUIShortcutMenu_4g;
var eDwShowOnlyCmdg;
var eDwCommandMgrg;
var eDwUIComponentTreePlugin_g;
var mDistLine_g;
var extSelObj_g;


var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function (d, b) {
            d.__proto__ = b
        }
         || function (d, b) {
            for (var p in b)
                if (Object.prototype.hasOwnProperty.call(b, p))
                    d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() {
            this.constructor = d
        }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
                resolve(value)
            }))
    }
    return new(P || (P = Promise))((function (resolve, reject) {
            function fulfilled(value) {
                try {
                    step(generator.next(value))
                } catch (e) {
                    reject(e)
                }
            }
            function rejected(value) {
                try {
                    step(generator["throw"](value))
                } catch (e) {
                    reject(e)
                }
            }
            function step(result) {
                result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
            }
            step((generator = generator.apply(thisArg, _arguments || [])).next())
        }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0,
        sent: function () {
            if (t[0] & 1)
                throw t[1];
            return t[1]
        },
        trys: [],
        ops: []
    },
    f,
    y,
    t,
    g;
    return g = {
        next: verb(0),
        throw : verb(1),
        return : verb(2)
    },
    typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }),
    g;
    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }
    function step(op) {
        if (f)
            throw new TypeError("Generator is already executing.");
        while (_)
            try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
                    return t;
                if (y = 0, t)
                    op = [op[0] & 2, t.value];
                switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {
                        value: op[1],
                        done: false
                    };
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2])
                        _.ops.pop();
                    _.trys.pop();
                    continue
                }
                op = body.call(thisArg, _)
            } catch (e) {
                op = [6, e];
                y = 0
            }
        finally {
            f = t = 0
        }
        if (op[0] & 5)
            throw op[1];
        return {
            value: op[0] ? op[1] : void 0,
            done: true
        }
    }
};
var __values = this && this.__values || function (o) {
    var s = typeof Symbol === "function" && Symbol.iterator,
    m = s && o[s],
    i = 0;
    if (m)
        return m.call(o);
    if (o && typeof o.length === "number")
        return {
            next: function () {
                if (o && i >= o.length)
                    o = void 0;
                return {
                    value: o && o[i++],
                    done: !o
                }
            }
        };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.")
};
define("eDwUICompTreeHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator"], (function (require, exports, eDwUIHTMLGenerator_1) {
        "use strict";
        var eDwUICompTreeHTMLGenerator = function (_super) {
            __extends(eDwUICompTreeHTMLGenerator, _super);
            function eDwUICompTreeHTMLGenerator(iViewer, iPanelUIID) {
                return _super.call(this, iViewer, iPanelUIID) || this
            }
            eDwUICompTreeHTMLGenerator.prototype.generateHTMLForTree = function (iConfigNode, iIncludeAllDescendents, iLeftPaddingInPX) {
                if (iIncludeAllDescendents === void 0) {
                    iIncludeAllDescendents = false
                }
                if (iLeftPaddingInPX === void 0) {
                    iLeftPaddingInPX = NaN
                }
                var generatedHTML = "";
                var childNodes = this.forNodeGetChildren(iConfigNode);
                if (childNodes.length > 0) {
                    var childNode = childNodes[0];
                    var classes = this.forNodeHasChildren(childNode) ? " edrawings-tree-expanded " : "";
                    var offset = this.computeOffset(iLeftPaddingInPX);
                    generatedHTML += _super.prototype.generateHTMLForNode.call(this, childNode, offset, classes, iIncludeAllDescendents);
                    generatedHTML += _super.prototype.generateHTMLForChildNodes.call(this, childNode, false, offset)
                }
                return generatedHTML
            };
            eDwUICompTreeHTMLGenerator.prototype.forNodeGetIconCSSClass = function (iNode) {
                return eDwUIHTMLGenerator_1.eDwUINodeHTMLGenerator.getDisplayStateCSSClass(eDwUIHTMLGenerator_1.eDwUINodeHTMLGenerator.getHierarchyNode(iNode))
            };
            return eDwUICompTreeHTMLGenerator
        }
        (eDwUIHTMLGenerator_1.eDwUINodeHTMLGenerator);
        return eDwUICompTreeHTMLGenerator
    }));
define("eDwUIComponentTreePlugin", ["require", "exports", "eDwUICompTreeHTMLGenerator", "eDwSelObj", "eDwUIUtils", "eDwEvents", "utils", "jqutils", "eDwUIBasePlugin", "eDwUIShortcutMenu"], (function (require, exports, eDwUICompTreeHTMLGenerator, eDwSelObj, eDwUIUtils, eDwEvents, utils, jqutils, eDwUIBasePlugin_1, eDwUIShortcutMenu_1) {
        "use strict";

        var eDwUIComponentTreePlugin = function (_super) {
            __extends(eDwUIComponentTreePlugin, _super);
            function eDwUIComponentTreePlugin(iViewer, iViewerFeatOpts) {
                var _this = this;
                var buttonInfo = {
                    ID: "#edrawings-button-component-tree"
                };
                _this = _super.call(this, "ComponentTree", iViewer, buttonInfo, iViewerFeatOpts) || this;
                _this.initPluginButton();
                return _this
            }
            eDwUIComponentTreePlugin.prototype.init = function () {
                return __awaiter(this, void 0, void 0, (function () {
                        var panelsToLoad,
                        model;
                        return __generator(this, (function (_a) {
                                switch (_a.label) {
                                case 0:
                                    panelsToLoad = [{
                                            ID: c_compPanelID,
                                            HTML: "componentpanel.html"
                                        }
                                    ];
                                    return [4, _super.prototype.init.call(this, panelsToLoad)];
                                case 1:
                                    _a.sent();
                                    model = this.mViewer.getModel();
                                    eDwUIUtils.hide(this.PluginButtonID, !model.isAssembly());
                                    eDwUIUtils.setUIGenerator(c_compPanelID, new eDwUICompTreeHTMLGenerator(this.mViewer, c_compPanelID));
                                    this.sync(model.getActiveModelView());
                                    return [2]
                                }
                            }))
                    }))
            };
            eDwUIComponentTreePlugin.prototype.onClick = function (iActivate) {
                _super.prototype.onClick.call(this, iActivate);
                if (iActivate) {
                    eDwUIUtils.activateUI(this.PluginButtonID, c_compPanelID)
                }
            };
            eDwUIComponentTreePlugin.prototype.onActivate = function (iButtonJQ) {
                return __awaiter(this, void 0, void 0, (function () {
                        var parentActivated;
                        var _this = this;
                        return __generator(this, (function (_a) {
                                switch (_a.label) {
                                case 0:
                                    return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                                case 1:
                                    parentActivated = _a.sent();
                                    if (!parentActivated)
                                        return [2, false];
                                    this.sync(this.mViewer.getModel().getActiveModelView());
                                    eDwUIUtils.addPanelModeEvents(c_compPanelID, c_eventIDSuffix, "#" + iButtonJQ.attr("id"));
                                    eDwUIUtils.addSubTreeArrowEventHandler(this.mUIHTMLEventMgr, c_compPanelID);
                                    this.mUIHTMLEventMgr.addDelegatedEventHandler("#edrawings-component-tree-menu .edrawings-submenu-list-item", "dblclick", (function (iEvent) {

                                            //PLM TEST
                                            (function () {
                                                return __awaiter(_this, void 0, void 0, (function () {
                                                        var selMgr,
                                                        showOnlyCmd;
                                                        return __generator(this, (function (_a) {
                                                                switch (_a.label) {
                                                                case 0:
                                                                    selMgr = this.mViewer.SelectionMgr;

                                                                    showOnlyCmd = new eDwShowOnlyCmdg(this.mViewer, selMgr.getSelHierarchyNodes());

                                                                    return [4, eDwCommandMgrg.get().run(showOnlyCmd, "commit")];
                                                                case 1:
                                                                    _a.sent();
                                                                    return [2]
                                                                }
                                                            }))
                                                    }))
                                            })();
                                            eDwUIShortcutMenu_4g.hide();
                                            //PLM TEST


                                            // selMgr = this.mViewer.SelectionMgr;
                                            // showOnlyCmd = new eDwShowOnlyCmdg(this.mViewer, selMgr.getSelHierarchyNodes());
                                            // eDwCommandMgrg.get().run(showOnlyCmd, "commit");

                                            var selObjIDHC = eDwUIUtils.getIDHC(jqutils.getAsJQueryObj(iEvent.target));
                                            if (!utils.isNumber(selObjIDHC))
                                                return;
                                            _this.zoomToFit(_this.mViewer)
                                        }));
                                    this.mUIHTMLEventMgr.addEventHandler("#component-search-cancel", "click", (function (iEvent) {
                                            $("#edrawings-component-tree-menu " + ".edrawings-menu-search-input").val("");
                                            eDwUIUtils.searchPanelList(_this.mViewer, jqutils.getAsJQueryObj(iEvent.target))
                                        }));
                                    this.mUIHTMLEventMgr.addEventHandler("#edrawings-search-component-input", "keyup", (function (iEvent) {
                                            eDwUIUtils.searchPanelList(_this.mViewer, jqutils.getAsJQueryObj(iEvent.target))
                                        }));
                                    eDwUIUtils.addCloseEventHandler(c_compPanelID, this.mUIHTMLEventMgr);
                                    this.setAppEvents(true);
                                    return [2, true]
                                }
                            }))
                    }))
            };
            eDwUIComponentTreePlugin.prototype.onDeactivate = function (iButtonJQ) {
                return __awaiter(this, void 0, void 0, (function () {
                        var parentDeactivated;
                        return __generator(this, (function (_a) {
                                switch (_a.label) {
                                case 0:
                                    return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                                case 1:
                                    parentDeactivated = _a.sent();
                                    if (!parentDeactivated)
                                        return [2, false];
                                    eDwUIUtils.deactivateMoveInput(c_eventIDSuffix);
                                    this.mUIHTMLEventMgr.removeEventHandlers(c_compPanelID, "click");
                                    this.setAppEvents(false);
                                    return [2, true]
                                }
                            }))
                    }))
            };
            eDwUIComponentTreePlugin.prototype.onInitFullUI = function (iViewer) {
                this.sync(iViewer.getModel().getActiveModelView())
            };
            eDwUIComponentTreePlugin.prototype.onModelViewChange = function (iViewer, iPrevModelView, iCurrModelView, iIsAssembly) {
                return __awaiter(this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                                this.sync(iCurrModelView);
                                return [2]
                            }))
                    }))
            };
            eDwUIComponentTreePlugin.prototype.onSelect = function (iViewer, iSelObjs) {
                var selFunc = function (iViewer, iSelHierNode) {
                    eDwUIUtils.expandSelected(iViewer, iSelHierNode);
                    eDwUIUtils.scrollToTreeNode(iSelHierNode, true)
                };
                this.processSelections(iViewer, iSelObjs, selFunc)
            };
            eDwUIComponentTreePlugin.prototype.onUnselect = function (iViewer, iSelObjs) {
                var unSelFunc = function (iViewer, iSelHierNode) {
                    eDwUIUtils.scrollToTreeNode(iSelHierNode, false)
                };
                this.processSelections(iViewer, iSelObjs, unSelFunc)
            };
            eDwUIComponentTreePlugin.prototype.setAppEvents = function (iEnable) {
                this.addAppObjEvent(eDwEvents.InitFullUIEvent, "onInitFullUI", iEnable);
                this.addAppObjEvent(eDwEvents.ModelViewChangeEvent, "onModelViewChange", iEnable);
                this.addAppObjEvent(eDwEvents.SelectEvent, "onSelect", iEnable);
                this.addAppObjEvent(eDwEvents.UnselectEvent, "onUnselect", iEnable)
            };
            eDwUIComponentTreePlugin.prototype.sync = function (iNewModelView) {
                var listJQ = $(c_compPanelID + " .edrawings-submenu-list");
                listJQ.empty();
                var gen = eDwUIUtils.getUIGenerator(c_compPanelID);
                listJQ.append(gen.generateHTMLForTree(iNewModelView.Hierarchy));
                eDwUIUtils.adjustModelViewSelection(iNewModelView, "[class~='item-tree-text']", "edrawings-list-selected")
            };
            eDwUIComponentTreePlugin.prototype.zoomToFit = function (iViewer) {
                eDwUIUtils.zoomToFit(iViewer);
                eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide()
            };
            eDwUIComponentTreePlugin.prototype.processSelections = function (iViewer, iSelObjsHC, iProcFunc) {
                var e_1,
                _a;
                var model = iViewer.getModel();
                if (!model.isAssembly())
                    return;
                var activeModelView = model.getActiveModelView();
                try {
                    for (var iSelObjsHC_1 = __values(iSelObjsHC), iSelObjsHC_1_1 = iSelObjsHC_1.next(); !iSelObjsHC_1_1.done; iSelObjsHC_1_1 = iSelObjsHC_1.next()) {
                        var selObjHC = iSelObjsHC_1_1.value;
                        var selObj = eDwSelObj.extendHCSelObj(selObjHC);
                        var selHierNode = activeModelView.Nodes[selObj.getIDHC()];
                        if (!selHierNode)
                            continue;
                        iProcFunc(iViewer, selHierNode)
                    }
                } catch (e_1_1) {
                    e_1 = {
                        error: e_1_1
                    }
                }
                finally {
                    try {
                        if (iSelObjsHC_1_1 && !iSelObjsHC_1_1.done && (_a = iSelObjsHC_1.return))
                            _a.call(iSelObjsHC_1)
                    }
                    finally {
                        if (e_1)
                            throw e_1.error
                    }
                }
            };
            return eDwUIComponentTreePlugin
        }
        (eDwUIBasePlugin_1.eDwUIBasePlugin);
        var c_compPanelID = "#edrawings-component-tree-menu";
        var c_eventIDSuffix = ".edw.tree";

        //PLM TEST
        eDwUIComponentTreePlugin_g = eDwUIComponentTreePlugin;
        return eDwUIComponentTreePlugin
    }));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
define("eDwUIConfigurationsPlugin", ["require", "exports", "eDwUIModelViewHTMLGenerator", "eDwUIUtils", "eDwEvents", "jqutils", "eDwUIBasePlugin"], (function (require, exports, eDwUIModelViewHTMLGenerator, eDwUIUtils, eDwEvents, jqutils, eDwUIBasePlugin_1) {
    "use strict";
    var eDwUIConfigurationsPlugin = function (_super) {
        __extends(eDwUIConfigurationsPlugin, _super);

        function eDwUIConfigurationsPlugin(iViewer, iViewerFeatOpts) {
            var _this = _super.call(this, "Configurations", iViewer, {ID: "#edrawings-button-configurations"}, iViewerFeatOpts) || this;
            _this.mDragging = false;
            _this.mPrevY = 0;
            _this.initPluginButton();
            return _this
        }

        eDwUIConfigurationsPlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var panelsToLoad, model;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            panelsToLoad = [{ID: c_configPanelID, HTML: "configpanel.html"}];
                            return [4, _super.prototype.init.call(this, panelsToLoad)];
                        case 1:
                            _a.sent();
                            model = this.mViewer.getModel();
                            eDwUIUtils.hide(this.PluginButtonID, model.isDrawing() || model.getModelViews().length === 1 && model.getActiveModelView().ContextName === "#-^");
                            this.mUIGenerator = new eDwUIModelViewHTMLGenerator(this.mViewer, c_configPanelID);
                            eDwUIUtils.setUIGenerator(c_configPanelID, this.mUIGenerator);
                            return [2]
                    }
                }))
            }))
        };
        eDwUIConfigurationsPlugin.prototype.onClick = function (iActivate) {
            _super.prototype.onClick.call(this, iActivate);
            if (iActivate) {
                eDwUIUtils.activateUI(this.PluginButtonID, c_configPanelID)
            }
        };
        eDwUIConfigurationsPlugin.prototype.addEventHandlers = function () {
            _super.prototype.addEventHandlers.call(this);
            this.setAppEvents(true)
        };
        eDwUIConfigurationsPlugin.prototype.removeEventHandlers = function () {
            _super.prototype.removeEventHandlers.call(this);
            this.setAppEvents(false)
        };
        eDwUIConfigurationsPlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentActivated, switchModelViewFunc;
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                        case 1:
                            parentActivated = _a.sent();
                            if (!parentActivated) return [2, false];
                            eDwUIUtils.addPanelModeEvents(c_configPanelID, c_eventIDSuffix, "#" + iButtonJQ.attr("id"));
                            switchModelViewFunc = function (iEvent) {
                                eDwUIUtils.scrollToTarget(jqutils.getAsJQueryObj(iEvent.target));
                                eDwUIUtils.switchModelView(iEvent, _this.mViewer, ".config-tree-text")
                            };
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_configPanelID + " .edrawings-root", "click", switchModelViewFunc);
                            eDwUIUtils.addCloseEventHandler(c_configPanelID, this.mUIHTMLEventMgr);
                            this.mUIHTMLEventMgr.addEventHandler(c_configDisplayStateDivider, "mousedown", (function (iEvent) {
                                _this.onDown(iEvent)
                            }));
                            this.mUIHTMLEventMgr.addEventHandler("document", "mousemove", (function (iEvent) {
                                _this.onMove(iEvent)
                            }));
                            this.mUIHTMLEventMgr.addEventHandler("document", "mouseup", (function (iEvent) {
                                _this.onUp(iEvent)
                            }));
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIConfigurationsPlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentDeactivated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                        case 1:
                            parentDeactivated = _a.sent();
                            if (!parentDeactivated) return [2, false];
                            eDwUIUtils.deactivateMoveInput(c_eventIDSuffix);
                            this.mUIHTMLEventMgr.removeAllEventHandlers();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIConfigurationsPlugin.prototype.onInitFullUI = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var modelView;
                return __generator(this, (function (_a) {
                    modelView = this.mViewer.getModel().getActiveModelView();
                    this.populateUI(modelView);
                    this.updateModelViewSelectionState(modelView);
                    return [2]
                }))
            }))
        };
        eDwUIConfigurationsPlugin.prototype.onModelViewChange = function (iViewer, iPrevModelView, iCurrModelView, iIsAssembly) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (iPrevModelView && iPrevModelView !== iCurrModelView) {
                        this.populateUI(iCurrModelView)
                    }
                    this.updateModelViewSelectionState(iCurrModelView);
                    return [2]
                }))
            }))
        };
        eDwUIConfigurationsPlugin.prototype.updateModelViewSelectionState = function (iModelView) {
            var elements = $(c_configPanelID).find(".edrawings-submenu-list-item");
            elements.removeClass("edrawings-list-selected");
            if (iModelView) {
                var displayListSelector = c_dispStatePanelListSelector + " :contains(" + iModelView.SubName + ")";
                eDwUIUtils.adjustListSelection(displayListSelector, "edrawings-list-selected");
                var configListSelector = c_configPanelListSelector + " :contains(" + iModelView.ContextName + ")";
                eDwUIUtils.adjustListSelection(configListSelector, "edrawings-list-selected")
            }
        };
        eDwUIConfigurationsPlugin.prototype.setAppEvents = function (iEnable) {
            this.addAppObjEvent(eDwEvents.InitFullUIEvent, "onInitFullUI", iEnable);
            this.addAppObjEvent(eDwEvents.ModelViewChangeEvent, "onModelViewChange", iEnable)
        };
        eDwUIConfigurationsPlugin.prototype.populateUI = function (iModelView) {
            var hide = iModelView ? !iModelView.SubName.length : false;
            eDwUIUtils.hide(c_dispStateSubContainerSelector, hide);
            var configHTML = this.mUIGenerator.generateTopModelViewHTML("config-tree-text");
            eDwUIUtils.refreshList($(c_configPanelListSelector), configHTML);
            var isLinked = this.mViewer.getModel().getModelViewsShowInContext();
            var contextOpts = {Name: isLinked ? iModelView.ContextName : "", OnlyLinked: isLinked};
            var dispStateHTML = this.mUIGenerator.generateSubModelViewHTML("config-tree-text", contextOpts);
            eDwUIUtils.refreshList($(c_dispStatePanelListSelector), dispStateHTML);
            if (!isLinked) eDwUIUtils.hide(c_displayStateLinkedID, true)
        };
        eDwUIConfigurationsPlugin.prototype.onDown = function (iMouseEvent) {
            this.mPrevY = l_getY(iMouseEvent);
            this.mDragging = true
        };
        eDwUIConfigurationsPlugin.prototype.onMove = function (iEvent) {
            if (this.mDragging) {
                var currY = l_getY(iEvent);
                var deltaY = currY - this.mPrevY;
                this.mPrevY = currY;
                var configListJQ = $(c_configPanelListSelector);
                var configListHeight = configListJQ.height();
                configListJQ.height(configListHeight + deltaY)
            }
        };
        eDwUIConfigurationsPlugin.prototype.onUp = function (iMouseEvent) {
            this.mDragging = false
        };
        return eDwUIConfigurationsPlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    var c_configPanelID = "#edrawings-configurations-menu";
    var c_displayStateLinkedID = "#edrawings-display-states-linked";
    var c_containerSelectorSubset = " > div.edrawings-menu-panel-wrapper" + " > div.edrawings-divided-container";
    var c_configPanelListSelector = c_configPanelID + c_containerSelectorSubset + " > div.edrawings-submenu-list";
    var c_dispStateSelectorSubset = " > div.edrawings-modelview-sub-container";
    var c_dispStateSubContainerSelector = c_configPanelID + c_containerSelectorSubset + c_dispStateSelectorSubset;
    var c_configDisplayStateDivider = c_dispStateSubContainerSelector + " > div.edrawings-divider";
    var c_dispStatePanelListSelector = c_dispStateSubContainerSelector + " > div.edrawings-submenu-list";
    var c_eventIDSuffix = ".edw.config";

    function l_getY(iEvent) {
        return eDwUIUtils.getEventPositions(iEvent)[0].y
    }

    return eDwUIConfigurationsPlugin
}));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
define("eDwUIExplodePlugin", ["require", "exports", "eDwUIBasePlugin", "eDwCommandMgr", "eDwCompositeCmd", "eDwExplodeCmd", "eDwUIUtils", "eDwEventMgr", "eDwEvents", "utils"], (function (require, exports, eDwUIBasePlugin_1, eDwCommandMgr, eDwCompositeCmd, eDwExplodeCmd, eDwUIUtils, eDwEventMgr, eDwEvents_1, utils) {
    "use strict";
    var eDwUIExplodePlugin = function (_super) {
        __extends(eDwUIExplodePlugin, _super);

        function eDwUIExplodePlugin(iViewer, iViewerFeatOpts) {
            var _this = this;
            var buttonInfo = {ID: "#edrawings-button-explode"};
            _this = _super.call(this, "Explode", iViewer, buttonInfo, iViewerFeatOpts) || this;
            _this.initPluginButton();
            return _this
        }

        eDwUIExplodePlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var panelsToLoad;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            panelsToLoad = [{ID: c_explodePanelID, HTML: "explodepanel.html"}];
                            return [4, _super.prototype.init.call(this, panelsToLoad)];
                        case 1:
                            _a.sent();
                            eDwUIUtils.hide(this.PluginButtonID, !this.mViewer.getModel().isAssembly());
                            return [2]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.onClick = function (iActivate) {
            _super.prototype.onClick.call(this, iActivate);
            if (iActivate) {
                eDwUIUtils.activateUI(this.PluginButtonID, c_explodePanelID)
            }
        };
        eDwUIExplodePlugin.prototype.destroy = function () {
            _super.prototype.destroy.call(this);
            $("#edrawings-button-explode").off("click.edw");
            var explodeHandle = $("#edrawings-explode-slider .ui-slider-handle");
            explodeHandle.off("touchmove.edw");
            explodeHandle.off("touchstart.edw");
            explodeHandle.off("touchend.edw");
            delete this.mExplodeCmd;
            delete this.mCompositeExplodeCmd
        };
        eDwUIExplodePlugin.prototype.addEventHandlers = function () {
            _super.prototype.addEventHandlers.call(this);
            this.setAppEvents(true)
        };
        eDwUIExplodePlugin.prototype.removeEventHandlers = function () {
            _super.prototype.removeEventHandlers.call(this);
            this.setAppEvents(false)
        };
        eDwUIExplodePlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentActivated, cmdMgr, viewer, explodeSlider;
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                        case 1:
                            parentActivated = _a.sent();
                            if (!parentActivated) return [2, false];
                            eDwUIUtils.addPanelModeEvents(c_explodePanelID, c_eventIDSuffix, "#" + iButtonJQ.attr("id"));
                            this.mCompositeExplodeCmd = new eDwCompositeCmd(this.mViewer);
                            cmdMgr = eDwCommandMgr.get();
                            cmdMgr.add(this.mCompositeExplodeCmd);
                            this.mCompositeExplodeCmd.initCmdActionImplementation({
                                compositeInit: function (ioCmd) {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        return __generator(this, (function (_a) {
                                            ioCmd.InitialState = this.mViewer.getExplosionLevel();
                                            return [2]
                                        }))
                                    }))
                                }, compositeUndo: function (ioCmd) {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        return __generator(this, (function (_a) {
                                            ioCmd.undoSubCmds();
                                            this.mViewer.setExplosionLevel(ioCmd.InitialState);
                                            return [2, true]
                                        }))
                                    }))
                                }, compositeRedo: function (ioCmd) {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        return __generator(this, (function (_a) {
                                            ioCmd.redoSubCmds();
                                            this.mViewer.setExplosionLevel(ioCmd.FinalState);
                                            return [2, true]
                                        }))
                                    }))
                                }, compositeCommit: function (ioCmd) {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        return __generator(this, (function (_a) {
                                            ioCmd.FinalState = this.mViewer.getExplosionLevel();
                                            return [2]
                                        }))
                                    }))
                                }, compositeCancel: function (ioCmd) {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        return __generator(this, (function (_a) {
                                            delete ioCmd.FinalState;
                                            delete ioCmd.InitialState;
                                            return [2]
                                        }))
                                    }))
                                }
                            });
                            viewer = this.mViewer;
                            explodeSlider = $("#edrawings-explode-slider");
                            try {
                                explodeSlider.slider("option")
                            } catch (iException) {
                                explodeSlider.slider({
                                    orientation: "vertical",
                                    range: "min",
                                    min: 0,
                                    max: 10,
                                    step: .1,
                                    value: viewer.getExplosionLevel(),
                                    slide: function (iEvent, iSliderParams) {
                                        var val = iSliderParams.value;
                                        if (utils.isNumber(val)) _this.mExplodeCmd.setLevel(val)
                                    },
                                    start: function (iEvent, iUI) {
                                        _this.start(cmdMgr)
                                    },
                                    stop: function (iEvent, iUI) {
                                        _this.stop(cmdMgr)
                                    }
                                });
                                $("#edrawings-explode-up").on("click.edw", (function () {
                                    _this.setLevel(cmdMgr, 10)
                                }));
                                $("#edrawings-explode-down").on("click.edw", (function () {
                                    _this.setLevel(cmdMgr, 0)
                                }))
                            }
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentDeactivated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                        case 1:
                            parentDeactivated = _a.sent();
                            if (!parentDeactivated) return [2, false];
                            eDwUIUtils.deactivateMoveInput(c_eventIDSuffix);
                            return [4, eDwCommandMgr.get().remove(this.mCompositeExplodeCmd, "commit")];
                        case 2:
                            _a.sent();
                            delete this.mCompositeExplodeCmd;
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.onExplodeLevelChange = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var explodeSlider;
                return __generator(this, (function (_a) {
                    explodeSlider = $("#edrawings-explode-slider");
                    try {
                        explodeSlider.slider("value", iViewer.getExplosionLevel())
                    } catch (iException) {
                    }
                    return [2]
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.onResetScene = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_1.ExplodeLevelChangeEvent)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.start = function (ioCmdMgr) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mExplodeCmd = new eDwExplodeCmd(this.mViewer);
                            return [4, ioCmdMgr.add(this.mExplodeCmd)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.stop = function (ioCmdMgr) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, ioCmdMgr.remove(this.mExplodeCmd, "commit")];
                        case 1:
                            _a.sent();
                            delete this.mExplodeCmd;
                            return [2]
                    }
                }))
            }))
        };
        eDwUIExplodePlugin.prototype.setLevel = function (ioCmdMgr, iLevel) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.start(ioCmdMgr)];
                            case 1:
                                _a.sent();
                                this.mExplodeCmd.setLevel(iLevel);
                                return [4, this.stop(ioCmdMgr)];
                            case 2:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUIExplodePlugin.prototype.setAppEvents = function (iEnable) {
            this.addAppObjEvent(eDwEvents_1.ResetSceneEvent, "onResetScene", iEnable);
            this.addAppObjEvent(eDwEvents_1.ExplodeLevelChangeEvent, "onExplodeLevelChange", iEnable)
        };
        return eDwUIExplodePlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    var c_explodePanelID = "#edrawings-explode-menu";
    var c_eventIDSuffix = ".edw.explode";
    return eDwUIExplodePlugin
}));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
var __values = this && this.__values || function (o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return {value: o && o[i++], done: !o}
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.")
};
define("eDwUIModelViewTabHTMLGenerator", ["require", "exports", "eDwUIModelViewHTMLGenerator"], (function (require, exports, eDwUIModelViewHTMLGenerator) {
    "use strict";
    var eDwUIModelViewTabHTMLGenerator = function (_super) {
        __extends(eDwUIModelViewTabHTMLGenerator, _super);

        function eDwUIModelViewTabHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUIModelViewTabHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML, model, modelViewContextNames, modelViewContextNames_1, modelViewContextNames_1_1,
                    modelViewContextName, modelView, modelViewNode;
                var e_1, _a;
                return __generator(this, (function (_b) {
                    generatedHTML = "";
                    model = this.mViewer.getModel();
                    modelViewContextNames = model.getContextModelViewNames();
                    try {
                        for (modelViewContextNames_1 = __values(modelViewContextNames), modelViewContextNames_1_1 = modelViewContextNames_1.next(); !modelViewContextNames_1_1.done; modelViewContextNames_1_1 = modelViewContextNames_1.next()) {
                            modelViewContextName = modelViewContextNames_1_1.value;
                            modelView = model.getActiveModelView(modelViewContextName);
                            if (!modelView) continue;
                            modelViewNode = modelView.Hierarchy;
                            generatedHTML += "<div class='edrawings-config-tab' " + "configname='" + modelViewContextName + "'>" + "<span class='config-tab-text' " + this.forNodeGetDataAttributes(modelViewNode) + ">" + modelViewContextName + "</span></div>"
                        }
                    } catch (e_1_1) {
                        e_1 = {error: e_1_1}
                    } finally {
                        try {
                            if (modelViewContextNames_1_1 && !modelViewContextNames_1_1.done && (_a = modelViewContextNames_1.return)) _a.call(modelViewContextNames_1)
                        } finally {
                            if (e_1) throw e_1.error
                        }
                    }
                    return [2, generatedHTML]
                }))
            }))
        };
        return eDwUIModelViewTabHTMLGenerator
    }(eDwUIModelViewHTMLGenerator);
    return eDwUIModelViewTabHTMLGenerator
}));
define("eDwUIModelViewTabsPlugin", ["require", "exports", "eDwUIBasePlugin", "eDwUIModelViewHTMLGenerator", "eDwUIModelViewTabHTMLGenerator", "eDwUIUtils", "eDwEvents"], (function (require, exports, eDwUIBasePlugin_1, eDwUIModelViewHTMLGenerator, eDwUIModelViewTabHTMLGenerator, eDwUIUtils, eDwEvents) {
    "use strict";
    var eDwUIModelViewTabsPlugin = function (_super) {
        __extends(eDwUIModelViewTabsPlugin, _super);

        function eDwUIModelViewTabsPlugin(iViewer, iViewerFeatOpts) {
            var _this = this;
            var buttonInfo = {ID: "#edrawings-button-confignav"};
            _this = _super.call(this, "ModelViewTabs", iViewer, buttonInfo, iViewerFeatOpts) || this;
            return _this
        }

        eDwUIModelViewTabsPlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var panelsToLoad;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            panelsToLoad = [{
                                ID: c_modelViewTabPanelID,
                                HTML: "modelviewtabspanel.html"
                            }, {ID: c_modelViewTabNavPanelID, HTML: "configpanel.html"}];
                            return [4, _super.prototype.init.call(this, panelsToLoad)];
                        case 1:
                            _a.sent();
                            if (!this.mViewer) return [2];
                            eDwUIUtils.hide(c_modelViewTabPanelID, !this.shouldShowTabs());
                            eDwUIUtils.hide(c_modelViewTabNavPanelID + ".edrawings-menu-title", true);
                            this.mUIGenerator = new eDwUIModelViewHTMLGenerator(this.mViewer, c_modelViewTabPanelID);
                            eDwUIUtils.setUIGenerator(c_modelViewTabNavPanelID, this.mUIGenerator);
                            this.mUITabGenerator = new eDwUIModelViewTabHTMLGenerator(this.mViewer, c_modelViewTabListID);
                            eDwUIUtils.setUIGenerator(c_modelViewTabListID, this.mUITabGenerator);
                            return [2]
                    }
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.onClick = function (iActivate) {
            _super.prototype.onClick.call(this, iActivate);
            if (iActivate) {
                eDwUIUtils.activateUI(this.PluginButtonID, c_modelViewTabNavPanelID)
            }
        };
        eDwUIModelViewTabsPlugin.prototype.addEventHandlers = function () {
            var _this = this;
            _super.prototype.addEventHandlers.call(this);
            this.mUIHTMLEventMgr.addEventHandler("window", "resize", (function (iEvent) {
                _this.adjustTabs()
            }));
            $(document).on("click.mvtedw", c_modelViewTabPanelID + " .edrawings-config-tab", (function (iEvent) {
                var target = eDwUIUtils.getTarget($(iEvent.target));
                if (target.hasClass("active-modelview")) {
                    return
                }
                eDwUIUtils.switchModelView(iEvent, _this.mViewer, ".config-tab-text")
            }));

            function scroll(iEvent, iUseFirstVisible) {
                if (iUseFirstVisible === void 0) {
                    iUseFirstVisible = true
                }
                var contentJQ = $(c_modelViewTabListID);
                if (contentJQ && contentJQ.length > 0) {
                    var incr = l_determineIncrement(contentJQ, iUseFirstVisible);
                    eDwUIUtils.executeScrolling(iUseFirstVisible ? -incr : incr, 0, contentJQ, $(c_modelViewTabPanelID))
                }
            }

            this.mUIHTMLEventMgr.addEventHandler(c_modelViewTabPanelID + ".edrawings-arrow-wrapper:has(> .edrawings-arrow-left)", "click", (function (iEvent) {
                scroll(iEvent)
            }));
            this.mUIHTMLEventMgr.addEventHandler(c_modelViewTabPanelID + ".edrawings-arrow-wrapper:has(> .edrawings-arrow-right)", "click", (function (iEvent) {
                scroll(iEvent, false)
            }));
            eDwUIUtils.enableScrollOnTouch(this.mUIHTMLEventMgr, c_modelViewTabListID, c_modelViewTabPanelID);
            this.setAppEvents(true)
        };
        eDwUIModelViewTabsPlugin.prototype.removeEventHandlers = function () {
            _super.prototype.removeEventHandlers.call(this);
            $(document).off("click.mvtedw");
            eDwUIUtils.disableScrollOnTouch(this.mUIHTMLEventMgr, c_modelViewTabListID);
            this.setAppEvents(false)
        };
        eDwUIModelViewTabsPlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentActivated;
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                        case 1:
                            parentActivated = _a.sent();
                            if (!parentActivated) return [2, false];
                            eDwUIUtils.addPanelModeEvents(c_modelViewTabNavPanelID, c_eventIDSuffix);
                            $(document).on("click.mvtedw", c_modelViewTabNavPanelID + " .edrawings-submenu-list-item", (function (iEvent) {
                                eDwUIUtils.switchModelView(iEvent, _this.mViewer, ".config-nav-text")
                            }));
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentDeactivated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                        case 1:
                            parentDeactivated = _a.sent();
                            if (!parentDeactivated) return [2, false];
                            eDwUIUtils.deactivateMoveInput(c_eventIDSuffix);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.onInitFullUI = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var modelViewHTML;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.mUITabGenerator.generateHTML("")];
                        case 1:
                            modelViewHTML = _a.sent();
                            eDwUIUtils.refreshList($(c_modelViewTabListID), modelViewHTML);
                            modelViewHTML = this.mUIGenerator.generateTopModelViewHTML("config-nav-text");
                            eDwUIUtils.refreshList($(c_overflowListSelector), modelViewHTML);
                            this.setActiveModelView(iViewer.getModel().getActiveModelView());
                            this.adjustTabs();
                            this.adjustPanel();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.onModelViewChange = function (iViewer, iPrevModelView, iCurrModelView, iIsAssembly) {
            return __awaiter(this, void 0, void 0, (function () {
                var elements;
                return __generator(this, (function (_a) {
                    $("[class~='edrawings-config-tab']").removeClass("active-modelview");
                    elements = $(c_overflowListSelector).children();
                    elements.removeClass("edrawings-list-selected");
                    this.setActiveModelView(iCurrModelView);
                    l_adjustTabs();
                    return [2]
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.onDone = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    $(c_modelViewTabListID).empty();
                    return [2]
                }))
            }))
        };
        eDwUIModelViewTabsPlugin.prototype.adjustTabs = function () {
            eDwUIUtils.deactivateUI(".edrawings-hud-button", ".edrawings-hud-menu");
            if (this.shouldShowTabs()) {
                var modelViewTabBar = $(c_modelViewTabPanelID);
                var modelViewTabList = $(c_modelViewTabListID);
                if (modelViewTabList[0].scrollWidth - modelViewTabBar.width() > 1) {
                    modelViewTabList.removeClass("edrawings-fullwidth").addClass("edrawings-compressed");
                    modelViewTabBar.addClass("edrawings-compressed-tab-list")
                } else {
                    modelViewTabList.removeClass("edrawings-compressed").addClass("edrawings-fullwidth");
                    modelViewTabBar.removeClass("edrawings-compressed-tab-list")
                }
                l_adjustTabs()
            }
        };
        eDwUIModelViewTabsPlugin.prototype.setActiveModelView = function (iModelView) {
            var activeTabSelector = c_tabListSelector + " :contains(" + iModelView.ContextName + ")";
            eDwUIUtils.adjustListSelection(activeTabSelector, "active-modelview");
            var activeItemSelector = c_overflowListSelector + " :contains(" + iModelView.ContextName + ")";
            eDwUIUtils.adjustListSelection(activeItemSelector, "edrawings-list-selected")
        };
        eDwUIModelViewTabsPlugin.prototype.shouldShowTabs = function () {
            var model = this.mViewer.getModel();
            return model.getContextModelViewNames().length > 1
        };
        eDwUIModelViewTabsPlugin.prototype.setAppEvents = function (iEnable) {
            this.addAppObjEvent(eDwEvents.InitFullUIEvent, "onInitFullUI", iEnable);
            this.addAppObjEvent(eDwEvents.DoneEvent, "onDone", iEnable);
            this.addAppObjEvent(eDwEvents.ModelViewChangeEvent, "onModelViewChange", iEnable)
        };
        eDwUIModelViewTabsPlugin.prototype.adjustPanel = function () {
            eDwUIUtils.hide(c_subContainer, true)
        };
        return eDwUIModelViewTabsPlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    var c_modelViewTabPanelID = "#edrawings-config-bar";
    var c_modelViewTabNavPanelID = "#edrawings-config-navigation";
    var c_subModelViewSelectorSubset = " > div.edrawings-menu-panel-wrapper" + " > div.edrawings-divided-container";
    var c_listSelectorSubset = " > div.edrawings-submenu-list";
    var c_subContainerSubset = " > div.edrawings-modelview-sub-container";
    var c_modelViewListSelector = c_subModelViewSelectorSubset + c_listSelectorSubset;
    var c_modelViewTabListID = "#edrawings-config-tab-list";
    var c_tabListSelector = c_modelViewTabListID;
    var c_overflowListSelector = c_modelViewTabNavPanelID + c_modelViewListSelector;
    var c_subContainer = c_modelViewTabNavPanelID + c_subModelViewSelectorSubset + c_subContainerSubset;
    var c_eventIDSuffix = ".edw.config.navigation";

    function l_adjustTabs() {
        var bottomBarJQ = $(c_modelViewTabPanelID + ".bottom-bar");
        var configTablistJQ = bottomBarJQ.find(c_modelViewTabListID);
        if (configTablistJQ.hasClass("edrawings-compressed")) {
            var leftButtonWrapperJQ = bottomBarJQ.find(".edrawings-arrow-left").parent(".edrawings-arrow-wrapper");
            var rightButtonWrapperJQ = bottomBarJQ.find(".edrawings-arrow-right").parent(".edrawings-arrow-wrapper");
            if (configTablistJQ[0].scrollLeft === 0) {
                leftButtonWrapperJQ.addClass("edrawings-disabled-button");
                bottomBarJQ.addClass("edrawings-removed-arrow-left")
            } else {
                leftButtonWrapperJQ.removeClass("edrawings-disabled-button");
                bottomBarJQ.removeClass("edrawings-removed-arrow-left")
            }
            if (configTablistJQ[0].scrollWidth - configTablistJQ[0].scrollLeft <= configTablistJQ.children(":last-child").width()) {
                rightButtonWrapperJQ.addClass("edrawings-disabled-button");
                bottomBarJQ.addClass("edrawings-removed-arrow-right")
            } else {
                rightButtonWrapperJQ.removeClass("edrawings-disabled-button");
                bottomBarJQ.removeClass("edrawings-removed-arrow-right")
            }
            eDwUIUtils.scrollToTarget(configTablistJQ.find(".edrawings-config-tab.active-modelview"))
        }
    }

    function l_determineIncrement(iContentJQ, iUseFirstVisible) {
        if (iUseFirstVisible === void 0) {
            iUseFirstVisible = true
        }
        var children = iContentJQ.children();
        var result = children.length > 0 ? children[0].offsetWidth : 0;
        if (iUseFirstVisible) {
            if (iContentJQ[0].scrollLeft > 0) {
                var sumOfWidth = 0;
                for (var i = 0; i < children.length; i++) {
                    sumOfWidth += children[i].offsetWidth;
                    if (sumOfWidth >= iContentJQ[0].scrollLeft) {
                        result = children[i].offsetWidth - (sumOfWidth - iContentJQ[0].scrollLeft);
                        result += i > 0 ? children[i - 1].offsetWidth : 0;
                        break
                    }
                }
            }
        } else {
            var sumOfWidth = 0;
            var contentScrollRight = iContentJQ[0].scrollLeft + iContentJQ.width();
            for (var i = 0; i < children.length; i++) {
                sumOfWidth += children[i].offsetWidth;
                if (sumOfWidth >= contentScrollRight) {
                    result = sumOfWidth - contentScrollRight;
                    result += i + 1 < children.length ? children[i + 1].offsetWidth : 0;
                    break
                }
            }
        }
        return result
    }

    return eDwUIModelViewTabsPlugin
}));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __values = this && this.__values || function (o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return {value: o && o[i++], done: !o}
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.")
};
define("eDwCompXformMgr", ["require", "exports", "eDwMoveOperator", "eDwEventMgr", "eDwCommandMgr", "eDwCompositeCmd", "eDwEvents", "utils"], (function (require, exports, eDwMoveOperator, eDwEventMgr, eDwCommandMgr, eDwCompositeCmd, eDwEvents_1, Utils) {
    "use strict";
    var eDwCompXformMgr = function () {
        function eDwCompXformMgr(iViewer) {
            this.mViewer = iViewer;
            this.mMoveOp = new eDwMoveOperator(iViewer, iViewer.SelectionMgr);
            iViewer.OperatorMgr.registerCustomOperator(this.mMoveOp);
            var eventMgr = eDwEventMgr.get();
            eventMgr.addEventHandlerObj(eDwEvents_1.ModelXformChangeStartEvent, this, c_eventCallbackName);
            this.mOrigModelXforms = {};
            this.mChangedModelXforms = {}
        }

        eDwCompXformMgr.prototype.unregister = function () {
            eDwEventMgr.get().removeEventHandlerObj(eDwEvents_1.ModelXformChangeStartEvent, this, c_eventCallbackName);
            this.mViewer.OperatorMgr.unregisterCustomOperatorByID(this.mMoveOp.OperatorID)
        };
        eDwCompXformMgr.prototype.activateMoveOp = function () {
            var _this = this;
            if (!this.mMoveOp) return null;
            this.mCompositeMoveCmd = new eDwCompositeCmd(this.mViewer);
            eDwCommandMgr.get().add(this.mCompositeMoveCmd);
            this.mCompositeMoveCmd.initCmdActionImplementation({
                compositeInit: function (ioCmd) {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            ioCmd.InitialState = true;
                            return [2]
                        }))
                    }))
                }, compositeUndo: function (ioCmd) {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, ioCmd.undoSubCmds()];
                                case 1:
                                    _a.sent();
                                    this.resetModelNodeXforms(ioCmd.InitialState);
                                    return [2, true]
                            }
                        }))
                    }))
                }, compositeRedo: function (ioCmd) {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, ioCmd.redoSubCmds()];
                                case 1:
                                    _a.sent();
                                    this.resetModelNodeXforms(ioCmd.FinalState);
                                    return [2, true]
                            }
                        }))
                    }))
                }, compositeCommit: function (ioCmd) {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            ioCmd.FinalState = false;
                            return [2]
                        }))
                    }))
                }, compositeCancel: function (ioCmd) {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            ioCmd.FinalState = ioCmd.InitialState = undefined;
                            return [2]
                        }))
                    }))
                }
            });
            var ret = this.mViewer.OperatorMgr.push(this.mMoveOp.OperatorID);
            return ret ? this.mMoveOp : null
        };
        eDwCompXformMgr.prototype.deactivateMoveOp = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwCommandMgr.get().remove(this.mCompositeMoveCmd, "commit")];
                        case 1:
                            _a.sent();
                            this.mCompositeMoveCmd = null;
                            return [2, this.mViewer.OperatorMgr.pop()]
                    }
                }))
            }))
        };
        eDwCompXformMgr.prototype.getModelNodeXform = function (iID) {
            return this.mOrigModelXforms ? this.mOrigModelXforms[iID] : null
        };
        eDwCompXformMgr.prototype.resetModelNodeXforms = function (iRestoreOrigs) {
            var _this = this;
            if (iRestoreOrigs === void 0) {
                iRestoreOrigs = true
            }
            var modelHC = this.mViewer.getModel().getHCModel();
            var modelXforms = iRestoreOrigs ? this.mOrigModelXforms : this.mChangedModelXforms;
            Utils.forAll((function (iCompNodeID, iCompXform) {
                if (!_this.mChangedModelXforms[iCompNodeID]) {
                    _this.mChangedModelXforms[iCompNodeID] = modelHC.getNodeMatrix(iCompNodeID).copy()
                }
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, modelHC.setNodeMatrix(iCompNodeID, iCompXform.copy())];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }), modelXforms)
        };
        eDwCompXformMgr.prototype.onModelXformChangeStart = function (iModelNodeID, iModelXform) {
            if (!this.mOrigModelXforms) this.mOrigModelXforms = {};
            if (!this.mOrigModelXforms[iModelNodeID]) {
                this.mOrigModelXforms[iModelNodeID] = iModelXform
            }
        };
        return eDwCompXformMgr
    }();
    var c_eventCallbackName = "onModelXformChangeStart";
    return eDwCompXformMgr
}));
define("eDwMoveComponentCmd", ["require", "exports", "eDwSupportsHistoryCmd", "utils"], (function (require, exports, eDwSupportsHistoryCmd, Utils) {
    "use strict";
    var eDwMoveComponentCmd = function (_super) {
        __extends(eDwMoveComponentCmd, _super);

        function eDwMoveComponentCmd(iViewer, iComponentData) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialComponentXforms = _this.assignModelXforms(iComponentData);
            return _this
        }

        eDwMoveComponentCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.setModelXforms(this.mInitialComponentXforms);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwMoveComponentCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.setModelXforms(this.mFinalComponentXforms);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwMoveComponentCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.setModelXforms(this.mFinalComponentXforms);
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwMoveComponentCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwMoveComponentCmd.prototype.setFinalComponentXforms = function (iComponentData) {
            this.mFinalComponentXforms = this.assignModelXforms(iComponentData)
        };
        eDwMoveComponentCmd.prototype.setModelXforms = function (iComponentXforms) {
            var e_1, _a;
            if (!iComponentXforms) return;
            var modelHC = this.mViewer.getModel().getHCModel();
            try {
                for (var iComponentXforms_1 = __values(iComponentXforms), iComponentXforms_1_1 = iComponentXforms_1.next(); !iComponentXforms_1_1.done; iComponentXforms_1_1 = iComponentXforms_1.next()) {
                    var compXform = iComponentXforms_1_1.value;
                    modelHC.setNodeMatrix(compXform.NodeID, compXform.Xform.copy())
                }
            } catch (e_1_1) {
                e_1 = {error: e_1_1}
            } finally {
                try {
                    if (iComponentXforms_1_1 && !iComponentXforms_1_1.done && (_a = iComponentXforms_1.return)) _a.call(iComponentXforms_1)
                } finally {
                    if (e_1) throw e_1.error
                }
            }
        };
        eDwMoveComponentCmd.prototype.assignModelXforms = function (iComponentData) {
            var componentXforms = [];
            if (!iComponentData) return componentXforms;
            Utils.forAll((function (iCompNodeID, iCompData) {
                componentXforms.push({NodeID: iCompNodeID, Xform: iCompData.Xform.copy()})
            }), iComponentData);
            return componentXforms
        };
        return eDwMoveComponentCmd
    }(eDwSupportsHistoryCmd);
    return eDwMoveComponentCmd
}));
define("eDwMoveOperator", ["require", "exports", "eDwBaseSelOperator", "eDwEventMgr", "eDwCommandMgr", "eDwMoveComponentCmd", "eDwTypes", "eDwEvents", "utils"], (function (require, exports, eDwBaseSelOperator, eDwEventMgr, eDwCommandMgr, eDwMoveComponentCmd, eDwTypes_1, eDwEvents_2, utils) {
    "use strict";
    var eDwMoveOperator = function (_super) {
        __extends(eDwMoveOperator, _super);

        function eDwMoveOperator(iViewer, iSelMgr) {
            var _this = _super.call(this, iViewer, iSelMgr) || this;
            _this.clearMemberData();
            return _this
        }

        eDwMoveOperator.prototype.onActivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this)];
                        case 1:
                            _a.sent();
                            this.mSelMgr.unSelectAllObjects();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this)];
                        case 1:
                            _a.sent();
                            this.mSelMgr.unSelectAllObjects();
                            this.clearMemberData();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseDown.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            if (!ioMouseEvent) return [2];
                            if (!(this.ActiveMouseButton === "left" || this.ActiveMouseButton === "right")) return [3, 3];
                            return [4, this.onDown(ioMouseEvent, !ioMouseEvent.controlDown())];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onMouseMove = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var doSpinAction;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseMove.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            if (!ioMouseEvent) return [2];
                            if (!this.CurrInputInfo) return [2];
                            doSpinAction = this.ActiveMouseButton === "right";
                            if (!this.onMove(ioMouseEvent, this.DragPt, this.mLastDragPt, ioMouseEvent.getPosition(), this.mLastPos, doSpinAction)) {
                                return [2]
                            }
                            this.mLastDragPt = this.DragPt;
                            this.mLastPos = ioMouseEvent.getPosition();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseUp.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            return [4, this.onUp(ioMouseEvent)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onTouchStart = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onTouchStart.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            if (this.CurrTouches.length > 1) return [2];
                            this.onDown(ioTouchEvent);
                            this.CurrInputInfo = null;
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onTouchMove = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var currTouchInfo, lastTouchInfo, doSpinAction;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!ioTouchEvent) return [2];
                            currTouchInfo = this.getTouchById(ioTouchEvent.getId());
                            lastTouchInfo = $.extend({}, currTouchInfo);
                            return [4, _super.prototype.onTouchMove.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            if (ioTouchEvent.getHandled()) return [2];
                            if (this.CurrTouches.length > 2 || !this.mSelMgr.Length) return [2];
                            doSpinAction = !this.isFirstTouchEvent(ioTouchEvent);
                            this.onMove(ioTouchEvent, currTouchInfo.DragPt, lastTouchInfo.DragPt, currTouchInfo.Pos, lastTouchInfo.Pos, doSpinAction);
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onTouchEnd = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var isFirstTouchEvent;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            isFirstTouchEvent = this.isFirstTouchEvent(ioTouchEvent);
                            return [4, _super.prototype.onTouchEnd.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            if (!ioTouchEvent) return [2];
                            ioTouchEvent.setHandled(false);
                            if (!(isFirstTouchEvent && this.mSelMgr.Length)) return [3, 3];
                            return [4, _super.prototype.onTouchEnd.call(this, ioTouchEvent)];
                        case 2:
                            _a.sent();
                            this.onUp(ioTouchEvent);
                            return [3, 4];
                        case 3:
                            this.removeTouchById(ioTouchEvent.getId());
                            _a.label = 4;
                        case 4:
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.dragFree = function (vec) {
            if (!this.CurrInputInfo && 0 === this.CurrTouches.length) return false;
            var modelHC = this.Viewer.getModel().getHCModel();
            var transMat = new eDwTypes_1.HC.Matrix;
            transMat.setTranslationComponent(vec.x, vec.y, vec.z);
            utils.forAll((function (iModelNodeID, ioNodeData) {
                ioNodeData.Xform = eDwTypes_1.HC.Matrix.multiply(ioNodeData.Xform, transMat);
                modelHC.setNodeMatrix(iModelNodeID, ioNodeData.Xform)
            }), this.mMovedCompData);
            return true
        };
        eDwMoveOperator.prototype.dragOrbit = function (deltaScrPt) {
            if (!this.CurrInputInfo && 0 === this.CurrTouches.length) return false;
            var view = this.Viewer.getHCView();
            var model = this.Viewer.getModel();
            var modelHC = model.getHCModel();
            var camera = view.getCamera();
            var projVec = eDwTypes_1.HC.Point3.subtract(camera.getTarget(), camera.getPosition()).normalize();
            var upVec = camera.getUp().copy().normalize();
            var dirVec = eDwTypes_1.HC.Point3.cross(upVec, projVec).normalize();
            utils.forAll((function (iModelNodeID, ioNodeData) {
                if (!ioNodeData.Bbox) return;
                var xformedCenter = new eDwTypes_1.HC.Point3(0, 0, 0);
                ioNodeData.Xform.transform(ioNodeData.Bbox.center(), xformedCenter);
                var transMat = new eDwTypes_1.HC.Matrix;
                var revTransMat = new eDwTypes_1.HC.Matrix;
                revTransMat.setTranslationComponent(-xformedCenter.x, -xformedCenter.y, -xformedCenter.z);
                transMat.setTranslationComponent(xformedCenter.x, xformedCenter.y, xformedCenter.z);
                var upAxisRotMat = eDwTypes_1.HC.Matrix.createFromOffAxisRotation(upVec, deltaScrPt.x);
                var dirAxisRotMat = eDwTypes_1.HC.Matrix.createFromOffAxisRotation(dirVec, -deltaScrPt.y);
                var rotMatrix = eDwTypes_1.HC.Matrix.multiply(revTransMat, upAxisRotMat);
                rotMatrix = eDwTypes_1.HC.Matrix.multiply(rotMatrix, dirAxisRotMat);
                rotMatrix = eDwTypes_1.HC.Matrix.multiply(rotMatrix, transMat);
                ioNodeData.Xform = eDwTypes_1.HC.Matrix.multiply(ioNodeData.Xform, rotMatrix);
                modelHC.setNodeMatrix(iModelNodeID, ioNodeData.Xform)
            }), this.mMovedCompData);
            return true
        };
        eDwMoveOperator.prototype.onDown = function (ioEvent, iUnselectAllEnabled) {
            if (iUnselectAllEnabled === void 0) {
                iUnselectAllEnabled = true
            }
            return __awaiter(this, void 0, void 0, (function () {
                var newlySelObj, eventMgr, model, modelHC, selObjIDs, selObjIDs_1, selObjIDs_1_1, selObjID, modelXform,
                    bboxHC, worldXformHC, invWorldXformHC, localBBoxHC, e_2_1;
                var e_2, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!ioEvent) return [2];
                            if (this.mMovedCompData) {
                                console.warn("Component transform already exists")
                            }
                            if (this.DragPt) console.warn("Still have last drag point");
                            if (iUnselectAllEnabled) this.mSelMgr.unSelectAllObjects();
                            return [4, this.getPickResult(ioEvent, this.Viewer.ViewMgr)];
                        case 1:
                            newlySelObj = _b.sent();
                            if (!newlySelObj) return [2];
                            this.DragPt = this.mFirstPt;
                            this.mLastDragPt = this.mFirstPt;
                            this.mLastPos = ioEvent.getPosition();
                            this.mMovedCompData = {};
                            eventMgr = eDwEventMgr.get();
                            model = this.Viewer.getModel();
                            modelHC = model.getHCModel();
                            selObjIDs = this.mSelMgr.getSelectableIDsHC();
                            _b.label = 2;
                        case 2:
                            _b.trys.push([2, 8, 9, 10]);
                            selObjIDs_1 = __values(selObjIDs), selObjIDs_1_1 = selObjIDs_1.next();
                            _b.label = 3;
                        case 3:
                            if (!!selObjIDs_1_1.done) return [3, 7];
                            selObjID = selObjIDs_1_1.value;
                            modelXform = modelHC.getNodeMatrix(selObjID);
                            return [4, eventMgr.fireEvent(eDwEvents_2.ModelXformChangeStartEvent, selObjID, modelXform.copy())];
                        case 4:
                            _b.sent();
                            return [4, model.getBoundingBoxOfIDsHC([selObjID])];
                        case 5:
                            bboxHC = _b.sent();
                            if (bboxHC.isDegenerate()) return [3, 6];
                            worldXformHC = modelHC.getNodeNetMatrix(selObjID);
                            invWorldXformHC = eDwTypes_1.HC.Matrix.inverse(worldXformHC);
                            localBBoxHC = bboxHC.copy();
                            l_transformBox(invWorldXformHC, localBBoxHC);
                            this.mMovedCompData[selObjID] = {Xform: modelXform, Bbox: localBBoxHC};
                            _b.label = 6;
                        case 6:
                            selObjIDs_1_1 = selObjIDs_1.next();
                            return [3, 3];
                        case 7:
                            return [3, 10];
                        case 8:
                            e_2_1 = _b.sent();
                            e_2 = {error: e_2_1};
                            return [3, 10];
                        case 9:
                            try {
                                if (selObjIDs_1_1 && !selObjIDs_1_1.done && (_a = selObjIDs_1.return)) _a.call(selObjIDs_1)
                            } finally {
                                if (e_2) throw e_2.error
                            }
                            return [7];
                        case 10:
                            this.mMoveCompCmd = new eDwMoveComponentCmd(this.Viewer, this.mMovedCompData);
                            return [4, eDwCommandMgr.get().add(this.mMoveCompCmd)];
                        case 11:
                            _b.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.onMove = function (ioEvent, iCurrPt, iLastPt, iCurrPos, iLastPos, iSpin) {
            if (!ioEvent || utils.isNaN(this.mSelMgr.getLastSelIDHC())) {
                return false
            }
            if (iSpin) {
                var deltaPt = iLastPos.subtract(iCurrPos).scale(-1);
                ioEvent.setHandled(this.dragOrbit(deltaPt))
            } else {
                var dragVec = eDwTypes_1.HC.Point3.subtract(iCurrPt, iLastPt);
                ioEvent.setHandled(this.dragFree(dragVec))
            }
            ioEvent.setHandled(true);
            return true
        };
        eDwMoveOperator.prototype.onUp = function (ioEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(ioEvent && this.mMoveCompCmd)) return [3, 2];
                            this.mMoveCompCmd.setFinalComponentXforms(this.mMovedCompData);
                            return [4, eDwCommandMgr.get().remove(this.mMoveCompCmd, "commit")];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            this.clearMemberData();
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveOperator.prototype.isFirstTouchEvent = function (ioTouchEvent) {
            return ioTouchEvent && this.CurrTouches.length > 0 && ioTouchEvent.getId() === this.CurrTouches[0].Event.getId()
        };
        eDwMoveOperator.prototype.clearMemberData = function () {
            this.mMovedCompData = null;
            this.mLastPos = null;
            this.mMoveCompCmd = null;
            this.mLastDragPt = null
        };
        return eDwMoveOperator
    }(eDwBaseSelOperator);

    function l_transformBox(iXform, ioBox) {
        iXform.transform(ioBox.min, ioBox.min);
        iXform.transform(ioBox.max, ioBox.max)
    }

    return eDwMoveOperator
}));
define("eDwUIMoveComponentPlugin", ["require", "exports", "eDwUIBasePlugin", "eDwCompXformMgr", "eDwEvents", "eDwUIUtils"], (function (require, exports, eDwUIBasePlugin_1, eDwCompXformMgr, eDwEvents_3, eDwUIUtils) {
    "use strict";
    var eDwUIMoveComponentPlugin = function (_super) {
        __extends(eDwUIMoveComponentPlugin, _super);

        function eDwUIMoveComponentPlugin(iViewer, iViewerFeatOpts) {
            var _this = this;
            var buttonInfo = {ID: "#edrawings-button-move"};
            _this = _super.call(this, "MoveComponent", iViewer, buttonInfo, iViewerFeatOpts) || this;
            _this.initPluginButton();
            _this.mCompXformMgr = new eDwCompXformMgr(iViewer);
            var model = iViewer.getModel();
            eDwUIUtils.hide(_this.PluginButtonID, !model.isAssembly());
            return _this
        }

        eDwUIMoveComponentPlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.init.call(this)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIMoveComponentPlugin.prototype.onClick = function (iActivate) {
            _super.prototype.onClick.call(this, iActivate);
            if (iActivate) {
                eDwUIUtils.activateUI(this.PluginButtonID, null)
            }
        };
        eDwUIMoveComponentPlugin.prototype.addEventHandlers = function () {
            _super.prototype.addEventHandlers.call(this);
            _super.prototype.addAppObjEvent.call(this, eDwEvents_3.ResetSceneEvent, "onResetScene", true)
        };
        eDwUIMoveComponentPlugin.prototype.removeEventHandlers = function () {
            _super.prototype.removeEventHandlers.call(this);
            _super.prototype.addAppObjEvent.call(this, eDwEvents_3.ResetSceneEvent, "onResetScene", false)
        };
        eDwUIMoveComponentPlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentActivated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                        case 1:
                            parentActivated = _a.sent();
                            if (!parentActivated) return [2, false];
                            this.mCompXformMgr.activateMoveOp();
                            $("#edrawings-canvas")[0].style.cursor = "pointer";
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIMoveComponentPlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentDeactivated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                        case 1:
                            parentDeactivated = _a.sent();
                            if (!parentDeactivated) return [2, false];
                            return [4, this.mCompXformMgr.deactivateMoveOp()];
                        case 2:
                            _a.sent();
                            $("#edrawings-canvas")[0].style.cursor = "default";
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIMoveComponentPlugin.prototype.onResetScene = function (iDoReset) {
            this.mCompXformMgr.resetModelNodeXforms(iDoReset)
        };
        return eDwUIMoveComponentPlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    return eDwUIMoveComponentPlugin
}));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
var __values = this && this.__values || function (o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return {value: o && o[i++], done: !o}
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.")
};
define("eDwMeasureEntities", ["require", "exports", "eDwEventMgr", "eDwSelObj", "eDwTypes", "hcutils", "eDwGeomUtils", "utils", "eDwMeasureEvents", "eDwUILocalize"], (function (require, exports, eDwEventMgr, eDwSelObj, eDwTypes_1, hcutils_1, eDwGeomUtils, utils, eDwMeasureEvents_1, eDwUILocalize_1) {
    "use strict";
    var eDwMeasureEntities = function (_super) {
        __extends(eDwMeasureEntities, _super);

        function eDwMeasureEntities(iViewer) {
            var _this = _super.call(this) || this;
            _this.mViewer = iViewer;
            l_Model = iViewer.getModel();
            _this.mSelObjs = [];
            _this.mSelMeasureEntColor = eDwTypes_1.HC.Color.green();
            _this.mAuxGeoSelected = new MeasureAuxGeo(_this.mViewer);
            _this.mAuxGeoImmediate = new MeasureAuxGeo(_this.mViewer);
            _this.mAuxGeoImmediate.setImmediateDrawMode(true);
            _this.mPanelInfo = new MeasurePanelInfo(_this.mAuxGeoSelected);
            return _this
        }

        eDwMeasureEntities.prototype.addEntity = function (iSelObj) {
            return __awaiter(this, void 0, void 0, (function () {
                var success, subEntityInfo;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            success = true;
                            this.mAuxGeoSelected.reset();
                            subEntityInfo = eDwSelObj.getSubEntityInfo(iSelObj);
                            if (!(subEntityInfo.SubEntityTypeName === "Point")) return [3, 2];
                            return [4, this.addAllForEntity(iSelObj)];
                        case 1:
                            _a.sent();
                            return [3, 7];
                        case 2:
                            if (!(subEntityInfo.SubEntityTypeName === "Line" && subEntityInfo.IsSelectable)) return [3, 4];
                            return [4, this.addAllForEntity(iSelObj)];
                        case 3:
                            _a.sent();
                            return [3, 7];
                        case 4:
                            if (!(subEntityInfo.SubEntityTypeName === "Face" && subEntityInfo.IsSelectable)) return [3, 6];
                            return [4, this.addAllForEntity(iSelObj)];
                        case 5:
                            _a.sent();
                            return [3, 7];
                        case 6:
                            this.reset();
                            success = false;
                            _a.label = 7;
                        case 7:
                            this.updatePanelResult();
                            return [2, success]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.addEntityImmediate = function (iSelObj) {
            return __awaiter(this, void 0, void 0, (function () {
                var subEntityInfo, selObjsHC, drawLabels;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(!iSelObj || !eDwMeasureEntities.PointToPoint && utils.isNumber(this.isItemSelected(iSelObj)))) return [3, 2];
                            return [4, this.resetImmediateResults()];
                        case 1:
                            _a.sent();
                            return [2, false];
                        case 2:
                            subEntityInfo = eDwSelObj.getSubEntityInfo(iSelObj);
                            selObjsHC = this.mSelObjs.slice();
                            drawLabels = true;
                            if (subEntityInfo.SubEntityTypeName === "Point") {
                                selObjsHC.push(iSelObj)
                            } else if (subEntityInfo.SubEntityTypeName === "Line" && subEntityInfo.IsSelectable) {
                                selObjsHC.push(iSelObj)
                            } else if (subEntityInfo.SubEntityTypeName === "Face" && subEntityInfo.IsSelectable) {
                                selObjsHC.push(iSelObj)
                            } else {
                                drawLabels = false
                            }
                            return [4, this.setImmediateResults(selObjsHC, drawLabels)];
                        case 3:
                            return [2, _a.sent()]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.resetImmediateResults = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.setImmediateResults(this.mSelObjs.slice())];
                        case 1:
                            return [2, _a.sent()]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.removeEntityAtIndex = function (idx) {
            return __awaiter(this, void 0, void 0, (function () {
                var toRemove, updated;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (idx < 0 || idx >= this.mSelObjs.length) return [2, null];
                            this.dehighlightAllTemporaryEntity();
                            toRemove = this.mSelObjs[idx];
                            this.mSelObjs.splice(idx, 1);
                            if (!utils.isNumber(this.isItemSelected(toRemove))) {
                                this.deColorEntity(toRemove)
                            }
                            return [4, this.updateResult(this.mSelObjs, this.mAuxGeoSelected)];
                        case 1:
                            updated = _a.sent();
                            if (!(updated || this.mSelObjs.length === 0)) return [3, 3];
                            return [4, this.resetImmediateResults()];
                        case 2:
                            _a.sent();
                            return [3, 4];
                        case 3:
                            this.mAuxGeoImmediate.regeneratePicks(this.mSelObjs);
                            _a.label = 4;
                        case 4:
                            this.updatePanelResult();
                            return [2, toRemove]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.setSelectedEntityColor = function (iColor) {
            this.mSelMeasureEntColor = hcutils_1.coerceToHCColor(iColor)
        };
        eDwMeasureEntities.prototype.setMeasureUnit = function (iUserUnits) {
            var _this = this;
            this.mViewer.getModel().setUserUnits(iUserUnits);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.resetImmediateResults()];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            this.mAuxGeoSelected.syncUnits();
            this.updatePanelResult();
            this.mViewer.getHCMarkupManager().refreshMarkup()
        };
        eDwMeasureEntities.prototype.updatePointToPoint = function (iEnable) {
            eDwMeasureEntities.PointToPoint = iEnable;
            this.reset();
            this.mAuxGeoSelected.updateResultLabels();
            this.mAuxGeoImmediate.updateResultLabels();
            this.mViewer.getHCMarkupManager().refreshMarkup()
        };
        eDwMeasureEntities.prototype.updateDelta = function (iEnable) {
            eDwMeasureEntities.ShowDelta = iEnable;
            this.mAuxGeoSelected.updateResultLabels();
            this.mAuxGeoImmediate.updateResultLabels();
            this.updatePanelResult();
            this.mViewer.getHCMarkupManager().refreshMarkup()
        };
        eDwMeasureEntities.prototype.updatePanelResult = function () {
            var userUnits = this.mViewer.getModel().getUserUnits();
            this.mPanelInfo.updatePanelResult(this.mSelObjs, userUnits)
        };
        eDwMeasureEntities.prototype.reset = function () {
            this.deColorAll();
            this.mAuxGeoSelected.reset();
            this.mAuxGeoImmediate.reset();
            this.mSelObjs = [];
            this.updatePanelResult()
        };
        eDwMeasureEntities.prototype.draw = function () {
            this.mAuxGeoSelected.draw();
            this.mAuxGeoImmediate.draw()
        };
        eDwMeasureEntities.prototype.getClassName = function () {
            return "eDwMeasureEntities"
        };
        eDwMeasureEntities.prototype.isItemSelected = function (iSelObj) {
            if (utils.isNumber(iSelObj.getIDHC())) {
                for (var i = 0; i < this.mSelObjs.length; ++i) {
                    var selObj = this.mSelObjs[i];
                    if (selObj.equals(iSelObj)) return i
                }
            }
            return NaN
        };
        eDwMeasureEntities.prototype.onDragLabelStart = function (iLabel, iPos) {
            if (utils.isInstanceOf(iLabel, LabelItem)) {
                this.mCurLabel = iLabel;
                this.mCurLabel.onDragStart(iPos)
            }
        };
        eDwMeasureEntities.prototype.onDragLabelMove = function (iPos) {
            if (this.mCurLabel) {
                this.mCurLabel.onDragMove(iPos);
                this.mViewer.getHCMarkupManager().refreshMarkup()
            }
        };
        eDwMeasureEntities.prototype.onDragLabelEnd = function (iPos) {
            if (this.mCurLabel) this.mCurLabel.onDragEnd(iPos);
            this.mCurLabel = null
        };
        eDwMeasureEntities.prototype.highlightTemporaryEntityAt = function (iIndex) {
            var _this = this;
            this.highlightEntityAt(iIndex);
            this.mAuxGeoSelected.updateInfoLabel(iIndex);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwMeasureEvents_1.MeasurementSelectionEvent, iIndex)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwMeasureEntities.prototype.dehighlightTemporaryEntityAt = function (iIndex) {
            this.highlightEntityAt(iIndex, false);
            this.mAuxGeoSelected.updateInfoLabel(-1)
        };
        eDwMeasureEntities.prototype.dehighlightAllTemporaryEntity = function () {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwMeasureEvents_1.MeasurementDeselectAllEvent)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            var n = this.mSelObjs.length;
            for (var i = 0; i < n; ++i) {
                this.dehighlightTemporaryEntityAt(i)
            }
        };
        eDwMeasureEntities.getMeasureSelObjID = function (iSelObj) {
            var subEntInfo = eDwSelObj.getSubEntityInfo(iSelObj);
            return subEntInfo.IsSelectable ? eDwSelObj.getSubEntityID(subEntInfo.SubEntity) : NaN
        };
        eDwMeasureEntities.highlightEntity = function (iSelObj, iModel, iHighlight) {
            if (iHighlight === void 0) {
                iHighlight = true
            }
            var entityID = eDwMeasureEntities.getMeasureSelObjID(iSelObj);
            if (!utils.isNumber(entityID)) return false;
            var highlightFunc = null;
            var modelHC = iModel.getHCModel();
            var nodeIDHC = iSelObj.getNodeId();
            if (iSelObj.getFaceEntity()) {
                highlightFunc = modelHC.setNodeFaceHighlighted
            } else if (iSelObj.getLineEntity()) {
                highlightFunc = modelHC.setNodeLineHighlighted
            } else if (iSelObj.getPointEntity()) {
                highlightFunc = modelHC.setNodePointHighlighted
            }
            if (highlightFunc) {
                highlightFunc.call(modelHC, nodeIDHC, entityID, iHighlight);
                return true
            }
            return false
        };
        eDwMeasureEntities.prototype.addObjs = function (iSelObj) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(eDwMeasureEntities.PointToPoint && 2 === this.mSelObjs.length)) return [3, 2];
                            return [4, this.removeEntityAtIndex(1)];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            this.mSelObjs.push(iSelObj);
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.deColorAll = function () {
            for (var i = 0; i < this.mSelObjs.length; ++i) {
                this.deColorEntity(this.mSelObjs[i])
            }
        };
        eDwMeasureEntities.prototype.deColorEntity = function (iSelObj) {
            this.colorEntity(iSelObj, false)
        };
        eDwMeasureEntities.prototype.colorEntity = function (iSelObj, iChangeColor) {
            if (iChangeColor === void 0) {
                iChangeColor = true
            }
            var modelHC = this.mViewer.getModel().getHCModel();
            var nodeID = iSelObj.getNodeId();
            var entityID = eDwMeasureEntities.getMeasureSelObjID(iSelObj);
            if (!utils.isNumber(entityID)) return;
            if (iSelObj.getFaceEntity()) {
                if (iChangeColor) {
                    modelHC.setNodeFaceColor(nodeID, entityID, this.mSelMeasureEntColor)
                } else modelHC.unsetNodeFaceColor(nodeID, entityID)
            }
            if (iSelObj.getLineEntity()) {
                if (iChangeColor) {
                    modelHC.setNodeLineColor(nodeID, entityID, this.mSelMeasureEntColor)
                } else modelHC.unsetNodeLineColor(nodeID, entityID)
            }
        };
        eDwMeasureEntities.prototype.setImmediateResults = function (iSelObjs, iDrawLabels) {
            if (iDrawLabels === void 0) {
                iDrawLabels = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.updateResult(iSelObjs, this.mAuxGeoImmediate, iDrawLabels)];
                        case 1:
                            return [2, _a.sent()]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.updateResult = function (iSelObjs, ioAuxGeo, iDrawLabels) {
            if (iDrawLabels === void 0) {
                iDrawLabels = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                var modelHC, selPropsHC, iSelObjs_1, iSelObjs_1_1, selObj, subEntityInfo, subEntityID, prop, e_1_1,
                    isValid, _a, _b, _c, n, result;
                var e_1, _d;
                return __generator(this, (function (_e) {
                    switch (_e.label) {
                        case 0:
                            ioAuxGeo.reset();
                            ioAuxGeo.setDrawLabel(iDrawLabels);
                            if (iSelObjs.length) {
                                console.debugLog("Measure", "Measure - Selected object properties:")
                            }
                            modelHC = this.mViewer.getModel().getHCModel();
                            selPropsHC = [];
                            _e.label = 1;
                        case 1:
                            _e.trys.push([1, 9, 10, 11]);
                            iSelObjs_1 = __values(iSelObjs), iSelObjs_1_1 = iSelObjs_1.next();
                            _e.label = 2;
                        case 2:
                            if (!!iSelObjs_1_1.done) return [3, 8];
                            selObj = iSelObjs_1_1.value;
                            subEntityInfo = eDwSelObj.getSubEntityInfo(selObj);
                            subEntityID = eDwSelObj.getSubEntityID(subEntityInfo.SubEntity);
                            prop = null;
                            if (!selObj.getLineEntity()) return [3, 4];
                            return [4, modelHC.getEdgeProperty(selObj.getNodeId(), subEntityID)];
                        case 3:
                            prop = _e.sent();
                            return [3, 6];
                        case 4:
                            if (!selObj.getFaceEntity()) return [3, 6];
                            return [4, modelHC.getFaceProperty(selObj.getNodeId(), subEntityID)];
                        case 5:
                            prop = _e.sent();
                            _e.label = 6;
                        case 6:
                            selPropsHC.push(prop);
                            console.debugLog("Measure", "Entity properties: " + JSON.stringify(prop));
                            _e.label = 7;
                        case 7:
                            iSelObjs_1_1 = iSelObjs_1.next();
                            return [3, 2];
                        case 8:
                            return [3, 11];
                        case 9:
                            e_1_1 = _e.sent();
                            e_1 = {error: e_1_1};
                            return [3, 11];
                        case 10:
                            try {
                                if (iSelObjs_1_1 && !iSelObjs_1_1.done && (_d = iSelObjs_1.return)) _d.call(iSelObjs_1)
                            } finally {
                                if (e_1) throw e_1.error
                            }
                            return [7];
                        case 11:
                            _c = eDwMeasureEntities.PointToPoint || this.updateSingleVert(iSelObjs) || this.updateSingleEdge(iSelObjs) || this.updateSingleFace(selPropsHC, iSelObjs) || this.updateVertEdge(selPropsHC, iSelObjs, ioAuxGeo);
                            if (_c) return [3, 13];
                            return [4, this.updateVertFace(selPropsHC, iSelObjs, ioAuxGeo)];
                        case 12:
                            _c = _e.sent();
                            _e.label = 13;
                        case 13:
                            _b = _c || this.updateVertVert(iSelObjs, ioAuxGeo);
                            if (_b) return [3, 15];
                            return [4, this.updateEdgeFace(selPropsHC, iSelObjs, ioAuxGeo)];
                        case 14:
                            _b = _e.sent();
                            _e.label = 15;
                        case 15:
                            _a = _b;
                            if (_a) return [3, 17];
                            return [4, this.updateFaceFace(selPropsHC, iSelObjs, ioAuxGeo)];
                        case 16:
                            _a = _e.sent();
                            _e.label = 17;
                        case 17:
                            isValid = _a || this.updateEdgeEdge(selPropsHC, iSelObjs, ioAuxGeo) || this.updateEdges(selPropsHC, iSelObjs, ioAuxGeo);
                            ioAuxGeo.addPickInfo(selPropsHC, iSelObjs, iDrawLabels);
                            n = iSelObjs.length;
                            if (!isValid && n > 0) {
                                result = new MeasureResultString(cLocalizedInfo, cLocalizedInvalidCombo);
                                ioAuxGeo.addMessage(result, iSelObjs[n - 1].getPosition(), eDwTypes_1.HC.Color.red())
                            }
                            ioAuxGeo.updateResultLabels();
                            return [2, isValid]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.updateSingleVert = function (iSelObjs) {
            if (1 !== iSelObjs.length) return false;
            var vertObj = iSelObjs[0];
            return vertObj.getPointEntity() ? true : false
        };
        eDwMeasureEntities.prototype.updateSingleEdge = function (iSelObjs) {
            if (1 !== iSelObjs.length) return false;
            var edgeObj = iSelObjs[0];
            if (edgeObj.getLineEntity()) return true;
            return false
        };
        eDwMeasureEntities.prototype.updateSingleFace = function (iSelPropsHC, iSelObjs) {
            if (1 !== iSelObjs.length) return false;
            var faceObj = iSelObjs[0];
            var faceProp = iSelPropsHC[0];
            if (!faceObj.getFaceEntity() || !faceProp) return false;
            if (faceProp instanceof eDwTypes_1.HC.SubentityProperties.CylinderElement) {
                return true
            } else if (faceProp instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement) {
                return true
            }
            return false
        };
        eDwMeasureEntities.prototype.updateVertVert = function (iSelObjs, iAuxGeo) {
            if (2 !== iSelObjs.length) return false;
            if (iSelObjs[0].getPointEntity() && iSelObjs[1].getPointEntity()) {
                var vertObj0 = iSelObjs[0];
                var vertObj1 = iSelObjs[1];
                if (vertObj0.equals(vertObj1)) return false;
                iAuxGeo.setByVertexVertex(vertObj0, vertObj1);
                return true
            }
            return false
        };
        eDwMeasureEntities.prototype.updateVertEdge = function (iSelPropsHC, iSelObjs, iAuxGeo) {
            if (2 !== iSelObjs.length) return false;
            var edgeProp = iSelPropsHC[0];
            var edgeObj = iSelObjs[0];
            var vertObj = iSelObjs[1];
            if (iSelObjs[1].getLineEntity() && iSelObjs[0].getPointEntity()) {
                edgeProp = iSelPropsHC[1];
                edgeObj = iSelObjs[1];
                vertObj = iSelObjs[0]
            }
            if (!vertObj.getPointEntity()) return false;
            if (edgeProp instanceof eDwTypes_1.HC.SubentityProperties.LineElement) {
                iAuxGeo.setByVertexLine(vertObj, edgeProp, edgeObj);
                return true
            } else if (edgeProp instanceof eDwTypes_1.HC.SubentityProperties.CircleElement) {
                iAuxGeo.setByVertexCircle(vertObj, edgeProp, edgeObj);
                return true
            }
            return false
        };
        eDwMeasureEntities.prototype.updateVertFace = function (iSelPropsHC, iSelObjs, iAuxGeo) {
            return __awaiter(this, void 0, void 0, (function () {
                var vertObj, faceProp, faceObj, minDistInfo;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (2 !== iSelObjs.length) return [2, false];
                            vertObj = iSelObjs[0];
                            faceProp = iSelPropsHC[1];
                            faceObj = iSelObjs[1];
                            if (iSelObjs[1].getPointEntity() && iSelObjs[0].getFaceEntity()) {
                                vertObj = iSelObjs[1];
                                faceProp = iSelPropsHC[0];
                                faceObj = iSelObjs[0]
                            }
                            if (!vertObj.getPointEntity()) return [2, false];
                            if (!(faceProp instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement)) return [3, 2];
                            return [4, eDwSelObj.getMinDistInfo(iSelPropsHC, iSelObjs, this.mViewer.getModel())];
                        case 1:
                            minDistInfo = _a.sent();
                            iAuxGeo.setByVertexPlane(vertObj, faceProp, faceObj, minDistInfo);
                            return [2, true];
                        case 2:
                            return [2, false]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.updateEdgeFace = function (iSelPropsHC, iSelObjs, iAuxGeo) {
            return __awaiter(this, void 0, void 0, (function () {
                var edgeProp, edgeObj, faceProp, faceObj, minDistInfo;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (2 !== iSelObjs.length) return [2, false];
                            edgeProp = iSelPropsHC[0];
                            edgeObj = iSelObjs[0];
                            faceProp = iSelPropsHC[1];
                            faceObj = iSelObjs[1];
                            if (iSelObjs[1].getLineEntity() && iSelObjs[0].getFaceEntity()) {
                                edgeProp = iSelPropsHC[1];
                                edgeObj = iSelObjs[1];
                                faceProp = iSelPropsHC[0];
                                faceObj = iSelObjs[0]
                            }
                            if (!(edgeProp instanceof eDwTypes_1.HC.SubentityProperties.LineElement && faceProp instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement)) return [3, 1];
                            iAuxGeo.setByPlaneLine(faceProp, edgeProp, faceObj, edgeObj);
                            return [2, true];
                        case 1:
                            if (!(edgeProp instanceof eDwTypes_1.HC.SubentityProperties.CircleElement && faceProp instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement)) return [3, 3];
                            return [4, eDwSelObj.getMinDistInfo(iSelPropsHC, iSelObjs, this.mViewer.getModel())];
                        case 2:
                            minDistInfo = _a.sent();
                            iAuxGeo.setByCirclePlane(edgeProp, faceProp, edgeObj, faceObj, minDistInfo);
                            return [2, true];
                        case 3:
                            return [2, false]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.updateEdgeEdge = function (iSelPropsHC, iSelObjs, iAuxGeo) {
            if (2 !== iSelObjs.length) return false;
            if (!iSelObjs[0].getLineEntity() || !iSelObjs[1].getLineEntity()) {
                return false
            }
            var edgeObj0 = iSelObjs[0];
            var edgeProp0 = iSelPropsHC[0];
            var edgeObj1 = iSelObjs[1];
            var edgeProp1 = iSelPropsHC[1];
            if (edgeObj0.equals(edgeObj1)) return false;
            if (edgeProp0 instanceof eDwTypes_1.HC.SubentityProperties.LineElement && edgeProp1 instanceof eDwTypes_1.HC.SubentityProperties.LineElement) {
                iAuxGeo.setByLineLine(edgeProp0, edgeProp1, edgeObj0, edgeObj1)
            } else if (edgeProp0 instanceof eDwTypes_1.HC.SubentityProperties.LineElement && edgeProp1 instanceof eDwTypes_1.HC.SubentityProperties.CircleElement) {
                iAuxGeo.setByCircleLine(edgeProp1, edgeProp0, edgeObj1, edgeObj0)
            } else if (edgeProp0 instanceof eDwTypes_1.HC.SubentityProperties.CircleElement && edgeProp1 instanceof eDwTypes_1.HC.SubentityProperties.LineElement) {
                iAuxGeo.setByCircleLine(edgeProp0, edgeProp1, edgeObj0, edgeObj1)
            } else if (edgeProp0 instanceof eDwTypes_1.HC.SubentityProperties.CircleElement && edgeProp1 instanceof eDwTypes_1.HC.SubentityProperties.CircleElement) {
                iAuxGeo.setByCircleCircle(edgeProp0, edgeProp1, edgeObj0, edgeObj1)
            }
            this.updateEdges(iSelPropsHC, iSelObjs, iAuxGeo);
            return true
        };
        eDwMeasureEntities.prototype.updateFaceFace = function (iSelPropsHC, iSelObjs, iAuxGeo) {
            return __awaiter(this, void 0, void 0, (function () {
                var faceObj0, faceProp0, faceObj1, faceProp1, minDistInfo;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (2 !== iSelObjs.length) return [2, false];
                            if (!iSelObjs[0].getFaceEntity() || !iSelObjs[1].getFaceEntity()) {
                                return [2, false]
                            }
                            faceObj0 = iSelObjs[0];
                            faceProp0 = iSelPropsHC[0];
                            faceObj1 = iSelObjs[1];
                            faceProp1 = iSelPropsHC[1];
                            if (faceObj0.equals(faceObj1)) return [2, false];
                            if (!faceObj1.getFaceEntity() || !faceProp1) return [2, false];
                            if (!(faceProp0 instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement && faceProp1 instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement)) return [3, 2];
                            return [4, eDwSelObj.getMinDistInfo(iSelPropsHC, iSelObjs, this.mViewer.getModel())];
                        case 1:
                            minDistInfo = _a.sent();
                            iAuxGeo.setByPlanePlane(faceProp1, faceProp0, faceObj1, faceObj0, minDistInfo);
                            return [2, true];
                        case 2:
                            return [2, false]
                    }
                }))
            }))
        };
        eDwMeasureEntities.prototype.updateEdges = function (iSelPropsHC, iSelObjs, ioAuxGeo) {
            var n = iSelObjs.length;
            var len = 0;
            var ids = [];
            for (var i = 0; i < n; ++i) {
                var selPropHC = iSelPropsHC[i];
                var selObj = iSelObjs[i];
                if (!selObj.getLineEntity() || !selPropHC) {
                    return false
                }
                var lineId = selObj.getLineEntity().getLineId();
                if (-1 !== ids.indexOf(lineId)) {
                    return false
                }
                ids.push(lineId);
                if (selPropHC instanceof eDwTypes_1.HC.SubentityProperties.LineElement || selPropHC instanceof eDwTypes_1.HC.SubentityProperties.OtherEdgeElement) {
                    len += selPropHC.length
                } else if (selPropHC instanceof eDwTypes_1.HC.SubentityProperties.CircleElement) {
                    var circularArc = l_getCircularArc(selObj, selPropHC);
                    len += circularArc.Length
                } else {
                    return false
                }
            }
            var pos = new eDwTypes_1.HC.Point3(0, 0, 0);
            if (n > 1) {
                var result = new MeasureResultDistance(cLocalizedTotalLength, len);
                pos = iSelObjs[n - 1].getPosition();
                ioAuxGeo.addOtherResult(result, pos);
                return true
            }
            return false
        };
        eDwMeasureEntities.prototype.highlightEntityAt = function (iIndex, iHighlight) {
            if (iHighlight === void 0) {
                iHighlight = true
            }
            var n = this.mSelObjs.length;
            if (iIndex < 0 || iIndex >= n) return;
            eDwMeasureEntities.highlightEntity(this.mSelObjs[iIndex], this.mViewer.getModel(), iHighlight)
        };
        eDwMeasureEntities.prototype.addAllForEntity = function (iSelObj) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.addObjs(iSelObj)];
                        case 1:
                            _a.sent();
                            return [4, this.updateResult(this.mSelObjs, this.mAuxGeoSelected)];
                        case 2:
                            _a.sent();
                            return [4, this.resetImmediateResults()];
                        case 3:
                            _a.sent();
                            this.colorEntity(iSelObj);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwMeasureEntities.PointToPoint = false;
        eDwMeasureEntities.ShowDelta = false;
        return eDwMeasureEntities
    }(eDwTypes_1.HC.Markup.MarkupItem);
    var LabelItem = function (_super) {
        __extends(LabelItem, _super);

        function LabelItem(iViewer, iLabel) {
            var _this = _super.call(this) || this;
            _this.mLabel = iLabel;
            return _this
        }

        LabelItem.prototype.setStringContent = function () {
            this.mLabel.setStringContent()
        };
        LabelItem.prototype.draw = function () {
            this.mLabel.drawLabel()
        };
        LabelItem.prototype.hit = function (iPos) {
            var box = this.mLabel.getLabelBox();
            if (!box) return false;
            var xMin = box.Min.x;
            var xMax = box.Max.x;
            var yMin = box.Min.y;
            var yMax = box.Max.y;
            return iPos.x <= xMax && iPos.x >= xMin && iPos.y <= yMax && iPos.y >= yMin
        };
        LabelItem.prototype.onDragStart = function (iPos) {
            this.mDragPos = iPos.copy();
            return true
        };
        LabelItem.prototype.onDragMove = function (iPos) {
            var delta = eDwTypes_1.HC.Point2.subtract(iPos, this.mDragPos);
            var endPos = this.mLabel.getLeaderEndPos();
            if (!eDwGeomUtils.isValidHCPoint(endPos) || !eDwGeomUtils.isValidHCPoint(delta)) return true;
            endPos.add(delta);
            this.mLabel.setLeaderEndPos(endPos);
            this.mDragPos = iPos.copy();
            return true
        };
        LabelItem.prototype.onDragEnd = function (iPos) {
            return true
        };
        return LabelItem
    }(eDwTypes_1.HC.Markup.MarkupItem);
    var MeasureResultItem = function () {
        function MeasureResultItem(iLocalizableName) {
            this.mLocalizableName = iLocalizableName
        }

        Object.defineProperty(MeasureResultItem.prototype, "Value", {
            get: function () {
                return ":NOVALUE:"
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(MeasureResultItem.prototype, "Name", {
            get: function () {
                return this.mLocalizableName()
            }, enumerable: false, configurable: true
        });
        return MeasureResultItem
    }();
    var MeasureResultString = function (_super) {
        __extends(MeasureResultString, _super);

        function MeasureResultString(iLocalizeableName, iLocalizeableValue) {
            var _this = _super.call(this, iLocalizeableName) || this;
            _this.mLocalizeableValue = iLocalizeableValue;
            return _this
        }

        Object.defineProperty(MeasureResultString.prototype, "Value", {
            get: function () {
                return this.mLocalizeableValue()
            }, enumerable: false, configurable: true
        });
        return MeasureResultString
    }(MeasureResultItem);
    var MeasureResultNumber = function (_super) {
        __extends(MeasureResultNumber, _super);

        function MeasureResultNumber(iLocalizeableName, iValueKind) {
            var _this = _super.call(this, iLocalizeableName) || this;
            _this.mValueKind = iValueKind;
            return _this
        }

        Object.defineProperty(MeasureResultNumber.prototype, "Value", {
            get: function () {
                return l_Model.getValueWithUnit(this.mValue, this.mValueKind)
            }, enumerable: false, configurable: true
        });
        return MeasureResultNumber
    }(MeasureResultItem);
    var MeasureResultDistance = function (_super) {
        __extends(MeasureResultDistance, _super);

        function MeasureResultDistance(iLocalizeableName, iValue) {
            var _this = _super.call(this, iLocalizeableName, "Length") || this;
            _this.mValue = iValue;
            return _this
        }

        return MeasureResultDistance
    }(MeasureResultNumber);
    var MeasureResultArea = function (_super) {
        __extends(MeasureResultArea, _super);

        function MeasureResultArea(iLocalizeableName, iValue) {
            var _this = _super.call(this, iLocalizeableName, "Area") || this;
            _this.mValue = iValue;
            return _this
        }

        return MeasureResultArea
    }(MeasureResultNumber);
    var MeasureResultAngle = function (_super) {
        __extends(MeasureResultAngle, _super);

        function MeasureResultAngle(iLocalizeableName, iValue) {
            var _this = _super.call(this, iLocalizeableName, "Angle") || this;
            _this.mValue = iValue;
            return _this
        }

        return MeasureResultAngle
    }(MeasureResultNumber);
    var MeasureResultPoint3D = function (_super) {
        __extends(MeasureResultPoint3D, _super);

        function MeasureResultPoint3D(iLocalizeableName, iValue) {
            var _this = _super.call(this, iLocalizeableName) || this;
            _this.mValue = iValue.copy();
            return _this
        }

        Object.defineProperty(MeasureResultPoint3D.prototype, "Value", {
            get: function () {
                return l_Model.getValueWithUnit(this.mValue.x, "Length") + "," + l_Model.getValueWithUnit(this.mValue.y, "Length") + "," + l_Model.getValueWithUnit(this.mValue.z, "Length")
            }, enumerable: false, configurable: true
        });
        return MeasureResultPoint3D
    }(MeasureResultItem);
    var MeasureLabelItem = function () {
        function MeasureLabelItem(iViewer, iResult, iColor) {
            this.mViewer = iViewer;
            this.mResult = iResult;
            this.mColor = iColor;
            this.mNameTextBox = undefined;
            this.mValueTextBox = undefined;
            this.mNameBox = undefined;
            this.mValueBox = undefined
        }

        MeasureLabelItem.prototype.drawItem = function () {
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            if (this.mNameBox) renderer.drawRectangle(this.mNameBox);
            if (this.mValueBox) renderer.drawRectangle(this.mValueBox);
            if (this.mNameTextBox) renderer.drawTextBox(this.mNameTextBox);
            if (this.mValueTextBox) renderer.drawTextBox(this.mValueTextBox)
        };
        MeasureLabelItem.prototype.setPosition = function (ioPos, iNameWidth, iValueWidth) {
            if (!this.mNameBox || !this.mValueBox || !this.mNameTextBox || !this.mValueTextBox) {
                this.mNameBox = new eDwTypes_1.HC.Markup.Shape.Rectangle;
                this.mNameBox.setFillColor(this.mColor ? this.mColor : cGreyColor);
                this.mValueBox = new eDwTypes_1.HC.Markup.Shape.Rectangle;
                this.mValueBox.setFillColor(eDwTypes_1.HC.Color.white());
                this.mNameTextBox = new eDwTypes_1.HC.Markup.Shape.TextBox;
                this.mNameTextBox.getBoxPortion().setFillColor(eDwTypes_1.HC.Color.white());
                this.mNameTextBox.getBoxPortion().setStrokeWidth(0);
                this.mNameTextBox.getTextPortion().setFillColor(eDwTypes_1.HC.Color.white());
                this.mNameTextBox.getBoxPortion().setFillOpacity(0);
                this.mNameTextBox.getTextPortion().setFontFamily("arial");
                this.mValueTextBox = new eDwTypes_1.HC.Markup.Shape.TextBox;
                this.mValueTextBox.getBoxPortion().setFillColor(eDwTypes_1.HC.Color.white());
                this.mValueTextBox.getBoxPortion().setStrokeWidth(0);
                this.mValueTextBox.getTextPortion().setFillColor(cGreyColor);
                this.mValueTextBox.getBoxPortion().setFillOpacity(0);
                this.mValueTextBox.getTextPortion().setFontFamily("arial")
            }
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            var nameSize = renderer.measureTextBox(this.mNameTextBox);
            var valueSize = renderer.measureTextBox(this.mValueTextBox);
            var height = Math.max(nameSize.y, valueSize.y);
            this.mNameBox.setSize(new eDwTypes_1.HC.Point2(iNameWidth, height));
            this.mValueBox.setSize(new eDwTypes_1.HC.Point2(iValueWidth, height));
            var namePos = ioPos.copy();
            var valuePos = ioPos.copy();
            valuePos.x += iNameWidth;
            this.mNameBox.setPosition(namePos);
            this.mNameTextBox.setPosition(namePos);
            this.mValueBox.setPosition(valuePos);
            this.mValueTextBox.setPosition(valuePos);
            ioPos.y += height
        };
        MeasureLabelItem.prototype.getWidth = function () {
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            var nameSize = this.mNameTextBox ? renderer.measureTextBox(this.mNameTextBox) : {x: 0, y: 0};
            var valueSize = this.mValueTextBox ? renderer.measureTextBox(this.mValueTextBox) : {x: 0, y: 0};
            return {NameWidth: nameSize.x, ValueWidth: valueSize.x}
        };
        MeasureLabelItem.prototype.setStringContent = function () {
            if (this.mNameTextBox) {
                this.mNameTextBox.setTextString(this.mResult.Name)
            }
            if (this.mValueTextBox) {
                this.mValueTextBox.setTextString(this.mResult.Value)
            }
        };
        MeasureLabelItem.prototype.getText = function () {
            return this.mResult.Name + ": " + this.mResult.Value
        };
        MeasureLabelItem.prototype.getBoundingBox = function () {
            if (!this.mNameBox || !this.mValueBox) {
                return null
            }
            var size1 = this.mValueBox.getSize();
            var posS = this.mNameBox.getPosition().copy();
            var pos1 = this.mValueBox.getPosition();
            var posE = new eDwTypes_1.HC.Point2(pos1.x + size1.x, pos1.y + size1.y);
            var min = new eDwTypes_1.HC.Point2(Math.min(posS.x, posE.x), Math.min(posS.y, posE.y));
            var max = new eDwTypes_1.HC.Point2(Math.max(posS.x, posE.x), Math.max(posS.y, posE.y));
            return {Min: min, Max: max}
        };
        return MeasureLabelItem
    }();
    var MeasureBaseLine = function () {
        function MeasureBaseLine(iViewer, iPntWCHC0, iPntWCHC1, iLineColor) {
            this.mViewer = iViewer;
            this.mColor = iLineColor || cGreyColor;
            this.setWCPts(iPntWCHC0, iPntWCHC1)
        }

        MeasureBaseLine.prototype.draw = function () {
            if (!this.isValid()) return;
            if (this.mLine) this.updateLinePts(); else this.createHCLine();
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            renderer.drawLine(this.mLine)
        };
        MeasureBaseLine.prototype.getLineColorHC = function () {
            return this.mColor
        };
        MeasureBaseLine.prototype.getMiddleWCPtHC = function () {
            var middle = eDwTypes_1.HC.Point3.scale(eDwTypes_1.HC.Point3.add(this.mWCEndPtHC0, this.mWCEndPntHC1), .5);
            return middle
        };
        MeasureBaseLine.prototype.setLineColor = function (iColor) {
            this.mColor = iColor;
            if (this.mLine) this.setColorOnHCLine(iColor); else this.createHCLine()
        };
        MeasureBaseLine.prototype.isValid = function () {
            return this.mWCEndPtHC0 && this.mWCEndPntHC1 && eDwGeomUtils.isValidHCPoint(this.mWCEndPtHC0) && eDwGeomUtils.isValidHCPoint(this.mWCEndPntHC1)
        };
        MeasureBaseLine.prototype.createHCLine = function () {
            this.mLine = new eDwTypes_1.HC.Markup.Shape.Line;
            this.setColorOnHCLine(this.mColor);
            this.updateLinePts();
            return this
        };
        MeasureBaseLine.prototype.copyFrom = function (iSrcLine) {
            if (iSrcLine.mLine) {
                this.mLine.setStrokeWidth(iSrcLine.mLine.getStrokeWidth());
                this.mLine.setEndcapType(iSrcLine.mLine.getEndEndcapType());
                this.mLine.setStartEndcapSize(iSrcLine.mLine.getStartEndcapSize());
                this.mLine.setEndEndcapSize(iSrcLine.mLine.getEndEndcapSize());
                this.mLine.setStartEndcapColor(iSrcLine.mLine.getStartEndcapColor());
                this.mLine.setEndEndcapColor(iSrcLine.mLine.getEndEndcapColor())
            }
            this.setWCPts(iSrcLine.mWCEndPtHC0, iSrcLine.mWCEndPntHC1);
            this.mColor = iSrcLine.mColor
        };
        MeasureBaseLine.prototype.setWCPts = function (iWCStartPntHC, iWCEndPntHC) {
            if (!iWCStartPntHC || !iWCEndPntHC || !eDwGeomUtils.isValidHCPoint(iWCStartPntHC) || !eDwGeomUtils.isValidHCPoint(iWCEndPntHC)) {
                console.warn("One or more measure points are invalid");
                return
            }
            this.mWCEndPtHC0 = iWCStartPntHC.copy();
            this.mWCEndPntHC1 = iWCEndPntHC.copy()
        };
        MeasureBaseLine.prototype.updateLinePts = function () {
            var viewHC = this.mViewer.getHCView();
            this.mLine.setP1(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mWCEndPtHC0)));
            this.mLine.setP2(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mWCEndPntHC1)))
        };
        MeasureBaseLine.prototype.setColorOnHCLine = function (iColor) {
            this.mLine.setStrokeColor(iColor);
            this.mLine.setEndEndcapColor(iColor);
            this.mLine.setStartEndcapColor(iColor)
        };
        return MeasureBaseLine
    }();
    var MeasureLine = function (_super) {
        __extends(MeasureLine, _super);

        function MeasureLine(iViewer, iPntHC0, iPntHC1, iLineColor) {
            var _this = _super.call(this, iViewer, iPntHC0, iPntHC1, iLineColor) || this;
            if (!_this.isValid()) _this.createHCLine();
            return _this
        }

        MeasureLine.prototype.copy = function () {
            var copy = new MeasureLine(this.mViewer, this.mWCEndPtHC0, this.mWCEndPntHC1, this.getLineColorHC());
            copy.copyFrom(this);
            return copy
        };
        MeasureLine.prototype.createHCLine = function () {
            _super.prototype.createHCLine.call(this).setWidthAndEndCapsOnHCLine();
            return this
        };
        MeasureLine.prototype.setWidthAndEndCapsOnHCLine = function () {
            this.mLine.setStrokeWidth(3);
            this.mLine.setEndcapType(eDwTypes_1.HC.Markup.Shape.EndcapType.None)
        };
        return MeasureLine
    }(MeasureBaseLine);
    var MeasureLeaderLine = function (_super) {
        __extends(MeasureLeaderLine, _super);

        function MeasureLeaderLine(iViewer, iPntHC0, iPntHC1, iLineColor) {
            var _this = _super.call(this, iViewer, iPntHC0, iPntHC1, iLineColor) || this;
            if (!_this.isValid()) _this.createHCLine();
            return _this
        }

        MeasureLeaderLine.prototype.copy = function () {
            var copy = new MeasureLeaderLine(this.mViewer, this.mWCEndPtHC0, this.mWCEndPntHC1, this.getLineColorHC());
            copy.copyFrom(this);
            return copy
        };
        MeasureLeaderLine.prototype.getLeaderStartPos = function () {
            return l_getPosForPnt(this.mViewer, this.mWCEndPtHC0)
        };
        MeasureLeaderLine.prototype.getLeaderEndPos = function () {
            return l_getPosForPnt(this.mViewer, this.mWCEndPntHC1)
        };
        MeasureLeaderLine.prototype.setLeaderEndPos = function (iPos) {
            this.setWCPts(this.mWCEndPtHC0, eDwGeomUtils.screenToWorld(iPos, this.mViewer.getHCView()))
        };
        MeasureLeaderLine.prototype.setLeaderEnd = function (iPoint) {
            this.mWCEndPntHC1 = iPoint.copy()
        };
        MeasureLeaderLine.prototype.getLeaderStart = function () {
            return this.mWCEndPtHC0
        };
        return MeasureLeaderLine
    }(MeasureBaseLine);
    var MeasureDistLine = function (_super) {
        __extends(MeasureDistLine, _super);

        function MeasureDistLine(iViewer, iPntHC0, iSelObj0, iPntHC1, iSelObj1, iLineColor, iUseArrowEnds) {
            if (iUseArrowEnds === void 0) {
                iUseArrowEnds = true
            }
            var _this = _super.call(this, iViewer, iPntHC0, iPntHC1, iLineColor) || this;
            _this.mStartSelObj = iSelObj0;
            _this.mEndSelObj = iSelObj1;
            _this.mDistColor = iLineColor || cLineDistanceColor;
            _this.mUseArrowEnds = iUseArrowEnds;
            if (!_this.isValid()) _this.createHCLine();
            return _this
        }

        MeasureDistLine.prototype.copy = function () {
            var copy = new MeasureDistLine(this.mViewer, this.mWCEndPtHC0, this.mStartSelObj, this.mWCEndPntHC1, this.mEndSelObj, this.getLineColorHC(), this.mUseArrowEnds);
            copy.copyFrom(this);
            return copy
        };
        MeasureDistLine.prototype.setSelObjEndPts = function (iWCStartPntHC, iStartSelObj, iWCEndPntHC, iEndSelObj) {
            _super.prototype.setWCPts.call(this, iWCStartPntHC, iWCEndPntHC);
            this.mStartSelObj = iStartSelObj;
            this.mEndSelObj = iEndSelObj
        };
        MeasureDistLine.prototype.getDistance = function () {
            var localPt0HC = this.mStartSelObj.getAsLocalPoint(this.mWCEndPtHC0);
            var localPt1HC = this.mEndSelObj.getAsLocalPoint(this.mWCEndPntHC1);
            return eDwTypes_1.HC.Point3.subtract(localPt0HC, localPt1HC).length()
        };
        MeasureDistLine.prototype.createHCLine = function () {
            _super.prototype.createHCLine.call(this).setHCLineAttributes();
            return this
        };
        MeasureDistLine.prototype.setHCLineAttributes = function () {
            this.mLine.setStrokeWidth(3);
            if (this.mUseArrowEnds) {
                this.mLine.setEndcapType(eDwTypes_1.HC.Markup.Shape.EndcapType.Arrowhead)
            }
            this.mLine.setStartEndcapSize(5);
            this.mLine.setEndEndcapSize(5);
            this.mLine.setStartEndcapColor(this.mDistColor);
            this.mLine.setEndEndcapColor(this.mDistColor);
            this.mLine.setStrokeColor(this.mDistColor)
        };
        return MeasureDistLine
    }(MeasureBaseLine);
    var MeasureLabel = function () {
        function MeasureLabel(iViewer, iPnt3DHC, iDrawEnabled) {
            if (iDrawEnabled === void 0) {
                iDrawEnabled = true
            }
            this.mViewer = iViewer;
            this.mItems = [];
            this.mDrawEnabled = iDrawEnabled;
            this.createLeaderIfPointValid(iPnt3DHC, iPnt3DHC)
        }

        MeasureLabel.prototype.reset = function () {
            this.mItems = []
        };
        MeasureLabel.prototype.drawLabel = function () {
            if (!this.isValid() || !this.mDrawEnabled) return;
            this.setLabelPosition(this.mLeader.getLeaderEndPos());
            var n = this.mItems.length;
            if (0 === n) return;
            this.mLeader.draw();
            for (var i = 0; i < n; ++i) {
                this.mItems[i].drawItem()
            }
        };
        MeasureLabel.prototype.addItem = function (iResult, iColor) {
            if (iResult) {
                var item = new MeasureLabelItem(this.mViewer, iResult, iColor);
                this.mItems.push(item)
            }
            return this
        };
        MeasureLabel.prototype.setStringContent = function () {
            var n = this.mItems.length;
            for (var i = 0; i < n; ++i) {
                this.mItems[i].setStringContent()
            }
        };
        MeasureLabel.prototype.setLeader = function (iEnd0) {
            var end1 = eDwTypes_1.HC.Point3.add(iEnd0, new eDwTypes_1.HC.Point3(1, 1, 1));
            this.createLeaderIfPointValid(iEnd0, end1)
        };
        MeasureLabel.prototype.getLeaderStartPos = function () {
            return this.mLeader ? this.mLeader.getLeaderStartPos() : null
        };
        MeasureLabel.prototype.getLeaderEndPos = function () {
            return this.mLeader ? this.mLeader.getLeaderEndPos() : null
        };
        MeasureLabel.prototype.setLeaderEndPos = function (pos) {
            if (!this.isValid()) return;
            this.setLabelPosition(pos.copy());
            this.adjustToFitOnScreen();
            var labelBox = this.getLabelBox();
            if (!labelBox) return;
            var leaderPos = new eDwTypes_1.HC.Point2(labelBox.Min.x, labelBox.Min.y);
            this.mLeader.setLeaderEndPos(leaderPos)
        };
        MeasureLabel.prototype.setDefaultEndPos = function () {
            if (!this.isValid()) return false;
            var start = this.getLeaderStartPos();
            var end = eDwTypes_1.HC.Point2.add(start, new eDwTypes_1.HC.Point2(30, 30));
            this.setLeaderEndPos(end);
            return true
        };
        MeasureLabel.prototype.getText = function () {
            this.setStringContent();
            var n = this.mItems.length;
            var str = n ? this.mItems[0].getText() : "";
            for (var i = 1; i < n; ++i) {
                str = str + "\n" + this.mItems[i].getText()
            }
            return str
        };
        MeasureLabel.prototype.getLabelBox = function () {
            var n = this.mItems.length;
            if (0 === n) return null;
            var boxes = [];
            for (var i = 0; i < n; ++i) {
                var box_1 = this.mItems[i].getBoundingBox();
                if (box_1) boxes.push(box_1)
            }
            n = boxes.length;
            if (!n) return null;
            var box = boxes[0];
            var xMin = box.Min.x, xMax = box.Max.x;
            var yMin = box.Min.y, yMax = box.Max.y;
            for (var i = 1; i < n; ++i) {
                var box_2 = boxes[i];
                xMin = Math.min(box_2.Min.x, xMin);
                yMin = Math.min(box_2.Min.y, yMin);
                xMax = Math.max(box_2.Max.x, xMax);
                yMax = Math.max(box_2.Max.y, yMax)
            }
            var min = new eDwTypes_1.HC.Point2(xMin, yMin);
            var max = new eDwTypes_1.HC.Point2(xMax, yMax);
            return {Min: min, Max: max}
        };
        MeasureLabel.prototype.isValid = function () {
            return this.mLeader ? true : false
        };
        MeasureLabel.prototype.setLabelPosition = function (iPos) {
            var e_2, _a, e_3, _b;
            var nameWidth = 0, valueWidth = 0;
            try {
                for (var _c = __values(this.mItems), _d = _c.next(); !_d.done; _d = _c.next()) {
                    var item = _d.value;
                    var itemWidth = item.getWidth();
                    nameWidth = Math.max(nameWidth, itemWidth.NameWidth);
                    valueWidth = Math.max(valueWidth, itemWidth.ValueWidth)
                }
            } catch (e_2_1) {
                e_2 = {error: e_2_1}
            } finally {
                try {
                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c)
                } finally {
                    if (e_2) throw e_2.error
                }
            }
            try {
                for (var _e = __values(this.mItems), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var item = _f.value;
                    item.setPosition(iPos, nameWidth, valueWidth)
                }
            } catch (e_3_1) {
                e_3 = {error: e_3_1}
            } finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e)
                } finally {
                    if (e_3) throw e_3.error
                }
            }
        };
        MeasureLabel.prototype.adjustToFitOnScreen = function () {
            var viewHC = this.mViewer.getHCView();
            var canvasSize = viewHC.getCanvasSize();
            var bbox2D = this.getLabelBox();
            if (!bbox2D) return;
            var bboxSize = new eDwTypes_1.HC.Point2(bbox2D.Max.x - bbox2D.Min.x, bbox2D.Max.y - bbox2D.Min.y);

            function adjustPos(iDimension) {
                var adjust = canvasSize[iDimension] - bboxSize[iDimension];
                adjust = adjust < 0 ? bbox2D.Min[iDimension] : adjust;
                var newPos = bbox2D.Min.copy();
                newPos[iDimension] = adjust;
                return newPos
            }

            if (bbox2D.Max.x > canvasSize.x && bboxSize.x < canvasSize.x) {
                this.setLabelPosition(adjustPos("x"))
            }
            if (bbox2D.Max.y > canvasSize.y && bboxSize.y < canvasSize.y) {
                bbox2D = this.getLabelBox();
                if (!bbox2D) return;
                bboxSize = new eDwTypes_1.HC.Point2(bbox2D.Max.x - bbox2D.Min.x, bbox2D.Max.y - bbox2D.Min.y);
                this.setLabelPosition(adjustPos("y"))
            }
        };
        MeasureLabel.prototype.createLeaderIfPointValid = function (iPnt3D0HC, iPnt3D1HC) {
            this.mLeader = null;
            if (!eDwGeomUtils.isValidHCPoint(iPnt3D0HC) || !eDwGeomUtils.isValidHCPoint(iPnt3D1HC)) return;
            this.mLeader = new MeasureLeaderLine(this.mViewer, iPnt3D0HC, iPnt3D1HC)
        };
        Object.defineProperty(MeasureLabel.prototype, "DrawEnabled", {
            get: function () {
                return this.mDrawEnabled
            }, enumerable: false, configurable: true
        });
        return MeasureLabel
    }();
    var MeasureAuxMessage = function () {
        function MeasureAuxMessage(iViewer) {
            this.mViewer = iViewer;
            this.reset()
        }

        MeasureAuxMessage.prototype.reset = function () {
            this.mLabels = []
        };
        MeasureAuxMessage.prototype.addResult = function (iResult, iStart, iColor) {
            var label = new MeasureLabel(this.mViewer, iStart);
            label.addItem(iResult, iColor);
            this.mLabels.push(label)
        };
        MeasureAuxMessage.prototype.addIfVertex = function (iVertSelObj) {
            if (!iVertSelObj.getPointEntity()) return;
            var pntHC = iVertSelObj.getPosition();
            var label = new MeasureLabel(this.mViewer, pntHC);
            label.addItem(new MeasureResultString(cLocalizedEntity, cLocalizedVertex));
            var coordHC = iVertSelObj.getLocalPoint() || pntHC;
            label.addItem(new MeasureResultPoint3D(cLocalizedCoordinate, coordHC));
            this.mLabels.push(label)
        };
        MeasureAuxMessage.prototype.addIfCurve = function (iLineOrOtherHC, iEdgeSelObj, iLocalizeableEntityValue) {
            if (!iEdgeSelObj.getLineEntity()) return;
            var label = new MeasureLabel(this.mViewer, iEdgeSelObj.getPosition());
            label.addItem(new MeasureResultString(cLocalizedEntity, iLocalizeableEntityValue));
            label.addItem(new MeasureResultDistance(cLocalizedLength, iLineOrOtherHC.length));
            this.mLabels.push(label)
        };
        MeasureAuxMessage.prototype.addIfCircle = function (iCircleOrigHC, iEdgeSelObj) {
            if (!iEdgeSelObj.getLineEntity()) return;
            var circularArc = l_getCircularArc(iEdgeSelObj, iCircleOrigHC);
            var diameterOrRadius = circularArc.Diameter;
            var label = new MeasureLabel(this.mViewer, iEdgeSelObj.getPosition());
            label.addItem(new MeasureResultString(cLocalizedEntity, cLocalizedCircle));
            label.addItem(new MeasureResultPoint3D(cLocalizedCenter, circularArc.OriginWCHC));
            label.addItem(new MeasureResultDistance(cLocalizedDiameter, diameterOrRadius));
            label.addItem(new MeasureResultArea(cLocalizedArea, circularArc.Area));
            label.addItem(new MeasureResultDistance(cLocalizedPerimeter, circularArc.Length));
            this.mLabels.push(label)
        };
        MeasureAuxMessage.prototype.addIfPlane = function (iFaceOrigHC, iFaceSelObj) {
            if (!iFaceSelObj.getFaceEntity()) return;
            if (iFaceOrigHC instanceof eDwTypes_1.HC.SubentityProperties.PlaneElement) {
                var label = new MeasureLabel(this.mViewer, iFaceSelObj.getPosition());
                label.addItem(new MeasureResultString(cLocalizedEntity, cLocalizedPlane));
                this.mLabels.push(label)
            }
        };
        MeasureAuxMessage.prototype.addIfCylinder = function (iCylinderOrigHC, iFaceSelObj) {
            if (!iFaceSelObj.getFaceEntity()) return;
            if (iCylinderOrigHC instanceof eDwTypes_1.HC.SubentityProperties.CylinderElement) {
                var label = new MeasureLabel(this.mViewer, iFaceSelObj.getPosition());
                label.addItem(new MeasureResultString(cLocalizedEntity, cLocalizedCylinder));
                label.addItem(new MeasureResultDistance(cLocalizedDiameter, 2 * iCylinderOrigHC.radius));
                this.mLabels.push(label)
            }
        };
        MeasureAuxMessage.prototype.getLabels = function () {
            return this.mLabels
        };
        MeasureAuxMessage.prototype.countLabels = function () {
            return this.mLabels.length
        };
        MeasureAuxMessage.prototype.getText = function () {
            var e_4, _a;
            var str = "";
            try {
                for (var _b = __values(this.mLabels), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var label = _c.value;
                    if (str.length) str += "\n\n";
                    str += label.getText()
                }
            } catch (e_4_1) {
                e_4 = {error: e_4_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_4) throw e_4.error
                }
            }
            return str
        };
        return MeasureAuxMessage
    }();
    var MeasureAuxDelta = function () {
        function MeasureAuxDelta(iViewer, iLineColor, iLineNormal) {
            if (iLineNormal === void 0) {
                iLineNormal = false
            }
            this.mViewer = iViewer;
            this.mLineColor = iLineColor;
            this.mLineNormal = iLineNormal;
            this.reset();
            this.mEndGlyph0 = new eDwTypes_1.HC.Markup.Shape.Circle;
            this.mEndGlyph1 = new eDwTypes_1.HC.Markup.Shape.Circle;
            this.setPointColor(cAuxDeltaPointFillColor);
            var widthEdge = 3;
            var pointSize = 7;
            this.mEndGlyph0.setStrokeColor(cAuxDeltaPointStrokeColor);
            this.mEndGlyph0.setStrokeWidth(widthEdge);
            this.mEndGlyph0.setRadius(pointSize);
            this.mEndGlyph1.setStrokeColor(cAuxDeltaPointStrokeColor);
            this.mEndGlyph1.setStrokeWidth(widthEdge);
            this.mEndGlyph1.setRadius(pointSize)
        }

        MeasureAuxDelta.prototype.reset = function () {
            this.mWCPntsHC = [];
            this.mModelSpaceMinDist = this.mModelSpaceMaxDist = 0;
            delete this.mLineDist;
            delete this.mDelta;
            this.mSomeCoordsArcCenters = false
        };
        MeasureAuxDelta.prototype.copy = function () {
            var auxDeltaCopy = new MeasureAuxDelta(this.mViewer);
            auxDeltaCopy.mLineColor = this.mLineColor;
            auxDeltaCopy.mLineNormal = this.mLineNormal;
            auxDeltaCopy.mSomeCoordsArcCenters = this.mSomeCoordsArcCenters;
            auxDeltaCopy.mEndGlyph0.setFillColor(this.mEndGlyph0.getFillColor());
            auxDeltaCopy.mEndGlyph1.setFillColor(this.mEndGlyph1.getFillColor());
            auxDeltaCopy.mWCPntsHC = utils.deepCopyArray(this.mWCPntsHC);
            auxDeltaCopy.mModelSpaceMinDist = this.mModelSpaceMinDist;
            auxDeltaCopy.mModelSpaceMaxDist = this.mModelSpaceMaxDist;
            auxDeltaCopy.mLineDist = this.mLineDist ? this.mLineDist.copy() : undefined;
            auxDeltaCopy.mDelta = this.mDelta ? this.mDelta.copy() : undefined;
            return auxDeltaCopy
        };
        MeasureAuxDelta.prototype.getWCDeltaEnds = function () {
            return this.mWCPntsHC
        };
        MeasureAuxDelta.prototype.setWCDeltaEnds = function (iWCPntsHC, iSelObjs) {
            this.mModelSpaceMinDist = this.mModelSpaceMaxDist = 0;
            this.mWCPntsHC = utils.deepCopyArray(iWCPntsHC);
            if (!iWCPntsHC[0].equalsWithTolerance(iWCPntsHC[1], cLengthTol)) {
                var startWCPtHC = iWCPntsHC[0].copy();
                var endWCPtHC = iWCPntsHC[1].copy();
                if (this.mDelta) {
                    this.mDelta.set(startWCPtHC, endWCPtHC, iSelObjs[0], iSelObjs[1])
                } else {
                    this.mDelta = MeasureDelta.create(this.mViewer, startWCPtHC, endWCPtHC, iSelObjs[0], iSelObjs[1])
                }
                if (this.mLineDist) {
                    this.mLineDist.setSelObjEndPts(startWCPtHC, iSelObjs[0], endWCPtHC, iSelObjs[1])
                } else {
                    this.mLineDist = new MeasureDistLine(this.mViewer, startWCPtHC, iSelObjs[0], endWCPtHC, iSelObjs[1], this.mLineColor)
                }
            }
        };
        MeasureAuxDelta.prototype.draw = function (iImmediateDrawMode) {
            if (this.hasDistance() && this.mLineDist && this.mWCPntsHC.length > 1) {
                this.mLineDist.draw();
                if (!this.mLineNormal && eDwMeasureEntities.ShowDelta && this.mDelta) {
                    this.mDelta.draw(iImmediateDrawMode)
                }
                var viewHC = this.mViewer.getHCView();
                this.mEndGlyph0.setCenter(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mWCPntsHC[0])));
                this.mEndGlyph1.setCenter(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mWCPntsHC[1])));
                if (!iImmediateDrawMode) {
                    var renderer = this.mViewer.getHCMarkupManager().getRenderer();
                    renderer.drawCircle(this.mEndGlyph0);
                    renderer.drawCircle(this.mEndGlyph1)
                }
            }
        };
        MeasureAuxDelta.prototype.getLabelData = function () {
            var _this = this;
            var labelData = {};
            labelData[cDistance] = new MeasureResultDistance((function () {
                var contentKey = _this.mLineNormal ? "Strings.NormalDist" : _this.mSomeCoordsArcCenters ? "Strings.CenterDist" : "Strings.Distance";
                return eDwUILocalize_1.eDwUILocalize.getString(contentKey)
            }), this.getDistance());
            var minResultDist = new MeasureResultDistance(cLocalizedMinDistance, this.mModelSpaceMinDist);
            if (parseFloat(minResultDist.Value) > 0) {
                labelData[cMinDistance] = minResultDist
            }
            var maxResultDist = new MeasureResultDistance(cLocalizedMaxDistance, this.mModelSpaceMaxDist);
            if (parseFloat(maxResultDist.Value) > 0) {
                labelData[cMaxDistance] = maxResultDist
            }
            if (!this.mLineNormal && eDwMeasureEntities.ShowDelta && this.mDelta) {
                $.extend(labelData, this.mDelta.getLabelData())
            }
            return labelData
        };
        MeasureAuxDelta.prototype.getLabels = function () {
            var labels = [];
            if (this.getDistance() < cLengthTol) return labels;
            var labelData = this.getLabelData();
            if (!this.mLineNormal && eDwMeasureEntities.ShowDelta && this.mDelta) {
                Array.prototype.push.apply(labels, this.mDelta.getLabels())
            }
            if (this.mLineDist && this.mLineDist.isValid()) {
                var labelDist = new MeasureLabel(this.mViewer, this.mLineDist.getMiddleWCPtHC());
                if (labelDist.isValid()) {
                    labels.push(labelDist.addItem(labelData[cDistance]))
                }
            }
            return labels
        };
        MeasureAuxDelta.prototype.getText = function () {
            if (!this.mLineNormal && eDwMeasureEntities.ShowDelta && this.mDelta) {
                return this.mDelta.getText()
            }
            return ""
        };
        MeasureAuxDelta.prototype.getDelta = function () {
            return this.mWCPntsHC.length > 1 && this.mLineDist ? eDwTypes_1.HC.Point3.subtract(this.mWCPntsHC[0], this.mWCPntsHC[1]) : eDwTypes_1.HC.Point3.zero()
        };
        MeasureAuxDelta.prototype.getDistance = function () {
            return this.mLineDist ? this.mLineDist.getDistance() : 0
        };
        MeasureAuxDelta.prototype.setDistLineColor = function (iColor) {
            this.mLineColor = iColor
        };
        MeasureAuxDelta.prototype.setPointColor = function (iColor) {
            this.mEndGlyph0.setFillColor(iColor);
            this.mEndGlyph1.setFillColor(iColor)
        };
        MeasureAuxDelta.prototype.setMinDist = function (iDist) {
            this.mModelSpaceMinDist = iDist
        };
        MeasureAuxDelta.prototype.setMaxDist = function (iDist) {
            this.mModelSpaceMaxDist = iDist
        };
        Object.defineProperty(MeasureAuxDelta.prototype, "LineNormal", {
            get: function () {
                return this.mLineNormal
            }, set: function (iEnable) {
                this.mLineNormal = iEnable
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(MeasureAuxDelta.prototype, "SomeCoordsArcCenters", {
            get: function () {
                return this.mSomeCoordsArcCenters
            }, set: function (iEnable) {
                this.mSomeCoordsArcCenters = iEnable
            }, enumerable: false, configurable: true
        });
        MeasureAuxDelta.prototype.hasDistance = function () {
            var deltaDist = this.getDistance();
            return deltaDist > cLengthTol ? true : false
        };
        return MeasureAuxDelta
    }();
    var MeasureDelta = function () {
        function MeasureDelta(iViewer) {
            this.mViewer = iViewer;
            this.reset()
        }

        MeasureDelta.prototype.set = function (iStartWCPtHC, iEndWCPtHC, iSelObj0, iSelObj1) {
            var deltas = l_getDeltas(iStartWCPtHC, iEndWCPtHC, iSelObj0, iSelObj1);
            var deltaWCPt0HC = deltas[0];
            var deltaWCPt1HC = deltas[1];
            this.mLineDeltaMap[cDeltaX].setSelObjEndPts(iStartWCPtHC, iSelObj0, deltaWCPt0HC, iSelObj1);
            this.mLineDeltaMap[cDeltaY].setSelObjEndPts(deltaWCPt0HC, iSelObj0, deltaWCPt1HC, iSelObj1);
            this.mLineDeltaMap[cDeltaZ].setSelObjEndPts(deltaWCPt1HC, iSelObj1, iEndWCPtHC, iSelObj1)
        };
        MeasureDelta.prototype.getLabels = function () {
            var e_5, _a;
            var labelData = this.getLabelData();
            var numNonZeroLabelData = 0;
            var nonZeroLabelData = {};
            try {
                for (var _b = __values([cDeltaX, cDeltaY, cDeltaZ]), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var deltaKey = _c.value;
                    var dist = this.mLineDeltaMap[deltaKey].getDistance();
                    if (dist > cLengthTol) {
                        nonZeroLabelData[deltaKey] = labelData[deltaKey];
                        numNonZeroLabelData++
                    }
                }
            } catch (e_5_1) {
                e_5 = {error: e_5_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_5) throw e_5.error
                }
            }
            if (numNonZeroLabelData === 1) nonZeroLabelData = {};
            var labels = [];
            for (var key in nonZeroLabelData) {
                var lineDelta = this.mLineDeltaMap[key];
                var label = new MeasureLabel(this.mViewer, lineDelta.getMiddleWCPtHC());
                label.addItem(labelData[key], lineDelta.getLineColorHC());
                if (label.isValid()) labels.push(label)
            }
            return labels
        };
        MeasureDelta.prototype.draw = function (iImmediateDrawMode) {
            if (this.isDeltaEnabled()) {
                for (var key in this.mLineDeltaMap) {
                    var deltaLine = this.mLineDeltaMap[key];
                    if (deltaLine.getDistance() > cLengthTol) deltaLine.draw()
                }
            }
        };
        MeasureDelta.prototype.reset = function () {
            this.mLineDeltaMap = {}
        };
        MeasureDelta.prototype.copy = function () {
            var auxDeltaCopy = new MeasureDelta(this.mViewer);
            for (var key in this.mLineDeltaMap) {
                auxDeltaCopy.mLineDeltaMap[key] = this.mLineDeltaMap[key].copy()
            }
            return auxDeltaCopy
        };
        MeasureDelta.prototype.getLabelData = function () {
            var e_6, _a;
            var labelData = {};
            if (this.isDeltaEnabled()) {
                var _loop_1 = function (delta) {
                    labelData[delta] = new MeasureResultDistance((function () {
                        return eDwUILocalize_1.eDwUILocalize.getString("Strings.Delta." + delta)
                    }), this_1.mLineDeltaMap[delta].getDistance())
                };
                var this_1 = this;
                try {
                    for (var _b = __values([cDeltaX, cDeltaY, cDeltaZ]), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var delta = _c.value;
                        _loop_1(delta)
                    }
                } catch (e_6_1) {
                    e_6 = {error: e_6_1}
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                    } finally {
                        if (e_6) throw e_6.error
                    }
                }
            }
            return labelData
        };
        MeasureDelta.prototype.getText = function () {
            if (this.isDeltaEnabled()) {
                var data = this.getLabelData();
                return eDwUILocalize_1.eDwUILocalize.getString("Strings.Delta.Label") + (" : " + data[cDeltaX].Value + ", " + data[cDeltaY].Value + ", ") + ("" + data[cDeltaZ].Value)
            }
            return ""
        };
        MeasureDelta.create = function (iViewer, iStartWCPtHC, iEndWCPtHC, iSelObj0, iSelObj1) {
            var measureDelta = new MeasureDelta(iViewer);
            var deltas = l_getDeltas(iStartWCPtHC, iEndWCPtHC, iSelObj0, iSelObj1);
            var deltaWCPt0HC = deltas[0];
            var deltaWCPt1HC = deltas[1];
            measureDelta.mLineDeltaMap[cDeltaX] = new MeasureDistLine(iViewer, iStartWCPtHC, iSelObj0, deltaWCPt0HC, iSelObj1, eDwTypes_1.HC.Color.red(), false);
            measureDelta.mLineDeltaMap[cDeltaY] = new MeasureDistLine(iViewer, deltaWCPt0HC, iSelObj0, deltaWCPt1HC, iSelObj1, new eDwTypes_1.HC.Color(0, 128, 0), false);
            measureDelta.mLineDeltaMap[cDeltaZ] = new MeasureDistLine(iViewer, deltaWCPt1HC, iSelObj1, iEndWCPtHC, iSelObj1, eDwTypes_1.HC.Color.blue(), false);
            return measureDelta
        };
        MeasureDelta.prototype.isDeltaEnabled = function () {
            return eDwMeasureEntities.ShowDelta && !!this.mLineDeltaMap[cDeltaX]
        };
        return MeasureDelta
    }();
    var MeasureAuxDistance = function () {
        function MeasureAuxDistance(iViewer) {
            this.mViewer = iViewer;
            this.mDistLine = new MeasureAuxDelta(iViewer);
            this.mNDistLine = new MeasureAuxDelta(iViewer, cAuxDistanceNormalDistanceLineColor, true);
            this.mNDistLine.setPointColor(cAuxDistanceNormalDistancePointColor);
            this.mNormalDistExtLines = []
        }

        MeasureAuxDistance.prototype.reset = function () {
            this.mDistLine.reset();
            this.mNDistLine.reset();
            this.mNDistLine.setDistLineColor(cAuxDistanceNormalDistanceLineColor);
            this.mNDistLine.LineNormal = true;
            this.mNDistLine.setPointColor(cAuxDistanceNormalDistancePointColor);
            this.mNormalDistExtLines = []
        };
        MeasureAuxDistance.prototype.draw = function (iImmediateDrawMode) {
            var e_7, _a;
            if (!this.getLabels().length) return;
            this.mDistLine.draw(iImmediateDrawMode);
            this.mNDistLine.draw(iImmediateDrawMode);
            try {
                for (var _b = __values(this.mNormalDistExtLines), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var normalExtLine = _c.value;
                    normalExtLine.draw()
                }
            } catch (e_7_1) {
                e_7 = {error: e_7_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_7) throw e_7.error
                }
            }
        };
        MeasureAuxDistance.prototype.setByPointPoint = function (iWCPntHC0, iSelObj0, iWCPntHC1, iSelObj1, isSomeCoordsArcCenters) {
            if (isSomeCoordsArcCenters === void 0) {
                isSomeCoordsArcCenters = false
            }
            this.reset();
            this.mDistLine.setWCDeltaEnds([iWCPntHC0, iWCPntHC1], [iSelObj0, iSelObj1]);
            this.mDistLine.SomeCoordsArcCenters = isSomeCoordsArcCenters;
            this.mNDistLine.setWCDeltaEnds([iWCPntHC0, iWCPntHC1], [iSelObj0, iSelObj1]);
            this.setNormalDistExtPoints([iWCPntHC0, iWCPntHC0, iWCPntHC1, iWCPntHC1]);
            this.avoidDuplication()
        };
        MeasureAuxDistance.prototype.setByPointLine = function (iPntWCHC, iSelObj0, iEdgeHC, iSelObj1, isSomeCoordsArcCenters) {
            if (isSomeCoordsArcCenters === void 0) {
                isSomeCoordsArcCenters = false
            }
            var pickPntWCHC = iSelObj1.getPosition();
            var endPntsWCHC = l_getLineEndPts(iSelObj1);
            var vecWCHC = eDwTypes_1.HC.Point3.subtract(endPntsWCHC.P0HC, endPntsWCHC.P1HC);
            if (vecWCHC.length() < 1e-6) return;
            vecWCHC.normalize();
            var k = eDwTypes_1.HC.Point3.dot(eDwTypes_1.HC.Point3.subtract(iPntWCHC, pickPntWCHC), vecWCHC);
            var basePntWCHC = eDwTypes_1.HC.Point3.add(pickPntWCHC, eDwTypes_1.HC.Point3.scale(vecWCHC, k));
            var vecWCHC0 = eDwTypes_1.HC.Point3.subtract(endPntsWCHC.P0HC, basePntWCHC);
            var vecWCHC1 = eDwTypes_1.HC.Point3.subtract(endPntsWCHC.P1HC, basePntWCHC);
            if (eDwTypes_1.HC.Point3.dot(vecWCHC0, vecWCHC1) < 0) {
                this.setByPointPoint(iPntWCHC, iSelObj0, basePntWCHC, iSelObj1, isSomeCoordsArcCenters)
            } else {
                this.reset();
                var pntWCHC = vecWCHC0.length() < vecWCHC1.length() ? endPntsWCHC.P0HC.copy() : endPntsWCHC.P1HC.copy();
                this.mDistLine.setWCDeltaEnds([iPntWCHC, pntWCHC], [iSelObj0, iSelObj1]);
                this.mDistLine.SomeCoordsArcCenters = isSomeCoordsArcCenters;
                this.mNDistLine.setWCDeltaEnds([iPntWCHC, basePntWCHC], [iSelObj0, iSelObj1]);
                this.setNormalDistExtPoints([iPntWCHC, iPntWCHC, pntWCHC, basePntWCHC]);
                this.avoidDuplication()
            }
        };
        MeasureAuxDistance.prototype.setByPointPlane = function (iPntWCHC, iSelObj0, iFaceHC, iSelObj1, iMinDistInfo, isSomeCoordsArcCenters) {
            if (isSomeCoordsArcCenters === void 0) {
                isSomeCoordsArcCenters = false
            }
            if (!iMinDistInfo) return false;
            this.reset();
            var pickWCPntHC = iSelObj1.getPosition();
            var normWCHC = iFaceHC.normal;
            normWCHC.normalize();
            var vecWCHC = eDwTypes_1.HC.Point3.subtract(pickWCPntHC, iPntWCHC);
            var k = eDwTypes_1.HC.Point3.dot(vecWCHC, normWCHC);
            var baseWCPntHC = eDwTypes_1.HC.Point3.add(iPntWCHC, eDwTypes_1.HC.Point3.scale(normWCHC, k));
            this.mDistLine.setWCDeltaEnds([iMinDistInfo.pos1, iMinDistInfo.pos2], [iSelObj0, iSelObj1]);
            this.mDistLine.SomeCoordsArcCenters = isSomeCoordsArcCenters;
            this.mNDistLine.setWCDeltaEnds([iPntWCHC, baseWCPntHC], [iSelObj0, iSelObj1]);
            this.setNormalDistExtPoints([iPntWCHC, iPntWCHC, pickWCPntHC, baseWCPntHC]);
            this.avoidDuplication();
            return true
        };
        MeasureAuxDistance.prototype.setByCircleCircle = function (iCircleHC0, iSelObj0, iCircleHC1, iSelObj1) {
            this.setByPointPoint(iCircleHC0.origin, iSelObj0, iCircleHC1.origin, iSelObj1, true);
            this.setMinMaxForCircles(iCircleHC0, iCircleHC1)
        };
        MeasureAuxDistance.prototype.setByCircleLine = function (iCircleHC, iSelObj0, iLineHC, iSelObj1) {
            this.setByPointLine(iCircleHC.origin, iSelObj0, iLineHC, iSelObj1, true)
        };
        MeasureAuxDistance.prototype.setByCirclePlane = function (iCircleHC, iSelObj0, iPlaneHC, iSelObj1, iMinDistInfo) {
            return this.setByPointPlane(iCircleHC.origin, iSelObj0, iPlaneHC, iSelObj1, iMinDistInfo, true)
        };
        MeasureAuxDistance.prototype.setByCirclePoint = function (iCircleHC, iSelObj0, iPointHC, iSelObj1) {
            this.setByPointPoint(iCircleHC.origin, iSelObj0, iPointHC, iSelObj1, true)
        };
        MeasureAuxDistance.prototype.setByPlanePlane = function (iFaceHC0, iFaceHC1, iSelObj0, iSelObj1, iMinDistInfo) {
            if (!iMinDistInfo) return false;
            this.reset();
            var pickWCPntHC0 = iSelObj0.getPosition().copy();
            var normWCHC0 = iFaceHC0.normal;
            normWCHC0.normalize();
            var pickWCPntHC1 = iSelObj1.getPosition().copy();
            var normWCHC1 = iFaceHC1.normal;
            normWCHC1.normalize();
            var angle = iSelObj0.findAngle(iSelObj1);
            if (0 !== angle && 180 !== angle) {
                var vecWCHC = eDwTypes_1.HC.Point3.cross(normWCHC0, normWCHC1);
                var wVecWCHC = eDwTypes_1.HC.Point3.cross(vecWCHC, normWCHC0);
                var k0 = (eDwTypes_1.HC.Point3.dot(pickWCPntHC1, normWCHC1) - eDwTypes_1.HC.Point3.dot(pickWCPntHC0, normWCHC1)) / eDwTypes_1.HC.Point3.dot(wVecWCHC, normWCHC1);
                var origWCPntHC0 = eDwTypes_1.HC.Point3.add(pickWCPntHC0, wVecWCHC.scale(k0));
                var wVecHC1 = eDwTypes_1.HC.Point3.cross(vecWCHC, normWCHC1);
                var k1 = (eDwTypes_1.HC.Point3.dot(pickWCPntHC0, normWCHC0) - eDwTypes_1.HC.Point3.dot(pickWCPntHC1, normWCHC0)) / eDwTypes_1.HC.Point3.dot(wVecHC1, normWCHC0);
                var origWCPntHC1 = eDwTypes_1.HC.Point3.add(pickWCPntHC1, wVecHC1.scale(k1));
                this.mDistLine.setWCDeltaEnds([iMinDistInfo.pos1, iMinDistInfo.pos2], [iSelObj0, iSelObj1]);
                this.mNDistLine.setWCDeltaEnds([origWCPntHC0, origWCPntHC0], [iSelObj0, iSelObj1]);
                this.setNormalDistExtPoints([origWCPntHC0, origWCPntHC0, origWCPntHC1, origWCPntHC1]);
                this.avoidDuplication()
            } else {
                var distWCPntHC1 = eDwTypes_1.HC.Point3.zero();
                if (0 !== eDwTypes_1.HC.Point3.dot(normWCHC0, normWCHC1)) {
                    var k = (eDwTypes_1.HC.Point3.dot(pickWCPntHC1, normWCHC1) - eDwTypes_1.HC.Point3.dot(pickWCPntHC0, normWCHC1)) / eDwTypes_1.HC.Point3.dot(normWCHC0, normWCHC1);
                    distWCPntHC1 = eDwTypes_1.HC.Point3.add(pickWCPntHC0, eDwTypes_1.HC.Point3.scale(normWCHC0, k))
                }
                this.mDistLine.setWCDeltaEnds([iMinDistInfo.pos1, iMinDistInfo.pos2], [iSelObj0, iSelObj1]);
                var distWCPntHC0 = pickWCPntHC0.copy();
                this.mNDistLine.setWCDeltaEnds([distWCPntHC0, distWCPntHC1], [iSelObj0, iSelObj1]);
                this.setNormalDistExtPoints([distWCPntHC0, pickWCPntHC0, distWCPntHC1, pickWCPntHC1]);
                this.avoidDuplication()
            }
            return true
        };
        MeasureAuxDistance.prototype.setByLinePlane = function (iEdgeHC, iFaceHC, iSelEdgeObj, iSelFaceObj) {
            return __awaiter(this, void 0, void 0, (function () {
                var pickPntWCHC0, pickPntWCHC1, vecNormWCHC, minDistInfo, distLinePtsWCHC, distLineSelObjs,
                    normDistLinePtsWCHC, normDistLineSelObjs, extendedLinePtsWCHC, angle, plnWCHC, pntOnPlnWCHC,
                    pickVecWCHC, k, scalePickPntWCHC;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.reset();
                            pickPntWCHC0 = iSelEdgeObj.getPosition();
                            pickPntWCHC1 = iSelFaceObj.getPosition();
                            vecNormWCHC = iFaceHC.normal;
                            vecNormWCHC.normalize();
                            return [4, eDwSelObj.getMinDistInfo([iEdgeHC, iFaceHC], [iSelEdgeObj, iSelFaceObj], this.mViewer.getModel())];
                        case 1:
                            minDistInfo = _a.sent();
                            distLinePtsWCHC = minDistInfo ? [minDistInfo.pos1, minDistInfo.pos2] : [pickPntWCHC0, pickPntWCHC0];
                            distLineSelObjs = [iSelEdgeObj, iSelFaceObj];
                            normDistLinePtsWCHC = [];
                            normDistLineSelObjs = [iSelEdgeObj, iSelFaceObj];
                            extendedLinePtsWCHC = [];
                            angle = iSelEdgeObj.findAngle(iSelFaceObj);
                            if (90 === angle || 270 === angle) {
                                plnWCHC = eDwTypes_1.HC.Plane.createFromPointAndNormal(pickPntWCHC1, vecNormWCHC);
                                pntOnPlnWCHC = eDwGeomUtils.dropPointOnPlane(pickPntWCHC0, plnWCHC);
                                normDistLinePtsWCHC = [pickPntWCHC0, pickPntWCHC0];
                                if (eDwTypes_1.HC.Point3.distance(pntOnPlnWCHC, pickPntWCHC0)) {
                                    normDistLinePtsWCHC = [pntOnPlnWCHC, pickPntWCHC0]
                                }
                                extendedLinePtsWCHC = [pntOnPlnWCHC, pickPntWCHC0, pickPntWCHC1, pickPntWCHC1]
                            } else {
                                pickVecWCHC = eDwTypes_1.HC.Point3.subtract(pickPntWCHC1, pickPntWCHC0);
                                k = eDwTypes_1.HC.Point3.scale(vecNormWCHC, eDwTypes_1.HC.Point3.dot(vecNormWCHC, pickVecWCHC));
                                scalePickPntWCHC = eDwTypes_1.HC.Point3.add(pickPntWCHC0, k);
                                distLinePtsWCHC = [pickPntWCHC0, pickPntWCHC0];
                                distLineSelObjs = [iSelEdgeObj, iSelEdgeObj];
                                normDistLinePtsWCHC = [pickPntWCHC0, scalePickPntWCHC];
                                normDistLineSelObjs = [iSelEdgeObj, iSelFaceObj];
                                extendedLinePtsWCHC = [pickPntWCHC0, pickPntWCHC0, scalePickPntWCHC, pickPntWCHC1]
                            }
                            this.mDistLine.setWCDeltaEnds(distLinePtsWCHC, distLineSelObjs);
                            this.mNDistLine.setWCDeltaEnds(normDistLinePtsWCHC, normDistLineSelObjs);
                            this.setNormalDistExtPoints(extendedLinePtsWCHC);
                            this.avoidDuplication();
                            return [2]
                    }
                }))
            }))
        };
        MeasureAuxDistance.prototype.setByLineLine = function (iEdgeHC0, iEdgeHC1, iSelEdgeObjHC0, iSelEdgeObjHC1) {
            var lineWCPntsHC0 = l_getLineEndPts(iSelEdgeObjHC0);
            var lineWCPntsHC1 = l_getLineEndPts(iSelEdgeObjHC1);
            var angle = iSelEdgeObjHC0.findAngle(iSelEdgeObjHC1);
            var tmp;
            if (0 !== angle && 180 !== angle) {
                tmp = l_distanceLineLineCross(lineWCPntsHC0, lineWCPntsHC1)
            } else {
                var pntWCHC0 = iSelEdgeObjHC0.getPosition();
                var pntWCHC1 = iSelEdgeObjHC1.getPosition();
                tmp = l_distanceLineLinePara(lineWCPntsHC0, lineWCPntsHC1, pntWCHC0, pntWCHC1)
            }
            this.mDistLine.setWCDeltaEnds([tmp.PntHC2, tmp.PntHC3], [iSelEdgeObjHC0, iSelEdgeObjHC1]);
            this.mNDistLine.setWCDeltaEnds([tmp.PntHC0, tmp.PntHC1], [iSelEdgeObjHC0, iSelEdgeObjHC1]);
            this.setNormalDistExtPoints([tmp.PntHC0, tmp.PntHC2, tmp.PntHC1, tmp.PntHC3]);
            this.avoidDuplication()
        };
        MeasureAuxDistance.prototype.getLabels = function () {
            var labels = [];
            labels = labels.concat(this.mDistLine.getLabels());
            labels = labels.concat(this.mNDistLine.getLabels());
            return labels
        };
        MeasureAuxDistance.prototype.getText = function () {
            var result = [];
            var distLine = this.mNDistLine.LineNormal ? this.mDistLine : this.mNDistLine;
            var labelData = distLine.getLabelData();
            var dist = this.mDistLine.getDistance();
            var normalDist = this.mNDistLine.getDistance();
            var maxDistLabel = eDwUILocalize_1.eDwUILocalize.getString("Strings.MaxDistance"),
                minDistLabel = eDwUILocalize_1.eDwUILocalize.getString("Strings.MinDistance"),
                distLabel = eDwUILocalize_1.eDwUILocalize.getString("Strings.Distance"),
                normalDistLabel = eDwUILocalize_1.eDwUILocalize.getString("Strings.NormalDistance");
            if (this.mDistLine.getWCDeltaEnds().length && dist > normalDist) {
                result.push(distLabel + ": " + labelData[cDistance].Value)
            }
            if (this.mNDistLine.getWCDeltaEnds().length && normalDist) {
                result.push((this.mNDistLine.LineNormal ? normalDistLabel : distLabel) + ": " + labelData[cDistance].Value)
            }
            var minDistResultItem = labelData[cMinDistance];
            if (minDistResultItem) {
                result.push(minDistLabel + ": " + minDistResultItem.Value)
            }
            var maxDistResultItem = labelData[cMaxDistance];
            if (maxDistResultItem) {
                result.push(maxDistLabel + ": " + maxDistResultItem.Value)
            }
            if (eDwMeasureEntities.ShowDelta) {
                var nDeltaPt = this.mNDistLine.getDelta();
                var deltaPt = this.mNDistLine.LineNormal ? this.mDistLine.getDelta() : nDeltaPt;
                if (!deltaPt.equalsWithTolerance(eDwTypes_1.HC.Point3.zero(), cLengthTol)) {
                    result.push(distLine.getText())
                }
            }
            return result.join("\n")
        };
        MeasureAuxDistance.getAngle = function (iV0, iV1) {
            var vec0 = iV0.copy();
            var vec1 = iV1.copy();
            vec0.normalize();
            vec1.normalize();
            var dotVal = eDwTypes_1.HC.Point3.dot(vec0, vec1);
            if (0 === dotVal) return 90;
            dotVal = Math.min(dotVal, 1);
            dotVal = Math.max(dotVal, -1);
            var angle = Math.acos(dotVal);
            var angleDgree = angle * 180 / Math.PI;
            var n = eDwTypes_1.HC.Point3.cross(vec0, vec1);
            n.normalize();
            if (isNaN(n.x) || isNaN(n.y) || isNaN(n.z)) return 0;
            return angleDgree
        };
        MeasureAuxDistance.prototype.setMinMaxForCircles = function (iCircleHC0, iCircleHC1) {
            function setMinMax(ioAuxDelta, iNominalDist, iRadiiDist) {
                if (!ioAuxDelta.getWCDeltaEnds().length) {
                    return
                }
                if (iNominalDist > iRadiiDist) {
                    ioAuxDelta.setMinDist(iNominalDist - iRadiiDist)
                }
                ioAuxDelta.setMaxDist(iNominalDist + iRadiiDist)
            }

            var circlePlaneHC0 = eDwTypes_1.HC.Plane.createFromPointAndNormal(iCircleHC0.origin, iCircleHC0.normal);
            var projPnt = eDwGeomUtils.dropPointOnPlane(iCircleHC1.origin, circlePlaneHC0);
            var dot = eDwTypes_1.HC.Point3.dot(iCircleHC0.normal, iCircleHC1.normal);
            var dist = projPnt.subtract(iCircleHC0.origin).length();
            console.debugLog("Measure", "2 circles/arcs: dot = " + dot + "  dist = " + dist);
            if (1 - Math.abs(dot) < cAngleTol && dist > cLengthTol) {
                var radiiDist = iCircleHC0.radius + iCircleHC1.radius;
                setMinMax(this.mDistLine, dist, radiiDist);
                setMinMax(this.mNDistLine, dist, radiiDist)
            }
        };
        MeasureAuxDistance.prototype.avoidDuplication = function () {
            var delta0 = this.mDistLine.getDelta();
            var delta1 = this.mNDistLine.getDelta();
            var len0 = delta0.length();
            var len1 = delta1.length();
            var lenMax = Math.max(len0, len1);
            var lenDiff = Math.abs(len0 - len1);
            if (0 === lenMax || lenDiff / lenMax < cLengthTol) {
                delta1 = delta0.copy()
            }
            var diff = new eDwTypes_1.HC.Point3(Math.abs(delta0.x) - Math.abs(delta1.x), Math.abs(delta0.y) - Math.abs(delta1.y), Math.abs(delta0.z) - Math.abs(delta1.z));
            if (diff.equalsWithTolerance(eDwTypes_1.HC.Point3.zero(), cLengthTol)) {
                this.mNDistLine = this.mDistLine.copy();
                this.mDistLine.reset()
            }
            if (0 === delta1.x && 0 === delta1.y && 0 === delta1.z || 0 === diff.x && 0 === diff.y && 0 === diff.z) {
                this.mNormalDistExtLines = []
            }
        };
        MeasureAuxDistance.prototype.setNormalDistExtPoints = function (iPntsHC) {
            if (!this.mNormalDistExtLines.length) {
                this.mNormalDistExtLines.push(new MeasureLine(this.mViewer, iPntsHC[0], iPntsHC[1], cAuxDistanceNormalDistanceExtLineColor));
                this.mNormalDistExtLines.push(new MeasureLine(this.mViewer, iPntsHC[2], iPntsHC[3], cAuxDistanceNormalDistanceExtLineColor))
            }
        };
        return MeasureAuxDistance
    }();
    var MeasureAuxAngle = function () {
        function MeasureAuxAngle(iViewer) {
            this.mViewer = iViewer;
            this.mAngleFace = new eDwTypes_1.HC.Markup.Shape.Polygon;
            this.mAngleArc = new eDwTypes_1.HC.Markup.Shape.Polyline;
            this.mAngleEdge = new eDwTypes_1.HC.Markup.Shape.Polyline;
            this.mAngleTip = new eDwTypes_1.HC.Markup.Shape.Circle;
            var cColorAngleFill = new eDwTypes_1.HC.Color(41, 128, 185);
            var cColorPoint = new eDwTypes_1.HC.Color(137, 196, 244);
            var cColorEdgeArc = new eDwTypes_1.HC.Color(52, 73, 94);
            var cColorEdgeStroke = new eDwTypes_1.HC.Color(100, 100, 100);
            var widthEdge = 3;
            var arrowSize = 5;
            var pointSize = 7;
            this.mAngleFace.setFillColor(cColorAngleFill);
            this.mAngleFace.setStrokeWidth(0);
            this.mAngleFace.setFillOpacity(.5);
            this.mAngleArc.setStrokeColor(cColorEdgeArc);
            this.mAngleArc.setEndEndcapColor(cColorEdgeArc);
            this.mAngleArc.setStartEndcapColor(cColorEdgeArc);
            this.mAngleArc.setStrokeWidth(widthEdge);
            this.mAngleArc.setEndcapType(eDwTypes_1.HC.Markup.Shape.EndcapType.Arrowhead);
            this.mAngleArc.setEndEndcapSize(arrowSize);
            this.mAngleArc.setStartEndcapSize(arrowSize);
            this.mAngleEdge.setStrokeColor(cColorEdgeStroke);
            this.mAngleEdge.setStrokeWidth(widthEdge + 1);
            this.mAngleTip.setFillColor(cColorPoint);
            this.mAngleTip.setStrokeColor(cColorEdgeStroke);
            this.mAngleTip.setStrokeWidth(widthEdge);
            this.mAngleTip.setRadius(pointSize)
        }

        MeasureAuxAngle.prototype.reset = function () {
            this.mAngle = NaN;
            this.mOriginHC = undefined;
            this.mPointsArcEdge = [];
            this.mPointsBorder = undefined
        };
        MeasureAuxAngle.prototype.draw = function (iImmediateDrawMode) {
            if (utils.isNaN(this.mAngle)) return;
            this.projectPoints();
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            renderer.drawPolygon(this.mAngleFace);
            renderer.drawPolyline(this.mAngleArc);
            renderer.drawPolyline(this.mAngleEdge);
            if (!iImmediateDrawMode) {
                renderer.drawCircle(this.mAngleTip)
            }
        };
        MeasureAuxAngle.prototype.setByPlanePlane = function (iFace0, iFace1, iFaceObj0, iFaceObj1) {
            this.reset();
            var pickHC0 = iFaceObj0.getPosition();
            this.mOriginHC = pickHC0.copy();
            var norm0HC = iFace0.normal;
            norm0HC.normalize();
            var pickHC1 = iFaceObj1.getPosition();
            var pntHC1 = pickHC1.copy();
            var norm1HC = iFace1.normal;
            norm1HC.normalize();
            this.mAngle = iFaceObj0.findAngle(iFaceObj1);
            this.commonComputeAngle((function () {
                return false
            }), (function () {
                var vecHC = eDwTypes_1.HC.Point3.cross(norm0HC, norm1HC);
                var wVecHC0 = eDwTypes_1.HC.Point3.cross(vecHC, norm0HC);
                var k0 = (eDwTypes_1.HC.Point3.dot(pntHC1, norm1HC) - eDwTypes_1.HC.Point3.dot(pickHC0, norm1HC)) / eDwTypes_1.HC.Point3.dot(wVecHC0, norm1HC);
                var originHC0 = eDwTypes_1.HC.Point3.add(pickHC0, wVecHC0.scale(k0));
                var wVecHC1 = eDwTypes_1.HC.Point3.cross(vecHC, norm1HC);
                var k1 = (eDwTypes_1.HC.Point3.dot(pickHC0, norm0HC) - eDwTypes_1.HC.Point3.dot(pntHC1, norm0HC)) / eDwTypes_1.HC.Point3.dot(wVecHC1, norm0HC);
                var originHC1 = eDwTypes_1.HC.Point3.add(pntHC1, wVecHC1.scale(k1));
                return [eDwTypes_1.HC.Point3.subtract(pickHC0, originHC0), eDwTypes_1.HC.Point3.subtract(pntHC1, originHC1)]
            }), this.maxScale(iFace0, iFaceObj0))
        };
        MeasureAuxAngle.prototype.setByLinePlane = function (iEdge, iFace, iEdgeObj, iFaceObj) {
            this.setByLinePlaneOrig(iEdge, iFace, iEdgeObj, iFaceObj, false)
        };
        MeasureAuxAngle.prototype.setByPlaneLine = function (iFace, iEdge, iFaceObj, iEdgeObj) {
            this.setByLinePlaneOrig(iEdge, iFace, iEdgeObj, iFaceObj, true)
        };
        MeasureAuxAngle.prototype.setByLineLine = function (iEdge0, iEdge1, iEdgeObj0, iEdgeObj1) {
            var _this = this;
            var pntWCHC0 = iEdgeObj0.getPosition();
            var pntWCHC1 = iEdgeObj1.getPosition();
            var line0 = l_getLineEndPts(iEdgeObj0);
            var line1 = l_getLineEndPts(iEdgeObj1);
            this.mAngle = iEdgeObj0.findAngle(iEdgeObj1);
            this.commonComputeAngle((function () {
                return 0 !== _this.mAngle && 180 !== _this.mAngle
            }), (function () {
                var tmp = l_distanceLineLineCross(line0, line1);
                _this.mOriginHC = pntWCHC1;
                return [eDwTypes_1.HC.Point3.subtract(pntWCHC0, tmp.PntHC0), eDwTypes_1.HC.Point3.subtract(pntWCHC1, tmp.PntHC1)]
            }), this.maxScale(iEdge1, iEdgeObj1))
        };
        MeasureAuxAngle.prototype.getLabels = function () {
            var labels = [];
            if (utils.isNumber(this.mAngle)) {
                var label = new MeasureLabel(this.mViewer, this.getAngleArcCenter());
                label.addItem(this.getResultItem());
                labels.push(label)
            }
            return labels
        };
        MeasureAuxAngle.prototype.getAngleArcCenter = function () {
            var n = this.mPointsArcEdge.length;
            return this.mPointsArcEdge[Math.round(n / 2)].copy()
        };
        MeasureAuxAngle.prototype.getText = function () {
            var resultItem = this.getResultItem();
            return resultItem ? resultItem.Name + ": " + resultItem.Value : ""
        };
        MeasureAuxAngle.prototype.getResultItem = function () {
            return utils.isNumber(this.mAngle) ? new MeasureResultAngle(cLocalizedAngle, this.mAngle) : null
        };
        MeasureAuxAngle.prototype.setByLinePlaneOrig = function (iEdge, iFace, iEdgeSelObj, iFaceSelObj, iReverseOrder) {
            var _this = this;
            this.reset();
            var pntWCHC0 = iEdgeSelObj.getPosition();
            var linePoints = l_getLineEndPts(iEdgeSelObj);
            var vecWCHC = eDwTypes_1.HC.Point3.subtract(linePoints.P0HC, linePoints.P1HC);
            vecWCHC.normalize();
            var pntWCHC1 = iFaceSelObj.getPosition();
            var normalWCHC1 = iFace.normal;
            normalWCHC1.normalize();
            var vec0PtALCHC = iEdgeSelObj.getAsLocalPoint(linePoints.P0HC);
            var vec0PtBLCHC = iEdgeSelObj.getAsLocalPoint(linePoints.P1HC);
            var edgeVecLCHC = eDwTypes_1.HC.Point3.subtract(vec0PtBLCHC, vec0PtALCHC);
            var plnWCHC = eDwTypes_1.HC.Plane.createFromPointAndNormal(iFace.origin, iFace.normal);
            var ptAOnPlnLCHC = eDwGeomUtils.dropPointOnPlane(vec0PtALCHC, plnWCHC);
            var ptBOnPlnLCHC = eDwGeomUtils.dropPointOnPlane(vec0PtBLCHC, plnWCHC);
            var edgeVecInPlaneLCHC = eDwTypes_1.HC.Point3.subtract(ptBOnPlnLCHC, ptAOnPlnLCHC);
            if (edgeVecInPlaneLCHC.length() < cLengthTol) {
                edgeVecInPlaneLCHC = eDwTypes_1.HC.Point3.subtract(ptBOnPlnLCHC, iFace.origin)
            }
            var maxScale = iReverseOrder ? this.maxScale(iEdge, iEdgeSelObj) : this.maxScale(iFace, iFaceSelObj);
            this.mAngle = l_getAngle(edgeVecInPlaneLCHC, edgeVecLCHC);
            this.commonComputeAngle((function () {
                return _this.mAngle && 180 !== _this.mAngle
            }), (function () {
                var k = (eDwTypes_1.HC.Point3.dot(pntWCHC1, normalWCHC1) - eDwTypes_1.HC.Point3.dot(pntWCHC0, normalWCHC1)) / eDwTypes_1.HC.Point3.dot(vecWCHC, normalWCHC1);
                var originHC = eDwTypes_1.HC.Point3.add(pntWCHC0, eDwTypes_1.HC.Point3.scale(vecWCHC, k));
                var vecHC0 = eDwTypes_1.HC.Point3.subtract(pntWCHC0, originHC);
                var vecHC1 = eDwTypes_1.HC.Point3.subtract(pntWCHC1, originHC);
                _this.mOriginHC = iReverseOrder ? pntWCHC0 : pntWCHC1;
                if (90 !== _this.mAngle && 270 !== _this.mAngle) {
                    vecHC1 = eDwTypes_1.HC.Point3.cross(normalWCHC1, eDwTypes_1.HC.Point3.cross(vecHC0, normalWCHC1))
                }
                vecHC1.normalize();
                vecHC1.scale(vecHC0.length());
                return [vecHC0, vecHC1]
            }), maxScale);
            if (utils.isNaN(this.mAngle)) {
                this.mAngle = iEdgeSelObj.findAngle(iFaceSelObj);
                this.commonComputeAngle((function () {
                    return 90 !== _this.mAngle && 180 !== _this.mAngle
                }), (function () {
                    var k = (eDwTypes_1.HC.Point3.dot(pntWCHC1, vecWCHC) - eDwTypes_1.HC.Point3.dot(pntWCHC0, vecWCHC)) / eDwTypes_1.HC.Point3.dot(vecWCHC, vecWCHC);
                    var pnVecHC = eDwTypes_1.HC.Point3.add(pntWCHC0, eDwTypes_1.HC.Point3.scale(vecWCHC, k));
                    var angVecHC = iReverseOrder ? eDwTypes_1.HC.Point3.subtract(pnVecHC, pntWCHC0) : eDwTypes_1.HC.Point3.subtract(pntWCHC0, pnVecHC);
                    if (0 === angVecHC.x && 0 === angVecHC.y && 0 === angVecHC.z) {
                        vecWCHC = angVecHC.copy()
                    }
                    vecWCHC = iFaceSelObj.getAsLocalVector(vecWCHC);
                    _this.mOriginHC = iReverseOrder ? pntWCHC0 : pntWCHC1;
                    return [vecWCHC, vecWCHC]
                }), maxScale)
            }
        };
        MeasureAuxAngle.prototype.commonComputeAngle = function (iAcceptableAngleFunc, iComputeDisplayVecsFunc, iMaxScale) {
            if (utils.isNaN(iMaxScale)) return;
            if (iAcceptableAngleFunc()) {
                var displayVecsHC = iComputeDisplayVecsFunc();
                if (!this.mOriginHC || !displayVecsHC || !displayVecsHC.length) {
                    return
                }
                var displayVec0 = displayVecsHC[0];
                var displayVec1 = displayVecsHC[1];
                var origin_1 = this.mOriginHC.copy();
                var radius = Math.max(displayVec0.length(), displayVec1.length());
                radius = Math.min(radius * .8, iMaxScale * .6);
                var vec0 = displayVec0.copy();
                var vec1 = displayVec1.copy();
                vec0.normalize();
                vec1.normalize();
                var angleDegree = l_getAngle(vec0, vec1);
                var angle = angleDegree * Math.PI / 180;
                var normal = eDwTypes_1.HC.Point3.cross(vec0, vec1);
                var vecY = eDwTypes_1.HC.Point3.cross(normal, vec0);
                vecY.normalize();
                if (isNaN(vecY.x) || isNaN(vecY.y) || isNaN(vecY.z)) {
                    for (var i = 0; i < 3; ++i) {
                        var point = eDwTypes_1.HC.Point3.add(origin_1, eDwTypes_1.HC.Point3.scale(vec0, radius));
                        this.mPointsArcEdge.push(point)
                    }
                } else {
                    var cNumSegments = 20;
                    for (var i = 0; i <= cNumSegments; ++i) {
                        var aX = vec0.copy();
                        var aY = vecY.copy();
                        var alpha = angle * i / cNumSegments;
                        var vX = aX.scale(Math.cos(alpha) * radius);
                        var vY = aY.scale(Math.sin(alpha) * radius);
                        var point = eDwTypes_1.HC.Point3.add(origin_1, eDwTypes_1.HC.Point3.add(vX, vY));
                        this.mPointsArcEdge.push(point)
                    }
                }
                var p0 = eDwTypes_1.HC.Point3.add(origin_1, eDwTypes_1.HC.Point3.scale(vec0, 1.2 * radius));
                var p1 = eDwTypes_1.HC.Point3.add(origin_1, eDwTypes_1.HC.Point3.scale(vec1, 1.2 * radius));
                this.mPointsBorder = {end0: p0, end1: p1, tip: origin_1.copy()}
            } else {
                this.mAngle = NaN
            }
        };
        MeasureAuxAngle.prototype.maxScale = function (iProp, iSelObj) {
            var lineEntity = iSelObj.getLineEntity();
            var faceEntity = iSelObj.getFaceEntity();
            if (lineEntity) {
                var line = l_getLineEndPts(iSelObj);
                return eDwTypes_1.HC.Point3.subtract(line.P0HC, line.P1HC).length()
            } else {
                var box = faceEntity.getBounding();
                return eDwTypes_1.HC.Point3.subtract(box.max, box.min).length()
            }
        };
        MeasureAuxAngle.prototype.projectPoints = function () {
            if (utils.isNaN(this.mAngle) || !this.mOriginHC) return;
            this.mAngleFace.clearPoints();
            this.mAngleArc.clearPoints();
            this.mAngleEdge.clearPoints();
            if (0 === this.mPointsArcEdge.length || !this.mPointsBorder) return;
            var viewHC = this.mViewer.getHCView();
            this.mAngleFace.pushPoint(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mOriginHC)));
            for (var i = 0; i < this.mPointsArcEdge.length; ++i) {
                var p = eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mPointsArcEdge[i]));
                this.mAngleFace.pushPoint(p);
                this.mAngleArc.pushPoint(p)
            }
            this.mAngleFace.pushPoint(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mOriginHC)));
            this.mAngleEdge.pushPoint(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mPointsBorder.end0)));
            this.mAngleEdge.pushPoint(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mPointsBorder.tip)));
            this.mAngleEdge.pushPoint(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mPointsBorder.end1)));
            this.mAngleTip.setCenter(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(this.mPointsBorder.tip)))
        };
        return MeasureAuxAngle
    }();
    var MeasureAuxPick = function () {
        function MeasureAuxPick(iViewer) {
            this.mViewer = iViewer;
            this.reset()
        }

        MeasureAuxPick.prototype.reset = function () {
            this.mPntData = [];
            this.mDistResultText = "";
            delete this.mDelta;
            delete this.mDistLine
        };
        MeasureAuxPick.prototype.draw = function (iImmediateDrawMode) {
            if (!this.mPntData.length) return;
            if (eDwMeasureEntities.PointToPoint) {
                if (this.mDistLine) {
                    mDistLine_g = this.mDistLine;//PLM Test
                    this.mDistLine.draw();
                }
                if (this.mDelta) this.mDelta.draw(iImmediateDrawMode)
            }
            this.drawEndPnts()
        };
        MeasureAuxPick.prototype.getLabels = function (iImmediateDrawMode) {
            var labels = [];
            var numPnts = this.mPntData.length;
            if (numPnts < 2 || !eDwMeasureEntities.PointToPoint) {
                return labels
            }
            var selObjFirst = this.mPntData[0].SelObj;
            var selObjLast = this.mPntData[numPnts - 1].SelObj;
            var pntWCHC0 = selObjFirst.getPosition();
            var pntLCHC0 = selObjFirst.getAsLocalPoint(pntWCHC0);
            var pntWCHC1 = selObjLast.getPosition();
            var pntLCHC1 = selObjLast.getAsLocalPoint(pntWCHC1);
            var vecHC = pntWCHC1.copy().subtract(pntWCHC0);
            var label = new MeasureLabel(this.mViewer, pntWCHC0.copy().add(vecHC.scale(.5)));
            label.addItem(new MeasureResultDistance(cLocalizedDistance, eDwTypes_1.HC.Point3.distance(pntLCHC0, pntLCHC1)));
            this.mDistResultText = label.getText();
            labels.push(label);
            if (this.mDelta) {
                Array.prototype.push.apply(labels, this.mDelta.getLabels())
            }
            return labels
        };
        MeasureAuxPick.prototype.getPointLabels = function () {
            var cDrawEnabled = !eDwMeasureEntities.PointToPoint;
            var labels = [];
            var n = this.mPntData.length;
            for (var i = 0; i < n; ++i) {
                var selObj = this.mPntData[i].SelObj;
                var pntWCHC = selObj.getPosition();
                var label = new MeasureLabel(this.mViewer, pntWCHC, cDrawEnabled);
                label.addItem(new MeasureResultPoint3D(cLocalizedCoordinate, selObj.getAsLocalPoint(pntWCHC)));
                labels.push(label)
            }
            return labels
        };
        MeasureAuxPick.prototype.regeneratePicks = function (iSelObjs) {
            this.reset();
            var n = iSelObjs.length;
            if (0 === n) return;
            if (n > 1) {
                this.addDisplayMarker(iSelObjs[0]);
                delete this.mDelta;
                delete this.mDistLine
            }
            this.addDisplayMarker(iSelObjs[n - 1]);
            if (eDwMeasureEntities.PointToPoint && this.mPntData.length === 2) {
                var selObj0 = this.mPntData[0].SelObj;
                var selObj1 = this.mPntData[1].SelObj;
                var pntWCHC0 = selObj0.getPosition();
                var pntWCHC1 = selObj1.getPosition();
                var absLenTol = eDwGeomUtils.cAbsLengthTol;
                if (!pntWCHC0.equalsWithTolerance(pntWCHC1, absLenTol)) {
                    this.mDistLine = new MeasureDistLine(this.mViewer, pntWCHC0, selObj0, pntWCHC1, selObj1);
                    this.mDistLine.draw();
                    this.mDelta = MeasureDelta.create(this.mViewer, pntWCHC1, pntWCHC0, selObj1, selObj0)
                }
            }
        };
        MeasureAuxPick.prototype.getText = function () {
            var text = "";
            if (eDwMeasureEntities.PointToPoint) {
                text = this.mDistResultText;
                if (this.mDelta) text += "\n" + this.mDelta.getText()
            }
            return text
        };
        MeasureAuxPick.prototype.addDisplayMarker = function (iSelObj) {
            var cWidthEdge = 3;
            var cPointSize = 7;
            var pntWCHC = iSelObj.getPosition().copy();
            var shapeCircleHC = new eDwTypes_1.HC.Markup.Shape.Circle;
            shapeCircleHC.setCenter(eDwTypes_1.HC.Point2.fromPoint3(this.mViewer.getHCView().projectPoint(pntWCHC)));
            shapeCircleHC.setFillColor(cAuxPickPointFillColor);
            shapeCircleHC.setStrokeColor(cAuxPickPointStrokeColor);
            shapeCircleHC.setStrokeWidth(cWidthEdge);
            shapeCircleHC.setRadius(cPointSize);
            this.mPntData.push({SelObj: iSelObj, Circle: shapeCircleHC});
            return shapeCircleHC
        };
        MeasureAuxPick.prototype.drawEndPnts = function () {
            var viewHC = this.mViewer.getHCView();
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            for (var i = 0; i < this.mPntData.length; ++i) {
                var pntData = this.mPntData[i];
                pntData.Circle.setCenter(eDwTypes_1.HC.Point2.fromPoint3(viewHC.projectPoint(pntData.SelObj.getPosition())));
                renderer.drawCircle(pntData.Circle)
            }
        };
        return MeasureAuxPick
    }();
    var MeasureAuxGeo = function () {
        function MeasureAuxGeo(iViewer) {
            this.mViewer = iViewer;
            this.mAuxAngle = new MeasureAuxAngle(iViewer);
            this.mAuxDist = new MeasureAuxDistance(iViewer);
            this.mAuxPick = new MeasureAuxPick(iViewer);
            this.mOtherResults = new MeasureAuxMessage(iViewer);
            this.mMessage = new MeasureAuxMessage(iViewer);
            this.mPickInfo = new MeasureAuxMessage(iViewer);
            this.mLabelIDs = [];
            this.mMarkupLabels = [];
            this.mDrawLabel = true;
            this.mImmediateDrawMode = false;
            this.reset()
        }

        MeasureAuxGeo.prototype.syncUnits = function () {
            var e_8, _a;
            try {
                for (var _b = __values(this.mResultLabels), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var measureLabel = _c.value;
                    measureLabel.setStringContent()
                }
            } catch (e_8_1) {
                e_8 = {error: e_8_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_8) throw e_8.error
                }
            }
        };
        MeasureAuxGeo.prototype.reset = function () {
            this.mAuxAngle.reset();
            this.mAuxDist.reset();
            this.mOtherResults.reset();
            this.mMessage.reset();
            this.mPickInfo.reset();
            this.mAuxPick.reset();
            this.mResultLabels = [];
            this.mInfoLabels = [];
            this.clearMarkupLabels()
        };
        MeasureAuxGeo.prototype.draw = function () {
            if (!this.hasLabels()) return;
            if (!eDwMeasureEntities.PointToPoint) {
                this.mAuxAngle.draw(this.mImmediateDrawMode);
                var drawFunc = this.mAuxDist.draw.bind(this.mAuxDist);
                if (!this.mImmediateDrawMode) {
                    if (this.mPickInfo.getLabels().length === 1) {
                        drawFunc = this.mAuxPick.draw.bind(this.mAuxPick)
                    }
                }
                drawFunc(this.mImmediateDrawMode)
            } else {
                this.mAuxPick.draw(this.mImmediateDrawMode)
            }
            if (this.mDrawLabel) {
                if (this.mImmediateDrawMode) {
                    this.drawResultLabels()
                }
                this.drawInfoLabels()
            }
        };
        MeasureAuxGeo.prototype.addMarkupLabels = function () {
            this.clearMarkupLabels();
            var markupMgr = this.mViewer.getHCMarkupManager();
            var n = this.mResultLabels.length;
            for (var i = 0; i < n; ++i) {
                var label = new LabelItem(this.mViewer, this.mResultLabels[i]);
                var id = markupMgr.registerMarkup(label);
                this.mLabelIDs.push(id);
                this.mMarkupLabels.push(label)
            }
        };
        MeasureAuxGeo.prototype.clearMarkupLabels = function () {
            var markupMgr = this.mViewer.getHCMarkupManager();
            var n = this.mLabelIDs.length;
            for (var i = 0; i < n; ++i) {
                markupMgr.unregisterMarkup(this.mLabelIDs[i])
            }
            this.mLabelIDs = [];
            this.mMarkupLabels = []
        };
        MeasureAuxGeo.prototype.drawResultLabels = function () {
            var n = this.mResultLabels.length;
            for (var i = 0; i < n; ++i) {
                this.mResultLabels[i].drawLabel()
            }
        };
        MeasureAuxGeo.prototype.drawInfoLabels = function () {
            var m = this.mInfoLabels.length;
            for (var i = 0; i < m; ++i) {
                this.mInfoLabels[i].drawLabel()
            }
        };
        MeasureAuxGeo.prototype.setByVertexVertex = function (iSelVert0HC, iSelVert1HC) {
            this.reset();
            this.mAuxDist.setByPointPoint(iSelVert0HC.getPosition(), iSelVert0HC, iSelVert1HC.getPosition(), iSelVert1HC)
        };
        MeasureAuxGeo.prototype.setByVertexLine = function (iSelVertHC, iLineOrigHC, iSelEdgeHC) {
            this.reset();
            this.mAuxDist.setByPointLine(iSelVertHC.getPosition(), iSelVertHC, iLineOrigHC, iSelEdgeHC)
        };
        MeasureAuxGeo.prototype.setByVertexCircle = function (iSelVertHC, iCircleOrigHC, iSelEdgeHC) {
            this.reset();
            this.mAuxDist.setByCirclePoint(iCircleOrigHC, iSelEdgeHC, iSelVertHC.getPosition(), iSelVertHC)
        };
        MeasureAuxGeo.prototype.setByVertexPlane = function (iSelVertHC, iPlaneOrigHC, iSelFaceHC, iMinDistInfo) {
            this.reset();
            return this.mAuxDist.setByPointPlane(iSelVertHC.getPosition(), iSelVertHC, iPlaneOrigHC, iSelFaceHC, iMinDistInfo)
        };
        MeasureAuxGeo.prototype.setByPlanePlane = function (iPlaneOrig0HC, iPlaneOrig1HC, iSelFace0HC, iSelFace1HC, iMinDistInfo) {
            this.reset();
            this.mAuxAngle.setByPlanePlane(iPlaneOrig0HC, iPlaneOrig1HC, iSelFace0HC, iSelFace1HC);
            return this.mAuxDist.setByPlanePlane(iPlaneOrig0HC, iPlaneOrig1HC, iSelFace0HC, iSelFace1HC, iMinDistInfo)
        };
        MeasureAuxGeo.prototype.setByPlaneLine = function (iPlaneOrigHC, iLineOrigHC, iSelFaceHC, iSelEdgeHC) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.reset();
                            this.mAuxAngle.setByPlaneLine(iPlaneOrigHC, iLineOrigHC, iSelFaceHC, iSelEdgeHC);
                            return [4, this.mAuxDist.setByLinePlane(iLineOrigHC, iPlaneOrigHC, iSelEdgeHC, iSelFaceHC)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        MeasureAuxGeo.prototype.setByLineLine = function (iLineOrig0HC, iLineOrig1HC, iSelEdge0HC, iSelEdge1HC) {
            this.reset();
            this.mAuxAngle.setByLineLine(iLineOrig0HC, iLineOrig1HC, iSelEdge0HC, iSelEdge1HC);
            this.mAuxDist.setByLineLine(iLineOrig0HC, iLineOrig1HC, iSelEdge0HC, iSelEdge1HC)
        };
        MeasureAuxGeo.prototype.setByCircleCircle = function (iCircleOrigHC0, iCircleOrigHC1, iSelEdgeHC0, iSelEdgeHC1) {
            this.reset();
            this.mAuxDist.setByCircleCircle(iCircleOrigHC0, iSelEdgeHC0, iCircleOrigHC1, iSelEdgeHC1)
        };
        MeasureAuxGeo.prototype.setByCircleLine = function (iCircleOrigHC, iLineOrigHC, iSelEdgeHC0, iSelEdgeHC1) {
            this.reset();
            this.mAuxDist.setByCircleLine(iCircleOrigHC, iSelEdgeHC0, iLineOrigHC, iSelEdgeHC1)
        };
        MeasureAuxGeo.prototype.setByCirclePlane = function (iCircleOrigHC, iPlaneOrigHC, iSelEdgeHC, iSelFaceHC, iMeasDistInfo) {
            this.reset();
            return this.mAuxDist.setByCirclePlane(iCircleOrigHC, iSelEdgeHC, iPlaneOrigHC, iSelFaceHC, iMeasDistInfo)
        };
        MeasureAuxGeo.prototype.addPickInfo = function (iSelPropsHC, iSelObjs, iDrawLabels) {
            var n = iSelObjs.length;
            var startIdx = 0;
            if (this.mImmediateDrawMode) {
                var hasImmediateEntity = iDrawLabels;
                startIdx = hasImmediateEntity && n > 0 ? n - 1 : n
            }
            for (var i = startIdx; i < n; ++i) {
                var selProp = iSelPropsHC[i];
                var selObj = iSelObjs[i];
                if (!selObj) continue;
                this.mPickInfo.addIfVertex(selObj);
                if (selProp instanceof eDwTypes_1.HC.SubentityProperties.CircleElement) {
                    this.mPickInfo.addIfCircle(selProp, selObj)
                } else if (selProp instanceof eDwTypes_1.HC.SubentityProperties.LineElement) {
                    this.mPickInfo.addIfCurve(selProp, selObj, cLocalizedStraightLine)
                } else if (selProp instanceof eDwTypes_1.HC.SubentityProperties.OtherEdgeElement) {
                    this.mPickInfo.addIfCurve(selProp, selObj, cLocalizedCurve)
                }
                this.mPickInfo.addIfCylinder(selProp, selObj);
                this.mPickInfo.addIfPlane(selProp, selObj)
            }
            this.regeneratePicks(iSelObjs)
        };
        MeasureAuxGeo.prototype.regeneratePicks = function (iSelObjs) {
            this.mAuxPick.regeneratePicks(iSelObjs)
        };
        MeasureAuxGeo.prototype.addMessage = function (iResult, iStart, iColor) {
            this.mMessage.addResult(iResult, iStart.copy(), iColor)
        };
        MeasureAuxGeo.prototype.addOtherResult = function (iResult, iStart) {
            this.mOtherResults.addResult(iResult, iStart.copy())
        };
        MeasureAuxGeo.prototype.updateResultLabels = function () {
            this.mResultLabels = [];
            if (!eDwMeasureEntities.PointToPoint) {
                this.mResultLabels = this.mResultLabels.concat(this.mAuxAngle.getLabels());
                this.mResultLabels = this.mResultLabels.concat(this.mAuxDist.getLabels());
                this.mResultLabels = this.mResultLabels.concat(this.mOtherResults.getLabels());
                this.mResultLabels = this.mResultLabels.concat(this.mMessage.getLabels())
            } else {
                this.mResultLabels = this.mResultLabels.concat(this.mAuxPick.getLabels(this.mImmediateDrawMode))
            }
            var labelsToBeDistributed = this.mResultLabels.slice();
            if (this.mImmediateDrawMode) {
                this.updateLastInfoLabels();
                if (this.mInfoLabels.length > 0) {
                    labelsToBeDistributed = this.mInfoLabels.slice().concat(this.mResultLabels)
                }
            }
            this.distributeLabels(labelsToBeDistributed);
            if (!this.mImmediateDrawMode) {
                this.addMarkupLabels()
            }
        };
        MeasureAuxGeo.prototype.updateLastInfoLabels = function () {
            this.updateInfoLabel(this.getLabels().length - 1)
        };
        MeasureAuxGeo.prototype.updateInfoLabel = function (iIndex) {
            this.mInfoLabels = [];

            function addTo(iCurrIndex, iLabels, ioLabels) {
                if (iLabels.length > iCurrIndex && iCurrIndex >= 0) {
                    var label = iLabels[iCurrIndex];
                    if (label.setDefaultEndPos()) {
                        label.setStringContent();
                        ioLabels.push(label)
                    }
                }
            }

            addTo(iIndex, this.getLabels(), this.mInfoLabels)
        };
        MeasureAuxGeo.prototype.getInfoLabelText = function () {
            var output = [];
            var labels = this.getLabels();
            for (var i = 0; i < labels.length; ++i) {
                var label = labels[i];
                output.push(label.getText())
            }
            return output
        };
        MeasureAuxGeo.prototype.distributeLabels = function (ioResultLabels) {
            var n = ioResultLabels.length;
            if (n < 1) return;
            var startsOrig = [];
            for (var i = 0; i < n; ++i) {
                var resultLabel = ioResultLabels[i];
                if (!resultLabel.DrawEnabled) continue;
                var leaderStartPos = resultLabel.getLeaderStartPos();
                if (leaderStartPos) startsOrig.push(leaderStartPos)
            }
            var startsNew = l_adjustLeaderEndByStart(startsOrig);
            var j = 0;
            for (var i = 0; i < n; ++i) {
                var resultLabel = ioResultLabels[i];
                if (!resultLabel.DrawEnabled) continue;
                resultLabel.setLeaderEndPos(startsNew[j++]);
                resultLabel.setStringContent()
            }
        };
        MeasureAuxGeo.prototype.getMeasureText = function () {
            if (!this.hasLabels()) return "";
            var result = [];
            var distStr = this.mAuxDist.getText();
            if (eDwMeasureEntities.PointToPoint) {
                if (distStr) {
                    result.push(distStr)
                } else {
                    var pickStr = this.mAuxPick.getText();
                    if (pickStr) result.push(pickStr)
                }
            } else {
                if (distStr) result.push(distStr);
                var angleStr = this.mAuxAngle.getText();
                if (angleStr) result.push(angleStr);
                if (this.mMessage.countLabels()) {
                    result.push(this.mMessage.getText())
                }
                if (this.mOtherResults.countLabels()) {
                    result.push(this.mOtherResults.getText())
                }
            }
            return result.join("\n")
        };
        MeasureAuxGeo.prototype.setDrawLabel = function (iEnable) {
            this.mDrawLabel = iEnable
        };
        MeasureAuxGeo.prototype.setImmediateDrawMode = function (iEnable) {
            this.mImmediateDrawMode = iEnable
        };
        MeasureAuxGeo.prototype.hasLabels = function () {
            return this.mAuxDist.getLabels().length || this.mAuxAngle.getLabels().length || this.mOtherResults.getLabels().length || this.mPickInfo.getLabels().length || this.mInfoLabels.length || this.mAuxPick.getLabels(this.mImmediateDrawMode).length ? true : false
        };
        MeasureAuxGeo.prototype.getLabels = function () {
            return eDwMeasureEntities.PointToPoint ? this.mAuxPick.getPointLabels() : this.mPickInfo.getLabels()
        };
        return MeasureAuxGeo
    }();
    var MeasurePanelInfo = function () {
        function MeasurePanelInfo(iAuxGeo) {
            this.mAuxGeo = iAuxGeo;
            this.mSelObjs = []
        }

        MeasurePanelInfo.prototype.updatePanelResult = function (iSelObjs, iUserUnits) {
            var _this = this;
            this.mSelObjs = [];
            for (var i = 0; i < iSelObjs.length; ++i) {
                this.mSelObjs.push(iSelObjs[i])
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var result;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                result = {
                                    SelObjs: this.mSelObjs,
                                    Descriptions: this.mAuxGeo.getInfoLabelText(),
                                    Message: this.mAuxGeo.getMeasureText()
                                };
                                return [4, eDwEventMgr.get().fireEvent(eDwMeasureEvents_1.MeasurementRefreshEvent, result)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            return
        };
        return MeasurePanelInfo
    }();
    var cDeltaX = "dX";
    var cDeltaY = "dY";
    var cDeltaZ = "dZ";
    var cDistance = "Distance";
    var cMinDistance = "Min " + cDistance;
    var cMaxDistance = "Max " + cDistance;
    var cLocalizedAngle = l_binder("Strings.Angle");
    var cLocalizedArea = l_binder("Strings.Area");
    var cLocalizedCoordinate = l_binder("Strings.Coordinate");
    var cLocalizedCenter = l_binder("Strings.Center");
    var cLocalizedCircle = l_binder("Strings.Circle");
    var cLocalizedCurve = l_binder("Strings.Curve");
    var cLocalizedCylinder = l_binder("Strings.Cylinder");
    var cLocalizedDiameter = l_binder("Strings.Diameter");
    var cLocalizedDistance = l_binder("Strings.Distance");
    var cLocalizedEntity = l_binder("Strings.Entity");
    var cLocalizedLength = l_binder("Strings.Length");
    var cLocalizedInfo = l_binder("Strings.Info");
    var cLocalizedInvalidCombo = l_binder("Strings.InvalidCombination");
    var cLocalizedMaxDistance = l_binder("Strings.MaxDistance");
    var cLocalizedMinDistance = l_binder("Strings.MinDistance");
    var cLocalizedPerimeter = l_binder("Strings.Perimeter");
    var cLocalizedPlane = l_binder("Strings.Plane");
    var cLocalizedStraightLine = l_binder("Strings.StraightLine");
    var cLocalizedTotalLength = l_binder("Strings.TotalLength");
    var cLocalizedVertex = l_binder("Strings.Vertex");
    var cLengthTol = 1e-5;
    var cAngleTol = .05;
    var cParallelTol = 4;
    var cPerpendicularTol = cAngleTol;
    var cGreyColor = new eDwTypes_1.HC.Color(50, 50, 50);
    var cLineDistanceColor = new eDwTypes_1.HC.Color(52, 73, 94);
    var cAuxPickPointFillColor = new eDwTypes_1.HC.Color(137, 196, 244);
    var cAuxPickPointStrokeColor = new eDwTypes_1.HC.Color(100, 100, 100);
    var cAuxPickLineColor = new eDwTypes_1.HC.Color(41, 128, 185);
    var cAuxDeltaPointFillColor = cAuxPickPointFillColor;
    var cAuxDeltaPointStrokeColor = cAuxPickPointStrokeColor;
    var cAuxDistanceNormalDistanceLineColor = cAuxPickLineColor;
    var cAuxDistanceNormalDistancePointColor = new eDwTypes_1.HC.Color(236, 240, 241);
    var cAuxDistanceNormalDistanceExtLineColor = new eDwTypes_1.HC.Color(154, 236, 219);
    var l_Model = null;

    function l_getCircularArc(iSelObj, ioCircleHC) {
        var curvePts = iSelObj.getLineEntity().getPoints();
        var startPt = curvePts[0];
        var endPt = curvePts[curvePts.length - 1];
        var len = Math.PI * ioCircleHC.radius * 2;
        var area = Math.PI * Math.pow(ioCircleHC.radius, 2);
        var angle = Math.PI * 2;
        if (!startPt.equalsWithTolerance(endPt, cLengthTol)) {
            var startVec = startPt.copy().subtract(ioCircleHC.origin).normalize();
            var endVec = endPt.copy().subtract(ioCircleHC.origin).normalize();
            var angleRange = Math.acos(eDwTypes_1.HC.Point3.dot(startVec, endVec));
            var refVec = eDwTypes_1.HC.Point3.cross(startVec, ioCircleHC.normal);
            var dir = eDwTypes_1.HC.Point3.dot(refVec, endVec);
            angleRange = dir > cAngleTol ? angleRange + Math.PI : angleRange;
            var percRange = angleRange / (2 * Math.PI);
            len *= percRange;
            area *= percRange;
            angle *= percRange
        }
        var circularArc = {
            OriginWCHC: iSelObj.getAsLocalPoint(ioCircleHC.origin),
            NormalWCHC: ioCircleHC.normal,
            StartPtWCHC: startPt,
            EndPtWCHC: endPt,
            Length: len,
            Area: area,
            Diameter: ioCircleHC.radius * 2,
            Angle: angle
        };
        return circularArc
    }

    function l_closestPoints(iPntHC0, iPntHC1) {
        var pntHC0 = iPntHC0[0].copy();
        var pntHC1 = iPntHC1[0].copy();
        var minDist = eDwTypes_1.HC.Point3.subtract(iPntHC0[0], iPntHC1[0]).length();
        for (var i = 0; i < iPntHC0.length; ++i) {
            for (var j = 0; j < iPntHC1.length; ++j) {
                var dist = eDwTypes_1.HC.Point3.subtract(iPntHC0[i], iPntHC1[j]).length();
                if (dist < minDist) {
                    pntHC0.assign(iPntHC0[i]);
                    pntHC1.assign(iPntHC1[j]);
                    minDist = dist
                }
            }
        }
        return {P0HC: pntHC0, P1HC: pntHC1}
    }

    function l_getAngle(iVecHC0, iVecHC1) {
        if (!iVecHC0 || !iVecHC1) return NaN;
        var vec0 = iVecHC0.copy();
        var vec1 = iVecHC1.copy();
        vec0.normalize();
        vec1.normalize();
        var dotVal = eDwTypes_1.HC.Point3.dot(vec0, vec1);
        if (0 === dotVal) return 90;
        dotVal = Math.min(dotVal, 1);
        dotVal = Math.max(dotVal, -1);
        var angle = Math.acos(dotVal);
        var angleDegree = angle * 180 / Math.PI;
        var n = eDwTypes_1.HC.Point3.cross(vec0, vec1);
        n.normalize();
        if (isNaN(n.x) || isNaN(n.y) || isNaN(n.z)) return 0;
        if (Math.abs(angleDegree) < cParallelTol) {
            angleDegree = 0
        }
        if (Math.abs(angleDegree - 90) < cPerpendicularTol) {
            angleDegree = 90
        }
        if (Math.abs(angleDegree - 180) < cParallelTol) {
            angleDegree = 180
        }
        return angleDegree
    }

    function l_getLineEndPts(iSelObj) {
        var pointsWCHC = iSelObj.getLineEntity().getPoints();
        return {P0HC: pointsWCHC[0].copy(), P1HC: pointsWCHC[pointsWCHC.length - 1].copy()}
    }

    function l_distanceLineLineCross(iLine0, iLine1) {
        var vecHC0 = eDwTypes_1.HC.Point3.subtract(iLine0.P0HC, iLine0.P1HC);
        var vecHC1 = eDwTypes_1.HC.Point3.subtract(iLine1.P0HC, iLine1.P1HC);
        vecHC0.normalize();
        vecHC1.normalize();
        var crossVecHC = eDwTypes_1.HC.Point3.cross(vecHC0, vecHC1);
        crossVecHC.normalize();
        var tmpArray = [vecHC0.x, -1 * vecHC1.x, -1 * crossVecHC.x, 0, vecHC0.y, -1 * vecHC1.y, -1 * crossVecHC.y, 0, vecHC0.z, -1 * vecHC1.z, -1 * crossVecHC.z, 0, 0, 0, 0, 1];
        var matrixHC = eDwTypes_1.HC.Matrix.createFromArray(tmpArray);
        var invMatrixHC = eDwTypes_1.HC.Matrix.inverse(matrixHC);
        var vecHC = eDwTypes_1.HC.Point3.subtract(iLine1.P0HC, iLine0.P0HC);
        var a = invMatrixHC.m[0] * vecHC.x + invMatrixHC.m[1] * vecHC.y + invMatrixHC.m[2] * vecHC.z;
        var b = invMatrixHC.m[4] * vecHC.x + invMatrixHC.m[5] * vecHC.y + invMatrixHC.m[6] * vecHC.z;
        var origPntHC0 = eDwTypes_1.HC.Point3.add(iLine0.P0HC, eDwTypes_1.HC.Point3.scale(vecHC0, a));
        var origPntHC1 = eDwTypes_1.HC.Point3.add(iLine1.P0HC, eDwTypes_1.HC.Point3.scale(vecHC1, b));
        var vecL0P0HC = eDwTypes_1.HC.Point3.subtract(iLine0.P0HC, origPntHC0);
        var vecL0P1HC = eDwTypes_1.HC.Point3.subtract(iLine0.P1HC, origPntHC0);
        var pntsL0HC = [iLine0.P0HC.copy(), iLine0.P1HC.copy()];
        if (eDwTypes_1.HC.Point3.dot(vecL0P0HC, vecL0P1HC) < 0) {
            pntsL0HC.push(origPntHC0)
        }
        var vecL1P0HC = eDwTypes_1.HC.Point3.subtract(iLine1.P0HC, origPntHC1);
        var vecL1P1HC = eDwTypes_1.HC.Point3.subtract(iLine1.P1HC, origPntHC1);
        var pntsL1HC = [iLine1.P0HC.copy(), iLine1.P1HC.copy()];
        if (eDwTypes_1.HC.Point3.dot(vecL1P0HC, vecL1P1HC) < 0) {
            pntsL1HC.push(origPntHC1)
        }
        var distPntHC0 = origPntHC0.copy();
        var distPntHC1 = origPntHC1.copy();
        if (eDwTypes_1.HC.Point3.dot(vecL1P0HC, vecL1P1HC) > 0 || eDwTypes_1.HC.Point3.dot(vecL0P0HC, vecL0P1HC) > 0) {
            var closePnts = l_closestPoints(pntsL0HC, pntsL1HC);
            distPntHC0 = closePnts.P0HC;
            distPntHC1 = closePnts.P1HC
        }
        return {PntHC0: origPntHC0, PntHC1: origPntHC1, PntHC2: distPntHC0, PntHC3: distPntHC1}
    }

    function l_distanceLineLinePara(iLineHC0, iLineHC1, iPntHC0, iPntHC1) {
        var vecHC0 = eDwTypes_1.HC.Point3.subtract(iLineHC0.P0HC, iLineHC0.P1HC);
        vecHC0.normalize();
        var k = eDwTypes_1.HC.Point3.dot(vecHC0, eDwTypes_1.HC.Point3.subtract(iPntHC1, iPntHC0)) / eDwTypes_1.HC.Point3.dot(vecHC0, vecHC0);
        var basePnt1HC = eDwTypes_1.HC.Point3.add(iPntHC0, eDwTypes_1.HC.Point3.scale(vecHC0, k));
        var vecL0P0HC = eDwTypes_1.HC.Point3.subtract(iLineHC0.P0HC, basePnt1HC);
        var vecL0P1HC = eDwTypes_1.HC.Point3.subtract(iLineHC0.P1HC, basePnt1HC);
        if (eDwTypes_1.HC.Point3.dot(vecL0P0HC, vecL0P1HC) < 0) {
            return {
                PntHC0: basePnt1HC.copy(),
                PntHC1: iPntHC1.copy(),
                PntHC2: basePnt1HC.copy(),
                PntHC3: iPntHC1.copy()
            }
        }
        var tmp = l_closestPoints([iLineHC1.P0HC, iLineHC1.P1HC], [iLineHC0.P0HC, iLineHC0.P1HC]);
        return {PntHC0: basePnt1HC.copy(), PntHC1: iPntHC1, PntHC2: tmp.P1HC, PntHC3: tmp.P0HC}
    }

    function l_adjustLeaderEndByStart(iPoints) {
        if (0 === iPoints.length) return [];

        function computeAngle(iVect) {
            var angle = Math.atan2(iVect.y, iVect.x);
            var degrees = 180 * angle / Math.PI;
            return (360 + Math.round(degrees)) % 360
        }

        function compare(iA, iB) {
            if (iA.ang < iB.ang) return -1;
            if (iA.ang > iB.ang) return 1;
            return 0
        }

        var targetRadius = 90;
        var center = new eDwTypes_1.HC.Point2(0, 0);
        for (var i = 0; i < iPoints.length; ++i) {
            center.add(iPoints[i])
        }
        if (1 === iPoints.length) {
            var vec = new eDwTypes_1.HC.Point2(targetRadius, targetRadius);
            return [eDwTypes_1.HC.Point2.add(iPoints[0], vec)]
        } else {
            center.set(center.x / iPoints.length, center.y / iPoints.length)
        }
        var angles = [];
        for (var i = 0; i < iPoints.length; ++i) {
            var vec = new eDwTypes_1.HC.Point2(iPoints[i].x - center.x, iPoints[i].y - center.y);
            angles.push({idx: i, ang: computeAngle(vec)})
        }
        angles.sort(compare);
        var tmp = 0;
        for (var i = 1; i < iPoints.length; ++i) {
            tmp = tmp + (angles[i].ang - angles[0].ang) - 180
        }
        angles[0].ang = angles[0].ang + tmp / iPoints.length;
        var deltaAng = 360 / iPoints.length;
        for (var i = 1; i < iPoints.length; ++i) {
            angles[i].ang = angles[i - 1].ang + deltaAng
        }
        var leaderVec = new Array(iPoints.length);
        var targetRadiusGroup = targetRadius + iPoints.length * 15;
        for (var i = 0; i < iPoints.length; ++i) {
            var idx = angles[i].idx;
            var angle = angles[i].ang % 360;
            angle = angle * Math.PI / 180;
            var vec = new eDwTypes_1.HC.Point2(Math.cos(angle), Math.sin(angle));
            vec = vec.scale(targetRadiusGroup);
            leaderVec[idx] = eDwTypes_1.HC.Point2.add(iPoints[idx], vec)
        }
        return leaderVec
    }

    function l_getPosForPnt(iViewer, iPntHC) {
        var viewerHC = iViewer.getHCView();
        return eDwTypes_1.HC.Point2.fromPoint3(viewerHC.projectPoint(iPntHC))
    }

    function l_getDeltas(iStartWCPtHC, iEndWCPtHC, iSelObj0, iSelObj1) {
        var startPtHC = iSelObj0.getAsLocalPoint(iStartWCPtHC);
        var endPtHC = iSelObj1.getAsLocalPoint(iEndWCPtHC);
        var deltaPtHC = eDwTypes_1.HC.Point3.subtract(startPtHC, endPtHC);
        var deltaPt0HC = new eDwTypes_1.HC.Point3(startPtHC.x - deltaPtHC.x, startPtHC.y, startPtHC.z);
        var deltaPt1HC = new eDwTypes_1.HC.Point3(deltaPt0HC.x, deltaPt0HC.y - deltaPtHC.y, deltaPt0HC.z);
        var deltaWCPt0HC = iSelObj0.getAsWorldPoint(deltaPt0HC);
        var deltaWCPt1HC = iSelObj1.getAsWorldPoint(deltaPt1HC);
        return [deltaWCPt0HC, deltaWCPt1HC]
    }

    function l_binder(iKey) {
        return eDwUILocalize_1.eDwUILocalize.getString.bind(null, iKey)
    }

    return eDwMeasureEntities
}));
define("eDwMeasureEvents", ["require", "exports", "eDwEvents"], (function (require, exports, eDwEvents_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.MeasurementDeselectAllEvent = exports.MeasurementSelectionEvent = exports.MeasurementRefreshEvent = void 0;
    exports.MeasurementRefreshEvent = new eDwEvents_1.AppEvent;
    exports.MeasurementSelectionEvent = new eDwEvents_1.AppEvent;
    exports.MeasurementDeselectAllEvent = new eDwEvents_1.AppEvent
}));
define("eDwMeasureMgr", ["require", "exports", "eDwMeasureOperator"], (function (require, exports, eDwMeasureOperator) {
    "use strict";
    var eDwMeasureMgr = function () {
        function eDwMeasureMgr(iViewer) {
            this.mViewer = iViewer;
            this.mMeasureOp = new eDwMeasureOperator(iViewer, this);
            this.mMeasureOp.OperatorID = iViewer.OperatorMgr.registerCustomOperator(this.mMeasureOp);
            this.mMarkupArray = []
        }

        eDwMeasureMgr.prototype.unregister = function () {
            this.mViewer.OperatorMgr.unregisterCustomOperatorByID(this.mMeasureOp.OperatorID)
        };
        eDwMeasureMgr.prototype.addMarkup = function (iNewMarkupID) {
            console.log(`PLM eDwMeasureMgr.addMarkup`)
            if (!this.mMarkupArray) {
                this.mMarkupArray = []
            }
            this.mMarkupArray.push(iNewMarkupID)
        };
        eDwMeasureMgr.prototype.activateMeasure = function (iMode) {
            this.mViewer.HCViewer.measureManager.setMeasurementColor(new Communicator.Color(4, 200, 5));
            var opMgr = this.mViewer.OperatorMgr;
            opMgr.push(this.mMeasureOp.OperatorID);
            this.setMeasureMode(iMode)
        };
        eDwMeasureMgr.prototype.deleteMeasurements = function () {
            var mkupMgr = this.mViewer.getHCMarkupManager();
            var markups = this.mMarkupArray.length;
            for (var i = 0; i < markups; i++) {
                mkupMgr.unregisterMarkup(this.mMarkupArray[i])
            }
        };
        eDwMeasureMgr.prototype.deactivateMeasure = function () {
            this.deleteMeasurements();
            var opMgr = this.mViewer.OperatorMgr;
            if (opMgr.getActiveOperatorID() === this.mMeasureOp.OperatorID) {
                opMgr.pop()
            }
            this.mViewer.HCViewer.selectionManager.setNodeSelectionColor(new Communicator.Color(4, 200, 5))
        };
        eDwMeasureMgr.prototype.getLastMarkup = function () {
            return this.mMarkupArray.length ? this.mMarkupArray[length - 1] : null
        };
        eDwMeasureMgr.prototype.setMeasureUnits = function (iLengthUnit, iAngleUnit) {
            var model = this.mViewer.getModel();
            var units = {Length: iLengthUnit, Angle: iAngleUnit};
            model.setUserUnits(units);
            this.mMeasureOp.updateMeasureResults(units)
        };
        eDwMeasureMgr.prototype.getDistanceUnit = function () {
            return this.mViewer.getModel().getUserUnits().Length
        };
        eDwMeasureMgr.prototype.getAngleUnit = function () {
            return this.mViewer.getModel().getUserUnits().Angle
        };
        eDwMeasureMgr.prototype.getMeasureMode = function () {
            return this.mMeasureOp.getMeasureMode()
        };
        eDwMeasureMgr.prototype.setMeasureMode = function (iMode) {
            this.mMeasureOp.setMeasureMode(iMode)
        };
        eDwMeasureMgr.prototype.setPointToPointMode = function (iEnable) {
            console.log(`PLM eDwMeasureMgr.setPointToPointMode`)
            this.mMeasureOp.setPointToPointMode(iEnable)
        };
        eDwMeasureMgr.prototype.setMeasureDelta = function (iEnable) {
            this.mMeasureOp.setShowDelta(iEnable)
        };
        eDwMeasureMgr.prototype.removeMeasureEntityAt = function (idx) {
            this.mMeasureOp.removeMeasureEntityAt(idx)
        };
        eDwMeasureMgr.prototype.clearMeasureEntities = function () {
            this.mMeasureOp.clearMeasureEntities()
        };
        eDwMeasureMgr.prototype.highlightSelectEntityAt = function (idx) {
            console.log(`PLM eDwMeasureMgr.highlightSelectEntityAt`)
            this.mMeasureOp.highlightEntityTempAt(idx)
        };
        eDwMeasureMgr.prototype.dehighlightAllSelectEntity = function () {
            this.mMeasureOp.dehighlightAllTemporaryEntity()
        };
        eDwMeasureMgr.prototype.updateResults = function () {
            console.log(`PLM eDwMeasureMgr.updateResults`)
            this.mMeasureOp.updateMeasureResults(this.mViewer.getModel().getUserUnits())
        };
        return eDwMeasureMgr
    }();
    return eDwMeasureMgr
}));
define("eDwMeasureOperator", ["require", "exports", "eDwSelObj", "eDwBaseSelOperator", "eDwMeasureEntities", "eDwTypes", "hcutils", "utils"], (function (require, exports, eDwSelObj, eDwBaseSelOperator, eDwMeasureEntities, eDwTypes_2, hcutils_2, utils) {
    "use strict";
    var eDwMeasureOperator = function (_super) {
        __extends(eDwMeasureOperator, _super);

        function eDwMeasureOperator(iViewer, iMeasureMgr) {
            var _this = _super.call(this, iViewer, iViewer.SelectionMgr) || this;
            _this.mTempHighlightItem = null;
            _this.mOperatingLabel = false;
            _this.mSelObjs = [];
            _this.mMeasureMgr = iMeasureMgr;
            _this.mMarkupMgrHC = _this.Viewer.getHCMarkupManager();
            _this.mHighlightColor = new eDwTypes_2.HC.Color(72, 219, 251);
            _this.mMeasureEntities = new eDwMeasureEntities(_this.Viewer);
            var mkupId = _this.mMarkupMgrHC.registerMarkup(_this.mMeasureEntities);
            _this.mMeasureMgr.addMarkup(mkupId);
            _this.mMeasureMode = eDwTypes_2.EntityMode.ALL;
            return _this
        }

        eDwMeasureOperator.prototype.onActivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var mkupId, deltaButton, pickButton;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this)];
                        case 1:
                            _a.sent();
                            if (!this.mMeasureEntities) {
                                this.mMeasureEntities = new eDwMeasureEntities(this.Viewer);
                                mkupId = this.mMarkupMgrHC.registerMarkup(this.mMeasureEntities);
                                this.mMeasureMgr.addMarkup(mkupId)
                            }
                            this.Viewer.getHCView().setPointSize(2, eDwTypes_2.HC.PointSizeUnit.ScreenPixels);
                            this.pushHighlightSelectionState("NODE", false);
                            this.pushHighlightSelectionState("FACE", true);
                            this.pushHighlightSelectionState("EDGE", true);
                            this.pushHighlightSelectionState("VERTEX", true);
                            this.pushElementSelectionColor(hcutils_2.coerceFromHCColor(this.mHighlightColor));
                            this.pushElementSelectionOutlineColor(hcutils_2.coerceFromHCColor(this.mHighlightColor));
                            this.pushNodeSelectionColor(hcutils_2.coerceFromHCColor(this.mHighlightColor));
                            this.pushNodeSelectionOutlineColor(hcutils_2.coerceFromHCColor(this.mHighlightColor));
                            this.pushNodeSelectionHighlightMode("HighlightAndOutline");
                            this.pushElementSelectionHighlightMode("HighlightAndOutline");
                            deltaButton = $("#edrawings-measure-panel " + ".edrawings-measure-delta-button");
                            pickButton = $("#edrawings-measure-panel " + ".edrawings-measure-pickpoint-button");
                            eDwMeasureEntities.ShowDelta = deltaButton.hasClass("state-on-button");
                            eDwMeasureEntities.PointToPoint = pickButton.hasClass("state-on-button");
                            this.mMeasureEntities.updatePointToPoint(eDwMeasureEntities.PointToPoint);
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureOperator.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this)];
                        case 1:
                            _a.sent();
                            this.Viewer.getHCView().setPointSize(0, eDwTypes_2.HC.PointSizeUnit.ScreenPixels);
                            this.clearMeasureEntities();
                            this.mMeasureEntities = null;
                            this.mMeasureMgr.deleteMeasurements();
                            this.resetSelections();
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureOperator.prototype.onMouseMove = function (ioEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var pos, label, extSelObj, added, error_1;
                return __generator(this, (function (_a) {
                    // console.log('PLM Log：eDwMeasureOperator.onMouseMove')
                    switch (_a.label) {
                        case 0:
                            pos = ioEvent.getPosition();
                            if (this.mOperatingLabel) {
                                this.mMeasureEntities.onDragLabelMove(pos);
                                ioEvent.setHandled(true);
                                return [2]
                            }
                            this.dehighlightAllTemporaryEntity();
                            label = this.mMarkupMgrHC.pickMarkupItem(pos);
                            if (!label) return [3, 2];
                            return [4, this.mMeasureEntities.resetImmediateResults()];
                        case 1:
                            _a.sent();
                            this.resetTempHighlight();
                            return [2];
                        case 2:
                            if (!!this.CurrInputInfo) return [3, 8];
                            _a.label = 3;
                        case 3:
                            _a.trys.push([3, 6, , 7]);
                            return [4, this.Viewer.ViewMgr.pickFromPoint(ioEvent.getPosition(), this.getPickConfig())];
                        case 4:
                            extSelObj = _a.sent();
                            return [4, this.mMeasureEntities.addEntityImmediate(extSelObj)];
                        case 5:
                            added = _a.sent();
                            this.resetTempHighlight();
                            if (!extSelObj || !utils.isNumber(extSelObj.getNodeId())) {
                                return [2]
                            }
                            if (!l_isAllowedSelection(extSelObj, this.mMeasureMode)) {
                                return [2]
                            }
                            if (added && eDwMeasureEntities.highlightEntity(extSelObj, this.Viewer.getModel(), true)) {
                                this.mTempHighlightItem = extSelObj
                            } else {
                                this.mMarkupMgrHC.refreshMarkup()
                            }
                            return [3, 7];
                        case 6:
                            error_1 = _a.sent();
                            this.mMarkupMgrHC.refreshMarkup();
                            return [3, 7];
                        case 7:
                            this.mMarkupMgrHC.refreshMarkup();
                            return [2];
                        case 8:
                            return [4, _super.prototype.onMouseMove.call(this, ioEvent)];
                        case 9:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureOperator.prototype.onMouseDown = function (ioEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var pos, label;
                return __generator(this, (function (_a) {
                    console.log(`PLM Log：eDwMeasureOperator.onMouseDown:${_a.label}`)
                    switch (_a.label) {
                        case 0:
                            pos = ioEvent.getPosition();
                            label = this.mMarkupMgrHC.pickMarkupItem(pos);
                            if (!label) return [3, 2];
                            this.resetTempHighlight();
                            return [4, this.mMeasureEntities.resetImmediateResults()];
                        case 1:
                            _a.sent();
                            this.mOperatingLabel = true;
                            this.mMeasureEntities.onDragLabelStart(label, pos);
                            ioEvent.setHandled(true);
                            return [2];
                        case 2:
                            return [4, _super.prototype.onMouseDown.call(this, ioEvent)];
                        case 3:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureOperator.prototype.onMouseUp = function (ioEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var extSelObj, idx, isAdded;
                return __generator(this, (function (_a) {
                    console.log(`PLM Log：eDwMeasureOperator.onMouseUp:${_a.label}`)
                    switch (_a.label) {
                        case 0:
                            if (this.mOperatingLabel) {
                                this.mOperatingLabel = false;
                                this.mMeasureEntities.onDragLabelEnd(ioEvent.getPosition());
                                ioEvent.setHandled(true);
                                return [2]
                            }
                            this.resetTempHighlight();
                            if (!(this.ActiveMouseButton === "left" && !this.isDragging())) return [3, 5];
                            return [4, this.Viewer.ViewMgr.pickFromPoint(ioEvent.getPosition(), this.getPickConfig())];
                        case 1:
                            extSelObj = _a.sent();
                            extSelObj_g = extSelObj;//plm Test
                            idx = this.mMeasureEntities.isItemSelected(extSelObj);
                            if (!(!eDwMeasureEntities.PointToPoint && utils.isNumber(idx))) return [3, 3];
                            return [4, this.mMeasureEntities.removeEntityAtIndex(idx)];
                        case 2:
                            _a.sent();
                            return [2];
                        case 3:
                            if (!l_isAllowedSelection(extSelObj, this.mMeasureMode)) {
                                return [2]
                            }
                            return [4, this.mMeasureEntities.addEntity(extSelObj)];
                        case 4:
                            isAdded = _a.sent();
                            if (isAdded) {
                                this.highlightMeasuringItem(extSelObj)
                            } else {
                                this.dehighlightMeasuringItems()
                            }
                            ioEvent.setHandled(true);
                            _a.label = 5;
                        case 5:
                            _super.prototype.onMouseUp.call(this, ioEvent);
                            return [2]
                    }
                }))
            }))
        };
        eDwMeasureOperator.prototype.updateMeasureResults = function (iUserUnits) {
            this.mMeasureEntities.setMeasureUnit(iUserUnits)
        };
        eDwMeasureOperator.prototype.removeMeasureEntityAt = function (iIdx) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var theRemoved, idx;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.mMeasureEntities.removeEntityAtIndex(iIdx)];
                            case 1:
                                theRemoved = _a.sent();
                                if (theRemoved) {
                                    idx = this.mSelObjs.indexOf(theRemoved);
                                    if (utils.isNumber(idx) && idx > -1) {
                                        this.mSelObjs.splice(idx, 1)
                                    }
                                }
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwMeasureOperator.prototype.clearMeasureEntities = function () {
            this.mMeasureEntities.reset()
        };
        eDwMeasureOperator.prototype.highlightEntityTempAt = function (idx) {
            this.mMeasureEntities.highlightTemporaryEntityAt(idx)
        };
        eDwMeasureOperator.prototype.dehighlightAllTemporaryEntity = function () {
            this.mMeasureEntities.dehighlightAllTemporaryEntity();
            this.resetTempHighlight()
        };
        eDwMeasureOperator.prototype.getMeasureMode = function () {
            return this.mMeasureMode
        };
        eDwMeasureOperator.prototype.setMeasureMode = function (iMode) {
            this.mMeasureMode = iMode
        };
        eDwMeasureOperator.prototype.setPointToPointMode = function (iEnable) {
            this.mMeasureEntities.updatePointToPoint(iEnable)
        };
        eDwMeasureOperator.prototype.setShowDelta = function (iEnable) {
            this.mMeasureEntities.updateDelta(iEnable)
        };
        eDwMeasureOperator.prototype.highlightMeasuringItem = function (iSelObj) {
            this.mSelObjs.push(iSelObj);
            this.Viewer.HCViewer.selectionManager.add(iSelObj)
        };
        eDwMeasureOperator.prototype.dehighlightMeasuringItems = function () {
            this.mSelObjs = [];
            this.Viewer.HCViewer.selectionManager.clear()
        };
        eDwMeasureOperator.prototype.removeMeasuringItemTempHighlight = function () {
            var e_9, _a;
            try {
                for (var _b = __values(this.mSelObjs), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var selObj = _c.value;
                    eDwMeasureEntities.highlightEntity(selObj, this.Viewer.getModel(), false)
                }
            } catch (e_9_1) {
                e_9 = {error: e_9_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_9) throw e_9.error
                }
            }
        };
        eDwMeasureOperator.prototype.resetTempHighlight = function () {
            eDwMeasureEntities.highlightEntity(this.mTempHighlightItem, this.Viewer.getModel(), false);
            this.removeMeasuringItemTempHighlight()
        };
        eDwMeasureOperator.prototype.resetSelections = function () {
            this.Viewer.HCViewer.selectionManager.clear()
        };
        eDwMeasureOperator.prototype.getPickConfig = function () {
            var pickConfig = new eDwTypes_2.HC.PickConfig(eDwTypes_2.HC.SelectionMask.None);
            pickConfig.allowPoints = this.mMeasureMode & eDwTypes_2.EntityMode.VERTEX ? true : false;
            pickConfig.allowLines = this.mMeasureMode & eDwTypes_2.EntityMode.EDGE ? true : false;
            pickConfig.allowFaces = this.mMeasureMode & eDwTypes_2.EntityMode.FACE ? true : false;
            return pickConfig
        };
        return eDwMeasureOperator
    }(eDwBaseSelOperator);

    function l_isAllowedSelection(iSelObj, iMeasureMode) {
        if (iSelObj && iSelObj.getSelectionType() === eDwTypes_2.HC.SelectionType.None) {
            return true
        }
        var subEntityInfo = eDwSelObj.getSubEntityInfo(iSelObj);
        if (subEntityInfo && subEntityInfo.SubEntity && subEntityInfo.IsSelectable && (iSelObj.getPointEntity() && iMeasureMode & eDwTypes_2.EntityMode.VERTEX) || iSelObj.getLineEntity() && iMeasureMode & eDwTypes_2.EntityMode.EDGE || iSelObj.getFaceEntity() && iMeasureMode & eDwTypes_2.EntityMode.FACE) {
            return true
        }
        return false
    }

    return eDwMeasureOperator
}));
define("eDwMeasureTypes", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true})
}));
define("eDwUIMeasureHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator", "eDwSelObj", "eDwMeasureEntities", "eDwUILocalize"], (function (require, exports, eDwUIHTMLGenerator_1, eDwSelObj, eDwMeasureEntities, eDwUILocalize_2) {
    "use strict";
    var eDwUIMeasureHTMLGenerator = function (_super) {
        __extends(eDwUIMeasureHTMLGenerator, _super);

        function eDwUIMeasureHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUIMeasureHTMLGenerator.prototype.setMeasureResult = function (iMeasureResult) {
            this.mMeasureResult = iMeasureResult
        };
        eDwUIMeasureHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML, modelHC, numFaces, numCurves, numPnts, i, selObjHC, nodeIDHC, subEntityInfo,
                    subEntityID, userVisEntCategory, entityIndex, highlight, _a, desc, status_1;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            generatedHTML = "";
                            modelHC = this.mViewer.getModel().getHCModel();
                            numFaces = 0, numCurves = 0, numPnts = 0;
                            i = 0;
                            _b.label = 1;
                        case 1:
                            if (!(i < this.mMeasureResult.SelObjs.length)) return [3, 11];
                            selObjHC = this.mMeasureResult.SelObjs[i];
                            nodeIDHC = selObjHC.getNodeId();
                            subEntityInfo = eDwSelObj.getSubEntityInfo(selObjHC);
                            subEntityID = eDwSelObj.getSubEntityID(subEntityInfo.SubEntity);
                            userVisEntCategory = eDwUILocalize_2.eDwUILocalize.getString("Strings.Point");
                            entityIndex = 0;
                            highlight = false;
                            _a = subEntityInfo.SubEntityTypeName;
                            switch (_a) {
                                case"Face":
                                    return [3, 2];
                                case"Line":
                                    return [3, 4];
                                case"Point":
                                    return [3, 6]
                            }
                            return [3, 8];
                        case 2:
                            entityIndex = numFaces++;
                            userVisEntCategory = eDwUILocalize_2.eDwUILocalize.getString("Strings.Surface");
                            return [4, modelHC.getNodeFaceHighlighted(nodeIDHC, subEntityID)];
                        case 3:
                            highlight = _b.sent();
                            return [3, 9];
                        case 4:
                            entityIndex = numCurves++;
                            userVisEntCategory = eDwUILocalize_2.eDwUILocalize.getString("Strings.Curve");
                            return [4, modelHC.getNodeLineHighlighted(nodeIDHC, subEntityID)];
                        case 5:
                            highlight = _b.sent();
                            return [3, 9];
                        case 6:
                            entityIndex = numPnts++;
                            return [4, modelHC.getNodePointHighlighted(nodeIDHC, subEntityID)];
                        case 7:
                            highlight = _b.sent();
                            return [3, 9];
                        case 8:
                            return [3, 10];
                        case 9:
                            desc = this.mMeasureResult.Descriptions[i];
                            if (!desc) desc = "";
                            if (eDwMeasureEntities.PointToPoint) {
                                userVisEntCategory = eDwUILocalize_2.eDwUILocalize.getString("Strings.Point");
                                entityIndex = i + 1;
                                desc = "\n" + desc
                            }
                            status_1 = highlight ? " edrawings-list-selected" : "";
                            generatedHTML += "<div class='edrawings-measure-entities-list-item" + status_1 + "' index='" + i + "'>" + "<div class='edrawings-measure-entities-info'>" + "<span class='edrawings-measure-entities-type'>" + userVisEntCategory + "-" + entityIndex + " </span>" + "<span class='edrawings-measure-entities-type'>" + desc + "</span></div>" + "<div class='edrawings-measure-entities-remove " + "edrawings-close-icon'></div></div>";
                            _b.label = 10;
                        case 10:
                            ++i;
                            return [3, 1];
                        case 11:
                            return [2, generatedHTML]
                    }
                }))
            }))
        };
        return eDwUIMeasureHTMLGenerator
    }(eDwUIHTMLGenerator_1.eDwUINodeHTMLGenerator);
    return eDwUIMeasureHTMLGenerator
}));
define("eDwUIMeasurePlugin", ["require", "exports", "eDwEventMgr", "eDwKeyMgr", "eDwUIUtils", "eDwMeasureMgr", "eDwUIMeasureHTMLGenerator", "eDwTypes", "eDwUIBasePlugin", "eDwEvents", "eDwMeasureEvents", "eDwUIShortcutMenu"], (function (require, exports, eDwEventMgr, eDwKeyMgr_1, eDwUIUtils, eDwMeasureMgr, eDwUIMeasureHTMLGenerator, eDwTypes_3, eDwUIBasePlugin_1, eDwEvents_2, eDwMeasureEvents_2, eDwUIShortcutMenu_1) {
    "use strict";
    var eDwUIMeasurePlugin = function (_super) {
        __extends(eDwUIMeasurePlugin, _super);

        function eDwUIMeasurePlugin(iViewer, iViewerFeatOpts) {
            var _this = this;
            var buttonInfo = {ID: "#edrawings-button-measure"};
            _this = _super.call(this, "Measure", iViewer, buttonInfo, iViewerFeatOpts) || this;
            _this.initPluginButton();
            return _this
        }

        eDwUIMeasurePlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var panelsToLoad, value, measureButton;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mMeasureMgr = new eDwMeasureMgr(this.mViewer);
                            panelsToLoad = [{ID: c_measurePanelID, HTML: "measurepanel.html"}];
                            return [4, _super.prototype.init.call(this, panelsToLoad)];
                        case 1:
                            _a.sent();
                            value = this.mViewer.getModel().getProperty("measure");
                            eDwUIUtils.hide("#edrawings-button-measure", false);
                            measureButton = $("#edrawings-button-measure");
                            measureButton[value === "true" ? "removeClass" : "addClass"]("edrawings-disabled-button");
                            eDwUIUtils.setUIGenerator(c_measurePanelID, new eDwUIMeasureHTMLGenerator(this.mViewer, c_measurePanelID));
                            return [2]
                    }
                }))
            }))
        };
        eDwUIMeasurePlugin.prototype.onClick = function (iActivate) {
            _super.prototype.onClick.call(this, iActivate);
            if (iActivate) {
                eDwUIUtils.activateUI(this.PluginButtonID, c_measurePanelID)
            }
        };
        eDwUIMeasurePlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentActivated, shortcutMenu, selectorName, eventMgr;
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this, iButtonJQ)];
                        case 1:
                            parentActivated = _a.sent();
                            if (!parentActivated) return [2, false];
                            eDwUIUtils.addPanelModeEvents(c_measurePanelID, c_eventIDSuffix, "#" + iButtonJQ.attr("id"));
                            shortcutMenu = eDwUIShortcutMenu_1.eDwUIShortcutMenu.get();
                            if (!shortcutMenu.isEmpty()) {
                                shortcutMenu.addMenuSeparator(this.PluginClassName)
                            }
                            shortcutMenu.addMenuItem(this.PluginClassName, "Strings.Remove", (function (iEvent, iUIItemJQ, iArg) {
                                var selMeasureItem = $(c_measurePanelID + " .edrawings-list-selected");
                                if (selMeasureItem) {
                                    var indexStr = selMeasureItem.attr("index");
                                    if (indexStr) {
                                        var index = parseInt(indexStr);
                                        _this.mMeasureMgr.removeMeasureEntityAt(index)
                                    }
                                }
                                eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide()
                            }));
                            shortcutMenu.addMenuItem(this.PluginClassName, "Strings.Clear", (function (iEvent, iUIItemJQ, iArg) {
                                _this.mMeasureMgr.clearMeasureEntities();
                                _this.mMeasureMgr.dehighlightAllSelectEntity();
                                eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide()
                            }));
                            selectorName = c_measurePanelID + " .edrawings-measure-entities-list-item";
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(selectorName, "click", (function (iEvent) {
                                var targetJQ = $(iEvent.target);
                                if (!targetJQ || !targetJQ.length) return;
                                eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide();
                                _this.updateMeasureSelection(targetJQ[0], selectorName)
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(selectorName, "mousedown", (function (iEvent) {
                                var eventJQ = iEvent;
                                if (!eDwKeyMgr_1.eDwKeyMgr.isRMBPressed(eventJQ)) {
                                    return
                                }
                                _this.updateMeasureSelection(eventJQ.target, selectorName);
                                (function () {
                                    return __awaiter(_this, void 0, void 0, (function () {
                                        var screenPos;
                                        return __generator(this, (function (_a) {
                                            switch (_a.label) {
                                                case 0:
                                                    screenPos = new eDwTypes_3.HC.Point2(eventJQ.clientX, eventJQ.clientY);
                                                    return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.RightClickEvent, this.mViewer, screenPos, null, this.PluginClassName)];
                                                case 1:
                                                    _a.sent();
                                                    return [2]
                                            }
                                        }))
                                    }))
                                })()
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_measurePanelID + " .edrawings-measure-entities-remove", "click", (function (iEvent) {
                                var targetJQ = $(iEvent.target);
                                var idxStr = targetJQ.parent().attr("index");
                                if (!idxStr) return;
                                var idx = parseInt(idxStr, 10);
                                _this.mMeasureMgr.removeMeasureEntityAt(idx)
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_measurePanelID + " .measure-filter-button", "click", (function (iEvent) {
                                var target = $(iEvent.target);
                                if (target.hasClass("state-on-button")) {
                                    target.removeClass("state-on-button")
                                } else {
                                    target.addClass("state-on-button")
                                }
                                _this.mMeasureMgr.setMeasureMode(l_getCurrentMeasureMode())
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_measurePanelID + " .edrawings-measure-delta-button", "click", (function (iEvent) {
                                var target = $(iEvent.target);
                                _this.mMeasureMgr.setMeasureDelta(!target.hasClass("state-on-button"));
                                target.toggleClass("state-on-button")
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_measurePanelID + " .edrawings-measure-pickpoint-button", "click", (function (iEvent) {
                                var target = $(iEvent.target);
                                var isSelected = target.hasClass("state-on-button");
                                _this.mMeasureMgr.setPointToPointMode(!isSelected);
                                target.toggleClass("state-on-button")
                            }));
                            this.mUIHTMLEventMgr.addDelegatedEventHandler(c_measurePanelID + " .measure-unit-selector", "change", (function (iEvent) {
                                var lengthUnit = $("#edrawings-measure-distant-unit").val();
                                var angleUnit = $("#edrawings-measure-angle-unit").val();
                                _this.mMeasureMgr.setMeasureUnits(lengthUnit, angleUnit)
                            }));
                            eventMgr = eDwEventMgr.get();
                            eventMgr.addEventHandlerFunc(eDwMeasureEvents_2.MeasurementRefreshEvent, l_onMeasurementRefresh);
                            eventMgr.addEventHandlerFunc(eDwMeasureEvents_2.MeasurementSelectionEvent, l_onMeasurementSelected);
                            eventMgr.addEventHandlerFunc(eDwMeasureEvents_2.MeasurementDeselectAllEvent, l_onMeasurementDeselectAll);
                            this.addAppObjEvent(eDwEvents_2.ModelViewChangeEvent, "onModelViewChange", true);
                            this.mMeasureMgr.activateMeasure(this.mMeasureMgr.getMeasureMode());
                            l_syncMeasureModeUI(this.mMeasureMgr, this.mViewer.getModel().getUserUnits());
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIMeasurePlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                var parentDeactivated, shortcutMenu, eventMgr;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this, iButtonJQ)];
                        case 1:
                            parentDeactivated = _a.sent();
                            if (!parentDeactivated) return [2, false];
                            eDwUIUtils.deactivateMoveInput(c_eventIDSuffix);
                            this.mMeasureMgr.deactivateMeasure();
                            shortcutMenu = eDwUIShortcutMenu_1.eDwUIShortcutMenu.get();
                            shortcutMenu.removeAllMenuItems(this.PluginClassName);
                            this.mUIHTMLEventMgr.removeAllEventHandlers();
                            eventMgr = eDwEventMgr.get();
                            eventMgr.removeEventHandlerFunc(eDwMeasureEvents_2.MeasurementRefreshEvent, "l_onMeasurementRefresh");
                            eventMgr.removeEventHandlerFunc(eDwMeasureEvents_2.MeasurementSelectionEvent, "l_onMeasurementSelected");
                            eventMgr.removeEventHandlerFunc(eDwMeasureEvents_2.MeasurementDeselectAllEvent, "l_onMeasurementDeselectAll");
                            this.addAppObjEvent(eDwEvents_2.ModelViewChangeEvent, "onModelViewChange", false);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwUIMeasurePlugin.prototype.onModelViewChange = function (iViewer, iPrevModelView, iCurrModelView, iIsAssembly) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    this.mMeasureMgr.dehighlightAllSelectEntity();
                    this.mMeasureMgr.clearMeasureEntities();
                    return [2]
                }))
            }))
        };
        eDwUIMeasurePlugin.prototype.localize = function (iElem) {
            this.mMeasureMgr.updateResults();
            _super.prototype.localize.call(this, iElem)
        };
        eDwUIMeasurePlugin.prototype.updateMeasureSelection = function (iTarget, iSelectorName) {
            var targetJQ = $(iTarget);
            var idxStr = targetJQ.attr("index");
            if (!idxStr) return;
            var idx = parseInt(idxStr, 10);
            var measureMgr = this.mMeasureMgr;
            $(iSelectorName).removeClass("edrawings-list-selected");
            measureMgr.dehighlightAllSelectEntity();
            targetJQ.addClass("edrawings-list-selected");
            measureMgr.highlightSelectEntityAt(idx)
        };
        return eDwUIMeasurePlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    var c_measurePanelID = "#edrawings-measure-panel";
    var c_eventIDSuffix = ".edw.measure";

    function l_onMeasurementDeselectAll() {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                $(".edrawings-measure-entities-list-item").removeClass("edrawings-list-selected");
                return [2]
            }))
        }))
    }

    function l_onMeasurementSelected(iSelListIndex) {
        return __awaiter(this, void 0, void 0, (function () {
            var selector, itemJQ;
            return __generator(this, (function (_a) {
                selector = '.edrawings-measure-entities-list-item[index="' + iSelListIndex + '"]';
                itemJQ = $(selector);
                if (itemJQ.length && !itemJQ.hasClass("edrawings-list-selected")) {
                    eDwUIUtils.scrollToTarget(itemJQ, "fast")
                }
                $(".edrawings-measure-entities-list-item").removeClass("edrawings-list-selected");
                itemJQ.addClass("edrawings-list-selected");
                return [2]
            }))
        }))
    }

    function l_onMeasurementRefresh(iMeasureResult) {
        return __awaiter(this, void 0, void 0, (function () {
            var list, gen, _a, _b;
            return __generator(this, (function (_c) {
                switch (_c.label) {
                    case 0:
                        list = $("#edrawings-measure-submenu-list");
                        $("#edrawings-measure-result").text("");
                        list.empty();
                        $("#edrawings-measure-result").text(iMeasureResult.Message);
                        gen = eDwUIUtils.getUIGenerator(c_measurePanelID);
                        gen.setMeasureResult(iMeasureResult);
                        _b = (_a = list).append;
                        return [4, gen.generateHTML("")];
                    case 1:
                        _b.apply(_a, [_c.sent()]);
                        eDwUIUtils.fixMenuPanelInwardToolbar($(c_measurePanelID));
                        return [2]
                }
            }))
        }))
    }

    function l_getCurrentMeasureMode() {
        var vertexEnabled = eDwUIUtils.isStateOn("#edrawings-measure-vertex-button") ? eDwTypes_3.EntityMode.VERTEX : 0;
        var edgeEnabled = eDwUIUtils.isStateOn("#edrawings-measure-edge-button") ? eDwTypes_3.EntityMode.EDGE : 0;
        var faceEnabled = eDwUIUtils.isStateOn("#edrawings-measure-face-button") ? eDwTypes_3.EntityMode.FACE : 0;
        var holeEnabled = eDwUIUtils.isStateOn("#edrawings-measure-hole-button") ? eDwTypes_3.EntityMode.HOLE : 0;
        return vertexEnabled | edgeEnabled | faceEnabled | holeEnabled
    }

    function l_syncMeasureModeUI(iMeasureMgr, iUserUnits) {
        function setMeasureButton(iID, iMeasureModes, iTargetModes) {
            var method = iMeasureModes & iTargetModes ? "addClass" : "removeClass";
            $(iID)[method]("state-on-button")
        }

        $("#edrawings-measure-distant-unit").val(iUserUnits.Length);
        $("#edrawings-measure-angle-unit").val(iUserUnits.Angle);
        var measureMode = iMeasureMgr.getMeasureMode();
        setMeasureButton("#edrawings-measure-vertex-button", measureMode, eDwTypes_3.EntityMode.VERTEX);
        setMeasureButton("#edrawings-measure-edge-button", measureMode, eDwTypes_3.EntityMode.EDGE);
        setMeasureButton("#edrawings-measure-face-button", measureMode, eDwTypes_3.EntityMode.FACE)
    }

    return eDwUIMeasurePlugin
}));

// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.
var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {
    function adopt(value) {
        return value instanceof P ? value : new P((function (resolve) {
            resolve(value)
        }))
    }

    return new (P || (P = Promise))((function (resolve, reject) {
        function fulfilled(value) {
            try {
                step(generator.next(value))
            } catch (e) {
                reject(e)
            }
        }

        function rejected(value) {
            try {
                step(generator["throw"](value))
            } catch (e) {
                reject(e)
            }
        }

        function step(result) {
            result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected)
        }

        step((generator = generator.apply(thisArg, _arguments || [])).next())
    }))
};
var __generator = this && this.__generator || function (thisArg, body) {
    var _ = {
        label: 0, sent: function () {
            if (t[0] & 1) throw t[1];
            return t[1]
        }, trys: [], ops: []
    }, f, y, t, g;
    return g = {
        next: verb(0),
        throw: verb(1),
        return: verb(2)
    }, typeof Symbol === "function" && (g[Symbol.iterator] = function () {
        return this
    }), g;

    function verb(n) {
        return function (v) {
            return step([n, v])
        }
    }

    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0:
                case 1:
                    t = op;
                    break;
                case 4:
                    _.label++;
                    return {value: op[1], done: false};
                case 5:
                    _.label++;
                    y = op[1];
                    op = [0];
                    continue;
                case 7:
                    op = _.ops.pop();
                    _.trys.pop();
                    continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                        _ = 0;
                        continue
                    }
                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {
                        _.label = op[1];
                        break
                    }
                    if (op[0] === 6 && _.label < t[1]) {
                        _.label = t[1];
                        t = op;
                        break
                    }
                    if (t && _.label < t[2]) {
                        _.label = t[2];
                        _.ops.push(op);
                        break
                    }
                    if (t[2]) _.ops.pop();
                    _.trys.pop();
                    continue
            }
            op = body.call(thisArg, _)
        } catch (e) {
            op = [6, e];
            y = 0
        } finally {
            f = t = 0
        }
        if (op[0] & 5) throw op[1];
        return {value: op[0] ? op[1] : void 0, done: true}
    }
};
var __values = this && this.__values || function (o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return {value: o && o[i++], done: !o}
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.")
};
var __extends = this && this.__extends || function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf || {__proto__: []} instanceof Array && function (d, b) {
            d.__proto__ = b
        } || function (d, b) {
            for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]
        };
        return extendStatics(d, b)
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);

        function __() {
            this.constructor = d
        }

        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __)
    }
}();
var __read = this && this.__read || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value)
    } catch (error) {
        e = {error: error}
    } finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i)
        } finally {
            if (e) throw e.error
        }
    }
    return ar
};
var __spreadArray = this && this.__spreadArray || function (to, from) {
    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];
    return to
};
define("color", ["require", "exports", "utils"], (function (require, exports, utils_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.cDefaultColor = exports.Color = void 0;
    var Color = function () {
        function Color(iRed, iGreen, iBlue, iAlpha) {
            if (iAlpha === void 0) {
                iAlpha = 255
            }
            this.mRed = NaN;
            this.mGreen = NaN;
            this.mBlue = NaN;
            this.mAlpha = NaN;
            this.mIsValid = false;
            this.setColor(iRed, iGreen, iBlue, iAlpha)
        }

        Color.prototype.copy = function () {
            return new Color(this.r, this.g, this.b, this.a)
        };
        Color.prototype.isValid = function () {
            return this.mIsValid
        };
        Color.prototype.isOpaque = function () {
            return this.mAlpha === 255
        };
        Color.prototype.toggleOpacity = function () {
            if (this.mIsValid) {
                this.mAlpha = this.isOpaque() ? 128 : 255
            }
        };
        Color.create = function (iColorNum) {
            var isValid = isNaN(iColorNum) || iColorNum > 4294967295 ? false : true;
            var red = isValid ? iColorNum & 255 : NaN;
            var green = isValid ? (iColorNum & 65280) >> 8 : NaN;
            var blue = isValid ? (iColorNum & 16711680) >> 16 : NaN;
            var alpha = isValid ? (iColorNum & 4278190080) >> 24 : NaN;
            return new Color(red, green, blue, alpha)
        };
        Color.normalize = function (iColor) {
            var isValid = iColor && iColor.isValid();
            var red = isValid ? iColor.r / 255 : NaN;
            var green = isValid ? iColor.g / 255 : NaN;
            var blue = isValid ? iColor.b / 255 : NaN;
            var alpha = isValid ? iColor.a / 255 : NaN;
            return new Color(red, green, blue, alpha)
        };
        Color.prototype.setColor = function (iRed, iGreen, iBlue, iAlpha) {
            if (Color.isValidRange(iRed) && Color.isValidRange(iGreen) && Color.isValidRange(iBlue) && Color.isValidRange(iAlpha)) {
                this.mRed = iRed;
                this.mGreen = iGreen;
                this.mBlue = iBlue;
                this.mAlpha = iAlpha
            }
            this.mIsValid = utils_1.isNumber(this.mRed) && utils_1.isNumber(this.mGreen) && utils_1.isNumber(this.mBlue) && utils_1.isNumber(this.mAlpha)
        };
        Color.isValidRange = function (iNum) {
            return iNum >= 0 && iNum <= 255 ? true : false
        };
        Object.defineProperty(Color.prototype, "r", {
            get: function () {
                return this.mRed
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(Color.prototype, "g", {
            get: function () {
                return this.mGreen
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(Color.prototype, "b", {
            get: function () {
                return this.mBlue
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(Color.prototype, "a", {
            get: function () {
                return this.mAlpha
            }, set: function (iAlpha) {
                this.setColor(this.mRed, this.mGreen, this.mBlue, iAlpha)
            }, enumerable: false, configurable: true
        });
        return Color
    }();
    exports.Color = Color;
    exports.cDefaultColor = new Color(128, 128, 128)
}));

console.assert(!console.debugLog);
console.debugLog = function (iCategory, iMsg) {
    var iParams = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        iParams[_i - 2] = arguments[_i]
    }
    if (!console.debugLogCategories) {
        console.debugLogCategories = []
    }
    if (!console.excludeDebugLogCategories) {
        console.excludeDebugLogCategories = []
    }
    if (console.excludeDebugLogCategories.indexOf(iCategory) > -1) {
        return
    }
    var augmentedMsg = iMsg;
    var stack = (new Error).stack;
    if (stack) {
        var stackLine = stack.split("\n")[2];
        if (!stackLine) return;
        var callerLine = stackLine.slice(stackLine.lastIndexOf("("), stackLine.lastIndexOf(")") + 1);
        if (!callerLine) {
            callerLine = stackLine.slice(stackLine.lastIndexOf("@") + 1);
            callerLine = "(" + callerLine + ")"
        }
        augmentedMsg = callerLine + " " + iMsg
    }
    if (console.debugLogCategories.indexOf(iCategory) > -1 || console.debugLogCategories.indexOf("*") > -1) {
        if (iParams && iParams.length) console.log(augmentedMsg, iParams); else console.log(augmentedMsg)
    }
};


define("eDrawingsWebViewer", ["require", "exports", "eDwUI", "eDwServiceMgr", "eDwUIMessageReporter", "eDrawingsWebViewerUtils", "utils", "eDwUIUtils"], (function (require, exports, eDwUI_1, eDwServiceMgr, eDwUIMessageReporter, eDrawingsWebViewerUtils, Utils, eDwUIUtils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.start = void 0;
    function start(iViewerOpts, iServerURL) {
        eDrawingsWebViewerUtils.startViewer(iServerURL || c_server, "edrawings-canvas", iViewerOpts, l_init, eDwUIMessageReporter.showResultPanel)
    }

    exports.start = start;

    function l_init(ioViewerOpts, iContainerElemID) {
        c_eDrawingsUI.initUIEvents(ioViewerOpts);

        var modelContents = window.modelContents_g;//PLM Test

        if (modelContents !== "<!-- SC_MODEL_DATA" + " -->") {
            eDwServiceMgr.get().disableAdvancedServices();
            ioViewerOpts.URL = "";
            eDwUIUtils.viewFile("1", null, ioViewerOpts, iContainerElemID, Utils.getUint8Array(modelContents))
        }
    }

    var c_eDrawingsUI = new eDwUI_1.eDwUI;
    var c_server = location.origin + location.pathname.slice(0, location.pathname.lastIndexOf("/") + 1)
}));
define("eDrawingsWebViewerUtils", ["require", "exports", "eDwEventMgr", "eDwServiceMgr", "eDwResultError", "eDwAJAXError", "eDwUIPluginMgr", "eDwTypes", "eDwEvents", "eDwUIUtils", "utils", "eDwUILocalize"], (function (require, exports, eDwEventMgr, eDwServiceMgr, eDwResultError, eDwAJAXError, eDwUIPluginMgr, eDwTypes_1, eDwEvents_1, eDwUIUtils, utils, eDwUILocalize_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.removeModelStreamCache = exports.shutdownViewer = exports.startViewer = exports.getViewerVersion = void 0;

    function getViewerVersion() {
        return "31.2.0.0035"
    }

    exports.getViewerVersion = getViewerVersion;

    function startViewer(iServerURL, iCanvasID, iViewerOpts, iInit, iOnError) {
        var _this = this;
        l_ModelLoadEvents = function (iState) {
            var viewerCanvasID = "#" + iCanvasID;
            if (iState === "init") {
                var viewerJQ = $(viewerCanvasID);
                viewerJQ.on("edw:ModelLoaded", (function (iEvent, iViewer) {
                    var viewHC = iViewer.getHCView();
                    viewHC.setPointSize(0, eDwTypes_1.HC.PointSizeUnit.ScreenPixels);
                    viewHC.setHardEdgesEnabled(false);
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            var iExcp_1;
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        _a.trys.push([0, 2, , 3]);
                                        return [4, l_processProductStructure(iViewer, iServerURL)];
                                    case 1:
                                        _a.sent();
                                        return [3, 3];
                                    case 2:
                                        iExcp_1 = _a.sent();
                                        l_displayError(iExcp_1, iOnError);
                                        return [3, 3];
                                    case 3:
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }));
                viewerJQ.on("edw:ModelLoadFailed", (function (iEvent, iViewer, iModelName, iReason) {
                    if (iOnError) {
                        iOnError({ErrorCode: "ModelLoadInViewerFailed", ErrorData: [iReason, iModelName]})
                    }
                }))
            } else {
                var viewerJQ = $(viewerCanvasID);
                viewerJQ.off("edw:ModelLoaded");
                viewerJQ.off("edw:ModelLoadFailed")
            }
        };
        var viewerFeatOpts = {};
        $.extend(viewerFeatOpts, c_featOps);
        if (iViewerOpts) {
            $.extend(viewerFeatOpts, iViewerOpts)
        } else {
            eDwUIUtils.getRequestedQueryStringParams(location.href, viewerFeatOpts)
        }
        if (viewerFeatOpts.Debug) {
            if (!console.debugLogCategories || console.debugLogCategories.length === 0) {
                console.debugLogCategories = [];
                var categories = "*";
                if (typeof viewerFeatOpts.Debug === "string") {
                    categories = viewerFeatOpts.Debug
                }
                console.debugLogCategories.push(categories)
            }
        }
        eDwServiceMgr.create(iServerURL);
        (function () {
            return __awaiter(_this, void 0, void 0, (function () {
                var iExcp_2;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            _a.trys.push([0, 2, , 3]);
                            l_ModelLoadEvents("init");
                            return [4, l_init(iCanvasID, viewerFeatOpts, iInit)];
                        case 1:
                            _a.sent();
                            return [3, 3];
                        case 2:
                            iExcp_2 = _a.sent();
                            l_displayError(iExcp_2, iOnError);
                            return [3, 3];
                        case 3:
                            return [2]
                    }
                }))
            }))
        })()
    }

    exports.startViewer = startViewer;

    function shutdownViewer(iViewer) {
        l_ModelLoadEvents("shutdown");
        iViewer.unregister()
    }

    exports.shutdownViewer = shutdownViewer;

    function removeModelStreamCache(iViewer, iServer) {
        return __awaiter(this, void 0, void 0, (function () {
            var modelKey, serviceMgr, iExcp_3;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        modelKey = iViewer.getCurrModelKey();
                        if (!modelKey || !iViewer.ViewerFeatureOpts.DeleteModelCacheFileWhenDone) {
                            return [2]
                        }
                        console.debugLog("ModelLoad", "Attempting to remove cached model: " + modelKey);
                        serviceMgr = eDwServiceMgr.get();
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4, serviceMgr.removeNamedCache(modelKey, iViewer.ViewerFeatureOpts.DeleteModelCacheFileWhenDone)];
                    case 2:
                        _a.sent();
                        console.debugLog("ModelLoad", "Removed cached model: " + modelKey);
                        return [3, 4];
                    case 3:
                        iExcp_3 = _a.sent();
                        console.debugLog("ModelLoad", "Failed to remove cached model: " + modelKey);
                        console.debugLog("ModelLoad", iExcp_3.message);
                        throw iExcp_3;
                    case 4:
                        return [2]
                }
            }))
        }))
    }

    exports.removeModelStreamCache = removeModelStreamCache;

    function l_init(iContainerElemID, ioViewerOpts, iInit) {
        return __awaiter(this, void 0, void 0, (function () {
            var serviceMgr, earlyPluginClassNames, pluginFileNames, pluginFileNames_1, pluginFileNames_1_1,
                pluginFileName, pluginClassName, e_1_1;
            var e_1, _a;
            return __generator(this, (function (_b) {
                switch (_b.label) {
                    case 0:
                        serviceMgr = eDwServiceMgr.get();
                        serviceMgr.disableAdvancedServices(!ioViewerOpts.Debug && utils.getExtension(ioViewerOpts.URL) === "scs");
                        return [4, eDwUILocalize_1.eDwUILocalize.initialize(ioViewerOpts.Locale)];
                    case 1:
                        _b.sent();
                        earlyPluginClassNames = [];
                        return [4, serviceMgr.getPluginFiles()];
                    case 2:
                        pluginFileNames = _b.sent();
                        _b.label = 3;
                    case 3:
                        _b.trys.push([3, 8, 9, 10]);
                        pluginFileNames_1 = __values(pluginFileNames), pluginFileNames_1_1 = pluginFileNames_1.next();
                        _b.label = 4;
                    case 4:
                        if (!!pluginFileNames_1_1.done) return [3, 7];
                        pluginFileName = pluginFileNames_1_1.value;
                        if (!pluginFileName.match(/.*EarlyLoad.*Plugin.*\.js/i)) return [3, 6];
                        return [4, serviceMgr.importPlugin(pluginFileName)];
                    case 5:
                        pluginClassName = _b.sent();
                        earlyPluginClassNames.push(pluginClassName);
                        _b.label = 6;
                    case 6:
                        pluginFileNames_1_1 = pluginFileNames_1.next();
                        return [3, 4];
                    case 7:
                        return [3, 10];
                    case 8:
                        e_1_1 = _b.sent();
                        e_1 = {error: e_1_1};
                        return [3, 10];
                    case 9:
                        try {
                            if (pluginFileNames_1_1 && !pluginFileNames_1_1.done && (_a = pluginFileNames_1.return)) _a.call(pluginFileNames_1)
                        } finally {
                            if (e_1) throw e_1.error
                        }
                        return [7];
                    case 10:
                        if (!earlyPluginClassNames.length) return [3, 12];
                        return [4, eDwUIPluginMgr.get().loadPlugins(earlyPluginClassNames, null, ioViewerOpts)];
                    case 11:
                        _b.sent();
                        _b.label = 12;
                    case 12:
                        if (iInit) iInit(ioViewerOpts, iContainerElemID);
                        if (!ioViewerOpts.URL) return [3, 14];
                        return [4, l_processInputURL(iContainerElemID, ioViewerOpts)];
                    case 13:
                        _b.sent();
                        _b.label = 14;
                    case 14:
                        return [2]
                }
            }))
        }))
    }

    function l_processProductStructure(iViewer, iServerURL) {
        return __awaiter(this, void 0, void 0, (function () {
            var model, modelHC, rootId, onDone, iException_1, msg, _a, _b, msg_1;
            var e_2, _c;
            var _this = this;
            return __generator(this, (function (_d) {
                switch (_d.label) {
                    case 0:
                        model = iViewer.getModel();
                        modelHC = model.getHCModel();
                        _d.label = 1;
                    case 1:
                        _d.trys.push([1, 4, , 5]);
                        rootId = modelHC.getAbsoluteRootNode();
                        modelHC._getModelStructure().resetPmiColor(rootId);
                        eDwUIUtils.createUIGenerators(iViewer);
                        return [4, model.initModelData()];
                    case 2:
                        _d.sent();
                        onDone = function () {
                            return __awaiter(_this, void 0, void 0, (function () {
                                return __generator(this, (function (_a) {
                                    removeModelStreamCache(iViewer, iServerURL);
                                    return [2]
                                }))
                            }))
                        };
                        eDwEventMgr.get().addEventHandlerFunc(eDwEvents_1.DoneEvent, onDone);
                        return [4, iViewer.processProductStructure()];
                    case 3:
                        _d.sent();
                        return [3, 5];
                    case 4:
                        iException_1 = _d.sent();
                        msg = iException_1.message ? iException_1.message : "No product structure XML?";
                        console.debugLog("ModelLoad", msg);
                        if (iException_1 instanceof eDwResultError) {
                            try {
                                for (_a = __values(iException_1.Result.ErrorData), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    msg_1 = _b.value;
                                    console.debugLog("ModelLoad", msg_1)
                                }
                            } catch (e_2_1) {
                                e_2 = {error: e_2_1}
                            } finally {
                                try {
                                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a)
                                } finally {
                                    if (e_2) throw e_2.error
                                }
                            }
                            if (iException_1.Result.ErrorCode === "NoNodeWithName") {
                                iException_1.Result.ErrorCode = "IncompleteFileProcessing"
                            }
                            throw iException_1
                        } else if (!(iException_1 instanceof TypeError)) {
                            throw new eDwAJAXError(msg, "AJAXFailure")
                        }
                        return [3, 5];
                    case 5:
                        return [2]
                }
            }))
        }))
    }

    function l_processInputURL(iContainerElemID, ioParams) {
        return __awaiter(this, void 0, void 0, (function () {
            var ext, pos2, fileName;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        ext = utils.getExtension(ioParams.URL);
                        if (!ext) throw new Error("The file has no extension");
                        if (!(ext === "scs")) return [3, 2];
                        pos2 = ioParams.URL.lastIndexOf("/");
                        fileName = ioParams.URL.substring(pos2 + 1);
                        fileName = fileName.slice(0, -(ext.length + 1));
                        return [4, l_viewSCSFile(fileName, iContainerElemID, ioParams)];
                    case 1:
                        _a.sent();
                        return [3, 6];
                    case 2:
                        if (!(ioParams.URL.indexOf("http") === 0)) return [3, 4];
                        return [4, l_convert(iContainerElemID, ioParams)];
                    case 3:
                        _a.sent();
                        return [3, 6];
                    case 4:
                        return [4, eDwUIUtils.viewFile(ioParams.URL, ioParams.URL, ioParams, iContainerElemID)];
                    case 5:
                        _a.sent();
                        _a.label = 6;
                    case 6:
                        return [2]
                }
            }))
        }))
    }

    function l_viewSCSFile(iFileName, iContainerElemID, ioParams) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, eDwUIUtils.viewFile(iFileName, null, ioParams, iContainerElemID)];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    function l_convert(iContainerID, ioParams) {
        return __awaiter(this, void 0, void 0, (function () {
            var serviceMgr, result, viewer, iExcp_4;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        serviceMgr = eDwServiceMgr.get();
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, , 7]);
                        return [4, serviceMgr.convert(ioParams)];
                    case 2:
                        result = _a.sent();
                        if (result.ErrorCode !== "Success") {
                            throw new eDwResultError(result)
                        }
                        return [4, eDwUIUtils.viewFile(result.FileName, result.ModelCacheName, ioParams, iContainerID)];
                    case 3:
                        viewer = _a.sent();
                        if (!viewer) return [3, 5];
                        return [4, eDwEventMgr.get().fireEvent(eDwEvents_1.LicenseKeyEvent, viewer, result.LicenseKey)];
                    case 4:
                        _a.sent();
                        _a.label = 5;
                    case 5:
                        return [3, 7];
                    case 6:
                        iExcp_4 = _a.sent();
                        if (iExcp_4 instanceof eDwResultError) throw iExcp_4;
                        console.debugLog("ModelLoad", "Model loading failed: " + iExcp_4.message);
                        throw new eDwAJAXError(iExcp_4.message, "AJAXFailure");
                    case 7:
                        return [2]
                }
            }))
        }))
    }

    function l_displayError(iExcp, iOnError) {
        if (iOnError) {
            iOnError(eDwUIUtils.makeResult(iExcp))
        }
    }

    var c_featOps = {
        URL: "",
        ValidateClientIP: false,
        RenderType: "ShadedWithEdges",
        Debug: false,
        DeleteModelCacheFileWhenDone: true,
        Locale: ""
    };
    var l_ModelLoadEvents
}));
define("eDwAJAXError", ["require", "exports", "eDwBaseError"], (function (require, exports, eDwBaseError) {
    "use strict";
    var eDwAJAXError = function (_super) {
        __extends(eDwAJAXError, _super);

        function eDwAJAXError(iMsg, iErrorCode) {
            var _this = _super.call(this, "AJAX Error", iMsg) || this;
            _this.ErrorCode = iErrorCode;
            return _this
        }

        return eDwAJAXError
    }(eDwBaseError);
    return eDwAJAXError
}));
define("eDwAmbientOcclusionCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwAmbientOcclusionCmd = function (_super) {
        __extends(eDwAmbientOcclusionCmd, _super);

        function eDwAmbientOcclusionCmd(iViewer, iActivate) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitiallyActive = !iActivate;
            _this.mFinallyActive = iActivate;
            return _this
        }

        eDwAmbientOcclusionCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.enableAmbientOcclusion(this.mInitiallyActive);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwAmbientOcclusionCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.enableAmbientOcclusion(this.mFinallyActive);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwAmbientOcclusionCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.ViewMgr.enableAmbientOcclusion(this.mFinallyActive);
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwAmbientOcclusionCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwAmbientOcclusionCmd
    }(eDwSupportsHistoryCmd);
    return eDwAmbientOcclusionCmd
}));
define("eDwAnimateCmd", ["require", "exports", "eDwCmd"], (function (require, exports, eDwCmd) {
    "use strict";
    var eDwAnimateCmd = function (_super) {
        __extends(eDwAnimateCmd, _super);

        function eDwAnimateCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mExclusive = false;
            return _this
        }

        eDwAnimateCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var viewMgr;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            if (!this.mViewer.getModel().isDrawing()) {
                                viewMgr = this.mViewer.ViewMgr;
                                if (viewMgr.isActive()) {
                                    viewMgr.stop()
                                } else {
                                    viewMgr.start()
                                }
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwAnimateCmd.prototype.cancel = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var viewMgr;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.cancel.call(this)];
                        case 1:
                            _a.sent();
                            viewMgr = this.mViewer.ViewMgr;
                            viewMgr.stop();
                            return [2]
                    }
                }))
            }))
        };
        return eDwAnimateCmd
    }(eDwCmd);
    return eDwAnimateCmd
}));
define("eDwBaseError", ["require", "exports"], (function (require, exports) {
    "use strict";
    var eDwBaseError = function (_super) {
        __extends(eDwBaseError, _super);

        function eDwBaseError(iName, iMessage) {
            var _newTarget = this.constructor;
            var _this = this;
            var trueProto = _newTarget.prototype;
            _this = _super.call(this, iMessage) || this;
            Object.setPrototypeOf(_this, trueProto);
            _this.name = iName ? iName : "eDwBaseError";
            return _this
        }

        return eDwBaseError
    }(Error);
    return eDwBaseError
}));
define("eDwBaseMarkupItem", ["require", "exports", "eDwTypes"], (function (require, exports, eDwTypes_2) {
    "use strict";
    var eDwBaseMarkupItem = function (_super) {
        __extends(eDwBaseMarkupItem, _super);

        function eDwBaseMarkupItem() {
            var _this = _super.call(this) || this;
            _this.mPosHC = new eDwTypes_2.HC.Point2(0, 0);
            return _this
        }

        eDwBaseMarkupItem.prototype.getClassName = function () {
            return "eDwBaseMarkupItem"
        };
        Object.defineProperty(eDwBaseMarkupItem.prototype, "Position", {
            get: function () {
                return this.mPosHC
            }, set: function (iPosHC) {
                this.mPosHC = iPosHC
            }, enumerable: false, configurable: true
        });
        return eDwBaseMarkupItem
    }(eDwTypes_2.HC.Markup.MarkupItem);
    return eDwBaseMarkupItem
}));
define("eDwBaseSelOperator", ["require", "exports", "eDwOperatorBaseDeps", "eDwTypes", "eDwGeomUtils"], (function (require, exports, eDwOperatorBaseDeps_1, eDwTypes_3, eDwGeomUtils) {
    "use strict";
    var eDwBaseSelOperator = function (_super) {
        __extends(eDwBaseSelOperator, _super);

        function eDwBaseSelOperator(iViewer, iSelMgr) {
            var _this = _super.call(this, iViewer) || this;
            _this.mSelMgr = iSelMgr;
            _this.mPrevHighlightStates = {};
            return _this
        }

        eDwBaseSelOperator.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onDeactivate.call(this)];
                        case 1:
                            _a.sent();
                            this.popHighlightSelectionState("NODE");
                            this.popHighlightSelectionState("FACE");
                            this.popHighlightSelectionState("EDGE");
                            this.popHighlightSelectionState("VERTEX");
                            this.popNodeSelectionColor();
                            this.popNodeSelectionOutlineColor();
                            this.popNodeSelectionHighlightMode();
                            this.popElementSelectionColor();
                            this.popElementSelectionOutlineColor();
                            this.popElementSelectionHighlightMode();
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseDown.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            if (ioMouseEvent) {
                                this.actionStart(ioMouseEvent.getPosition())
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseUp.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            if (ioMouseEvent) {
                                this.actionEnd(ioMouseEvent.getPosition())
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.onTouchStart = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onTouchStart.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            if (ioTouchEvent) {
                                this.actionStart(ioTouchEvent.getPosition())
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.onTouchMove = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onTouchMove.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.onTouchEnd = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onTouchEnd.call(this, ioTouchEvent)];
                        case 1:
                            _a.sent();
                            if (ioTouchEvent) {
                                this.actionEnd(ioTouchEvent.getPosition())
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.pushHighlightSelectionState = function (iSelType, iNewState) {
            return this.mPrevHighlightStates[iSelType] = this.mSelMgr.setHighlightSelection(iSelType, iNewState)
        };
        eDwBaseSelOperator.prototype.pushNodeSelectionColor = function (iColor) {
            return this.mPrevNodeColor = this.mSelMgr.setNodeSelectionColor(iColor)
        };
        eDwBaseSelOperator.prototype.pushNodeSelectionOutlineColor = function (iColor) {
            return this.mPrevNodeOutlineColor = this.mSelMgr.setNodeSelectionOutlineColor(iColor)
        };
        eDwBaseSelOperator.prototype.pushNodeSelectionHighlightMode = function (iSelHighlightMode) {
            return this.mPrevNodeHighlightMode = this.mSelMgr.setNodeSelectionHighlightMode(iSelHighlightMode)
        };
        eDwBaseSelOperator.prototype.pushElementSelectionColor = function (iColor) {
            return this.mPrevElementColor = this.mSelMgr.setElementSelectionColor(iColor)
        };
        eDwBaseSelOperator.prototype.pushElementSelectionOutlineColor = function (iColor) {
            return this.mPrevElementOutlineColor = this.mSelMgr.setElementSelectionOutlineColor(iColor)
        };
        eDwBaseSelOperator.prototype.pushElementSelectionHighlightMode = function (iSelHighlightMode) {
            return this.mPrevElementHighlightMode = this.mSelMgr.setElementSelectionHighlightMode(iSelHighlightMode)
        };
        eDwBaseSelOperator.prototype.popHighlightSelectionState = function (iSelType) {
            if (this.mPrevHighlightStates && this.mPrevHighlightStates.hasOwnProperty(iSelType)) {
                this.mSelMgr.setHighlightSelection(iSelType, this.mPrevHighlightStates[iSelType]);
                delete this.mPrevHighlightStates[iSelType]
            }
        };
        eDwBaseSelOperator.prototype.popNodeSelectionColor = function () {
            if (this.mPrevNodeColor) {
                this.mSelMgr.setNodeSelectionColor(this.mPrevNodeColor);
                this.mPrevNodeColor = null
            }
        };
        eDwBaseSelOperator.prototype.popNodeSelectionOutlineColor = function () {
            if (this.mPrevNodeOutlineColor) {
                this.mSelMgr.setNodeSelectionOutlineColor(this.mPrevNodeOutlineColor);
                this.mPrevNodeOutlineColor = null
            }
        };
        eDwBaseSelOperator.prototype.popNodeSelectionHighlightMode = function () {
            if (this.mPrevNodeHighlightMode) {
                this.mSelMgr.setNodeSelectionHighlightMode(this.mPrevNodeHighlightMode);
                this.mPrevNodeHighlightMode = null
            }
        };
        eDwBaseSelOperator.prototype.popElementSelectionColor = function () {
            if (this.mPrevElementColor) {
                this.mSelMgr.setElementSelectionColor(this.mPrevElementColor);
                this.mPrevElementColor = null
            }
        };
        eDwBaseSelOperator.prototype.popElementSelectionOutlineColor = function () {
            if (this.mPrevElementOutlineColor) {
                this.mSelMgr.setElementSelectionOutlineColor(this.mPrevElementOutlineColor);
                this.mPrevElementOutlineColor = null
            }
        };
        eDwBaseSelOperator.prototype.popElementSelectionHighlightMode = function () {
            if (this.mPrevElementHighlightMode) {
                this.mSelMgr.setElementSelectionHighlightMode(this.mPrevElementHighlightMode);
                this.mPrevElementHighlightMode = null
            }
        };
        eDwBaseSelOperator.prototype.getPickResult = function (iEvent, iViewMgr, iPickConfig) {
            if (iPickConfig === void 0) {
                iPickConfig = new eDwTypes_3.HC.PickConfig(eDwTypes_3.HC.SelectionMask.All)
            }
            return __awaiter(this, void 0, void 0, (function () {
                var selObj;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.getPickResult.call(this, iEvent, iViewMgr, iPickConfig)];
                        case 1:
                            selObj = _a.sent();
                            if (selObj) this.mSelMgr.append(selObj);
                            return [2, selObj]
                    }
                }))
            }))
        };
        eDwBaseSelOperator.prototype.actionStart = function (iPoint) {
            this.mFirstPt = eDwGeomUtils.screenToWorld(iPoint, this.Viewer.getHCView());
            console.debugLog("BaseSelOp", "down screen pt = " + JSON.stringify(iPoint))
        };
        eDwBaseSelOperator.prototype.actionEnd = function (iPoint) {
            this.mFirstPt = null;
            console.debugLog("BaseSelOp", "up screen pt = " + JSON.stringify(eDwGeomUtils.screenToWorld(iPoint, this.Viewer.getHCView())))
        };
        return eDwBaseSelOperator
    }(eDwOperatorBaseDeps_1.eDwBaseOperator);
    return eDwBaseSelOperator
}));
define("eDwChangeModelViewCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwChangeModelViewCmd = function (_super) {
        __extends(eDwChangeModelViewCmd, _super);

        function eDwChangeModelViewCmd(iViewer, iModelView) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialModelView = iViewer.getModel().getActiveModelView();
            _this.mFinalModelView = iModelView;
            return _this
        }

        eDwChangeModelViewCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.activateModelView(this.mInitialModelView)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwChangeModelViewCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.activateModelView(this.mFinalModelView)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwChangeModelViewCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, this.activateModelView(this.mFinalModelView)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwChangeModelViewCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwChangeModelViewCmd.prototype.activateModelView = function (iModelView) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.mViewer.SelectionMgr.unSelectAllObjects()];
                        case 1:
                            _a.sent();
                            return [4, this.mViewer.getModel().activateModelView(iModelView)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        return eDwChangeModelViewCmd
    }(eDwSupportsHistoryCmd);
    return eDwChangeModelViewCmd
}));
define("eDwChangeSectionPlaneCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwChangeSectionPlaneCmd = function (_super) {
        __extends(eDwChangeSectionPlaneCmd, _super);

        function eDwChangeSectionPlaneCmd(iViewer, iInitialPlane, iFinalPlane) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialPlane = iInitialPlane;
            _this.mFinalPlane = iFinalPlane;
            return _this
        }

        eDwChangeSectionPlaneCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.mViewer.XSectionMgr.setSectionPlane(this.mInitialPlane)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwChangeSectionPlaneCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.mViewer.XSectionMgr.setSectionPlane(this.mFinalPlane)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwChangeSectionPlaneCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, this.mViewer.XSectionMgr.setSectionPlane(this.mFinalPlane)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwChangeSectionPlaneCmd.prototype.isCommitted = function () {
            return _super.prototype.isCommitted.call(this) && !!this.mInitialPlane && !!this.mFinalPlane
        };
        Object.defineProperty(eDwChangeSectionPlaneCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwChangeSectionPlaneCmd
    }(eDwSupportsHistoryCmd);
    return eDwChangeSectionPlaneCmd
}));
define("eDwCmd", ["require", "exports", "eDwOperationMixin"], (function (require, exports, eDwOperationMixin) {
    "use strict";
    var eDwCmd = function (_super) {
        __extends(eDwCmd, _super);

        function eDwCmd(iViewer) {
            var _this = _super.call(this) || this;
            _this.mViewer = iViewer;
            return _this
        }

        eDwCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    return [2]
                }))
            }))
        };
        eDwCmd.prototype.cancel = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    return [2]
                }))
            }))
        };
        eDwCmd.prototype.setHierarchyNodeIDsAttribs = function (iNodesWithAttribs) {
            var _this = this;
            if (!iNodesWithAttribs) return;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        this.mViewer.getModel().setAttribs(iNodesWithAttribs);
                        return [2]
                    }))
                }))
            })()
        };
        eDwCmd.prototype.getHierarchyNodesAttribs = function (iExcludeModelViewNode) {
            if (iExcludeModelViewNode === void 0) {
                iExcludeModelViewNode = true
            }
            var nodeWithAttrib = [];
            var modelView = this.mViewer.getModel().getActiveModelView();
            var hierNodes = modelView.Nodes;
            for (var hierNodeName in hierNodes) {
                var hierNode = hierNodes[hierNodeName];
                if (iExcludeModelViewNode && modelView.Hierarchy === hierNode) {
                    continue
                }
                var attrib = $.extend(true, {}, hierNode.getAttribs());
                nodeWithAttrib.push({HierNode: hierNode, Attribs: attrib})
            }
            return nodeWithAttrib
        };
        return eDwCmd
    }(eDwOperationMixin);
    return eDwCmd
}));
define("eDwCommandMgr", ["require", "exports", "utils"], (function (require, exports, Utils) {
    "use strict";
    var eDwCommandMgr = function () {
        function eDwCommandMgr() {
            this.mActiveCmds = []
        }

        eDwCommandMgr.get = function () {
            if (!eDwCommandMgr.sCommandMgr) {
                eDwCommandMgr.sCommandMgr = new eDwCommandMgr
            }
            return eDwCommandMgr.sCommandMgr
        };
        eDwCommandMgr.prototype.add = function (iCmd) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!iCmd) {
                                console.debugLog("CommandMgr", "Command noexistant.  Not added.");
                                return [2]
                            }
                            return [4, this.popCmds(iCmd)];
                        case 1:
                            _a.sent();
                            this.mActiveCmds.push(iCmd);
                            console.debugLog("CommandMgr", "Added " + Utils.getObjectTypeName(iCmd) + " as an active command.");
                            return [2]
                    }
                }))
            }))
        };
        eDwCommandMgr.prototype.remove = function (iCmd, iCmdAction) {
            return __awaiter(this, void 0, void 0, (function () {
                var detached;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            detached = false;
                            if (!iCmd) return [3, 2];
                            detached = this.detach(iCmd);
                            if (!(detached && iCmdAction)) return [3, 2];
                            return [4, iCmd[iCmdAction]()];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            console.debugLog("CommandMgr", (detached ? "Removed " : "Not Found ") + Utils.getObjectTypeName(iCmd) + " as an active command. " + (detached && iCmdAction ? " Also, " + iCmdAction + "ed it." : ""));
                            return [2, detached]
                    }
                }))
            }))
        };
        eDwCommandMgr.prototype.run = function (ioCmd, iCmdAction) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.add(ioCmd)];
                        case 1:
                            _a.sent();
                            return [4, this.remove(ioCmd, iCmdAction)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwCommandMgr.prototype.clear = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var cmd;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            cmd = this.mActiveCmds.pop();
                            _a.label = 1;
                        case 1:
                            if (!cmd) return [3, 4];
                            return [4, cmd.cancel()];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            cmd = this.mActiveCmds.pop();
                            return [3, 1];
                        case 4:
                            console.debugLog("CommandMgr", "All active commands cleared.");
                            return [2]
                    }
                }))
            }))
        };
        eDwCommandMgr.prototype.popCmds = function (iCmd) {
            return __awaiter(this, void 0, void 0, (function () {
                var exclusiveCmds, i;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (iCmd.Aggregable && (!this.mActiveCmds.length || this.mActiveCmds[this.mActiveCmds.length - 1].AllowsAggregation)) {
                                return [2]
                            }
                            if (!iCmd.Exclusive) return [3, 5];
                            exclusiveCmds = this.mActiveCmds.filter((function (iCmd) {
                                return iCmd.Exclusive
                            }));
                            i = exclusiveCmds.length - 1;
                            _a.label = 1;
                        case 1:
                            if (!(i > -1)) return [3, 4];
                            return [4, exclusiveCmds[i].commit()];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            --i;
                            return [3, 1];
                        case 4:
                            this.mActiveCmds = this.mActiveCmds.filter((function (iCmd) {
                                return !iCmd.Exclusive
                            }));
                            _a.label = 5;
                        case 5:
                            return [2]
                    }
                }))
            }))
        };
        eDwCommandMgr.prototype.detach = function (iCmd) {
            var cmdPos = this.mActiveCmds.indexOf(iCmd);
            if (cmdPos === -1) return false;
            var removedCmds = this.mActiveCmds.splice(cmdPos, 1);
            return removedCmds.length === 1 ? true : false
        };
        return eDwCommandMgr
    }();

    //plm test
    eDwCommandMgrg=eDwCommandMgr;
    
    return eDwCommandMgr
}));
define("eDwCompositeCmd", ["require", "exports", "eDwSupportsHistoryCmd", "eDwHistoryMgr", "eDwCommandMgr", "utils"], (function (require, exports, eDwSupportsHistoryCmd, eDwHistoryMgr, eDwCommandMgr, Utils) {
    "use strict";
    var eDwCompositeCmd = function (_super) {
        __extends(eDwCompositeCmd, _super);

        function eDwCompositeCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mSubCmds = [];
            eDwHistoryMgr.get().pushStack();
            return _this
        }

        eDwCompositeCmd.prototype.initCmdActionImplementation = function (iHistoryActions) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mCmdHistoryActions = iHistoryActions;
                            if (!(this.mCmdHistoryActions && this.mCmdHistoryActions.compositeInit)) return [3, 2];
                            return [4, this.mCmdHistoryActions.compositeInit(this)];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            return [2]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var actionExists, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!_super.prototype.undo.call(this)) return [2, false];
                            actionExists = this.mCmdHistoryActions && this.mCmdHistoryActions.compositeUndo;
                            if (!actionExists) return [3, 2];
                            return [4, this.mCmdHistoryActions.compositeUndo(this)];
                        case 1:
                            _a = _b.sent();
                            return [3, 4];
                        case 2:
                            return [4, this.undoSubCmds()];
                        case 3:
                            _a = _b.sent();
                            _b.label = 4;
                        case 4:
                            return [2, _a]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var actionExists, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!_super.prototype.redo.call(this)) return [2, false];
                            actionExists = this.mCmdHistoryActions && this.mCmdHistoryActions.compositeRedo;
                            if (!actionExists) return [3, 2];
                            return [4, this.mCmdHistoryActions.compositeRedo(this)];
                        case 1:
                            _a = _b.sent();
                            return [3, 4];
                        case 2:
                            return [4, this.redoSubCmds()];
                        case 3:
                            _a = _b.sent();
                            _b.label = 4;
                        case 4:
                            return [2, _a]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mSubCmds = eDwHistoryMgr.get().popStack();
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            if (!(this.mCmdHistoryActions && this.mCmdHistoryActions.compositeCommit)) return [3, 3];
                            return [4, this.mCmdHistoryActions.compositeCommit(this)];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            return [2]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.cancel = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mSubCmds = eDwHistoryMgr.get().popStack();
                            return [4, _super.prototype.cancel.call(this)];
                        case 1:
                            _a.sent();
                            if (!(this.mCmdHistoryActions && this.mCmdHistoryActions.compositeCancel)) return [3, 3];
                            return [4, this.mCmdHistoryActions.compositeCancel(this)];
                        case 2:
                            _a.sent();
                            return [3, 5];
                        case 3:
                            return [4, this.cancelSubCmds()];
                        case 4:
                            _a.sent();
                            _a.label = 5;
                        case 5:
                            this.clearSubCmds();
                            return [2]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.isCommitted = function () {
            return _super.prototype.isCommitted.call(this) && !(this.InitialState === undefined) && !(this.FinalState === undefined)
        };
        Object.defineProperty(eDwCompositeCmd.prototype, "AllowsAggregation", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwCompositeCmd.prototype.undoSubCmds = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var isSuccessful, lastCmdIndex, i, cmd, ret;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            isSuccessful = true;
                            lastCmdIndex = this.mSubCmds.length - 1;
                            i = lastCmdIndex;
                            _a.label = 1;
                        case 1:
                            if (!(i > -1)) return [3, 4];
                            cmd = this.mSubCmds[i];
                            return [4, cmd.undo()];
                        case 2:
                            ret = _a.sent();
                            console.debugLog("History", "Undo subcommand history at index " + i + (ret ? " succeeded." : " failed.") + " Object Type = " + Utils.getObjectTypeName(cmd) + ".");
                            if (!ret) {
                                isSuccessful = false
                            }
                            _a.label = 3;
                        case 3:
                            i--;
                            return [3, 1];
                        case 4:
                            return [2, isSuccessful]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.cancelSubCmds = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var cmdMgr, lastCmdIndex, i;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            cmdMgr = eDwCommandMgr.get();
                            lastCmdIndex = this.mSubCmds.length - 1;
                            i = lastCmdIndex;
                            _a.label = 1;
                        case 1:
                            if (!(i > -1)) return [3, 4];
                            return [4, cmdMgr.remove(this.mSubCmds[i], "cancel")];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            i--;
                            return [3, 1];
                        case 4:
                            delete this.InitialState;
                            delete this.FinalState;
                            return [2]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.redoSubCmds = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var isSuccessful, numCmds, i, cmd, ret;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            isSuccessful = true;
                            numCmds = this.mSubCmds.length;
                            i = 0;
                            _a.label = 1;
                        case 1:
                            if (!(i < numCmds)) return [3, 4];
                            cmd = this.mSubCmds[i];
                            return [4, cmd.redo()];
                        case 2:
                            ret = _a.sent();
                            console.debugLog("History", "Redo subcommand history at index " + i + (ret ? " succeeded." : " failed.") + " Object Type = " + Utils.getObjectTypeName(cmd) + ".");
                            if (!ret) {
                                isSuccessful = false
                            }
                            _a.label = 3;
                        case 3:
                            i++;
                            return [3, 1];
                        case 4:
                            return [2, isSuccessful]
                    }
                }))
            }))
        };
        eDwCompositeCmd.prototype.clearSubCmds = function () {
            this.mSubCmds = []
        };
        return eDwCompositeCmd
    }(eDwSupportsHistoryCmd);
    return eDwCompositeCmd
}));
define("eDwConvTypes", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true})
}));
define("eDwDrawModeCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwDrawModeCmd = function (_super) {
        __extends(eDwDrawModeCmd, _super);

        function eDwDrawModeCmd(iViewer, iDrawMode) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialDrawMode = iViewer.getDrawMode();
            _this.mFinalDrawMode = iDrawMode;
            return _this
        }

        eDwDrawModeCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.setDrawMode(this.mInitialDrawMode);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwDrawModeCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.setDrawMode(this.mFinalDrawMode);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwDrawModeCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.setDrawMode(this.mFinalDrawMode);
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwDrawModeCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwDrawModeCmd
    }(eDwSupportsHistoryCmd);
    return eDwDrawModeCmd
}));
define("eDwEventMgr", ["require", "exports", "utils"], (function (require, exports, utils) {
    "use strict";
    var eDwEventMgr = function () {
        function eDwEventMgr() {
            this.mEventHandlers = new Map
        }

        eDwEventMgr.get = function () {
            if (!eDwEventMgr.sMgr) eDwEventMgr.sMgr = new eDwEventMgr;
            return eDwEventMgr.sMgr
        };
        eDwEventMgr.prototype.addEventHandlerObj = function (iEvent, iEventHandlerObj, iEventHandlerFuncName) {
            if (!iEventHandlerFuncName) {
                throw new Error("Eventhandler object has no function name")
            }
            this.initHandlersMapForEvent(iEvent);
            var handlerMap = {};
            handlerMap[iEventHandlerFuncName] = iEventHandlerObj;
            var handlers = this.mEventHandlers.get(iEvent);
            handlers.push(handlerMap)
        };
        eDwEventMgr.prototype.addEventHandlerFunc = function (iEvent, ioEventHandlerFunc) {
            this.initHandlersMapForEvent(iEvent);
            ioEventHandlerFunc.funcName = ioEventHandlerFunc.name;
            if (!ioEventHandlerFunc.funcName) {
                var eventTypeName = this.constructor.toString().match(/\w+/g)[1];
                ioEventHandlerFunc.funcName = eventTypeName + this.mEventHandlers.get(iEvent).length
            }
            var handlerMap = {};
            handlerMap[ioEventHandlerFunc.funcName] = ioEventHandlerFunc;
            var handlers = this.mEventHandlers.get(iEvent);
            handlers.push(handlerMap)
        };
        eDwEventMgr.prototype.removeEventHandlerFunc = function (iEvent, iEventHandlerFuncName) {
            var numRemoved = 0;
            var eventHandlerMaps = this.mEventHandlers.get(iEvent);
            if (!eventHandlerMaps) return numRemoved;
            for (var key in eventHandlerMaps) {
                var handlerMap = eventHandlerMaps[key];
                if (handlerMap[iEventHandlerFuncName]) {
                    eventHandlerMaps.splice(parseInt(key, 10), 1);
                    ++numRemoved
                }
            }
            return numRemoved
        };
        eDwEventMgr.prototype.removeEventHandlerObj = function (iEvent, iEventHandlerObj, iEventHandlerFuncName) {
            var e_3, _a;
            var numRemoved = 0;
            var eventHandlerMaps = this.mEventHandlers.get(iEvent);
            if (!eventHandlerMaps) return numRemoved;
            try {
                for (var eventHandlerMaps_1 = __values(eventHandlerMaps), eventHandlerMaps_1_1 = eventHandlerMaps_1.next(); !eventHandlerMaps_1_1.done; eventHandlerMaps_1_1 = eventHandlerMaps_1.next()) {
                    var handlerMap = eventHandlerMaps_1_1.value;
                    var handlerObj = handlerMap[iEventHandlerFuncName];
                    if (handlerObj === iEventHandlerObj) {
                        var index = eventHandlerMaps.indexOf(handlerMap);
                        if (index > -1) {
                            eventHandlerMaps.splice(index, 1);
                            ++numRemoved
                        }
                    }
                }
            } catch (e_3_1) {
                e_3 = {error: e_3_1}
            } finally {
                try {
                    if (eventHandlerMaps_1_1 && !eventHandlerMaps_1_1.done && (_a = eventHandlerMaps_1.return)) _a.call(eventHandlerMaps_1)
                } finally {
                    if (e_3) throw e_3.error
                }
            }
            return numRemoved
        };
        eDwEventMgr.prototype.removeAllEventHandlers = function () {
            this.mEventHandlers.clear()
        };
        eDwEventMgr.prototype.removeEventHandlers = function (iEvent) {
            this.mEventHandlers.delete(iEvent)
        };
        eDwEventMgr.prototype.fireEvent = function (iEvent) {
            var iArgs = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                iArgs[_i - 1] = arguments[_i]
            }
            return __awaiter(this, void 0, void 0, (function () {
                var handlerMaps, allPromises, handlerMaps_1, handlerMaps_1_1, handlerMap, keys, funcName, handlerItem,
                    retPromise, handlerFunc, retPromise;
                var e_4, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            handlerMaps = this.mEventHandlers.get(iEvent);
                            if (!handlerMaps) return [2, []];
                            allPromises = [];
                            try {
                                for (handlerMaps_1 = __values(handlerMaps), handlerMaps_1_1 = handlerMaps_1.next(); !handlerMaps_1_1.done; handlerMaps_1_1 = handlerMaps_1.next()) {
                                    handlerMap = handlerMaps_1_1.value;
                                    keys = Object.keys(handlerMap);
                                    console.assert(keys.length === 1);
                                    funcName = keys[0];
                                    handlerItem = handlerMap[funcName];
                                    if ("funcName" in handlerItem) {
                                        retPromise = handlerItem.apply(void 0, __spreadArray([], __read(iArgs)));
                                        utils.appendToArray(retPromise, allPromises)
                                    } else {
                                        handlerFunc = eDwEventMgr.getHandler(handlerItem, funcName);
                                        if (handlerFunc) {
                                            handlerFunc = handlerFunc.bind(handlerItem);
                                            retPromise = handlerFunc.apply(void 0, __spreadArray([], __read(iArgs)));
                                            utils.appendToArray(retPromise, allPromises)
                                        }
                                    }
                                }
                            } catch (e_4_1) {
                                e_4 = {error: e_4_1}
                            } finally {
                                try {
                                    if (handlerMaps_1_1 && !handlerMaps_1_1.done && (_a = handlerMaps_1.return)) _a.call(handlerMaps_1)
                                } finally {
                                    if (e_4) throw e_4.error
                                }
                            }
                            return [4, Promise.all(allPromises)];
                        case 1:
                            return [2, _b.sent()]
                    }
                }))
            }))
        };
        eDwEventMgr.getHandler = function (iHandlerObj, iHandlerName) {
            var handler;
            var handlerObj = iHandlerObj;
            var parentClass = Object.getPrototypeOf(iHandlerObj);
            while (handlerObj && !handler) {
                handler = handlerObj[iHandlerName];
                if (!handler) {
                    handlerObj = parentClass;
                    parentClass = handlerObj ? Object.getPrototypeOf(handlerObj) : null
                }
            }
            return handler instanceof Function ? handler : null
        };
        eDwEventMgr.prototype.initHandlersMapForEvent = function (iEvent) {
            if (!this.mEventHandlers.has(iEvent)) {
                this.mEventHandlers.set(iEvent, [])
            }
        };
        return eDwEventMgr
    }();
    return eDwEventMgr
}));
define("eDwEvents", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.ViewDeletedEvent = exports.ViewLoadedEvent = exports.ViewCreatedEvent = exports.UpdateLocalizationEvent = exports.LicenseKeyEvent = exports.GLContextLostEvent = exports.UserUnitsChangeEvent = exports.DeactivateUIOpEvent = exports.ActivateUIOpEvent = exports.ExplodeLevelChangeEvent = exports.AmbientOcclChangeEvent = exports.ResetSceneEvent = exports.CameraChangeEvent = exports.ModelXformChangeStartEvent = exports.ProjModeChangeEvent = exports.DrawModeChangeEvent = exports.TimeoutEvent = exports.LeftDoubleClickEvent = exports.RightClickEvent = exports.MiddleClickEvent = exports.LeftClickEvent = exports.StopAnimationEvent = exports.StartAnimationEvent = exports.ProdStructLoadedEvent = exports.ModelViewChangeEvent = exports.UnselectEvent = exports.SelectEvent = exports.NodeAttribChangeEvent = exports.DoneEvent = exports.InitFullUIEvent = exports.InitEvent = exports.AppEvent = void 0;
    var AppEvent = function () {
        function AppEvent() {
            this.doNotUse
        }

        return AppEvent
    }();
    exports.AppEvent = AppEvent;
    exports.InitEvent = new AppEvent;
    exports.InitFullUIEvent = new AppEvent;
    exports.DoneEvent = new AppEvent;
    exports.NodeAttribChangeEvent = new AppEvent;
    exports.SelectEvent = new AppEvent;
    exports.UnselectEvent = new AppEvent;
    exports.ModelViewChangeEvent = new AppEvent;
    exports.ProdStructLoadedEvent = new AppEvent;
    exports.StartAnimationEvent = new AppEvent;
    exports.StopAnimationEvent = new AppEvent;
    exports.LeftClickEvent = new AppEvent;
    exports.MiddleClickEvent = new AppEvent;
    exports.RightClickEvent = new AppEvent;
    exports.LeftDoubleClickEvent = new AppEvent;
    exports.TimeoutEvent = new AppEvent;
    exports.DrawModeChangeEvent = new AppEvent;
    exports.ProjModeChangeEvent = new AppEvent;
    exports.ModelXformChangeStartEvent = new AppEvent;
    exports.CameraChangeEvent = new AppEvent;
    exports.ResetSceneEvent = new AppEvent;
    exports.AmbientOcclChangeEvent = new AppEvent;
    exports.ExplodeLevelChangeEvent = new AppEvent;
    exports.ActivateUIOpEvent = new AppEvent;
    exports.DeactivateUIOpEvent = new AppEvent;
    exports.UserUnitsChangeEvent = new AppEvent;
    exports.GLContextLostEvent = new AppEvent;
    exports.LicenseKeyEvent = new AppEvent;
    exports.UpdateLocalizationEvent = new AppEvent;
    exports.ViewCreatedEvent = new AppEvent;
    exports.ViewLoadedEvent = new AppEvent;
    exports.ViewDeletedEvent = new AppEvent
}));
define("eDwExplodeCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwExplodeCmd = function (_super) {
        __extends(eDwExplodeCmd, _super);

        function eDwExplodeCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialLevel = _this.mViewer.getExplosionLevel();
            _this.mFinalLevel = NaN;
            return _this
        }

        eDwExplodeCmd.prototype.setLevel = function (iLevel) {
            this.setExplosionLevel(iLevel);
            this.mFinalLevel = iLevel
        };
        eDwExplodeCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.setExplosionLevel(this.mInitialLevel);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwExplodeCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.setExplosionLevel(this.mFinalLevel);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwExplodeCmd.prototype.cancel = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.cancel.call(this)];
                        case 1:
                            _a.sent();
                            this.setExplosionLevel(this.mInitialLevel);
                            this.mViewer.HCViewer.explodeManager.stop();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwExplodeCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwExplodeCmd.prototype.setExplosionLevel = function (iLevel) {
            var explodeMgrHC = this.mViewer.HCViewer.explodeManager;
            if (!explodeMgrHC.getActive()) explodeMgrHC.start();
            explodeMgrHC.setMagnitude(iLevel)
        };
        return eDwExplodeCmd
    }(eDwSupportsHistoryCmd);
    return eDwExplodeCmd
}));
define("eDwGenericError", ["require", "exports", "eDwBaseError"], (function (require, exports, eDwBaseError) {
    "use strict";
    var eDwGenericError = function (_super) {
        __extends(eDwGenericError, _super);

        function eDwGenericError(iMessage) {
            return _super.call(this, "Generic Error", iMessage) || this
        }

        return eDwGenericError
    }(eDwBaseError);
    return eDwGenericError
}));
define("eDwGeomUtils", ["require", "exports", "eDwTypes", "utils"], (function (require, exports, eDwTypes_4, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.cAbsAngleTol = exports.cAbsLengthTol = exports.isValidHCPoint = exports.isPoint3DInBox = exports.screenToWorld = exports.dropPointOnPlane = void 0;

    function dropPointOnPlane(iPtHC, iPlnHC) {
        var dist = iPlnHC.distanceToPoint(iPtHC);
        var vecHC = iPlnHC.normal.copy();
        return vecHC.normalize().scale(-dist).add(iPtHC)
    }

    exports.dropPointOnPlane = dropPointOnPlane;

    function screenToWorld(iScreenPosHC, iViewHC) {
        var cameraHC = iViewHC.getCamera();
        var pnt3DHC = cameraHC.getCameraPlaneIntersectionPoint(iScreenPosHC, iViewHC);
        console.debugLog("GeomUtils", "Screen pt = " + JSON.stringify(iScreenPosHC) + " 3D pt = " + JSON.stringify(pnt3DHC));
        return pnt3DHC
    }

    exports.screenToWorld = screenToWorld;

    function isPoint3DInBox(iPt3HC, iBboxHC) {
        var pntArr = [];
        iPt3HC.toArray(pntArr);
        var minPt = [];
        iBboxHC.min.toArray(minPt);
        var maxPt = [];
        iBboxHC.max.toArray(maxPt);
        console.debugLog("GeomUtils", "3D pt = " + JSON.stringify(iPt3HC) + " Bounding box = " + JSON.stringify(iBboxHC));
        for (var i = 0; i < 3; ++i) {
            if (pntArr[i] < minPt[i] || pntArr[i] > maxPt[i]) return false
        }
        return true
    }

    exports.isPoint3DInBox = isPoint3DInBox;

    function isValidHCPoint(iPntHC) {
        if (!iPntHC) return false;
        if (iPntHC instanceof eDwTypes_4.HC.Point3) {
            if (utils.isNaN(iPntHC.x) || utils.isNaN(iPntHC.y) || utils.isNaN(iPntHC.z)) {
                return false
            }
        } else {
            if (utils.isNaN(iPntHC.x) || utils.isNaN(iPntHC.y)) {
                return false
            }
        }
        return true
    }

    exports.isValidHCPoint = isValidHCPoint;
    exports.cAbsLengthTol = 1e-6;
    exports.cAbsAngleTol = 1e-9
}));
define("eDwHierNodeAttribArray", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true})
}));
define("eDwHierarchyNode", ["require", "exports", "eDwNodeAttributes", "utils", "eDwTypes", "color"], (function (require, exports, eDwNodeAttributes_1, utils, eDwTypes_5, color_1) {
    "use strict";
    var eDwHierarchyNode = function () {
        function eDwHierarchyNode(iName, iCategory, iAttributes, iNodeIDHC, iParentNode, iModeView) {
            this.Category = iCategory;
            this.HOOPSID = iNodeIDHC;
            this.mModelView = iModeView;
            this.mChildNameToHierNode = {};
            this.mBoundingBoxNodeInfo = {IDs: [], VisState: false};
            this.mParentNode = iParentNode;
            this.Name = iName;
            if ("`" === iName.charAt(0) && "`" === iName.charAt(iName.length - 1)) {
                this.Name = iName.slice(1, -1)
            }
            this.mAttribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            $.extend(this.mAttribs, iAttributes);
            this.mReadOnlyAttribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            $.extend(this.mReadOnlyAttribs, this.mAttribs);
            this.mReadOnlyOverrideAttribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            if (this.mModelView) {
                this.mModelView.Nodes[iNodeIDHC] = this
            }
        }

        eDwHierarchyNode.prototype.addChild = function (iName, iCategory, iAttribs, iNodeIDHC, iParentNode) {
            var node = new eDwHierarchyNode(iName, iCategory, iAttribs, iNodeIDHC, iParentNode, this.mModelView);
            this.mChildNameToHierNode[iName] = node;
            return node
        };
        eDwHierarchyNode.prototype.getChildren = function () {
            return utils.makeArray(this.mChildNameToHierNode)
        };
        eDwHierarchyNode.prototype.getAllChildren = function (ioHierNodes) {
            for (var name_1 in this.mChildNameToHierNode) {
                var hierNode = this.mChildNameToHierNode[name_1];
                if (hierNode) {
                    ioHierNodes.push(hierNode);
                    hierNode.getAllChildren(ioHierNodes)
                }
            }
        };
        eDwHierarchyNode.prototype.getChildrenAndKeys = function () {
            return this.mChildNameToHierNode
        };
        Object.defineProperty(eDwHierarchyNode.prototype, "Parent", {
            get: function () {
                return this.mParentNode
            }, enumerable: false, configurable: true
        });
        eDwHierarchyNode.prototype.getModelView = function () {
            return this.mModelView
        };
        eDwHierarchyNode.prototype.getAttribs = function (iIgnoreActive) {
            if (iIgnoreActive === void 0) {
                iIgnoreActive = false
            }
            var attribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            $.extend(attribs, this.mAttribs);
            $.extend(attribs, this.mReadOnlyOverrideAttribs);
            if (!iIgnoreActive && !this.isActive()) {
                $.extend(attribs, {Visible: false})
            }
            return attribs
        };
        eDwHierarchyNode.prototype.getInitialAttribs = function () {
            var attribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            $.extend(attribs, this.mReadOnlyAttribs);
            return attribs
        };
        eDwHierarchyNode.prototype.setAttribs = function (iAttribs) {
            return this.mAttribs.set(iAttribs)
        };
        eDwHierarchyNode.prototype.setOverrideAttribs = function (iAttribs) {
            this.mReadOnlyOverrideAttribs = new eDwNodeAttributes_1.eDwNodeAttributes;
            var overridesExist = false;
            for (var attribName in iAttribs) {
                if (this.mAttribs.getProp(attribName) !== iAttribs.getProp(attribName)) {
                    overridesExist = true;
                    break
                }
            }
            if (overridesExist) $.extend(this.mReadOnlyOverrideAttribs, iAttribs);
            return Object.keys(iAttribs)
        };
        eDwHierarchyNode.prototype.mergeAttribs = function (iAttribs) {
            this.mAttribs = eDwNodeAttributes_1.eDwNodeAttributes.mergeAttribs(this.mAttribs, iAttribs);
            return this.mAttribs
        };
        eDwHierarchyNode.prototype.getMergedChildrenAttribs = function (iTraverseOption, ioAccumAttrib) {
            var attrib = new eDwNodeAttributes_1.eDwNodeAttributes;
            var childHierNodes = this.mChildNameToHierNode;
            var childNodeKeys = Object.keys(childHierNodes);
            if (childNodeKeys.length) {
                attrib = ioAccumAttrib || attrib;
                for (var i = 0; i < childNodeKeys.length; i++) {
                    var childHierNode = childHierNodes[childNodeKeys[i]];
                    var childAttrib = childHierNode.getAttribs();
                    attrib = eDwNodeAttributes_1.eDwNodeAttributes.mergeAttribs(attrib, childAttrib);
                    if (iTraverseOption === "All") {
                        childHierNode.getMergedChildrenAttribs(iTraverseOption, attrib)
                    }
                }
            }
            return attrib
        };
        eDwHierarchyNode.prototype.syncAttribsWithChildren = function (iTraverseOption) {
            if (iTraverseOption === void 0) {
                iTraverseOption = "DirectDescendantsOnly"
            }
            this.setAttribs(this.getMergedChildrenAttribs(iTraverseOption))
        };
        eDwHierarchyNode.prototype.propagateAttribsToChildren = function (iPropagatingAttribNames, iUseSetOverride, iTraverseOption) {
            var e_5, _a;
            if (iUseSetOverride === void 0) {
                iUseSetOverride = false
            }
            if (iTraverseOption === void 0) {
                iTraverseOption = "All"
            }
            var setMethod = iUseSetOverride ? eDwHierarchyNode.prototype.setOverrideAttribs : eDwHierarchyNode.prototype.setAttribs;
            var changedHierNodes = [];
            var childHierNodes = this.mChildNameToHierNode;
            var childNodeKeys = Object.keys(childHierNodes);
            if (childNodeKeys.length) {
                for (var i = 0; i < childNodeKeys.length; i++) {
                    if (iPropagatingAttribNames && iPropagatingAttribNames.length) {
                        try {
                            for (var iPropagatingAttribNames_1 = (e_5 = void 0, __values(iPropagatingAttribNames)), iPropagatingAttribNames_1_1 = iPropagatingAttribNames_1.next(); !iPropagatingAttribNames_1_1.done; iPropagatingAttribNames_1_1 = iPropagatingAttribNames_1.next()) {
                                var attribName = iPropagatingAttribNames_1_1.value;
                                var attrib = new eDwNodeAttributes_1.eDwNodeAttributes;
                                attrib.setProp(attribName, this.mAttribs.getProp(attribName));
                                var childHierNode = childHierNodes[childNodeKeys[i]];
                                var changedAttribNames = setMethod.call(childHierNode, attrib);
                                if (changedAttribNames.length) {
                                    changedHierNodes.push(childHierNode)
                                }
                                if (iTraverseOption === "All") {
                                    var childrenChangedHierNodes = childHierNode.propagateAttribsToChildren(iPropagatingAttribNames, iUseSetOverride, iTraverseOption);
                                    Array.prototype.push.apply(changedHierNodes, childrenChangedHierNodes)
                                }
                            }
                        } catch (e_5_1) {
                            e_5 = {error: e_5_1}
                        } finally {
                            try {
                                if (iPropagatingAttribNames_1_1 && !iPropagatingAttribNames_1_1.done && (_a = iPropagatingAttribNames_1.return)) _a.call(iPropagatingAttribNames_1)
                            } finally {
                                if (e_5) throw e_5.error
                            }
                        }
                    }
                }
            }
            return changedHierNodes
        };
        eDwHierarchyNode.prototype.invertAttrib = function (iAttribName) {
            this.mAttribs.setProp(iAttribName, !this.mAttribs.getProp(iAttribName));
            return this.mAttribs
        };
        eDwHierarchyNode.prototype.getDisplayState = function (iOtherAttribs) {
            var state = eDwNodeAttributes_1.NodeDisplayState.Invisible;
            var setVisible = this.mAttribs.Opaque !== undefined && Object.keys(this.mAttribs).length === 1 && iOtherAttribs && iOtherAttribs.Visible;
            this.mAttribs.Visible = setVisible ? true : this.mAttribs.Visible;
            if (this.mAttribs.Visible) {
                state = this.mAttribs.isOpaque() ? eDwNodeAttributes_1.NodeDisplayState.Visible : eDwNodeAttributes_1.NodeDisplayState.Transparent;
                if (iOtherAttribs && iOtherAttribs.Opaque === false) {
                    state = eDwNodeAttributes_1.NodeDisplayState.Transparent
                }
            }
            return state
        };
        eDwHierarchyNode.prototype.find = function (iPropName, iPropValue, iFuzzyComparison, iIncludeThis, iRecurse) {
            if (iFuzzyComparison === void 0) {
                iFuzzyComparison = false
            }
            if (iIncludeThis === void 0) {
                iIncludeThis = true
            }
            if (iRecurse === void 0) {
                iRecurse = true
            }
            var hierNodes = [];

            function getHierNodeWithPropNameAndValue(iHierNode) {
                if (!iHierNode) return;
                var propValue = iHierNode[iPropName];
                if (propValue && utils.isEqual(iPropValue, propValue, iFuzzyComparison)) {
                    hierNodes.push(iHierNode)
                }
            }

            function getChildHierNodesWithPropNameAndValue(iHierNode) {
                for (var childNodeName in iHierNode.mChildNameToHierNode) {
                    var childHierNode = iHierNode.mChildNameToHierNode[childNodeName];
                    getHierNodeWithPropNameAndValue(childHierNode);
                    if (iRecurse) {
                        getChildHierNodesWithPropNameAndValue(childHierNode)
                    }
                }
            }

            if (iIncludeThis) getHierNodeWithPropNameAndValue(this);
            getChildHierNodesWithPropNameAndValue(this);
            return hierNodes
        };
        eDwHierarchyNode.prototype.getAllHierNodesWithChangedAttribs = function (ioHierNodes) {
            if (!utils.isEqual(this.getInitialAttribs(), this.mAttribs)) {
                ioHierNodes.push(this)
            }
            for (var key in this.mChildNameToHierNode) {
                this.mChildNameToHierNode[key].getAllHierNodesWithChangedAttribs(ioHierNodes)
            }
        };
        eDwHierarchyNode.prototype.showBoundingBox = function (iViewer, iState) {
            return __awaiter(this, void 0, void 0, (function () {
                var model, isVisible, bboxHC, width, height, length_1, scale, vmin, vmax, p0, p1, p2, p3, polylineData,
                    beautifulGreen, rgba, i, tmp, boxMesh, modelHC, key, meshInstance, nodeID;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            model = iViewer.getModel();
                            isVisible = !this.mBoundingBoxNodeInfo || !this.mBoundingBoxNodeInfo.IDs.length || !this.mBoundingBoxNodeInfo.VisState ? false : true;
                            if (iState === "on" && isVisible) return [2, true];
                            if (iState === "off" || iState === "toggle" && isVisible) {
                                this.mBoundingBoxNodeInfo.VisState = false;
                                model.setVisibilityForNodesHC(this.mBoundingBoxNodeInfo.IDs, false);
                                return [2, false]
                            }
                            return [4, model.activateModelView(this.mModelView)];
                        case 1:
                            _a.sent();
                            this.mBoundingBoxNodeInfo.VisState = true;
                            if (!!this.mBoundingBoxNodeInfo.IDs.length) return [3, 5];
                            return [4, model.getBoundingBoxOfIDsHC([this.HOOPSID])];
                        case 2:
                            bboxHC = _a.sent();
                            if (bboxHC.isDegenerate()) return [2, false];
                            width = bboxHC.max.x - bboxHC.min.x;
                            height = bboxHC.max.y - bboxHC.min.y;
                            length_1 = Math.max(width, height);
                            scale = .05 / 2;
                            vmin = new eDwTypes_5.HC.Point3(bboxHC.min.x - length_1 * scale, bboxHC.min.y - length_1 * scale, bboxHC.min.z);
                            vmax = new eDwTypes_5.HC.Point3(bboxHC.max.x + length_1 * scale, bboxHC.max.y + length_1 * scale, bboxHC.max.z);
                            p0 = new eDwTypes_5.HC.Point3(vmin.x, vmin.y, vmax.z);
                            p1 = new eDwTypes_5.HC.Point3(vmin.x, vmax.y, vmax.z);
                            p2 = new eDwTypes_5.HC.Point3(vmax.x, vmax.y, vmax.z);
                            p3 = new eDwTypes_5.HC.Point3(vmax.x, vmin.y, vmax.z);
                            polylineData = [p0.x, p0.y, p0.z, p1.x, p1.y, p1.z, p2.x, p2.y, p2.z, p3.x, p3.y, p3.z, p0.x, p0.y, p0.z];
                            beautifulGreen = new color_1.Color(0, 255, 0);
                            rgba = [];
                            for (i = 0; i < 5; i++) {
                                tmp = [beautifulGreen.r, beautifulGreen.g, beautifulGreen.b, 255];
                                rgba = rgba.concat(tmp)
                            }
                            boxMesh = new eDwTypes_5.HC.MeshData;
                            boxMesh.addPolyline(polylineData, rgba);
                            modelHC = model.getHCModel();
                            return [4, modelHC.createMesh(boxMesh)];
                        case 3:
                            key = _a.sent();
                            meshInstance = new eDwTypes_5.HC.MeshInstanceData(key);
                            return [4, modelHC.createMeshInstance(meshInstance, 0)];
                        case 4:
                            nodeID = _a.sent();
                            this.mBoundingBoxNodeInfo.IDs.push(nodeID);
                            _a.label = 5;
                        case 5:
                            model.setVisibilityForNodesHC(this.mBoundingBoxNodeInfo.IDs, true);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwHierarchyNode.prototype.isSelectable = function () {
            return !!this.mAttribs.Selectable
        };
        eDwHierarchyNode.prototype.isActive = function () {
            var activeModelView = this.mModelView.Model.getActiveModelView();
            return this.mModelView === activeModelView ? true : false
        };
        eDwHierarchyNode.prototype.resetAttribs = function () {
            var e_6, _a;
            var changedHierNodes = [];
            this.getAllHierNodesWithChangedAttribs(changedHierNodes);
            try {
                for (var changedHierNodes_1 = __values(changedHierNodes), changedHierNodes_1_1 = changedHierNodes_1.next(); !changedHierNodes_1_1.done; changedHierNodes_1_1 = changedHierNodes_1.next()) {
                    var changedHierNode = changedHierNodes_1_1.value;
                    changedHierNode.mAttribs = changedHierNode.getInitialAttribs()
                }
            } catch (e_6_1) {
                e_6 = {error: e_6_1}
            } finally {
                try {
                    if (changedHierNodes_1_1 && !changedHierNodes_1_1.done && (_a = changedHierNodes_1.return)) _a.call(changedHierNodes_1)
                } finally {
                    if (e_6) throw e_6.error
                }
            }
            return changedHierNodes
        };
        eDwHierarchyNode.create = function (iAttribs) {
            return new eDwHierarchyNode("", "", iAttribs || new eDwNodeAttributes_1.eDwNodeAttributes, Number.NaN, null, null)
        };
        eDwHierarchyNode.findPropagatingAttribNames = function (iChangedAttribNames) {
            var e_7, _a;
            var propagatingAttribNames = eDwHierarchyNode.sPropagatingAttribNames;
            var changedPropAttribNames = [];
            try {
                for (var iChangedAttribNames_1 = __values(iChangedAttribNames), iChangedAttribNames_1_1 = iChangedAttribNames_1.next(); !iChangedAttribNames_1_1.done; iChangedAttribNames_1_1 = iChangedAttribNames_1.next()) {
                    var attribName = iChangedAttribNames_1_1.value;
                    if (propagatingAttribNames.indexOf(attribName) > -1) {
                        changedPropAttribNames.push(attribName)
                    }
                }
            } catch (e_7_1) {
                e_7 = {error: e_7_1}
            } finally {
                try {
                    if (iChangedAttribNames_1_1 && !iChangedAttribNames_1_1.done && (_a = iChangedAttribNames_1.return)) _a.call(iChangedAttribNames_1)
                } finally {
                    if (e_7) throw e_7.error
                }
            }
            return changedPropAttribNames
        };
        eDwHierarchyNode.isHierarchyNode = function (iNode) {
            return iNode.Name
        };
        eDwHierarchyNode.sPropagatingAttribNames = ["Visible", "Opaque"];
        return eDwHierarchyNode
    }();
    return eDwHierarchyNode
}));
define("eDwHistoryMgr", ["require", "exports", "utils"], (function (require, exports, Utils) {
    "use strict";
    var eDwHistoryMgr = function () {
        function eDwHistoryMgr() {
            this.clear()
        }

        eDwHistoryMgr.get = function () {
            if (!eDwHistoryMgr.sHistoryMgr) {
                eDwHistoryMgr.sHistoryMgr = new eDwHistoryMgr
            }
            return eDwHistoryMgr.sHistoryMgr
        };
        eDwHistoryMgr.prototype.undo = function () {
            var currStacksElem = this.getCurrStackElem();
            var currStack = currStacksElem.Stack;
            var currStackCmdIndex = currStacksElem.getCurrCmdIndex();
            if (currStackCmdIndex < 0 || currStack.length === 0) {
                console.debugLog("History", "Already before first command.");
                return null
            }
            currStacksElem.incrementCurrCmdIndex(-1);
            var cmd = currStack[currStackCmdIndex];
            cmd.undo();
            console.debugLog("History", "Undoing command at index " + currStackCmdIndex + " Object type: " + Utils.getObjectTypeName(cmd));
            return cmd
        };
        eDwHistoryMgr.prototype.redo = function () {
            var currStacksElem = this.getCurrStackElem();
            var currStack = currStacksElem.Stack;
            var nextStackCmdIndex = currStacksElem.getCurrCmdIndex() + 1;
            if (nextStackCmdIndex >= currStack.length) {
                console.debugLog("History", "Already after last command.");
                return null
            }
            currStacksElem.incrementCurrCmdIndex(1);
            var cmd = currStack[nextStackCmdIndex];
            cmd.redo();
            console.debugLog("History", "Redoing command at index " + nextStackCmdIndex + " Object type: " + Utils.getObjectTypeName(cmd));
            return cmd
        };
        eDwHistoryMgr.prototype.push = function (iCmd) {
            if (!iCmd) return;
            var currStacksElem = this.getCurrStackElem();
            var currStack = currStacksElem.Stack;
            var currStackSize = currStack.length;
            var currStackCmdIndex = currStacksElem.getCurrCmdIndex();
            if (currStackCmdIndex !== currStackSize - 1) {
                currStack.splice(currStackCmdIndex + 1);
                console.debugLog("History", "Truncated history to " + (currStackCmdIndex + 1) + " elements.")
            }
            currStack.push(iCmd);
            currStacksElem.incrementCurrCmdIndex(1);
            console.debugLog("History", "Adding command to history at index " + (currStackCmdIndex + 1) + " Object Type = " + Utils.getObjectTypeName(iCmd) + ".")
        };
        eDwHistoryMgr.prototype.clear = function () {
            console.debugLog("History", "Clear all history.");
            this.mCmdStacksStack = [];
            this.pushStack()
        };
        eDwHistoryMgr.prototype.pushStack = function () {
            console.debugLog("History", "Add a new history stack at index " + this.mCmdStacksStack.length + ".");
            this.mCmdStacksStack.push(new eDwCmdStacksElem)
        };
        eDwHistoryMgr.prototype.popStack = function () {
            console.debugLog("History", "Remove history stack from index " + (this.mCmdStacksStack.length - 1) + " down to 0.");
            var activeCmds = [];
            var currStackElem = this.mCmdStacksStack.pop();
            if (currStackElem) {
                var currCmdIndex = currStackElem.getCurrCmdIndex() + 1;
                for (var i = 0; i < currCmdIndex; i++) {
                    activeCmds.push(currStackElem.Stack[i])
                }
            }
            return activeCmds
        };
        eDwHistoryMgr.prototype.getCurrStackElem = function () {
            return this.mCmdStacksStack[this.mCmdStacksStack.length - 1]
        };
        return eDwHistoryMgr
    }();
    var eDwCmdStacksElem = function () {
        function eDwCmdStacksElem() {
            this.mCmdStack = [];
            this.mCurrCmdIndex = -1
        }

        Object.defineProperty(eDwCmdStacksElem.prototype, "Stack", {
            get: function () {
                return this.mCmdStack
            }, enumerable: false, configurable: true
        });
        eDwCmdStacksElem.prototype.getCurrCmdIndex = function () {
            return this.mCurrCmdIndex
        };
        eDwCmdStacksElem.prototype.incrementCurrCmdIndex = function (iIndex) {
            if (typeof iIndex !== "number") return;
            this.mCurrCmdIndex += iIndex
        };
        return eDwCmdStacksElem
    }();
    return eDwHistoryMgr
}));
define("eDwKeyMgr", ["require", "exports", "eDwUIHTMLEventMgr", "eDwTypes", "utils"], (function (require, exports, eDwUIHTMLEventMgr, eDwTypes_6, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwKeyMgr = void 0;
    var eDwKeyMgr = function () {
        function eDwKeyMgr() {
            var _this = this;
            window.frames.focus();
            this.mUIHTMLEventMgr = new eDwUIHTMLEventMgr;
            var processKeyEventFunc = function (iEvent) {
                var keyEventJQ = iEvent;
                if (iEvent.type === "keydown") {
                    _this.mDownKeys[keyEventJQ.key] = true
                } else if (iEvent.type == "keyup") {
                    delete _this.mDownKeys[keyEventJQ.key]
                } else {
                    return
                }
                var eventHandlers = _this.mKeyEventHandlers[iEvent.type][keyEventJQ.key];
                for (var i in eventHandlers) {
                    var eventHandler = eventHandlers[i];
                    if (l_isEqual(keyEventJQ, eventHandler.Modifiers)) {
                        eventHandler.KeyFunc(keyEventJQ)
                    }
                }
            };
            this.mUIHTMLEventMgr.addEventHandler("document", "keydown", processKeyEventFunc);
            this.mUIHTMLEventMgr.addEventHandler("document", "keyup", processKeyEventFunc);
            this.mUIHTMLEventMgr.addEventHandler("document", "keypress", processKeyEventFunc);
            this.mKeyEventHandlers = {};
            this.mKeyEventHandlers["keydown"] = {};
            this.mKeyEventHandlers["keyup"] = {};
            this.mKeyEventHandlers["keypress"] = {};
            this.mDownKeys = {}
        }

        eDwKeyMgr.get = function () {
            if (!eDwKeyMgr.sKeyMgr) {
                eDwKeyMgr.sKeyMgr = new eDwKeyMgr
            }
            return eDwKeyMgr.sKeyMgr
        };
        eDwKeyMgr.prototype.add = function (iKeyInfo, iEventName, iFunc) {
            var eventHandlers = this.mKeyEventHandlers[iEventName][iKeyInfo.key];
            if (!eventHandlers) {
                eventHandlers = this.mKeyEventHandlers[iEventName][iKeyInfo.key] = {}
            }
            var keyModifiers = l_getKeyModifiers(iKeyInfo);
            this.mKeyEventHandlers[iEventName][iKeyInfo.key][keyModifiers] = {Modifiers: iKeyInfo, KeyFunc: iFunc}
        };
        eDwKeyMgr.prototype.remove = function (iKeyInfo, iEventName) {
            var keyModifiers = l_getKeyModifiers(iKeyInfo);
            delete this.mKeyEventHandlers[iEventName][iKeyInfo.key][keyModifiers]
        };
        eDwKeyMgr.prototype.isDown = function (iKey) {
            return this.mDownKeys[iKey] ? true : false
        };
        eDwKeyMgr.isLMBPressed = function (iEvent) {
            return eDwKeyMgr.getMouseButtonPressed(iEvent) === "left" ? true : false
        };
        eDwKeyMgr.isMMBPressed = function (iEvent) {
            return eDwKeyMgr.getMouseButtonPressed(iEvent) === "middle" ? true : false
        };
        eDwKeyMgr.isRMBPressed = function (iEvent) {
            return eDwKeyMgr.getMouseButtonPressed(iEvent) === "right" ? true : false
        };
        eDwKeyMgr.isAnyPressed = function (iEvent) {
            return eDwKeyMgr.getMouseButtonPressed(iEvent) === "none" ? false : true
        };
        eDwKeyMgr.getMouseButtonPressed = function (iEvent) {
            var buttonPressed = "none";
            if (utils.isOfType(iEvent, "which")) {
                if (utils.isNumber(iEvent.which)) {
                    switch (iEvent.which) {
                        case 0:
                            buttonPressed = "none";
                            break;
                        case 1:
                            buttonPressed = "left";
                            break;
                        case 2:
                            buttonPressed = "middle";
                            break;
                        case 3:
                            buttonPressed = "right";
                            break;
                        default:
                            break
                    }
                } else {
                    switch (iEvent.button) {
                        case 0:
                            return buttonPressed = "none";
                            break;
                        case 1:
                            return buttonPressed = "left";
                            break;
                        case 4:
                            return buttonPressed = "middle";
                            break;
                        case 2:
                            return buttonPressed = "right";
                            break;
                        default:
                            break
                    }
                }
                return buttonPressed
            } else {
                if (iEvent.getButtons() === eDwTypes_6.HC.Buttons.None) {
                    switch (iEvent.getButton()) {
                        case eDwTypes_6.HC.Button.None:
                            buttonPressed = "none";
                            break;
                        case eDwTypes_6.HC.Button.Left:
                            buttonPressed = "left";
                            break;
                        case eDwTypes_6.HC.Button.Middle:
                            buttonPressed = "middle";
                            break;
                        case eDwTypes_6.HC.Button.Right:
                            buttonPressed = "right";
                            break;
                        default:
                            break
                    }
                    return buttonPressed
                }
            }
            switch (iEvent.getButtons()) {
                case eDwTypes_6.HC.Buttons.None:
                    buttonPressed = "none";
                    break;
                case eDwTypes_6.HC.Buttons.Left:
                    buttonPressed = "left";
                    break;
                case eDwTypes_6.HC.Buttons.Middle:
                    buttonPressed = "middle";
                    break;
                case eDwTypes_6.HC.Buttons.Right:
                    buttonPressed = "right";
                    break;
                default:
                    break
            }
            return buttonPressed
        };
        return eDwKeyMgr
    }();
    exports.eDwKeyMgr = eDwKeyMgr;

    function l_isEqual(iKey1, iKey2) {
        var e_8, _a;
        var numMatch = 0;
        var compareFields = ["altKey", "ctrlKey", "metaKey", "shiftKey"];
        try {
            for (var compareFields_1 = __values(compareFields), compareFields_1_1 = compareFields_1.next(); !compareFields_1_1.done; compareFields_1_1 = compareFields_1.next()) {
                var i = compareFields_1_1.value;
                if (iKey1[i] === iKey2[i]) ++numMatch
            }
        } catch (e_8_1) {
            e_8 = {error: e_8_1}
        } finally {
            try {
                if (compareFields_1_1 && !compareFields_1_1.done && (_a = compareFields_1.return)) _a.call(compareFields_1)
            } finally {
                if (e_8) throw e_8.error
            }
        }
        return numMatch === Object.keys(iKey2).length - 1 ? true : false
    }

    function l_getKeyModifiers(iKeyInfo) {
        var keyModifiers = "";
        for (var key in iKeyInfo) {
            if (key.indexOf("Key") > -1 && iKeyInfo[key]) {
                keyModifiers += key + "-"
            }
        }
        return keyModifiers ? keyModifiers.substring(0, keyModifiers.length - 1) : "none"
    }
}));
define("eDwLanguages", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.default = {
        cs: {
            Locale: {
                Code: "cs-CZ",
                FlagUrl: "/images/locale/cs/cs.bmp",
                HelpId: "czech",
                DefaultName: "Czech",
                NativeName: "Čeština"
            },
            Messages: {ConnectionTimeOut: "Vypršel časový limit připojení. Chcete-li pokračovat, znovu načtěte stránku."},
            Placeholders: {
                DebugCategories: "Kategorie ladění konzole",
                SearchFilter: "Zadat text pro filtrování seznamu"
            },
            Strings: {
                All: "Vše",
                AmbientOcclusion: "Okolní okluze",
                AnimateViews: "Animovat pohledy",
                Annotations: "Popisy",
                Angle: "Úhel",
                Area: "Obsah",
                Back: "Zadní",
                Bezier: "Bézierova křivka",
                Bottom: "Dolní",
                Center: "Střed",
                CenterDist: "Vzdálenost od středu",
                Clear: "Vymazat",
                Circle: "Kružnice",
                Components: "Součásti",
                Configurations: "Konfigurace",
                Coordinate: "Souřadnice",
                Curve: "Křivka",
                Cylinder: "Válec",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Průměr",
                Display: "Zobrazit",
                DisplayStates: "Stavy zobrazení",
                Distance: "Vzdálenost",
                DropYourContent: "Přetáhněte obsah sem",
                EnableCapping: "Povolit uzavření",
                Entity: "Entita",
                Explode: "Rozložit",
                ExplodeDown: "Rozložit dolů",
                ExplodeUp: "Rozložit nahoru",
                Face: "Plocha",
                Flip: "Obrátit",
                Front: "Přední",
                Fullscreen: "Na celou obrazovku",
                HiddenLinesRemoved: "Skryté hrany odstraněné",
                HiddenLinesVisible: "Skryté hrany viditelné",
                HideOthers: "Skrýt ostatní",
                HideShow: "Skrýt/Zobrazit",
                Help: "Nápověda",
                Image: "Obrázek",
                Info: "Informace",
                InvalidCombination: "Neplatná kombinace",
                Isometric: "Izometrický",
                Languages: "Jazyky",
                Layers: "Hladiny",
                Left: "Levý",
                Length: "Délka",
                Line: "Přímka",
                Markup: "Značka",
                MaxDistance: "Max. vzdálenost",
                Measure: "Měřit",
                MinDistance: "Min. vzdálenost",
                Move: "Přesunout",
                Name: "Název",
                NormalDist: "Normálnívzdálenost",
                NormalDistance: "Kolmá vzdálenost",
                Or: "Nebo",
                Perimeter: "Obvod",
                Perspective: "Perspektiva",
                Plane: "Rovina",
                Point: "Bod",
                PointToPoint: "Bod-k-bodu",
                Polyline: "Křivka",
                Rectangle: "Obdélník",
                Remove: "Odebrat",
                Reset: "Obnovit",
                Right: "Pravý",
                SearchText: "Zadat text pro filtrování seznamu",
                SectionViews: "Řezy",
                Select: {Edge: "Vybrat hranu", Face: "Vybrat plochu", Vertex: "Vybrat vrchol"},
                Shaded: "Stínovaný",
                ShadedWithEdges: "Stínovaný s hranami",
                Sheets: "Listy",
                Show: {All: "Zobrazit vše", Matrices: "Zobrazit matice", SectionPlane: "Zobrazit rovinu řezu"},
                StraightLine: "Přímka",
                Surface: "Povrch",
                Tables: "Tabulky",
                Text: "Text",
                Top: "Horní",
                TotalLength: "Celková délka",
                TransparentSolid: "Průhledný/Pevný",
                UploadFile: "Nahrát soubor",
                Vertex: "Vrchol",
                ViewsOrientation: "Orientace pohledů",
                ViewFromSectionPlane: "Pohled z roviny řezu",
                ViewFromSelectedFace: "Pohled z vybrané plochy",
                ViewSettings: "Nastavení zobrazení",
                Wireframe: "Drátový režim",
                XYPlane: "Rovina X/Y",
                XZPlane: "Rovina X/Z",
                YZPlane: "Rovina Y/Z",
                XYZMeasurements: "Měření XYZ",
                ZoomToFit: "Zoom na všechno"
            },
            Text: {
                Angle: "Úhel:",
                Browse: "Procházet...",
                Distance: "Vzdálenost:",
                FormatVersion: "Verze formátu:",
                HCVersion: "Verze HC:",
                Linked: "(propojeno)",
                NotLinked: "(nepropojeno)",
                Version: "Verze č.:"
            },
            Titles: {Product: "eDrawings", Error: "Chyba", Info: "Informace", Warning: "Varování"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "stupeň",
                    Inches: "in",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centimetry",
                Degrees: "Stupně",
                Inches: "Palce",
                Feet: "stopy",
                FeetAndInches: "Stopy a palce",
                Meters: "metry",
                Millimeters: "milimetry",
                Radians: "radiány"
            },
            Errors: {
                ContextLost: "Váš prohlížeč nebo zařízení nemá prostředky k zobrazení prohlížeče.",
                Device: {DoesNotSupportTouch: "Toto zařízení nepodporuje dotykové ovládání."},
                Server: {
                    AJAXFailure: "Server je nedostupný. Zkuste to znovu. Pokud chyba přetrvává, nahlaste tuto zprávu zákaznické podpoře.",
                    CannotConnectToLicenseServer: "Licenční server není dostupný. Ověřte, že je server správně nakonfigurován a je aktivní.",
                    LicenseExpired: "Vaše licence vypršela z důvodu nečinnosti, licence byla vrácena na server.",
                    LicenseVersionMismatch: "Došlo k nesouladu verzí licence.",
                    LoadFailure1: "Zobrazení modelu se nezdařilo. Zopakujte načtení a zkuste to znovu. Pokud chyba přetrvává, nahlaste prosím níže uvedené informace zákaznické podpoře.",
                    LoadFailure2: "Server: {0}",
                    LoadFailure3: "ID modelu: {0}",
                    NoMoreLicenses: "V tuto chvíli nejsou bohužel k dispozici žádné licence. Zavřete prosím stávající relaci v aplikaci eDrawings Web Viewer a zkuste to znovu později.",
                    UnableToProcessFile: "Zpracování tohoto souboru nelze dokončit.",
                    UnknownError: "Došlo k chybě. Zkuste to znovu.",
                    UnknownLicenseError: "Došlo k chybě licence. Zkuste to znovu.",
                    UnsupportedFileType: "{0} nelze načíst. Jedná se o nepodporovaný typ souboru.",
                    URLInaccessible: "Nelze získat přístup k adrese URL souboru: {0}",
                    WebSocketFailure: "U prohlížeče se nepodařilo navázat připojení ke streamování."
                },
                Viewer: {LoadFailure: "V prohlížeči se nepodařilo načíst model: {0}"}
            }
        }, de: {
            Locale: {
                Code: "de-DE",
                FlagUrl: "/images/locale/de/D.bmp",
                HelpId: "german",
                DefaultName: "German",
                NativeName: "Deutsch"
            },
            Messages: {ConnectionTimeOut: "Zeitüberschreitung bei der Verbindung. Laden Sie die Seite erneut, um fortzufahren."},
            Placeholders: {
                DebugCategories: "Debuggingkategorien Konsole",
                SearchFilter: "Text in Filterliste eingeben"
            },
            Strings: {
                All: "Alle",
                AmbientOcclusion: "Umgebungslicht-Okklusion",
                AnimateViews: "Ansichtsbewegungssimulation",
                Annotations: "Beschriftungen",
                Angle: "Winkel",
                Area: "Fläche",
                Back: "Hinten",
                Bezier: "Bezier",
                Bottom: "Unten",
                Center: "Mitte",
                CenterDist: "Mittelpunktabstand",
                Clear: "Löschen",
                Circle: "Kreis",
                Components: "Komponenten",
                Configurations: "Konfigurationen",
                Coordinate: "Koordinate",
                Curve: "Kurve",
                Cylinder: "Zylinder",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Durchmesser",
                Display: "Anzeige",
                DisplayStates: "Anzeigestatus",
                Distance: "Abstand",
                DropYourContent: "Legen Sie Ihre Inhalte hier ab",
                EnableCapping: "Deckfläche aktivieren",
                Entity: "Element",
                Explode: "Auflösen",
                ExplodeDown: "Nach unten auflösen",
                ExplodeUp: "Nach oben auflösen",
                Face: "Fläche",
                Flip: "Kippen",
                Front: "Vorne",
                Fullscreen: "Vollbildschirm",
                HiddenLinesRemoved: "Verdeckte Kanten ausgeblendet",
                HiddenLinesVisible: "Verdeckte Kanten sichtbar",
                HideOthers: "Andere ausblenden",
                HideShow: "Ausblenden/Einblenden",
                Help: "Hilfe",
                Image: "Bild",
                Info: "Info",
                InvalidCombination: "Ungültige Kombination",
                Isometric: "Isometrisch",
                Languages: "Sprachen",
                Layers: "Layer",
                Left: "Links",
                Length: "Länge",
                Line: "Linie",
                Markup: "Markierung",
                MaxDistance: "Max. Abstand",
                Measure: "Messen",
                MinDistance: "Min. Abstand",
                Move: "Verschieben",
                Name: "Name",
                NormalDist: "Normalen-Abst.",
                NormalDistance: "Normaler Abstand",
                Or: "Oder",
                Perimeter: "Perimeter",
                Perspective: "Perspektive",
                Plane: "Ebene",
                Point: "Punkt",
                PointToPoint: "Punkt-zu-Punkt",
                Polyline: "Polylinie",
                Rectangle: "Rechteck",
                Remove: "Entfernen",
                Reset: "Zurücksetzen",
                Right: "Rechts",
                SearchText: "Text in Filterliste eingeben",
                SectionViews: "Schnittansichten",
                Select: {Edge: "Kante auswählen", Face: "Fläche auswählen", Vertex: "Eckpunkt auswählen"},
                Shaded: "Schattiert",
                ShadedWithEdges: "Schattiert mit Kanten",
                Sheets: "Blätter",
                Show: {All: "Alles anzeigen", Matrices: "Matrizen anzeigen", SectionPlane: "Schnittebene anzeigen"},
                StraightLine: "Gerade Linie",
                Surface: "Oberfläche",
                Tables: "Tabellen",
                Text: "Text",
                Top: "Oben",
                TotalLength: "Gesamtlänge",
                TransparentSolid: "Transparent/Fest",
                UploadFile: "Datei hochladen",
                Vertex: "Eckpunkt",
                ViewsOrientation: "Ausrichtung Ansichten",
                ViewFromSectionPlane: "Ansicht von Schnittebene",
                ViewFromSelectedFace: "Ansicht von ausgewählter Fläche",
                ViewSettings: "Einstellungen anzeigen",
                Wireframe: "Drahtdarstellung",
                XYPlane: "X/Y-Ebene",
                XZPlane: "X/Z-Ebene",
                YZPlane: "Y/Z-Ebene",
                XYZMeasurements: "XYZ-Abmessungen",
                ZoomToFit: "In Fenster zoomen"
            },
            Text: {
                Angle: "Winkel:",
                Browse: "Durchsuchen...",
                Distance: "Abstand:",
                FormatVersion: "Formatversion:",
                HCVersion: "HC-Version:",
                Linked: "(verknüpft)",
                NotLinked: "(nicht verknüpft)",
                Version: "Version Nr.:"
            },
            Titles: {Product: "eDrawings", Error: "Fehler", Info: "Information", Warning: "Warnung"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "Grad",
                    Inches: "Zoll",
                    Feet: "Fuß",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Zentimeter",
                Degrees: "Grad",
                Inches: "Zoll",
                Feet: "Fuß",
                FeetAndInches: "Fuß und Zoll",
                Meters: "Meter",
                Millimeters: "Millimeter",
                Radians: "Radiant"
            },
            Errors: {
                ContextLost: "Ihr Browser oder Gerät verfügt nicht über die notwendigen Ressourcen, um den Viewer anzuzeigen.",
                Device: {DoesNotSupportTouch: "Dieses Gerät verfügt nicht über Touch-Unterstützung."},
                Server: {
                    AJAXFailure: "Server nicht verfügbar. Versuchen Sie es erneut. Wenn der Fehler weiterhin besteht, leiten Sie diese Meldung an den Kundensupport weiter.",
                    CannotConnectToLicenseServer: "Der Lizenzserver kann nicht erreicht werden. Bitte überprüfen Sie, ob der Server korrekt konfiguriert ist und ob der Lizenzserver ausgeführt wird.",
                    LicenseExpired: "Ihre Lizenz ist aufgrund von Inaktivität abgelaufen, die Lizenz wurde an den Server zurückgegeben.",
                    LicenseVersionMismatch: "Die Lizenzversionen stimmen nicht überein.",
                    LoadFailure1: "Anzeigen des Modells fehlgeschlagen, neu laden und erneut versuchen. Wenn der Fehler weiterhin besteht, leiten Sie die untenstehenden Informationen an den Kundensupport weiter.",
                    LoadFailure2: "Server: {0}",
                    LoadFailure3: "Modell-ID: {0}",
                    NoMoreLicenses: "Der Lizenzserver ist derzeit leider nicht verfügbar. Schließen Sie eine bestehende Sitzung des eDrawings Web Viewers und versuchen Sie es später erneut.",
                    UnableToProcessFile: "Die Verarbeitung der Datei konnte nicht abgeschlossen werden.",
                    UnknownError: "Ein Fehler ist aufgetreten, versuchen Sie es erneut.",
                    UnknownLicenseError: "Ein Lizenzfehler ist aufgetreten, versuchen Sie es erneut.",
                    UnsupportedFileType: "{0} kann nicht geladen werden, der Dateityp wird nicht unterstützt.",
                    URLInaccessible: "Kein Zugriff auf Datei-URL: {0}",
                    WebSocketFailure: "Streaming-Verbindung zum Viewer konnte nicht hergestellt werden."
                },
                Viewer: {LoadFailure: "Das Modell konnte nicht im Viewer geladen werden: {0}"}
            }
        }, en: {
            Locale: {
                Code: "en-US",
                FlagUrl: "/images/locale/en/gb.bmp",
                HelpId: "english",
                DefaultName: "English",
                NativeName: "English"
            },
            Messages: {ConnectionTimeOut: "Connection timed-out.  Reload the page to continue."},
            Placeholders: {DebugCategories: "Console debug categories", SearchFilter: "Enter text to filter list"},
            Strings: {
                All: "All",
                AmbientOcclusion: "Ambient Occlusion",
                AnimateViews: "Animate Views",
                Annotations: "Annotations",
                Angle: "Angle",
                Area: "Area",
                Back: "Back",
                Bezier: "Bezier",
                Bottom: "Bottom",
                Center: "Center",
                CenterDist: "Center Dist.",
                Clear: "Clear",
                Circle: "Circle",
                Components: "Components",
                Configurations: "Configurations",
                Coordinate: "Coordinate",
                Curve: "Curve",
                Cylinder: "Cylinder",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Diameter",
                Display: "Display",
                DisplayStates: "Display States",
                Distance: "Distance",
                DropYourContent: "Drop your content here",
                EnableCapping: "Enable Capping",
                Entity: "Entity",
                Explode: "Explode",
                ExplodeDown: "Explode Down",
                ExplodeUp: "Explode Up",
                Face: "Face",
                Flip: "Flip",
                Front: "Front",
                Fullscreen: "Fullscreen",
                HiddenLinesRemoved: "Hidden Lines Removed",
                HiddenLinesVisible: "Hidden Lines Visible",
                HideOthers: "Hide Others",
                HideShow: "Hide/Show",
                Help: "Help",
                Image: "Image",
                Info: "Info",
                InvalidCombination: "Invalid combination",
                Isometric: "Isometric",
                Languages: "Languages",
                Layers: "Layers",
                Left: "Left",
                Length: "Length",
                Line: "Line",
                Markup: "Markup",
                MaxDistance: "Max Distance",
                Measure: "Measure",
                MinDistance: "Min Distance",
                Move: "Move",
                Name: "Name",
                NormalDist: "Normal Dist.",
                NormalDistance: "Normal Distance",
                Or: "Or",
                Perimeter: "Perimeter",
                Perspective: "Perspective",
                Plane: "Plane",
                Point: "Point",
                PointToPoint: "Point-to-Point",
                Polyline: "Polyline",
                Rectangle: "Rectangle",
                Remove: "Remove",
                Reset: "Reset",
                Right: "Right",
                SearchText: "Enter text to filter list",
                SectionViews: "Section Views",
                Select: {Edge: "Select Edge", Face: "Select Face", Vertex: "Select Vertex"},
                Shaded: "Shaded",
                ShadedWithEdges: "Shaded With Edges",
                Sheets: "Sheets",
                Show: {All: "Show All", Matrices: "Show Matrices", SectionPlane: "Show Section Plane"},
                StraightLine: "Straight Line",
                Surface: "Surface",
                Tables: "Tables",
                Text: "Text",
                Top: "Top",
                TotalLength: "Total Length",
                TransparentSolid: "Transparent/Solid",
                UploadFile: "Upload file",
                Vertex: "Vertex",
                ViewsOrientation: "Views orientation",
                ViewFromSectionPlane: "View the from Section Plane",
                ViewFromSelectedFace: "View from Selected Face",
                ViewSettings: "View Settings",
                Wireframe: "Wireframe",
                XYPlane: "X/Y Plane",
                XZPlane: "X/Z Plane",
                YZPlane: "Y/Z Plane",
                XYZMeasurements: "XYZ Measurements",
                ZoomToFit: "Zoom to Fit",
                CompNameUnknown: "Component Name Unknown"
            },
            Text: {
                Angle: "Angle:",
                Browse: "Browse...",
                Distance: "Distance:",
                FormatVersion: "Format Version:",
                HCVersion: "HC Version:",
                Linked: "(linked)",
                NotLinked: "(not linked)",
                Version: "Version #:"
            },
            Titles: {Product: "eDrawings", Error: "Error", Info: "Information", Warning: "Warning"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "deg",
                    Inches: "in",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centimeters",
                Degrees: "Degrees",
                Inches: "Inches",
                Feet: "Feet",
                FeetAndInches: "Feet and Inches",
                Meters: "Meters",
                Millimeters: "Millimeters",
                Radians: "Radians"
            },
            Errors: {
                ContextLost: "Your browser or device does not have the resources to display the viewer.",
                Device: {DoesNotSupportTouch: "This device does not support touch."},
                Server: {
                    AJAXFailure: "Server unavailable.  Please try again.  If the failure persists, please report this message to customer support.",
                    CannotConnectToLicenseServer: "The license server is not reachable. Please confirm that the server is configured correctly and that the license server is running.",
                    LicenseExpired: "Your license has timed out due to inactivity, license has been returned to the server.",
                    LicenseVersionMismatch: "There is a license version mismatch.",
                    LoadFailure1: "Model viewing failed.  Please reload and try again.  If the failure persists, please report the information below to customer support.",
                    LoadFailure2: "Server: {0}",
                    LoadFailure3: "Model ID: {0}",
                    NoMoreLicenses: "We're sorry, no licenses are available at this time. Please close an existing session of eDrawings Web Viewer and try again later.",
                    UnableToProcessFile: "Unable to complete processing of this file.",
                    UnknownError: "An error occurred.  Please try again.",
                    UnknownLicenseError: "A licensing error occurred.  Please try again.",
                    UnsupportedFileType: "Can not load {0}.  It is an unsupported file type.",
                    URLInaccessible: "Cannot access file URL: {0}",
                    WebSocketFailure: "Could not establish streaming connection for viewer."
                },
                Viewer: {LoadFailure: "Failed to load model in the viewer: {0}"}
            }
        }, es: {
            Locale: {
                Code: "es-ES",
                FlagUrl: "/images/locale/es/E.bmp",
                HelpId: "spanish",
                DefaultName: "Spanish",
                NativeName: "Español"
            },
            Messages: {ConnectionTimeOut: "Se ha agotado el tiempo de espera de conexión.  Vuelva a cargar la página para continuar."},
            Placeholders: {
                DebugCategories: "Categorías de debug de consola",
                SearchFilter: "Introduzca texto para filtrar la lista"
            },
            Strings: {
                All: "Todo",
                AmbientOcclusion: "Oclusión de ambiente",
                AnimateViews: "Animar vistas",
                Annotations: "Anotaciones",
                Angle: "Ángulo",
                Area: "Área",
                Back: "Atrás",
                Bezier: "Bézier",
                Bottom: "Inferior",
                Center: "Centro",
                CenterDist: "Dist. al centro",
                Clear: "Borrar",
                Circle: "Círculo",
                Components: "Componentes",
                Configurations: "Configuraciones",
                Coordinate: "Coordenar",
                Curve: "Curva",
                Cylinder: "Cilindro",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Diámetro",
                Display: "Visualizar",
                DisplayStates: "Estados de visualización",
                Distance: "Distancia",
                DropYourContent: "Coloque su contenido aquí",
                EnableCapping: "Activar tapado",
                Entity: "Entidad",
                Explode: "Explosionar",
                ExplodeDown: "Explosionar hacia abajo",
                ExplodeUp: "Explosionar hacia arriba",
                Face: "Cara",
                Flip: "Invertir",
                Front: "Frontal",
                Fullscreen: "Pantalla completa",
                HiddenLinesRemoved: "Sin líneas ocultas",
                HiddenLinesVisible: "Líneas ocultas visibles",
                HideOthers: "Ocultar otros",
                HideShow: "Ocultar/Mostrar",
                Help: "Ayuda",
                Image: "Imagen",
                Info: "Información",
                InvalidCombination: "Combinación no válida",
                Isometric: "Isométrica",
                Languages: "Idiomas",
                Layers: "Capas",
                Left: "Izquierda",
                Length: "Longitud",
                Line: "Línea",
                Markup: "Marca",
                MaxDistance: "Distancia máx.",
                Measure: "Medir",
                MinDistance: "Distancia mín.",
                Move: "Mover",
                Name: "Nombre",
                NormalDist: "Dist. normal",
                NormalDistance: "Distancia normal",
                Or: "O",
                Perimeter: "Perímetro",
                Perspective: "Perspectiva",
                Plane: "Plano",
                Point: "Puntual",
                PointToPoint: "Punto a punto",
                Polyline: "Polilínea",
                Rectangle: "Rectángulo",
                Remove: "Eliminar",
                Reset: "Restablecer",
                Right: "Derecha",
                SearchText: "Escriba texto para filtrar la lista",
                SectionViews: "Vistas de sección",
                Select: {Edge: "Seleccionar arista", Face: "Seleccionar cara", Vertex: "Seleccionar vértice"},
                Shaded: "Sombreado",
                ShadedWithEdges: "Sombreado con aristas",
                Sheets: "Hojas",
                Show: {All: "Mostrar todo", Matrices: "Mostrar matrices", SectionPlane: "Mostrar plano de sección"},
                StraightLine: "Línea recta",
                Surface: "Superficie",
                Tables: "Tablas",
                Text: "Texto",
                Top: "Superior",
                TotalLength: "Longitud total",
                TransparentSolid: "Transparente/Sólido",
                UploadFile: "Cargar archivo",
                Vertex: "Vértice",
                ViewsOrientation: "Orientación de vistas",
                ViewFromSectionPlane: "Vista del plano de sección",
                ViewFromSelectedFace: "Vista de la cara seleccionada",
                ViewSettings: "Ver configuración",
                Wireframe: "Estructura alámbrica",
                XYPlane: "Plano X/Y",
                XZPlane: "Plano X/Z",
                YZPlane: "Plano Y/Z",
                XYZMeasurements: "Medidas XYZ",
                ZoomToFit: "Zoom para ajustar"
            },
            Text: {
                Angle: "Ángulo:",
                Browse: "Examinar...",
                Distance: "Distancia:",
                FormatVersion: "Versión de formato:",
                HCVersion: "Versión de HC:",
                Linked: "(vinculada)",
                NotLinked: "(no vinculada)",
                Version: "N.º de versión:"
            },
            Titles: {Product: "eDrawings", Error: "Error", Info: "Información", Warning: "Advertencia"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "°",
                    Inches: "pulgadas",
                    Feet: "pies",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centímetros",
                Degrees: "Grados",
                Inches: "Pulgadas",
                Feet: "Pies",
                FeetAndInches: "Pies y pulgadas",
                Meters: "Metros",
                Millimeters: "Milímetros",
                Radians: "Radianes"
            },
            Errors: {
                ContextLost: "Su explorador o dispositivo no tiene los recursos necesarios para mostrar el visor.",
                Device: {DoesNotSupportTouch: "Este dispositivo no tiene compatibilidad táctil."},
                Server: {
                    AJAXFailure: "El servidor no está disponible.  Inténtelo de nuevo.  Si el fallo persiste, informe de este mensaje al servicio de atención al cliente.",
                    CannotConnectToLicenseServer: "No se puede obtener el servidor de licencias. Confirme que el servidor se ha configurado correctamente y que el servidor de licencias se encuentra operativo.",
                    LicenseExpired: "Se ha agotado el tiempo de espera de su licencia debido a inactividad, por lo que se ha devuelto al servidor.",
                    LicenseVersionMismatch: "Existe una discrepancia de versión de licencia.",
                    LoadFailure1: "Se ha producido un error en la visualización de modelo.  Vuelva a cargar e inténtelo de nuevo.  Si el fallo persiste, notifique la siguiente información al servicio de atención al cliente.",
                    LoadFailure2: "Servidor: {0}",
                    LoadFailure3: "ID de modelo: {0}",
                    NoMoreLicenses: "Lo sentimos, no hay licencias disponibles en este momento. Cierre una sesión existente de eDrawings Web Viewer e inténtelo de nuevo más tarde.",
                    UnableToProcessFile: "No se ha podido completar el procesamiento de este archivo.",
                    UnknownError: "Se ha producido un error.  Inténtelo de nuevo.",
                    UnknownLicenseError: "Se ha producido un error de licencia.  Inténtelo de nuevo.",
                    UnsupportedFileType: "No se puede cargar {0}.  El tipo de archivo no es compatible.",
                    URLInaccessible: "No se puede acceder a la URL de archivo: {0}",
                    WebSocketFailure: "No se ha podido establecer la conexión de secuencia para el visor."
                },
                Viewer: {LoadFailure: "Error al cargar el modelo en el visor: {0}"}
            }
        }, fr: {
            Locale: {
                Code: "fr-FR",
                FlagUrl: "/images/locale/fr/F.bmp",
                HelpId: "french",
                DefaultName: "French",
                NativeName: "Français"
            },
            Messages: {ConnectionTimeOut: "La connexion a expiré. Rechargez la page pour continuer."},
            Placeholders: {
                DebugCategories: "Catégories de débogage de la console",
                SearchFilter: "Entrez un texte pour filtrer la liste"
            },
            Strings: {
                All: "Tous",
                AmbientOcclusion: "Occlusion ambiante",
                AnimateViews: "Animer les vues",
                Annotations: "Annotations",
                Angle: "Angle",
                Area: "Superficie",
                Back: "Retour",
                Bezier: "Bézier",
                Bottom: "Bas",
                Center: "Centre",
                CenterDist: "Dist. centre",
                Clear: "Effacer",
                Circle: "Cercle",
                Components: "Composants",
                Configurations: "Configurations",
                Coordinate: "Coordonnée",
                Curve: "Courbe",
                Cylinder: "Cylindre",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Diamètre",
                Display: "Afficher",
                DisplayStates: "Etats d'affichage",
                Distance: "Distance",
                DropYourContent: "Déposez votre contenu ici",
                EnableCapping: "Activer la limitation",
                Entity: "Entité",
                Explode: "Eclater",
                ExplodeDown: "Eclater vers le bas",
                ExplodeUp: "Eclater vers le haut",
                Face: "Face",
                Flip: "Inverser",
                Front: "Avant",
                Fullscreen: "Plein écran",
                HiddenLinesRemoved: "Lignes cachées supprimées",
                HiddenLinesVisible: "Lignes cachées apparentes",
                HideOthers: "Cacher les autres",
                HideShow: "Cacher/Montrer",
                Help: "Aide",
                Image: "Image",
                Info: "Info",
                InvalidCombination: "Combinaison non valide",
                Isometric: "Isométrique",
                Languages: "Langues",
                Layers: "Calques",
                Left: "Gauche",
                Length: "Longueur",
                Line: "Ligne",
                Markup: "Marquage",
                MaxDistance: "Distance max.",
                Measure: "Mesurer",
                MinDistance: "Distance min.",
                Move: "Déplacer",
                Name: "Nom",
                NormalDist: "Dist. normale",
                NormalDistance: "Distance normale",
                Or: "Ou",
                Perimeter: "Périmètre",
                Perspective: "Perspective",
                Plane: "Plan",
                Point: "Point",
                PointToPoint: "Point-à-point",
                Polyline: "Polyligne",
                Rectangle: "Rectangle",
                Remove: "Supprimer",
                Reset: "Réinitialiser",
                Right: "Droite",
                SearchText: "Entrez un texte pour filtrer la liste",
                SectionViews: "Vues en coupe",
                Select: {
                    Edge: "Sélectionner une arête",
                    Face: "Sélectionner une face",
                    Vertex: "Sélectionner un sommet"
                },
                Shaded: "Image ombrée",
                ShadedWithEdges: "Arêtes en mode Image ombrée",
                Sheets: "Feuilles",
                Show: {All: "Montrer tout", Matrices: "Montrer les matrices", SectionPlane: "Montrer le plan de coupe"},
                StraightLine: "Ligne droite",
                Surface: "Surface",
                Tables: "Tables",
                Text: "Texte",
                Top: "Haut",
                TotalLength: "Longueur totale",
                TransparentSolid: "Transparent/Solide",
                UploadFile: "Charger un fichier",
                Vertex: "Sommet",
                ViewsOrientation: "Orientation des vues",
                ViewFromSectionPlane: "Vue depuis le plan de coupe",
                ViewFromSelectedFace: "Vue depuis la face sélectionnée",
                ViewSettings: "Paramètres d'affichage",
                Wireframe: "Filaire",
                XYPlane: "Plan X/Y",
                XZPlane: "Plan X/Z",
                YZPlane: "Plan Y/Z",
                XYZMeasurements: "Mesures XYZ",
                ZoomToFit: "Zoom au mieux"
            },
            Text: {
                Angle: "Angle :",
                Browse: "Parcourir...",
                Distance: "Distance :",
                FormatVersion: "Version du format :",
                HCVersion: "Version HC :",
                Linked: "(lié)",
                NotLinked: "(non lié)",
                Version: "N° de version :"
            },
            Titles: {Product: "eDrawings", Error: "Erreur", Info: "Information", Warning: "Avertissement"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "deg",
                    Inches: "po",
                    Feet: "pi",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centimètres",
                Degrees: "Degrés",
                Inches: "Pouces",
                Feet: "Pieds",
                FeetAndInches: "Pieds et pouces",
                Meters: "Mètres",
                Millimeters: "Millimètres",
                Radians: "Radians"
            },
            Errors: {
                ContextLost: "Votre navigateur ou périphérique ne dispose pas des ressources pour afficher le visualisateur.",
                Device: {DoesNotSupportTouch: "Ce périphérique ne prend pas en charge la fonction tactile."},
                Server: {
                    AJAXFailure: "Serveur non disponible. Veuillez réessayer. Si l'erreur persiste, veuillez signaler ce message au support clientèle.",
                    CannotConnectToLicenseServer: "Le serveur de licences n'est pas accessible. Vérifiez que le serveur est correctement configuré et que le serveur de licences est en cours d'exécution.",
                    LicenseExpired: "Votre licence a expiré pour des raisons d'inactivité. La licence a été renvoyée au serveur.",
                    LicenseVersionMismatch: "La version de la licence ne correspond pas.",
                    LoadFailure1: "Echec de l'affichage du modèle. Veuillez recharger et réessayer. Si l'erreur persiste, veuillez transmettre les informations ci-dessous au support clientèle.",
                    LoadFailure2: "Serveur : {0}",
                    LoadFailure3: "ID de modèle : {0}",
                    NoMoreLicenses: "Nous sommes désolés, aucune licence n'est disponible pour le moment. Clonez une session existante d'eDrawings Web Viewer et réessayez ultérieurement.",
                    UnableToProcessFile: "Impossible de terminer le traitement de ce fichier.",
                    UnknownError: "Une erreur s'est produite. Veuillez réessayer.",
                    UnknownLicenseError: "Une erreur de licence s'est produite. Veuillez réessayer.",
                    UnsupportedFileType: "Impossible de charger {0}. Ce type de fichier n'est pas pris en charge.",
                    URLInaccessible: "Impossible d'accéder à l'URL de fichier : {0}",
                    WebSocketFailure: "Impossible d'établir une connexion de diffusion en continu pour le visualisateur."
                },
                Viewer: {LoadFailure: "Echec du chargement du modèle dans le visualisateur : {0}"}
            }
        }, it: {
            Locale: {
                Code: "it-IT",
                FlagUrl: "/images/locale/it/I.bmp",
                HelpId: "italian",
                DefaultName: "Italian",
                NativeName: "Italiano"
            },
            Messages: {ConnectionTimeOut: "Connessione scaduta. Ricaricare la pagina per continuare."},
            Placeholders: {
                DebugCategories: "Categorie di debug console",
                SearchFilter: "Immetti testo per filtrare l'elenco"
            },
            Strings: {
                All: "Tutte",
                AmbientOcclusion: "Occlusione ambiente",
                AnimateViews: "Animazione viste",
                Annotations: "Annotazioni",
                Angle: "Angolo",
                Area: "Area",
                Back: "Posteriore",
                Bezier: "Bezier",
                Bottom: "Inferiore",
                Center: "Centro",
                CenterDist: "Dist centrale",
                Clear: "Cancella",
                Circle: "Cerchio",
                Components: "Componenti",
                Configurations: "Configurazioni",
                Coordinate: "Coordinata",
                Curve: "Curva",
                Cylinder: "Cilindro",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Diametro",
                Display: "Visualizzazione",
                DisplayStates: "Stati di visualizzazione",
                Distance: "Distanza",
                DropYourContent: "Rilascia qui il tuo contenuto",
                EnableCapping: "Consenti chiusura",
                Entity: "Entità",
                Explode: "Esplodi",
                ExplodeDown: "Esplodi giù",
                ExplodeUp: "Esplodi su",
                Face: "Faccia",
                Flip: "Inverti",
                Front: "Anteriore",
                Fullscreen: "Schermo intero",
                HiddenLinesRemoved: "Linee nascoste rimosse",
                HiddenLinesVisible: "Linee nascoste visibili",
                HideOthers: "Nascondi altri",
                HideShow: "Nascondi/Mostra",
                Help: "Guida",
                Image: "Immagine",
                Info: "Informazioni",
                InvalidCombination: "Combinazione non valida",
                Isometric: "Isometrica",
                Languages: "Lingue",
                Layers: "Livelli",
                Left: "Sinistra",
                Length: "Lunghezza",
                Line: "Linea",
                Markup: "Annotazione",
                MaxDistance: "Distanza max",
                Measure: "Misura",
                MinDistance: "Distanza min",
                Move: "Sposta",
                Name: "Nome",
                NormalDist: "Dist normale",
                NormalDistance: "Distanza normale",
                Or: "Oppure",
                Perimeter: "Perimetro",
                Perspective: "Prospettiva",
                Plane: "Piano",
                Point: "Punto",
                PointToPoint: "Da punto a punto",
                Polyline: "Polilinea",
                Rectangle: "Rettangolo",
                Remove: "Rimuovi",
                Reset: "Azzera",
                Right: "Destra",
                SearchText: "Immetti testo per filtrare l'elenco",
                SectionViews: "Viste di sezione",
                Select: {Edge: "Seleziona bordo", Face: "Seleziona faccia", Vertex: "Seleziona vertice"},
                Shaded: "Ombreggiato",
                ShadedWithEdges: "Ombreggiato con bordi",
                Sheets: "Fogli",
                Show: {All: "Mostra tutto", Matrices: "Mostra matrici", SectionPlane: "Mostra piano di sezione"},
                StraightLine: "Linea retta",
                Surface: "Superficie",
                Tables: "Tabelle",
                Text: "Testo",
                Top: "Superiore",
                TotalLength: "Lunghezza totale",
                TransparentSolid: "Trasparente/Solido",
                UploadFile: "Carica file",
                Vertex: "Vertice",
                ViewsOrientation: "Orientamento delle viste",
                ViewFromSectionPlane: "Vista dal piano di sezione",
                ViewFromSelectedFace: "Vista dalla faccia selezionata",
                ViewSettings: "Impostazioni vista",
                Wireframe: "Struttura a reticolo",
                XYPlane: "Piano X/Y",
                XZPlane: "Piano X/Z",
                YZPlane: "Piano Y/Z",
                XYZMeasurements: "Misure XYZ",
                ZoomToFit: "Zoom ottimizzato"
            },
            Text: {
                Angle: "Angolo:",
                Browse: "Sfoglia...",
                Distance: "Distanza:",
                FormatVersion: "Versione formato:",
                HCVersion: "Versione HC:",
                Linked: "(collegato)",
                NotLinked: "(non collegato)",
                Version: "N. versione:"
            },
            Titles: {Product: "eDrawings", Error: "Errore", Info: "Informazioni", Warning: "Avvertimento"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "gradi",
                    Inches: "in",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "raggio"
                },
                Centimeters: "Centimetri",
                Degrees: "Gradi",
                Inches: "Pollici",
                Feet: "Piedi",
                FeetAndInches: "Piedi e pollici",
                Meters: "Metri",
                Millimeters: "Millimetri",
                Radians: "Radianti"
            },
            Errors: {
                ContextLost: "Il browser o dispositivo in uso non dispone delle risorse per visualizzare il visualizzatore.",
                Device: {DoesNotSupportTouch: "Questo dispositivo non supporta il tocco."},
                Server: {
                    AJAXFailure: "Server non disponibile. Riprovare. Se l'errore persiste, segnalare questo messaggio al supporto clienti.",
                    CannotConnectToLicenseServer: "Il server delle licenze non è raggiungibile. Verificare che il server sia configurato correttamente e che il server delle licenze sia in esecuzione.",
                    LicenseExpired: "La licenza è scaduta a causa di inattività ed è stata restituita al server.",
                    LicenseVersionMismatch: "La versione della licenza non corrisponde.",
                    LoadFailure1: "Visualizzazione del modello non riuscita. Ricaricare e riprovare. Se l'errore persiste, segnalare le seguenti informazioni al supporto clienti.",
                    LoadFailure2: "Server: {0}",
                    LoadFailure3: "ID modello: {0}",
                    NoMoreLicenses: "Spiacenti, non sono disponibili licenze al momento. Chiudere la sessione esistente di eDrawings Web Viewer e riprovare in seguito.",
                    UnableToProcessFile: "Impossibile completare l'elaborazione di questo file.",
                    UnknownError: "Si è verificato un errore. Riprovare.",
                    UnknownLicenseError: "Si è verificato un errore di licenza. Riprovare.",
                    UnsupportedFileType: "Impossibile caricare {0}. Si tratta di un tipo di file non supportato.",
                    URLInaccessible: "Impossibile accedere all'URL del file: {0}",
                    WebSocketFailure: "Impossibile stabilire la connessione in streaming per il visualizzatore."
                },
                Viewer: {LoadFailure: "Impossibile caricare il modello nel visualizzatore: {0}"}
            }
        }, ja: {
            Locale: {
                Code: "ja-JP",
                FlagUrl: "/images/locale/ja/J.bmp",
                HelpId: "japanese",
                DefaultName: "Japanese",
                NativeName: "日本語"
            },
            Messages: {ConnectionTimeOut: "接続がﾀｲﾑｱｳﾄしました。続行するには、ﾍﾟｰｼﾞを再ﾛｰﾄﾞしてください。"},
            Placeholders: {DebugCategories: "ｺﾝｿｰﾙ ﾃﾞﾊﾞｯｸﾞ ｶﾃｺﾞﾘ", SearchFilter: "ﾌｨﾙﾀｰ ﾘｽﾄに入力"},
            Strings: {
                All: "すべて",
                AmbientOcclusion: "ｱﾝﾋﾞｴﾝﾄ ｵｸﾙｰｼﾞｮﾝ",
                AnimateViews: "ｱﾆﾒｰｼｮﾝ表示",
                Annotations: "ｱﾉﾃｰﾄ ｱｲﾃﾑ",
                Angle: "角度",
                Area: "領域",
                Back: "背面",
                Bezier: "ﾍﾞｼﾞｪ",
                Bottom: "下",
                Center: "中心",
                CenterDist: "中心距離",
                Clear: "ｸﾘｱ",
                Circle: "円",
                Components: "構成部品",
                Configurations: "ｺﾝﾌｨｷﾞｭﾚｰｼｮﾝ",
                Coordinate: "座標",
                Curve: "ｶｰﾌﾞ",
                Cylinder: "ｼﾘﾝﾀﾞ",
                Debug: "Debug",
                Delta: {Label: "ﾃﾞﾙﾀ", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "直径",
                Display: "表示",
                DisplayStates: "ｽﾃｰﾀｽを表示",
                Distance: "距離",
                DropYourContent: "ｺﾝﾃﾝﾂをここにﾄﾞﾛｯﾌﾟします",
                EnableCapping: "ｷｬｯﾋﾟﾝｸﾞを有効化",
                Entity: "ｴﾝﾃｨﾃｨ",
                Explode: "分解",
                ExplodeDown: "分解 ﾀﾞｳﾝ",
                ExplodeUp: "分解 ｱｯﾌﾟ",
                Face: "面",
                Flip: "反転",
                Front: "正面",
                Fullscreen: "全画面表示",
                HiddenLinesRemoved: "隠線なし",
                HiddenLinesVisible: "隠線表示",
                HideOthers: "他は非表示",
                HideShow: "非表示/表示",
                Help: "ﾍﾙﾌﾟ",
                Image: "ｲﾒｰｼﾞ",
                Info: "情報",
                InvalidCombination: "無効な組み合わせ",
                Isometric: "等角投影",
                Languages: "言語",
                Layers: "ﾚｲﾔｰ",
                Left: "左",
                Length: "長さ",
                Line: "直線",
                Markup: "ﾏｰｸｱｯﾌﾟ",
                MaxDistance: "最大距離",
                Measure: "測定",
                MinDistance: "最小距離",
                Move: "移動",
                Name: "名前",
                NormalDist: "標準距離",
                NormalDistance: "標準距離",
                Or: "OR",
                Perimeter: "外周",
                Perspective: "ﾊﾟｰｽ表示",
                Plane: "平面",
                Point: "点",
                PointToPoint: "点から点へ",
                Polyline: "ﾎﾟﾘﾗｲﾝ",
                Rectangle: "矩形",
                Remove: "削除",
                Reset: "ﾘｾｯﾄ",
                Right: "右",
                SearchText: "ﾌｨﾙﾀｰ ﾘｽﾄに入力",
                SectionViews: "断面図",
                Select: {Edge: "ｴｯｼﾞを選択", Face: "面を選択", Vertex: "頂点を選択"},
                Shaded: "ｼｪｲﾃﾞｨﾝｸﾞ",
                ShadedWithEdges: "ｴｯｼﾞ ｼｪｲﾃﾞｨﾝｸﾞ表示",
                Sheets: "ｼｰﾄ",
                Show: {All: "すべて表示", Matrices: "ﾏﾄﾘｯｸｽを表示", SectionPlane: "断面平面を表示"},
                StraightLine: "直線",
                Surface: "ｻｰﾌｪｽ",
                Tables: "ﾃｰﾌﾞﾙ",
                Text: "ﾃｷｽﾄ",
                Top: "上",
                TotalLength: "長さの合計",
                TransparentSolid: "透明/固体",
                UploadFile: "ﾌｧｲﾙをｱｯﾌﾟﾛｰﾄﾞ",
                Vertex: "頂点",
                ViewsOrientation: "表示方向",
                ViewFromSectionPlane: "断面平面から表示",
                ViewFromSelectedFace: "選択面から表示",
                ViewSettings: "表示設定",
                Wireframe: "ﾜｲﾔﾌﾚｰﾑ",
                XYPlane: "X/Y 平面",
                XZPlane: "X/Z 平面",
                YZPlane: "Y/Z 平面",
                XYZMeasurements: "XYZ 測定",
                ZoomToFit: "ｳｨﾝﾄﾞｳにﾌｨｯﾄ"
            },
            Text: {
                Angle: "角度:",
                Browse: "参照...",
                Distance: "距離:",
                FormatVersion: "ﾌｫｰﾏｯﾄ ﾊﾞｰｼﾞｮﾝ:",
                HCVersion: "HC ﾊﾞｰｼﾞｮﾝ:",
                Linked: "(ﾘﾝｸ済み)",
                NotLinked: "(未ﾘﾝｸ)",
                Version: "ﾊﾞｰｼﾞｮﾝ番号:"
            },
            Titles: {Product: "eDrawings", Error: "ｴﾗｰ", Info: "情報", Warning: "警告"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "deg",
                    Inches: "in",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "ｾﾝﾁﾒｰﾀ",
                Degrees: "度",
                Inches: "ｲﾝﾁ",
                Feet: "ﾌｨｰﾄ",
                FeetAndInches: "ﾌｨｰﾄとｲﾝﾁ",
                Meters: "ﾒｰﾄﾙ",
                Millimeters: "ﾐﾘﾒｰﾄﾙ",
                Radians: "ﾗｼﾞｱﾝ"
            },
            Errors: {
                ContextLost: "ﾌﾞﾗｳｻﾞまたはﾃﾞﾊﾞｲｽにﾋﾞｭｰｱを表示するためのﾘｿｰｽがありません。",
                Device: {DoesNotSupportTouch: "このﾃﾞﾊﾞｲｽはﾀｯﾁ操作をｻﾎﾟｰﾄしていません。"},
                Server: {
                    AJAXFailure: "ｻｰﾊﾞｰを使用できません。再試行してください。問題が解決しない場合は、このﾒｯｾｰｼﾞをｶｽﾀﾏｰ ｻﾎﾟｰﾄに報告してください。",
                    CannotConnectToLicenseServer: "ﾗｲｾﾝｽ ｻｰﾊﾞｰにｱｸｾｽできません。ｻｰﾊﾞｰが正しく設定され、ﾗｲｾﾝｽ ｻｰﾊﾞｰが実行中であることを確認してください。",
                    LicenseExpired: "ｱｸﾃｨﾌﾞでないためﾗｲｾﾝｽがﾀｲﾑｱｳﾄになりました。ﾗｲｾﾝｽはｻｰﾊﾞｰに返却されています。",
                    LicenseVersionMismatch: "ﾗｲｾﾝｽ ﾊﾞｰｼﾞｮﾝの不一致があります。",
                    LoadFailure1: "ﾓﾃﾞﾙの表示に失敗しました。再ﾛｰﾄﾞして再試行してください。問題が解決しない場合は、以下の情報をｶｽﾀﾏｰ ｻﾎﾟｰﾄに報告してください。",
                    LoadFailure2: "ｻｰﾊﾞｰ: {0}",
                    LoadFailure3: "ﾓﾃﾞﾙ ID: {0}",
                    NoMoreLicenses: "申し訳ありませんが、現在使用可能なﾗｲｾﾝｽはありません。eDrawings Web Viewer の既存のｾｯｼｮﾝを閉じて、後で再試行してください。",
                    UnableToProcessFile: "このﾌｧｲﾙの処理を完了できません。",
                    UnknownError: "ｴﾗｰが発生しました。再試行してください。",
                    UnknownLicenseError: "ﾗｲｾﾝｽ ｴﾗｰが発生しました。再試行してください。",
                    UnsupportedFileType: "{0} をﾛｰﾄﾞできません。ｻﾎﾟｰﾄされていないﾌｧｲﾙ ﾀｲﾌﾟです。",
                    URLInaccessible: "ﾌｧｲﾙ URL にｱｸｾｽできません: {0}",
                    WebSocketFailure: "ﾋﾞｭｰｱのｽﾄﾘｰﾐﾝｸﾞ接続を確立できませんでした。"
                },
                Viewer: {LoadFailure: "ﾋﾞｭｰｱでﾓﾃﾞﾙのﾛｰﾄﾞに失敗しました: {0} "}
            }
        }, ko: {
            Locale: {
                Code: "ko-KR",
                FlagUrl: "/images/locale/ko/ko.bmp",
                HelpId: "korean",
                DefaultName: "Korean",
                NativeName: "한국어"
            },
            Messages: {ConnectionTimeOut: "연결 제한 시간을 초과했습니다. 계속하려면 페이지를 다시 로드하십시오."},
            Placeholders: {DebugCategories: "콘솔 디버그 카테고리", SearchFilter: "필터 목록에 텍스트를 입력합니다."},
            Strings: {
                All: "전체",
                AmbientOcclusion: "엠비언트 오클루젼",
                AnimateViews: "뷰 애니메이션",
                Annotations: "주석",
                Angle: "각도",
                Area: "면적",
                Back: "뒤로",
                Bezier: "베지어",
                Bottom: "아랫면",
                Center: "중심",
                CenterDist: "중심 거리.",
                Clear: "지우기",
                Circle: "원",
                Components: "부품",
                Configurations: "설정",
                Coordinate: "좌표",
                Curve: "곡선",
                Cylinder: "원통",
                Debug: "Debug",
                Delta: {Label: "델타", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "직경",
                Display: "디스플레이",
                DisplayStates: "표시 상태",
                Distance: "거리",
                DropYourContent: "여기에 콘텐츠 놓기",
                EnableCapping: "캡핑 활성화",
                Entity: "요소",
                Explode: "분해",
                ExplodeDown: "분해(아래로)",
                ExplodeUp: "분해(위로)",
                Face: "면",
                Flip: "뒤집기",
                Front: "정면",
                Fullscreen: "전체 화면",
                HiddenLinesRemoved: "은선 제거",
                HiddenLinesVisible: "은선 표시",
                HideOthers: "다른 요소 숨기기",
                HideShow: "숨기기/보이기",
                Help: "도움말",
                Image: "이미지",
                Info: "정보",
                InvalidCombination: "잘못된 조합",
                Isometric: "등각보기",
                Languages: "언어",
                Layers: "레이어",
                Left: "왼쪽",
                Length: "길이",
                Line: "선",
                Markup: "마크업",
                MaxDistance: "최대 거리",
                Measure: "측정",
                MinDistance: "최소 거리",
                Move: "이동",
                Name: "이름",
                NormalDist: "정상 거리.",
                NormalDistance: "수직 거리",
                Or: "또는",
                Perimeter: "둘레",
                Perspective: "원근 표시",
                Plane: "평면",
                Point: "점",
                PointToPoint: "점-점",
                Polyline: "다중선",
                Rectangle: "직사각형",
                Remove: "제거",
                Reset: "재설정",
                Right: "오른쪽",
                SearchText: "필터 목록에 텍스트를 입력합니다.",
                SectionViews: "단면도",
                Select: {Edge: "모서리 선택", Face: "면 선택", Vertex: "꼭지점 선택"},
                Shaded: "음영",
                ShadedWithEdges: "모서리 표시 음영",
                Sheets: "시트",
                Show: {All: "모두 표시", Matrices: "행렬 표시", SectionPlane: "단면 면 표시"},
                StraightLine: "직선",
                Surface: "곡면",
                Tables: "테이블",
                Text: "텍스트",
                Top: "윗면",
                TotalLength: "총 길이",
                TransparentSolid: "투명/솔리드",
                UploadFile: "파일 업로드",
                Vertex: "꼭지점",
                ViewsOrientation: "뷰 방향",
                ViewFromSectionPlane: "단면 면에서 보기",
                ViewFromSelectedFace: "선택한 면에서 보기",
                ViewSettings: "뷰 설정",
                Wireframe: "실선",
                XYPlane: "X/Y 평면",
                XZPlane: "X/Z 평면",
                YZPlane: "Y/Z 평면",
                XYZMeasurements: "XYZ 측정",
                ZoomToFit: "전체 보기"
            },
            Text: {
                Angle: "각도:",
                Browse: "찾아보기...",
                Distance: "거리:",
                FormatVersion: "형식 버전:",
                HCVersion: "HC 버전:",
                Linked: "(연결됨)",
                NotLinked: "(연결되지 않음)",
                Version: "버전 번호:"
            },
            Titles: {Product: "eDrawings", Error: "오류", Info: "정보", Warning: "경고"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "도",
                    Inches: "포함",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "라디안"
                },
                Centimeters: "센티미터",
                Degrees: "도",
                Inches: "인치",
                Feet: "피트",
                FeetAndInches: "피트와 인치",
                Meters: "미터",
                Millimeters: "밀리미터",
                Radians: "Radians"
            },
            Errors: {
                ContextLost: "브라우저 또는 장치에 뷰어를 표시할 리소스가 없습니다.",
                Device: {DoesNotSupportTouch: "이 장치에서는 터치 조작을 지원하지 않습니다."},
                Server: {
                    AJAXFailure: "서버를 사용할 수 없습니다. 다시 시도하십시오. 장애가 지속되면 이 메시지를 고객 지원에 보고하십시오.",
                    CannotConnectToLicenseServer: "사용권 서버에 접속할 수 없습니다. 서버가 올바르게 구성되었으며, 사용권 서버가 실행 중인지 확인하십시오.",
                    LicenseExpired: "활동이 없어서 사용권 제한 시간이 초과되었으며, 사용권이 서버로 반환되었습니다.",
                    LicenseVersionMismatch: "사용권 버전이 일치하지 않습니다.",
                    LoadFailure1: "모델을 보는 데 실패했습니다. 다시 로드하여 시도하십시오. 장애가 지속되면 아래 정보를 고객 지원에 보고하십시오.",
                    LoadFailure2: "서버: {0}",
                    LoadFailure3: "모델 ID: {0}",
                    NoMoreLicenses: "죄송합니다. 현재 사용권을 이용할 수 없습니다. eDrawings Web Viewer의 기존 세션을 닫고 나중에 다시 시도하십시오.",
                    UnableToProcessFile: "이 파일 처리를 완료할 수 없습니다.",
                    UnknownError: "오류가 발생했습니다. 다시 시도하십시오.",
                    UnknownLicenseError: "사용권 오류가 발생했습니다. 다시 시도하십시오.",
                    UnsupportedFileType: "{0}을(를) 로드할 수 없습니다. 지원되지 않는 파일 형식입니다.",
                    URLInaccessible: "파일 URL에 액세스할 수 없습니다. {0}",
                    WebSocketFailure: "뷰어에 대한 스트리밍 연결을 설정할 수 없습니다."
                },
                Viewer: {LoadFailure: "뷰어에서 모델을 로드하지 못했습니다. {0}"}
            }
        }, pl: {
            Locale: {
                Code: "pl-PL",
                FlagUrl: "/images/locale/pl/pl.bmp",
                HelpId: "polish",
                DefaultName: "Polish",
                NativeName: "Polski"
            },
            Messages: {ConnectionTimeOut: "Upłynął limit czasu połączenia.  Załaduj ponownie stronę, aby kontynuować."},
            Placeholders: {
                DebugCategories: "Kategorie debugowania konsoli",
                SearchFilter: "Wprowadź tekst, aby filtrować listę"
            },
            Strings: {
                All: "Wszystkie",
                AmbientOcclusion: "Okluzja otoczenia",
                AnimateViews: "Animuj widoki",
                Annotations: "Adnotacje",
                Angle: "Kąt",
                Area: "Obszar",
                Back: "Tył",
                Bezier: "Krzywa Beziera",
                Bottom: "Dół",
                Center: "Środek",
                CenterDist: "Odległość środkowa",
                Clear: "Wyczyść",
                Circle: "Okrąg",
                Components: "Komponenty",
                Configurations: "Konfiguracje",
                Coordinate: "Współrzędna",
                Curve: "Krzywa",
                Cylinder: "Walec",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Średnica",
                Display: "Wyświetlaj",
                DisplayStates: "Stany wyświetlania",
                Distance: "Odległość",
                DropYourContent: "Upuść zawartość w tym miejscu",
                EnableCapping: "Włącz zamknięcie",
                Entity: "Element",
                Explode: "Rozstrzel",
                ExplodeDown: "Rozstrzel w dół",
                ExplodeUp: "Rozstrzel w górę",
                Face: "Ściana",
                Flip: "Odwróć",
                Front: "Przód",
                Fullscreen: "Pełny ekran",
                HiddenLinesRemoved: "Ukryte linie usunięte",
                HiddenLinesVisible: "Ukryte linie widoczne",
                HideOthers: "Ukryj pozostałe",
                HideShow: "Ukryj/pokaż",
                Help: "Pomoc",
                Image: "Obraz",
                Info: "Informacje",
                InvalidCombination: "Nieprawidłowa kombinacja",
                Isometric: "Izometryczny",
                Languages: "Języki",
                Layers: "Warstwy",
                Left: "Lewa strona",
                Length: "Długość",
                Line: "Linia",
                Markup: "Uwaga",
                MaxDistance: "Maks. odległość",
                Measure: "Zmierz",
                MinDistance: "Min. odległość",
                Move: "Przenieś",
                Name: "Nazwa",
                NormalDist: "Odległość normalna",
                NormalDistance: "Normalna odległość",
                Or: "Albo",
                Perimeter: "Obwód",
                Perspective: "Perspektywa",
                Plane: "Płaszczyzna",
                Point: "Punkt",
                PointToPoint: "Punkt-do-punktu",
                Polyline: "Polilinia",
                Rectangle: "Prostokąt",
                Remove: "Usuń",
                Reset: "Resetuj",
                Right: "Prawa strona",
                SearchText: "Wprowadź tekst, aby filtrować listę",
                SectionViews: "Widoki przekroju",
                Select: {Edge: "Wybierz krawędź", Face: "Wybierz ścianę", Vertex: "Wybierz wierzchołek"},
                Shaded: "Cieniowany",
                ShadedWithEdges: "Cieniowany z krawędziami",
                Sheets: "Arkusze",
                Show: {All: "Pokaż wszystkie", Matrices: "Pokaż matryce", SectionPlane: "Pokaż płaszczyznę przekroju"},
                StraightLine: "Linia prosta",
                Surface: "Powierzchnia",
                Tables: "Tabele",
                Text: "Tekst",
                Top: "Góra",
                TotalLength: "Całkowita długość",
                TransparentSolid: "Przezroczysty/pełny",
                UploadFile: "Prześlij plik",
                Vertex: "Wierzchołek",
                ViewsOrientation: "Orientacja widoków",
                ViewFromSectionPlane: "Widok z płaszczyzny przekroju",
                ViewFromSelectedFace: "Widok z wybranej ściany",
                ViewSettings: "Przeglądaj ustawienia",
                Wireframe: "Przedstawienie krawędziowe",
                XYPlane: "Płaszczyzna X/Y",
                XZPlane: "Płaszczyzna X/Z",
                YZPlane: "Płaszczyzna Y/Z",
                XYZMeasurements: "Pomiary XYZ",
                ZoomToFit: "Wpasuj w ekran"
            },
            Text: {
                Angle: "Kąt:",
                Browse: "Przeglądaj...",
                Distance: "Odległość:",
                FormatVersion: "Wersja formatu:",
                HCVersion: "Wersja HC:",
                Linked: "(połączono)",
                NotLinked: "(nie połączono)",
                Version: "Nr wersji:"
            },
            Titles: {Product: "eDrawings", Error: "Błąd", Info: "Informacje", Warning: "Ostrzeżenie"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "stopnie",
                    Inches: "cale",
                    Feet: "stopy",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centymetry",
                Degrees: "Stopnie",
                Inches: "Cale",
                Feet: "Stopy",
                FeetAndInches: "Stopy i cale",
                Meters: "Metry",
                Millimeters: "Milimetry",
                Radians: "Radiany"
            },
            Errors: {
                ContextLost: "Przeglądarka lub urządzenie nie mają wystarczających zasobów do wyświetlania podglądu.",
                Device: {DoesNotSupportTouch: "Urządzenie nie obsługuje wprowadzania dotykowego."},
                Server: {
                    AJAXFailure: "Serwer jest niedostępny. Spróbuj ponownie. Jeżeli błąd będzie nadal występował, zgłoś ten komunikat do działu obsługi klienta.",
                    CannotConnectToLicenseServer: "Serwer licencji jest nieosiągalny. Potwierdź, że serwer został prawidłowo skonfigurowany i działa.",
                    LicenseExpired: "Limit czasu licencji upłynął ze względu na brak aktywności; licencja została zwrócona na serwer.",
                    LicenseVersionMismatch: "Wystąpiła niezgodność wersji licencji.",
                    LoadFailure1: "Wyświetlanie podglądu modelu nie powiodło się. Załaduj ponownie i ponów próbę. Jeżeli problem będzie nadal występował, przekaż poniższą informację do działu obsługi klientów.",
                    LoadFailure2: "Serwer: {0}",
                    LoadFailure3: "Identyfikator modelu: {0}",
                    NoMoreLicenses: "Przepraszamy, obecnie nie ma dostępnych licencji. Zamknij trwającą sesję eDrawings Web Viewer i spróbuj ponownie później.",
                    UnableToProcessFile: "Nie można ukończyć przetwarzania tego pliku.",
                    UnknownError: "Wystąpił błąd. Spróbuj ponownie później.",
                    UnknownLicenseError: "Wystąpił bład licencjonowania. Spróbuj ponownie później.",
                    UnsupportedFileType: "Nie można załadować {0}. Jest to nieobsługiwany typ pliku.",
                    URLInaccessible: "Nie można uzyskać dostępu do adresu URL pliku: {0}",
                    WebSocketFailure: "Nie można nawiązać połączenia transmisji strumieniowej dla podglądu."
                },
                Viewer: {LoadFailure: "Nie można załadować modelu w podglądzie: {0}"}
            }
        }, pt: {
            Locale: {
                Code: "pt-BR",
                FlagUrl: "/images/locale/pt/ptb.bmp",
                HelpId: "portuguese-brazilian",
                DefaultName: "Portuguese-Brazilian",
                NativeName: "Português (Brasil)"
            },
            Messages: {ConnectionTimeOut: "A conexão expirou. Recarregue a página para continuar."},
            Placeholders: {
                DebugCategories: "Categorias de depuração do console",
                SearchFilter: "Digite o texto para filtrar a lista"
            },
            Strings: {
                All: "Tudo",
                AmbientOcclusion: "Oclusão de ambiente",
                AnimateViews: "Animar vistas",
                Annotations: "Anotações",
                Angle: "Ângulo",
                Area: "Área",
                Back: "Voltar",
                Bezier: "Bezier",
                Bottom: "Inferior",
                Center: "Centro",
                CenterDist: "Dist. Centro.",
                Clear: "Limpar",
                Circle: "Círculo",
                Components: "Componentes",
                Configurations: "Configurações",
                Coordinate: "Coordenada",
                Curve: "Curva",
                Cylinder: "Cilindro",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Diâmetro",
                Display: "Exibir",
                DisplayStates: "Estados de exibição",
                Distance: "Distância",
                DropYourContent: "Solte seu conteúdo aqui",
                EnableCapping: "Habilitar limitação",
                Entity: "Entidade",
                Explode: "Explodir",
                ExplodeDown: "Explodir para baixo",
                ExplodeUp: "Explodir para cima",
                Face: "Face",
                Flip: "Inverter",
                Front: "Frente",
                Fullscreen: "Tela cheia",
                HiddenLinesRemoved: "Linhas ocultas removidas",
                HiddenLinesVisible: "Linhas ocultas visíveis",
                HideOthers: "Ocultar outros",
                HideShow: "Ocultar/Exibir",
                Help: "Ajuda",
                Image: "Imagem",
                Info: "Informações",
                InvalidCombination: "Combinação inválida",
                Isometric: "Isométrico",
                Languages: "Idiomas",
                Layers: "Layers",
                Left: "Esquerda",
                Length: "Comprimento",
                Line: "Linha",
                Markup: "Marcação",
                MaxDistance: "Distância máxima",
                Measure: "Medida",
                MinDistance: "Distância mínima",
                Move: "Mover",
                Name: "Nome",
                NormalDist: "Dist. Normal",
                NormalDistance: "Distância normal",
                Or: "Ou",
                Perimeter: "Perímetro",
                Perspective: "Perspectiva",
                Plane: "Plano",
                Point: "Ponto",
                PointToPoint: "Ponto-a-ponto",
                Polyline: "Polilinha",
                Rectangle: "Retângulo",
                Remove: "Remover",
                Reset: "Redefinir",
                Right: "Direita",
                SearchText: "Digite o texto para filtrar a lista",
                SectionViews: "Vistas de seção",
                Select: {Edge: "Selecionar aresta", Face: "Selecionar face", Vertex: "Selecionar vértice"},
                Shaded: "Sombreado",
                ShadedWithEdges: "Sombreado com arestas",
                Sheets: "Folhas",
                Show: {All: "Exibir todos", Matrices: "Exibir matrizes", SectionPlane: "Exibir plano de seção"},
                StraightLine: "Linha reta",
                Surface: "Superfície",
                Tables: "Tabelas",
                Text: "Texto",
                Top: "Superior",
                TotalLength: "Comprimento total",
                TransparentSolid: "Transparente/Sólido",
                UploadFile: "Carregar arquivo",
                Vertex: "Vértice",
                ViewsOrientation: "Orientação das vistas",
                ViewFromSectionPlane: "Exibir a partir do Plano de seção",
                ViewFromSelectedFace: "Exibir a partir da Face selecionada",
                ViewSettings: "Exibir configurações",
                Wireframe: "Estrutura de arame",
                XYPlane: "Plano X/Y",
                XZPlane: "Plano X/Z",
                YZPlane: "Plano Y/Z",
                XYZMeasurements: "Medidas XYZ",
                ZoomToFit: "Zoom para ajustar"
            },
            Text: {
                Angle: "Ângulo:",
                Browse: "Procurar...",
                Distance: "Distância:",
                FormatVersion: "Versão do formato:",
                HCVersion: "Versão do HC:",
                Linked: "(vinculado)",
                NotLinked: "(não vinculado)",
                Version: "Nº da versão:"
            },
            Titles: {Product: "eDrawings", Error: "Erro", Info: "Informação", Warning: "Aviso"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "grau",
                    Inches: "pol",
                    Feet: "pé",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Centímetros",
                Degrees: "Graus",
                Inches: "Polegadas",
                Feet: "Pés",
                FeetAndInches: "Pés e polegadas",
                Meters: "Metros",
                Millimeters: "Milímetros",
                Radians: "Radianos"
            },
            Errors: {
                ContextLost: "O seu navegador ou dispositivo não tem os recursos necessários para exibir o visualizador.",
                Device: {DoesNotSupportTouch: "Este dispositivo não tem suporte a toque."},
                Server: {
                    AJAXFailure: "Servidor indisponível. Tente novamente. Se o erro persistir, encaminhe esta mensagem ao atendimento ao cliente.",
                    CannotConnectToLicenseServer: "Não é possível estabelecer contato com o servidor de licença. Verifique se o servidor está configurado corretamente e se o servidor de licença está em execução.",
                    LicenseExpired: "Sua licença expirou devido a inatividade. A licença foi devolvida ao servidor.",
                    LicenseVersionMismatch: "A versão da licença não corresponde.",
                    LoadFailure1: "A exibição de modelo falhou. Recarregue e tente novamente. Se o erro persistir, encaminhe as informações abaixo para o atendimento ao cliente.",
                    LoadFailure2: "Servidor: {0}",
                    LoadFailure3: "ID do modelo: {0}",
                    NoMoreLicenses: "Lamentamos, mas não há licenças disponíveis no momento. Feche uma sessão existente do eDrawings Web Viewer e tente novamente.",
                    UnableToProcessFile: "Não foi possível concluir o processamento deste arquivo.",
                    UnknownError: "Ocorreu um erro. Tente novamente.",
                    UnknownLicenseError: "Ocorreu um erro de licenciamento. Tente novamente.",
                    UnsupportedFileType: "Não foi possível carregar {0}. O tipo de arquivo não é compatível.",
                    URLInaccessible: "Não é possível acessar o URL do arquivo: {0}",
                    WebSocketFailure: "Não foi possível estabelecer uma conexão de streaming para o visualizador."
                },
                Viewer: {LoadFailure: "Não foi possível carregar o modelo no visualizador: {0}"}
            }
        }, ru: {
            Locale: {
                Code: "ru-RU",
                FlagUrl: "/images/locale/ru/ru.bmp",
                HelpId: "russian",
                DefaultName: "Русский",
                NativeName: "Русский"
            },
            Messages: {ConnectionTimeOut: "Время ожидания подключения истекло.  Перезагрузите страницу, чтобы продолжить."},
            Placeholders: {
                DebugCategories: "Категории отладки консоли",
                SearchFilter: "Введите текст для фильтрации списка"
            },
            Strings: {
                All: "Все",
                AmbientOcclusion: "Окклюзия",
                AnimateViews: "Анимация видов",
                Annotations: "Примечания",
                Angle: "Угол",
                Area: "Площадь",
                Back: "Назад",
                Bezier: "Безье",
                Bottom: "Снизу",
                Center: "Центр",
                CenterDist: "Расстояние между центрами",
                Clear: "Очистить",
                Circle: "Окружность",
                Components: "Компоненты",
                Configurations: "Конфигурации",
                Coordinate: "Координата",
                Curve: "Кривая",
                Cylinder: "Цилиндр",
                Debug: "Debug",
                Delta: {Label: "Дельта", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Диаметр",
                Display: "Отобразить",
                DisplayStates: "Состояния отображения",
                Distance: "Расстояние",
                DropYourContent: "Перетащите содержимое сюда",
                EnableCapping: "Включить ограничение",
                Entity: "Объект",
                Explode: "Разнести",
                ExplodeDown: "Разнести вниз",
                ExplodeUp: "Разнести вверх",
                Face: "Грань",
                Flip: "Переставить",
                Front: "Спереди",
                Fullscreen: "Полный экран",
                HiddenLinesRemoved: "Скрыть невидимые линии",
                HiddenLinesVisible: "Невидимые линии отображаются",
                HideOthers: "Скрыть другие",
                HideShow: "Отобразить/Скрыть",
                Help: "Справка",
                Image: "Изображение",
                Info: "Данные",
                InvalidCombination: "Недопустимое сочетание",
                Isometric: "Изометрия",
                Languages: "Языки",
                Layers: "Слои",
                Left: "Слева",
                Length: "Длина",
                Line: "Линия",
                Markup: "Исправление",
                MaxDistance: "Макс. расстояние",
                Measure: "Измерить",
                MinDistance: "Мин. расстояние",
                Move: "Переместить",
                Name: "Имя",
                NormalDist: "Нормальное расстояние",
                NormalDistance: "Нормальное расстояние",
                Or: "Или",
                Perimeter: "Периметр",
                Perspective: "Перспектива",
                Plane: "Плоскость",
                Point: "Точка",
                PointToPoint: "От точки к точке",
                Polyline: "Полилиния",
                Rectangle: "Прямоугольник",
                Remove: "Удалить",
                Reset: "Сброс",
                Right: "Справа",
                SearchText: "Введите текст в списке фильтра",
                SectionViews: "Разрезы",
                Select: {Edge: "Выбрать кромку", Face: "Выбрать грань", Vertex: "Выбрать вершину"},
                Shaded: "Закрашенное представление",
                ShadedWithEdges: "Закрасить с кромками",
                Sheets: "Листы",
                Show: {
                    All: "Отобразить все",
                    Matrices: "Отобразить матрицы",
                    SectionPlane: "Отобразить плоскость сечения"
                },
                StraightLine: "Прямая линия",
                Surface: "Поверхность",
                Tables: "Таблицы",
                Text: "Текст",
                Top: "Сверху",
                TotalLength: "Общая длина",
                TransparentSolid: "Прозрачный/Непрозрачный",
                UploadFile: "Загрузить файл",
                Vertex: "Вершина",
                ViewsOrientation: "Ориентация видов",
                ViewFromSectionPlane: "Вид из плоскости сечения",
                ViewFromSelectedFace: "Вид с выбранной грани",
                ViewSettings: "Просмотр настроек",
                Wireframe: "Каркасное представление",
                XYPlane: "Плоскость X/Y",
                XZPlane: "Плоскость X/Z",
                YZPlane: "Плоскость Y/Z",
                XYZMeasurements: "Измерения XYZ",
                ZoomToFit: "Изменить в размер экрана"
            },
            Text: {
                Angle: "Угол:",
                Browse: "Обзор...",
                Distance: "Расстояние:",
                FormatVersion: "Версия формата:",
                HCVersion: "Версия HC:",
                Linked: "(связано)",
                NotLinked: "(не связано)",
                Version: "Версия №:"
            },
            Titles: {Product: "eDrawings", Error: "Ошибка", Info: "Информация", Warning: "Предупреждение"},
            Units: {
                Abbreviations: {
                    Centimeters: "см",
                    Degrees: "град.",
                    Inches: "дюйм",
                    Feet: "фут",
                    Meters: "м",
                    Millimeters: "мм",
                    Radians: "рад"
                },
                Centimeters: "Сантиметры",
                Degrees: "Градусы",
                Inches: "Дюймы",
                Feet: "Футы",
                FeetAndInches: "Футы и дюймы",
                Meters: "Метры",
                Millimeters: "Миллиметры",
                Radians: "Радианы"
            },
            Errors: {
                ContextLost: "Ваш браузер или устройство не имеет ресурсов для отображения средства просмотра.",
                Device: {DoesNotSupportTouch: "Это устройство не поддерживает касания."},
                Server: {
                    AJAXFailure: "Сервер недоступен.  Повторите попытку.  Если проблема сохраняется, сообщите о ней в службу поддержки клиентов.",
                    CannotConnectToLicenseServer: "Сервер лицензий недоступен. Убедитесь, что сервер настроен правильно и что сервер лицензий запущен.",
                    LicenseExpired: "Срок действия лицензии истек из-за неактивности. Лицензия возвращена на сервер.",
                    LicenseVersionMismatch: "Возникло несоответствие версий лицензий.",
                    LoadFailure1: "Сбой просмотра модели.  Перезагрузите и повторите попытку.  Если проблема сохраняется, сообщите указанную ниже информацию в службу поддержки клиентов.",
                    LoadFailure2: "Сервер: {0}",
                    LoadFailure3: "ИД модели: {0}",
                    NoMoreLicenses: "В настоящий момент нет доступных лицензий. Закройте существующий сеанс eDrawings Web Viewer и повторите попытку позднее.",
                    UnableToProcessFile: "Не удается завершить обработку этого файла.",
                    UnknownError: "Произошла ошибка.  Повторите попытку.",
                    UnknownLicenseError: "Произошла ошибка лицензирования.  Повторите попытку.",
                    UnsupportedFileType: "Невозможно загрузить {0}.  Этот тип файла не поддерживается.",
                    URLInaccessible: "Невозможно получить доступ к URL-адресу файла: {0}",
                    WebSocketFailure: "Не удалось установить подключение для потоковой передачи для средства просмотра."
                },
                Viewer: {LoadFailure: "Сбой при загрузке модели в средстве просмотра: {0}"}
            }
        }, tr: {
            Locale: {
                Code: "tr-TR",
                FlagUrl: "/images/locale/tr/tr.bmp",
                HelpId: "turkish",
                DefaultName: "Turkish",
                NativeName: "Türkçe"
            },
            Messages: {ConnectionTimeOut: "Bağlantı zaman aşımına uğradı.  Devam etmek için sayfayı yeniden yükleyin."},
            Placeholders: {
                DebugCategories: "Konsol ayıklama kategorileri",
                SearchFilter: "Listeyi filtrelemek için metin girin"
            },
            Strings: {
                All: "Tümü",
                AmbientOcclusion: "Ortam Kapanması",
                AnimateViews: "Görünümleri Canlandır",
                Annotations: "Detaylandırmalar",
                Angle: "Açı",
                Area: "Alan",
                Back: "Arka",
                Bezier: "Bezier",
                Bottom: "Alt",
                Center: "Merkez",
                CenterDist: "Merkez Uzakl.",
                Clear: "Temizle",
                Circle: "Daire",
                Components: "Bileşenler",
                Configurations: "Konfigürasyonlar",
                Coordinate: "Koordinat",
                Curve: "Eğri",
                Cylinder: "Silindir",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "Çap",
                Display: "Görüntü",
                DisplayStates: "Görüntü Durumları",
                Distance: "Mesafe",
                DropYourContent: "İçeriğinizi buraya bırakın",
                EnableCapping: "Kaplamayı Etkinleştir",
                Entity: "Obje",
                Explode: "Patlat",
                ExplodeDown: "Aşağıyı Patlat",
                ExplodeUp: "Yukarıyı Patlat",
                Face: "Yüz",
                Flip: "Ters Çevir",
                Front: "Ön",
                Fullscreen: "Tam Ekran",
                HiddenLinesRemoved: "Arka Kenarları Gizle",
                HiddenLinesVisible: "Arka Kenarları Göster",
                HideOthers: "Diğerlerini Gizle",
                HideShow: "Gizle/Göster",
                Help: "Yardım",
                Image: "Resim",
                Info: "Bilgi",
                InvalidCombination: "Geçersiz kombinasyon",
                Isometric: "İzometrik",
                Languages: "Diller",
                Layers: "Katmanlar",
                Left: "Sol",
                Length: "Uzunluk",
                Line: "Çizgi",
                Markup: "İşaretleme",
                MaxDistance: "Maks. Uzaklık",
                Measure: "Ölç",
                MinDistance: "Min. Uzaklık",
                Move: "Taşı",
                Name: "Ad",
                NormalDist: "Normal Uzakl.",
                NormalDistance: "Normal Mesafe",
                Or: "Veya",
                Perimeter: "Çevre",
                Perspective: "Perspektif",
                Plane: "Düzlem",
                Point: "Nokta",
                PointToPoint: "Noktadan Noktaya",
                Polyline: "Devamlı Çizgi",
                Rectangle: "Dikdörtgen",
                Remove: "Kaldır",
                Reset: "Sıfırla",
                Right: "Sağ",
                SearchText: "Listeyi filtrelemek için metin girin",
                SectionViews: "Kesit Görünümleri",
                Select: {Edge: "Kenar Seç", Face: "Yüz Seç", Vertex: "Tepe Noktası Seç"},
                Shaded: "Gölgeli",
                ShadedWithEdges: "Gölgeli ve Kenarlı",
                Sheets: "Çalışma Sayfaları",
                Show: {All: "Tümünü Göster", Matrices: "Matrisleri Göster", SectionPlane: "Kesit Düzlemini Göster"},
                StraightLine: "Düz Çizgi",
                Surface: "Yüzey",
                Tables: "Tablolar",
                Text: "Metin",
                Top: "Üst",
                TotalLength: "Toplam Uzunluk",
                TransparentSolid: "Şeffaf/Katı",
                UploadFile: "Dosya yükle",
                Vertex: "Tepe Noktası",
                ViewsOrientation: "Görünümlerin oryantasyonu",
                ViewFromSectionPlane: "Kesit Düzleminden Görünüm",
                ViewFromSelectedFace: "Seçili Yüzden Görünüm",
                ViewSettings: "Görünüm Ayarları",
                Wireframe: "Tel Kafes",
                XYPlane: "X/Y Düzlemi",
                XZPlane: "X/Z Düzlemi",
                YZPlane: "Y/Z Düzlemi",
                XYZMeasurements: "XYZ Ölçümleri",
                ZoomToFit: "Sığacak Şekilde Yakınlaştır"
            },
            Text: {
                Angle: "Açı:",
                Browse: "Gözat...",
                Distance: "Uzaklık:",
                FormatVersion: "Biçim Sürümü:",
                HCVersion: "HC Sürümü:",
                Linked: "(bağlı)",
                NotLinked: "(bağlı değil)",
                Version: "Sürüm No.:"
            },
            Titles: {Product: "eDrawings", Error: "Hata", Info: "Bilgi", Warning: "Uyarı"},
            Units: {
                Abbreviations: {
                    Centimeters: "cm",
                    Degrees: "derece",
                    Inches: "inç",
                    Feet: "ft",
                    Meters: "m",
                    Millimeters: "mm",
                    Radians: "rad"
                },
                Centimeters: "Santimetre",
                Degrees: "Derece",
                Inches: "İnç",
                Feet: "Fit",
                FeetAndInches: "Fit ve İnç",
                Meters: "Metre",
                Millimeters: "Milimetre",
                Radians: "Radyan"
            },
            Errors: {
                ContextLost: "Tarayıcınız veya cihazınız, görüntüleyiciyi görüntülemek için gerekli kaynaklara sahip değil.",
                Device: {DoesNotSupportTouch: "Bu cihaz dokunmatik özelliği desteklemiyor."},
                Server: {
                    AJAXFailure: "Sunucu kullanılamıyor.  Lütfen tekrar deneyin.  Hata devam ederse lütfen bu mesajı müşteri desteğine bildirin.",
                    CannotConnectToLicenseServer: "Lisans sunucusuna ulaşılamıyor. Lütfen sunucunun doğru şekilde yapılandırıldığını ve lisans sunucusunun çalıştığını onaylayın.",
                    LicenseExpired: "Lisansınız, etkinlik olmaması nedeniyle zaman aşımına uğradı, lisans sunucuya iade edildi.",
                    LicenseVersionMismatch: "Lisans sürümü uyumsuzluğu var.",
                    LoadFailure1: "Model görüntüleme başarısız. Lütfen yeniden yükleyin ve tekrar deneyin. Hata devam ederse lütfen aşağıdaki bilgiyi müşteri desteğine bildirin.",
                    LoadFailure2: "Sunucu: {0}",
                    LoadFailure3: "Model Kimliği: {0}",
                    NoMoreLicenses: "Üzgünüz, şu anda kullanılabilir hiç lisans yok. Lütfen eDrawings Web Viewer'ın mevcut oturumlarından birini kapatın ve daha sonra tekrar deneyin.",
                    UnableToProcessFile: "Bu dosyanın işlenmesi tamamlanamıyor.",
                    UnknownError: "Bir hata oluştu.  Lütfen tekrar deneyin.",
                    UnknownLicenseError: "Bir lisanslama hatası oluştu.  Lütfen tekrar deneyin.",
                    UnsupportedFileType: "{0} yüklenemiyor.  Dosya tipi desteklenmiyor.",
                    URLInaccessible: "Dosya URL'sine erişilemiyor: {0}",
                    WebSocketFailure: "Görüntüleyici için akış bağlantısı sağlanamadı."
                },
                Viewer: {LoadFailure: "Görüntüleyicide model yüklenemedi: {0}"}
            }
        }, zhs: {
            Locale: {
                Code: "zh-CN",
                FlagUrl: "/images/locale/zh/zhs.bmp",
                HelpId: "chinese-simplified",
                DefaultName: "Chinese-Simplified",
                NativeName: "简体中文"
            },
            Messages: {ConnectionTimeOut: "连接超时。重新加载页面以继续。"},
            Placeholders: {DebugCategories: "控制台调试类别", SearchFilter: "输入文字以过滤列表"},
            Strings: {
                All: "全部",
                AmbientOcclusion: "环境封闭",
                AnimateViews: "动画视图",
                Annotations: "注解",
                Angle: "角度",
                Area: "区域",
                Back: "后",
                Bezier: "贝塞尔",
                Bottom: "下",
                Center: "居中",
                CenterDist: "中心距离",
                Clear: "清除",
                Circle: "圆形",
                Components: "零部件",
                Configurations: "配置",
                Coordinate: "坐标",
                Curve: "曲线",
                Cylinder: "圆柱",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "直径",
                Display: "显示",
                DisplayStates: "显示状态",
                Distance: "距离",
                DropYourContent: "将您的内容放在此处",
                EnableCapping: "启用压缩",
                Entity: "实体",
                Explode: "爆炸",
                ExplodeDown: "向下爆炸",
                ExplodeUp: "向上爆炸",
                Face: "面",
                Flip: "翻转",
                Front: "前",
                Fullscreen: "全屏",
                HiddenLinesRemoved: "移除隐藏线",
                HiddenLinesVisible: "隐藏线可见",
                HideOthers: "隐藏其他",
                HideShow: "隐藏/显示",
                Help: "帮助",
                Image: "图像",
                Info: "信息",
                InvalidCombination: "组合无效",
                Isometric: "等轴测",
                Languages: "语言",
                Layers: "图层",
                Left: "左",
                Length: "长度",
                Line: "直线",
                Markup: "标注",
                MaxDistance: "最大距离",
                Measure: "测量",
                MinDistance: "最小距离",
                Move: "移动",
                Name: "名称",
                NormalDist: "正常距离",
                NormalDistance: "法向距离",
                Or: "或",
                Perimeter: "周长",
                Perspective: "透视",
                Plane: "平面",
                Point: "点",
                PointToPoint: "点对点",
                Polyline: "多线",
                Rectangle: "矩形",
                Remove: "移除",
                Reset: "重置",
                Right: "右",
                SearchText: "输入文字以过滤列表",
                SectionViews: "剖面视图",
                Select: {Edge: "选择边线", Face: "选择面", Vertex: "选择顶点"},
                Shaded: "上色",
                ShadedWithEdges: "带边线上色",
                Sheets: "图纸",
                Show: {All: "全部显示", Matrices: "显示矩阵", SectionPlane: "显示剖面平面"},
                StraightLine: "直线",
                Surface: "曲面",
                Tables: "表格",
                Text: "文本",
                Top: "上",
                TotalLength: "总长度",
                TransparentSolid: "透明/实体",
                UploadFile: "上传文件",
                Vertex: "顶点",
                ViewsOrientation: "视图方向",
                ViewFromSectionPlane: "从剖面平面查看",
                ViewFromSelectedFace: "从选定面查看",
                ViewSettings: "查看设置",
                Wireframe: "线架构",
                XYPlane: "X/Y 平面",
                XZPlane: "X/Z 平面",
                YZPlane: "Y/Z 平面",
                XYZMeasurements: "XYZ 测量",
                ZoomToFit: "整屏显示全图"
            },
            Text: {
                Angle: "角度：",
                Browse: "浏览...",
                Distance: "距离:",
                FormatVersion: "格式版本：",
                HCVersion: "HC 版本：",
                Linked: "（已链接）",
                NotLinked: "（未链接）",
                Version: "版本号："
            },
            Titles: {Product: "eDrawings", Error: "错误", Info: "信息", Warning: "警告"},
            Units: {
                Abbreviations: {
                    Centimeters: "厘米",
                    Degrees: "度",
                    Inches: "英寸",
                    Feet: "英尺",
                    Meters: "米",
                    Millimeters: "毫米",
                    Radians: "弧度"
                },
                Centimeters: "厘米",
                Degrees: "度数",
                Inches: "英寸",
                Feet: "英尺",
                FeetAndInches: "英尺和英寸",
                Meters: "米",
                Millimeters: "毫米",
                Radians: "弧度"
            },
            Errors: {
                ContextLost: "您的浏览器或设备没有资源来显示查看器。",
                Device: {DoesNotSupportTouch: "此设备不支持触控。"},
                Server: {
                    AJAXFailure: "服务器不可用。请重试。如果故障仍然存在，请将此消息报告给客户支持。",
                    CannotConnectToLicenseServer: "无法访问许可服务器。请确认服务器配置正确并且许可服务器正在运行。",
                    LicenseExpired: "由于不活动，您的许可已超时，许可已返回给服务器。",
                    LicenseVersionMismatch: "许可版本不匹配。",
                    LoadFailure1: "模型查看失败。请重新加载并重试。如果故障仍然存在，请将以下信息报告给客户支持。",
                    LoadFailure2: "服务器：{0}",
                    LoadFailure3: "模型 ID：{0}",
                    NoMoreLicenses: "很抱歉，目前没有可用的许可。请关闭 eDrawings Web 查看器的现有会话并稍后重试。",
                    UnableToProcessFile: "无法完成此文件的处理。",
                    UnknownError: "出现错误。请重试。",
                    UnknownLicenseError: "出现许可错误。请重试。",
                    UnsupportedFileType: "无法加载 {0}。此文件类型不受支持。",
                    URLInaccessible: "无法访问文件 URL：{0}",
                    WebSocketFailure: "无法为查看器建立流传输连接。"
                },
                Viewer: {LoadFailure: "无法在查看器中加载模型：{0}"}
            }
        }, zht: {
            Locale: {
                Code: "zh-TW",
                FlagUrl: "/images/locale/zh/zht.bmp",
                HelpId: "chinese",
                DefaultName: "Chinese-Traditional",
                NativeName: "繁體中文"
            },
            Messages: {ConnectionTimeOut: "連線逾時。請重新載入頁面以繼續。"},
            Placeholders: {DebugCategories: "主控台 debug 類別", SearchFilter: "輸入文字來過濾清單"},
            Strings: {
                All: "全部",
                AmbientOcclusion: "周圍吸收",
                AnimateViews: "產生視圖動畫",
                Annotations: "註記",
                Angle: "角度",
                Area: "區域",
                Back: "返回",
                Bezier: "貝茲",
                Bottom: "下",
                Center: "中心",
                CenterDist: "中心距離",
                Clear: "清除",
                Circle: "圓形",
                Components: "零組件",
                Configurations: "模型組態",
                Coordinate: "座標",
                Curve: "曲線",
                Cylinder: "圓柱",
                Debug: "Debug",
                Delta: {Label: "Delta", dX: "dX", dY: "dY", dZ: "dZ"},
                Diameter: "直徑",
                Display: "顯示",
                DisplayStates: "顯示狀態",
                Distance: "距離",
                DropYourContent: "將內容置放於此處",
                EnableCapping: "啟用覆蓋",
                Entity: "圖元",
                Explode: "爆炸",
                ExplodeDown: "向下爆炸",
                ExplodeUp: "向上爆炸",
                Face: "面",
                Flip: "反轉",
                Front: "前視",
                Fullscreen: "全螢幕",
                HiddenLinesRemoved: "移除隱藏線",
                HiddenLinesVisible: "顯示隱藏線",
                HideOthers: "隱藏其他",
                HideShow: "隱藏/顯示",
                Help: "說明",
                Image: "影像",
                Info: "資訊",
                InvalidCombination: "無效組合",
                Isometric: "等角視",
                Languages: "語言",
                Layers: "圖層",
                Left: "左",
                Length: "長度",
                Line: "線條",
                Markup: "標示",
                MaxDistance: "最大距離",
                Measure: "量測",
                MinDistance: "最小距離",
                Move: "移動",
                Name: "名稱",
                NormalDist: "一般距離",
                NormalDistance: "垂直距離",
                Or: "或",
                Perimeter: "周長",
                Perspective: "遠近透視",
                Plane: "平面",
                Point: "點",
                PointToPoint: "點到點",
                Polyline: "聚合線",
                Rectangle: "矩形",
                Remove: "移除",
                Reset: "重設",
                Right: "右",
                SearchText: "輸入文字來過濾清單",
                SectionViews: "剖面視圖",
                Select: {Edge: "選擇邊線", Face: "選擇面", Vertex: "選擇頂點"},
                Shaded: "塗彩",
                ShadedWithEdges: "帶邊線塗彩",
                Sheets: "圖頁",
                Show: {All: "顯示全部", Matrices: "顯示矩陣", SectionPlane: "顯示剖切平面"},
                StraightLine: "直線",
                Surface: "表面",
                Tables: "表格",
                Text: "文字",
                Top: "上",
                TotalLength: "總長度",
                TransparentSolid: "透明/純色",
                UploadFile: "上傳檔案",
                Vertex: "頂點",
                ViewsOrientation: "視角方位",
                ViewFromSectionPlane: "從剖切平面檢視",
                ViewFromSelectedFace: "從所選面檢視",
                ViewSettings: "檢視設定",
                Wireframe: "線架構",
                XYPlane: "X/Y 平面",
                XZPlane: "X/Z 平面",
                YZPlane: "Y/Z 平面",
                XYZMeasurements: "XYZ 測量",
                ZoomToFit: "最適當大小"
            },
            Text: {
                Angle: "角度：",
                Browse: "瀏覽...",
                Distance: "距離：",
                FormatVersion: "格式版本：",
                HCVersion: "HC 版本：",
                Linked: "(已連結)",
                NotLinked: "(未連結)",
                Version: "版本 #："
            },
            Titles: {Product: "eDrawings", Error: "錯誤", Info: "資訊", Warning: "警告"},
            Units: {
                Abbreviations: {
                    Centimeters: "公分",
                    Degrees: "度",
                    Inches: "英吋",
                    Feet: "英呎",
                    Meters: "公尺",
                    Millimeters: "公釐",
                    Radians: "弧度"
                },
                Centimeters: "釐米",
                Degrees: "度",
                Inches: "英吋",
                Feet: "英呎",
                FeetAndInches: "英呎及英吋",
                Meters: "米",
                Millimeters: "毫米",
                Radians: "徑度"
            },
            Errors: {
                ContextLost: "您的瀏覽器或裝置沒有能顯示檢視器的資源。",
                Device: {DoesNotSupportTouch: "此裝置不支援觸控。"},
                Server: {
                    AJAXFailure: "伺服器無法使用。請再試一次。如果持續失敗，請向客戶支援回報此訊息。",
                    CannotConnectToLicenseServer: "無法與使用許可伺服器溝通。請確認伺服器正確設定，且使用許可伺服器執行中。",
                    LicenseExpired: "您的使用許可因無任何活動已逾時，使用許可已歸還至伺服器。",
                    LicenseVersionMismatch: "使用許可版本不相符。",
                    LoadFailure1: "模型檢視失敗。請重新載入並再試一次。如果持續失敗，請向客戶支援回報以下資訊。",
                    LoadFailure2: "伺服器：{0}",
                    LoadFailure3: "模型 ID：{0}",
                    NoMoreLicenses: "很抱歉，目前無可用的使用許可。請關閉 eDrawings Web Viewer 現有工作階段，稍後再試一次。",
                    UnableToProcessFile: "無法完成此檔案的處理。",
                    UnknownError: "發生錯誤。請再試一次。",
                    UnknownLicenseError: "發生使用許可錯誤。請再試一次。",
                    UnsupportedFileType: "無法載入 {0}。其為不支援的檔案類型。",
                    URLInaccessible: "無法存取檔案 URL：{0}",
                    WebSocketFailure: "無法建立檢視器的串流連線。"
                },
                Viewer: {LoadFailure: "無法在檢視器中載入模型：{0}"}
            }
        }
    }
}));
define("eDwLayer", ["require", "exports", "eDwNodeAttributes", "utils"], (function (require, exports, eDwNodeAttributes_2, utils) {
    "use strict";
    var eDwLayer = function () {
        function eDwLayer(iLayerName, iLayerIDHC, iAttribs) {
            this.mName = iLayerName;
            this.mIDHC = iLayerIDHC;
            this.mInitAttribs = iAttribs.copy();
            this.mAttribs = iAttribs.copy();
            this.mNodeIDHCToHierNodeMap = {}
        }

        eDwLayer.prototype.addNodes = function (iNodeIDsHC, iModel) {
            var e_9, _a;
            try {
                for (var iNodeIDsHC_1 = __values(iNodeIDsHC), iNodeIDsHC_1_1 = iNodeIDsHC_1.next(); !iNodeIDsHC_1_1.done; iNodeIDsHC_1_1 = iNodeIDsHC_1.next()) {
                    var nodeIDHC = iNodeIDsHC_1_1.value;
                    if (!this.mNodeIDHCToHierNodeMap[nodeIDHC]) {
                        this.mNodeIDHCToHierNodeMap[nodeIDHC] = iModel.getHierarchyNode(nodeIDHC)
                    }
                }
            } catch (e_9_1) {
                e_9 = {error: e_9_1}
            } finally {
                try {
                    if (iNodeIDsHC_1_1 && !iNodeIDsHC_1_1.done && (_a = iNodeIDsHC_1.return)) _a.call(iNodeIDsHC_1)
                } finally {
                    if (e_9) throw e_9.error
                }
            }
        };
        eDwLayer.prototype.getName = function () {
            return this.mName
        };
        eDwLayer.prototype.getIDHC = function () {
            return this.mIDHC
        };
        eDwLayer.prototype.getAttribs = function () {
            return this.mAttribs.copy()
        };
        eDwLayer.prototype.setAttribs = function (iSrcAttribs) {
            if (utils.isEqual(this.mAttribs, iSrcAttribs)) return false;
            this.mAttribs = iSrcAttribs.copy();
            return true
        };
        eDwLayer.prototype.resetAttribs = function () {
            this.mAttribs = this.mInitAttribs.copy()
        };
        eDwLayer.prototype.mergeAttribs = function (iSrcAttribs) {
            this.mAttribs = eDwNodeAttributes_2.eDwNodeAttributes.mergeAttribs(this.mAttribs, iSrcAttribs)
        };
        eDwLayer.prototype.getNodeIDsHC = function () {
            var nodeIDsHC = [];
            for (var nodeIDHCStr in this.mNodeIDHCToHierNodeMap) {
                nodeIDsHC.push(parseInt(nodeIDHCStr, 10))
            }
            return nodeIDsHC
        };
        eDwLayer.prototype.getHCNodesAndAttribs = function (ioNodeIDsHCAndAttribs) {
            var e_10, _a;
            var nodeOnLayerIDsHC = this.getNodeIDsHC();
            try {
                for (var nodeOnLayerIDsHC_1 = __values(nodeOnLayerIDsHC), nodeOnLayerIDsHC_1_1 = nodeOnLayerIDsHC_1.next(); !nodeOnLayerIDsHC_1_1.done; nodeOnLayerIDsHC_1_1 = nodeOnLayerIDsHC_1.next()) {
                    var nodeOnLayerIDHC = nodeOnLayerIDsHC_1_1.value;
                    var combinedAttribs = this.getCombinedAttribsForHCNode(nodeOnLayerIDHC);
                    if (!combinedAttribs) continue;
                    ioNodeIDsHCAndAttribs.push({IDHC: nodeOnLayerIDHC, Attribs: combinedAttribs})
                }
            } catch (e_10_1) {
                e_10 = {error: e_10_1}
            } finally {
                try {
                    if (nodeOnLayerIDsHC_1_1 && !nodeOnLayerIDsHC_1_1.done && (_a = nodeOnLayerIDsHC_1.return)) _a.call(nodeOnLayerIDsHC_1)
                } finally {
                    if (e_10) throw e_10.error
                }
            }
        };
        eDwLayer.prototype.getCombinedAttribsForHCNode = function (iNodeIDHC) {
            var parentHierNode = this.mNodeIDHCToHierNodeMap[iNodeIDHC];
            if (!parentHierNode) return undefined;
            var detachedAttribs = this.mAttribs.copy();
            while (parentHierNode) {
                detachedAttribs = eDwNodeAttributes_2.eDwNodeAttributes.intersectAttribs(detachedAttribs, parentHierNode.getAttribs());
                parentHierNode = parentHierNode.Parent
            }
            return detachedAttribs
        };
        return eDwLayer
    }();
    return eDwLayer
}));
define("eDwMBDNoteMgr", ["require", "exports", "eDwTypes", "eDwGeomUtils"], (function (require, exports, eDwTypes_7, eDwGeomUtils) {
    "use strict";
    var MBDNote = function () {
        function MBDNote(iViewer, iRefPntHC, iCurPntHC, nodeId) {
            var modelHC = iViewer.getModel().getHCModel();
            var viewHC = iViewer.getHCView();
            this.mViewer = iViewer;
            this.mRefPntHC = iRefPntHC.copy();
            this.mNodeId = nodeId;
            var rPos2 = eDwTypes_7.HC.Point2.fromPoint3(iViewer.getHCView().projectPoint(this.mRefPntHC));
            var cPos2 = eDwTypes_7.HC.Point2.fromPoint3(iViewer.getHCView().projectPoint(iCurPntHC));
            this.mOffset = eDwTypes_7.HC.Point2.subtract(cPos2, rPos2);
            var rPos3 = eDwGeomUtils.screenToWorld(rPos2, viewHC);
            var cPos3 = eDwGeomUtils.screenToWorld(cPos2, viewHC);
            this.mOffsetLen = eDwTypes_7.HC.Point3.subtract(cPos3, rPos3).length();
            var cDelta = eDwTypes_7.HC.Point3.subtract(cPos3, iCurPntHC);
            var matrix = new eDwTypes_7.HC.Matrix;
            matrix.loadIdentity();
            matrix.setTranslationComponent(cDelta.x, cDelta.y, cDelta.z);
            var nodeMatrix = modelHC.getNodeMatrix(nodeId);
            nodeMatrix = eDwTypes_7.HC.Matrix.multiply(nodeMatrix, matrix);
            modelHC.setNodeMatrix(nodeId, nodeMatrix);
            this.mOrigPos = cPos3.copy();
            var camera = this.mViewer.getHCView().getCamera();
            this.mOrigCamMatrix = camera.getMatrixFromCamera().copy();
            this.mOrigModMatrix = modelHC.getNodeMatrix(nodeId)
        }

        MBDNote.prototype.updatePos = function () {
            var viewHC = this.mViewer.getHCView();
            var modelHC = this.mViewer.getModel().getHCModel();
            var rPos2 = eDwTypes_7.HC.Point2.fromPoint3(this.mViewer.getHCView().projectPoint(this.mRefPntHC));
            var cPos2 = eDwTypes_7.HC.Point2.add(rPos2, this.mOffset);
            var rPos3 = eDwGeomUtils.screenToWorld(rPos2, viewHC);
            var cPos3 = eDwGeomUtils.screenToWorld(cPos2, viewHC);
            var crDelta = eDwTypes_7.HC.Point3.subtract(cPos3, rPos3);
            crDelta.normalize();
            crDelta.scale(this.mOffsetLen);
            cPos3 = eDwTypes_7.HC.Point3.add(rPos3, crDelta);
            var posDelta = eDwTypes_7.HC.Point3.subtract(cPos3, this.mOrigPos);
            var revTransMat = new eDwTypes_7.HC.Matrix;
            var transMat = new eDwTypes_7.HC.Matrix;
            var extraTransMat = new eDwTypes_7.HC.Matrix;
            revTransMat.setTranslationComponent(-this.mOrigPos.x, -this.mOrigPos.y, -this.mOrigPos.z);
            transMat.setTranslationComponent(this.mOrigPos.x, this.mOrigPos.y, this.mOrigPos.z);
            extraTransMat.setTranslationComponent(posDelta.x, posDelta.y, posDelta.z);
            this.mOrigPos = cPos3.copy();
            var nodeMatrix = this.mOrigModMatrix.copy();
            var camera = viewHC.getCamera();
            var curCamMatrix = camera.getMatrixFromCamera().copy();
            var oriCamMatrix = this.mOrigCamMatrix.copy();
            var oriCamMatrixR = oriCamMatrix.inverseAndDeterminant()[0];
            this.mOrigCamMatrix = curCamMatrix.copy();
            var rotMatrix = eDwTypes_7.HC.Matrix.multiply(revTransMat, oriCamMatrixR);
            rotMatrix = eDwTypes_7.HC.Matrix.multiply(rotMatrix, curCamMatrix);
            rotMatrix = eDwTypes_7.HC.Matrix.multiply(rotMatrix, transMat);
            rotMatrix = eDwTypes_7.HC.Matrix.multiply(rotMatrix, extraTransMat);
            nodeMatrix = modelHC.getNodeMatrix(this.mNodeId);
            nodeMatrix = eDwTypes_7.HC.Matrix.multiply(nodeMatrix, rotMatrix);
            modelHC.setNodeMatrix(this.mNodeId, nodeMatrix, false)
        };
        return MBDNote
    }();
    var eDwMBDNoteMgr = function () {
        function eDwMBDNoteMgr(iViewer) {
            this.mNotes = [];
            this.mViewer = iViewer
        }

        eDwMBDNoteMgr.prototype.addNote = function (nodeId, refBox) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var model, boxHC;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                model = this.mViewer.getModel();
                                return [4, model.getBoundingBoxOfIDsHC([nodeId])];
                            case 1:
                                boxHC = _a.sent();
                                if (boxHC.isDegenerate()) return [2];
                                this.mNotes.push(new MBDNote(this.mViewer, refBox.center(), boxHC.center(), nodeId));
                                return [2]
                        }
                    }))
                }))
            })();
            return true
        };
        eDwMBDNoteMgr.prototype.updateNote = function () {
            var len = this.mNotes.length;
            for (var i = 0; i < len; ++i) {
                this.mNotes[i].updatePos()
            }
        };
        return eDwMBDNoteMgr
    }();
    return eDwMBDNoteMgr
}));
define("eDwModel", ["require", "exports", "eDwEventMgr", "eDwHierarchyNode", "eDwModelView", "eDwLayer", "eDwResultError", "eDwUILocalize", "color", "eDwNodeAttributes", "eDwEvents", "eDwTypes", "eDwUnits", "utils"], (function (require, exports, eDwEventMgr, eDwHierarchyNode, eDwModelView, eDwLayer, eDwResultError, eDwUILocalize_2, Color_1, eDwNodeAttributes_3, eDwEvents_2, eDwTypes_8, eDwUnits_1, utils) {
    "use strict";
    var eDwModel = function () {
        function eDwModel(iViewer) {
            this.mViewer = iViewer;
            this.mModelHC = iViewer.HCViewer.model;
            this.mModelViewContexts = [];
            this.mModelViewsShowInContext = false;
            this.mLayers = [];
            this.mCategory = "UNKNOWN";
            this.mOrigin = "";
            this.mBox = new eDwTypes_8.HC.Box;
            this.mProperties = $([]);
            this.setUserUnits({Length: eDwUnits_1.cDefaultLengthUnit, Angle: eDwUnits_1.cDefaultAngleUnit});
            this.mModelHC.setEnableAutomaticUnitScaling(false);
            this.mModelHC.setBehaviorInitiallyHidden(false);
            this.calculateBoundingBox()
        }

        eDwModel.prototype.initModelData = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var bbox, res, nodeProps, modelViewContext, modelViews, currModelView, attribs;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!this.mViewer) return [2];
                            bbox = this.getBoundingBox();
                            if (!bbox.extents().equals(eDwTypes_8.HC.Point3.zero())) return [3, 2];
                            return [4, this.calculateBoundingBox()];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            res = {ErrorCode: "UnknownError", ErrorData: []};
                            return [4, this.mModelHC.getNodeProperties(this.getModelIDHC())];
                        case 3:
                            nodeProps = _a.sent();
                            if (!nodeProps) {
                                res.ErrorData = ["There are no model views in this model."];
                                throw new eDwResultError(res)
                            }
                            this.loadProperties(nodeProps);
                            if (this.isDrawing() && !this.mViewer.ViewerFeatureOpts.Debug) {
                                this.mViewer.OperatorMgr.removeByOpID(eDwTypes_8.HC.OperatorId.Navigate);
                                this.mViewer.OperatorMgr.push(eDwTypes_8.HC.OperatorId.Pan);
                                this.mViewer.OperatorMgr.push(eDwTypes_8.HC.OperatorId.Zoom)
                            }
                            this.mViewer.initializeManagers();
                            modelViewContext = this.getContext(this.mCurrContextName);
                            modelViews = modelViewContext.ModelViews;
                            currModelView = modelViewContext.Current;
                            if (!currModelView) return [3, 5];
                            attribs = currModelView.Hierarchy.getInitialAttribs();
                            if (!attribs.Visible) return [3, 5];
                            return [4, this.setActiveModelView(currModelView)];
                        case 4:
                            _a.sent();
                            return [2];
                        case 5:
                            if (!modelViews.length) return [3, 7];
                            console.warn("There is no active model view." + "  Defaulting to first.");
                            return [4, this.setActiveModelView(modelViews[0])];
                        case 6:
                            _a.sent();
                            return [2];
                        case 7:
                            console.warn(res.ErrorData[0]);
                            throw new eDwResultError(res)
                    }
                }))
            }))
        };
        eDwModel.prototype.getBoundingBox = function () {
            return this.mBox
        };
        eDwModel.prototype.calculateBoundingBox = function (iIgnoreInvisible, iIncludeExcluded) {
            if (iIgnoreInvisible === void 0) {
                iIgnoreInvisible = true
            }
            if (iIncludeExcluded === void 0) {
                iIncludeExcluded = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            _a = this;
                            return [4, this.mModelHC.getModelBounding(iIgnoreInvisible, iIncludeExcluded)];
                        case 1:
                            _a.mBox = _b.sent();
                            return [2, this.mBox]
                    }
                }))
            }))
        };
        eDwModel.prototype.getBoundingBoxOfIDsHC = function (iUDsHC) {
            return __awaiter(this, void 0, void 0, (function () {
                var bboxHC, iExcp_5;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            bboxHC = eDwTypes_8.HC.Box.invalid();
                            if (!(iUDsHC && iUDsHC.length)) return [3, 4];
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, this.mModelHC.getNodesBounding(iUDsHC)];
                        case 2:
                            bboxHC = _a.sent();
                            return [3, 4];
                        case 3:
                            iExcp_5 = _a.sent();
                            console.debugLog("Model", iExcp_5.message);
                            return [3, 4];
                        case 4:
                            return [2, bboxHC]
                    }
                }))
            }))
        };
        eDwModel.prototype.getLayers = function () {
            return this.mLayers
        };
        eDwModel.prototype.getUserUnits = function () {
            return $.extend({}, this.mUserUnits)
        };
        eDwModel.prototype.setUserUnits = function (iUserUnits) {
            var _this = this;
            if (utils.isEqual(this.mUserUnits, iUserUnits)) return;
            this.mUserUnits = $.extend({}, iUserUnits);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.UserUnitsChangeEvent, this)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwModel.prototype.getValueWithUnit = function (iValue, iUnitType) {
            var _this = this;
            var cUnitScaleFactor = {
                degree: 1,
                radian: Math.PI / 180,
                millimeter: c_lengthUnitToMMFactor,
                centimeter: c_lengthUnitToMMFactor / 10,
                meter: c_lengthUnitToMMFactor / 1e3,
                inch: c_lengthUnitToMMFactor / 25.4,
                foot: c_lengthUnitToMMFactor / 304.8,
                footAndInch: NaN
            };

            function l_getScaledValue(iNonScaledVal, iUnit) {
                var scale = cUnitScaleFactor[iUnit];
                return iUnitType === "Area" ? iNonScaledVal * scale * scale : iNonScaledVal * scale
            }

            var cCommonUnitFormat = "${val}${unit}";

            function l_getFormattedScaledValue(iVal, iUnit, iUserUnitLabel) {
                var val = l_getScaledValue(iVal, iUnit);
                return utils.formatString(cCommonUnitFormat, eDwUILocalize_2.eDwUILocalize.formatNumber(+val.toFixed(2)), eDwUILocalize_2.eDwUILocalize.getString("Units.Abbreviations." + iUserUnitLabel))
            }

            var basicUserUnitResults = {
                degree: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "degree", "Degrees")
                }, radian: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "radian", "Radians")
                }, millimeter: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "millimeter", "Millimeters")
                }, centimeter: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "centimeter", "Centimeters")
                }, meter: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "meter", "Meters")
                }, inch: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "inch", "Inches")
                }, foot: function (iVal) {
                    return l_getFormattedScaledValue(iVal, "foot", "Feet")
                }, footAndInch: function (iVal) {
                    var signFactor = iVal < 0 ? -1 : 1;
                    var absValue = Math.abs(iVal);
                    var footVal = Math.floor(l_getScaledValue(absValue, "foot"));
                    var footValInDBUnits = footVal / l_getScaledValue(1, "foot");
                    var inchVal = l_getScaledValue(absValue - footValInDBUnits, "inch") * signFactor;
                    var inchLabel = eDwUILocalize_2.eDwUILocalize.getString("Units.Abbreviations.Inches");
                    var formattedString = utils.formatString("${inchVal}" + inchLabel, inchVal.toFixed(2));
                    if (footVal > .5) {
                        footVal *= signFactor;
                        var footLabel = eDwUILocalize_2.eDwUILocalize.getString("Units.Abbreviations.Feet");
                        formattedString = utils.formatString("${footVal}" + footLabel, footVal.toFixed(0), formattedString)
                    }
                    return formattedString
                }, area: function (iVal) {
                    var userUnits = _this.mUserUnits["Length"];
                    var func = basicUserUnitResults[userUnits];
                    var valueWithUnits = func.call(_this, iVal);
                    return utils.formatString(cCommonUnitFormat, valueWithUnits, "^2")
                }
            };
            var unit = this.mUserUnits[iUnitType];
            unit = unit || iUnitType.toLowerCase();
            var func = basicUserUnitResults[unit];
            return func ? func.call(this, iValue) : iValue.toString()
        };
        eDwModel.prototype.setAttribOnHierNodes = function (iHierNodes, iAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                var changedHierNodes, changedAncestorHierNodeMap, iHierNodes_1, iHierNodes_1_1, hierNode,
                    changedAttribNames, propagatingAttribNames, changedChildHierNodes, parentHierNode,
                    propagatingAttribNames_1, propagatingAttribNames_1_1, attribName, attribs, parentAttrib, value,
                    otherValue, mergedAttrib, parentIDHC, parentIDHC, changedHierNodesAndAttribs, changedHCNodeID,
                    ancHierNode;
                var e_11, _a, e_12, _b;
                return __generator(this, (function (_c) {
                    switch (_c.label) {
                        case 0:
                            changedHierNodes = [];
                            changedAncestorHierNodeMap = {};
                            try {
                                for (iHierNodes_1 = __values(iHierNodes), iHierNodes_1_1 = iHierNodes_1.next(); !iHierNodes_1_1.done; iHierNodes_1_1 = iHierNodes_1.next()) {
                                    hierNode = iHierNodes_1_1.value;
                                    if (!hierNode || utils.isNaN(hierNode.HOOPSID)) continue;
                                    changedAttribNames = hierNode.setAttribs(iAttribs);
                                    propagatingAttribNames = eDwHierarchyNode.findPropagatingAttribNames(changedAttribNames);
                                    if (propagatingAttribNames.length) {
                                        changedHierNodes.push(hierNode);
                                        changedChildHierNodes = hierNode.propagateAttribsToChildren(propagatingAttribNames);
                                        Array.prototype.push.apply(changedHierNodes, changedChildHierNodes);
                                        parentHierNode = hierNode.Parent;
                                        if (parentHierNode && parentHierNode.Parent) {
                                            try {
                                                for (propagatingAttribNames_1 = (e_12 = void 0, __values(propagatingAttribNames)), propagatingAttribNames_1_1 = propagatingAttribNames_1.next(); !propagatingAttribNames_1_1.done; propagatingAttribNames_1_1 = propagatingAttribNames_1.next()) {
                                                    attribName = propagatingAttribNames_1_1.value;
                                                    attribs = new eDwNodeAttributes_3.eDwNodeAttributes;
                                                    attribs.setProp(attribName, iAttribs.getProp(attribName));
                                                    parentAttrib = parentHierNode.getAttribs();
                                                    value = parentAttrib.getProp(attribName);
                                                    otherValue = attribs.getProp(attribName);
                                                    if (!utils.isEqual(value, otherValue)) {
                                                        if (value) {
                                                            mergedAttrib = parentHierNode.getMergedChildrenAttribs("DirectDescendantsOnly");
                                                            if (!mergedAttrib.getProp(attribName)) {
                                                                parentHierNode.setAttribs(attribs);
                                                                parentIDHC = parentHierNode.HOOPSID;
                                                                changedAncestorHierNodeMap[parentIDHC] = parentHierNode
                                                            }
                                                        } else {
                                                            parentHierNode.setAttribs(attribs);
                                                            parentIDHC = parentHierNode.HOOPSID;
                                                            changedAncestorHierNodeMap[parentIDHC] = parentHierNode
                                                        }
                                                    }
                                                }
                                            } catch (e_12_1) {
                                                e_12 = {error: e_12_1}
                                            } finally {
                                                try {
                                                    if (propagatingAttribNames_1_1 && !propagatingAttribNames_1_1.done && (_b = propagatingAttribNames_1.return)) _b.call(propagatingAttribNames_1)
                                                } finally {
                                                    if (e_12) throw e_12.error
                                                }
                                            }
                                        }
                                    }
                                }
                            } catch (e_11_1) {
                                e_11 = {error: e_11_1}
                            } finally {
                                try {
                                    if (iHierNodes_1_1 && !iHierNodes_1_1.done && (_a = iHierNodes_1.return)) _a.call(iHierNodes_1)
                                } finally {
                                    if (e_11) throw e_11.error
                                }
                            }
                            changedHierNodesAndAttribs = l_makeNodeAttribArray(changedHierNodes, null, false);
                            return [4, this.syncHCNodesState(changedHierNodesAndAttribs)];
                        case 1:
                            _c.sent();
                            for (changedHCNodeID in changedAncestorHierNodeMap) {
                                ancHierNode = changedAncestorHierNodeMap[changedHCNodeID];
                                changedHierNodes.push(ancHierNode);
                                changedHierNodesAndAttribs.push({HierNode: ancHierNode, Attribs: iAttribs})
                            }
                            if (!changedHierNodes.length) return [3, 3];
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.NodeAttribChangeEvent, this.mViewer, changedHierNodesAndAttribs)];
                        case 2:
                            _c.sent();
                            _c.label = 3;
                        case 3:
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.setAttribs = function (iNodesWithAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                var nodesWithAttribs, nodesWithAttribs_1, nodesWithAttribs_1_1, nodeWithAttrib, e_13_1;
                var e_13, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            nodesWithAttribs = iNodesWithAttribs;
                            _b.label = 1;
                        case 1:
                            _b.trys.push([1, 6, 7, 8]);
                            nodesWithAttribs_1 = __values(nodesWithAttribs), nodesWithAttribs_1_1 = nodesWithAttribs_1.next();
                            _b.label = 2;
                        case 2:
                            if (!!nodesWithAttribs_1_1.done) return [3, 5];
                            nodeWithAttrib = nodesWithAttribs_1_1.value;
                            return [4, this.setAttribOnHierNodes([nodeWithAttrib.HierNode], nodeWithAttrib.Attribs)];
                        case 3:
                            _b.sent();
                            _b.label = 4;
                        case 4:
                            nodesWithAttribs_1_1 = nodesWithAttribs_1.next();
                            return [3, 2];
                        case 5:
                            return [3, 8];
                        case 6:
                            e_13_1 = _b.sent();
                            e_13 = {error: e_13_1};
                            return [3, 8];
                        case 7:
                            try {
                                if (nodesWithAttribs_1_1 && !nodesWithAttribs_1_1.done && (_a = nodesWithAttribs_1.return)) _a.call(nodesWithAttribs_1)
                            } finally {
                                if (e_13) throw e_13.error
                            }
                            return [7];
                        case 8:
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.setOverrideAttribOnHierNodes = function (iHierNodesAndAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                var overriddenHierNodesAndAttribs, iHierNodesAndAttribs_1, iHierNodesAndAttribs_1_1, hierNodeAndAttribs,
                    hierNode, attribs, childHierNodesAndAttribs, childNodesAndKeys, key, e_14_1;
                var e_14, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            overriddenHierNodesAndAttribs = [];
                            _b.label = 1;
                        case 1:
                            _b.trys.push([1, 6, 7, 8]);
                            iHierNodesAndAttribs_1 = __values(iHierNodesAndAttribs), iHierNodesAndAttribs_1_1 = iHierNodesAndAttribs_1.next();
                            _b.label = 2;
                        case 2:
                            if (!!iHierNodesAndAttribs_1_1.done) return [3, 5];
                            hierNodeAndAttribs = iHierNodesAndAttribs_1_1.value;
                            hierNode = hierNodeAndAttribs.HierNode;
                            attribs = hierNodeAndAttribs.Attribs;
                            hierNode.setOverrideAttribs(attribs);
                            overriddenHierNodesAndAttribs.push({HierNode: hierNode, Attribs: hierNode.getAttribs()});
                            childHierNodesAndAttribs = [];
                            childNodesAndKeys = hierNode.getChildrenAndKeys();
                            for (key in childNodesAndKeys) {
                                childHierNodesAndAttribs.push({HierNode: childNodesAndKeys[key], Attribs: attribs})
                            }
                            return [4, this.setOverrideAttribOnHierNodes(childHierNodesAndAttribs)];
                        case 3:
                            _b.sent();
                            _b.label = 4;
                        case 4:
                            iHierNodesAndAttribs_1_1 = iHierNodesAndAttribs_1.next();
                            return [3, 2];
                        case 5:
                            return [3, 8];
                        case 6:
                            e_14_1 = _b.sent();
                            e_14 = {error: e_14_1};
                            return [3, 8];
                        case 7:
                            try {
                                if (iHierNodesAndAttribs_1_1 && !iHierNodesAndAttribs_1_1.done && (_a = iHierNodesAndAttribs_1.return)) _a.call(iHierNodesAndAttribs_1)
                            } finally {
                                if (e_14) throw e_14.error
                            }
                            return [7];
                        case 8:
                            return [4, this.syncHCNodesState(overriddenHierNodesAndAttribs)];
                        case 9:
                            _b.sent();
                            if (!overriddenHierNodesAndAttribs.length) return [3, 11];
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.NodeAttribChangeEvent, this.mViewer, overriddenHierNodesAndAttribs)];
                        case 10:
                            _b.sent();
                            _b.label = 11;
                        case 11:
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.isAssembly = function () {
            return this.mCategory === "ASSEMBLY" ? true : false
        };
        eDwModel.prototype.isPart = function () {
            return this.mCategory === "PART" ? true : false
        };
        eDwModel.prototype.isDrawing = function () {
            return this.mCategory === "DRAWING" ? true : false
        };
        eDwModel.prototype.getNodeType = function (iNodeID) {
            return utils.isNaN(iNodeID) ? eDwTypes_8.HC.NodeType.Unknown : this.mModelHC.getNodeType(iNodeID)
        };
        eDwModel.prototype.getHierarchyNode = function (iIDHC) {
            var e_15, _a;
            var hierNode;
            var modelHC = this.getHCModel();
            var modelViews = this.getAllModelViews();
            try {
                for (var modelViews_1 = __values(modelViews), modelViews_1_1 = modelViews_1.next(); !modelViews_1_1.done; modelViews_1_1 = modelViews_1.next()) {
                    var modelView = modelViews_1_1.value;
                    var nodeType = this.getNodeType(iIDHC);
                    var nodeIDHC = iIDHC;
                    hierNode = modelView.Nodes[nodeIDHC];
                    while (hierNode && (!hierNode.isSelectable() && hierNode !== modelView.Hierarchy) || !hierNode && nodeType !== eDwTypes_8.HC.NodeType.Unknown) {
                        var parentNodeIDHC = modelHC.getNodeParent(nodeIDHC);
                        nodeType = this.getNodeType(parentNodeIDHC);
                        nodeIDHC = parentNodeIDHC || 0;
                        hierNode = modelView.Nodes[nodeIDHC]
                    }
                    if (hierNode) break
                }
            } catch (e_15_1) {
                e_15 = {error: e_15_1}
            } finally {
                try {
                    if (modelViews_1_1 && !modelViews_1_1.done && (_a = modelViews_1.return)) _a.call(modelViews_1)
                } finally {
                    if (e_15) throw e_15.error
                }
            }
            return hierNode
        };
        eDwModel.prototype.getModelViews = function (iContextOpts) {
            var opts = {Name: ""};
            if (iContextOpts) opts = iContextOpts;
            return this.getContext(opts.Name).ModelViews
        };
        eDwModel.prototype.getAllModelViews = function () {
            var e_16, _a;
            var modelViews = [];
            var contextNames = this.getContextModelViewNames();
            try {
                for (var contextNames_1 = __values(contextNames), contextNames_1_1 = contextNames_1.next(); !contextNames_1_1.done; contextNames_1_1 = contextNames_1.next()) {
                    var contextName = contextNames_1_1.value;
                    Array.prototype.push.apply(modelViews, this.getModelViews({Name: contextName}))
                }
            } catch (e_16_1) {
                e_16 = {error: e_16_1}
            } finally {
                try {
                    if (contextNames_1_1 && !contextNames_1_1.done && (_a = contextNames_1.return)) _a.call(contextNames_1)
                } finally {
                    if (e_16) throw e_16.error
                }
            }
            return modelViews
        };
        eDwModel.prototype.getCurrModelViewsOfContexts = function () {
            var e_17, _a;
            var modelViews = [];
            var contexts = this.getAllContexts();
            try {
                for (var contexts_1 = __values(contexts), contexts_1_1 = contexts_1.next(); !contexts_1_1.done; contexts_1_1 = contexts_1.next()) {
                    var modelViewContext = contexts_1_1.value;
                    var modelView = modelViewContext.getCurrModelView();
                    if (modelView) modelViews.push(modelView)
                }
            } catch (e_17_1) {
                e_17 = {error: e_17_1}
            } finally {
                try {
                    if (contexts_1_1 && !contexts_1_1.done && (_a = contexts_1.return)) _a.call(contexts_1)
                } finally {
                    if (e_17) throw e_17.error
                }
            }
            return modelViews
        };
        eDwModel.prototype.getContextModelViewNames = function () {
            var e_18, _a;
            var modelViewContexts = this.getCurrModelViewsOfContexts();
            var contextModelViewNames = [];
            try {
                for (var modelViewContexts_1 = __values(modelViewContexts), modelViewContexts_1_1 = modelViewContexts_1.next(); !modelViewContexts_1_1.done; modelViewContexts_1_1 = modelViewContexts_1.next()) {
                    var modelViewContext = modelViewContexts_1_1.value;
                    contextModelViewNames.push(modelViewContext.ContextName)
                }
            } catch (e_18_1) {
                e_18 = {error: e_18_1}
            } finally {
                try {
                    if (modelViewContexts_1_1 && !modelViewContexts_1_1.done && (_a = modelViewContexts_1.return)) _a.call(modelViewContexts_1)
                } finally {
                    if (e_18) throw e_18.error
                }
            }
            return contextModelViewNames
        };
        eDwModel.prototype.getActiveModelView = function (iContextName) {
            if (iContextName === void 0) {
                iContextName = ""
            }
            var context = this.getContext(iContextName);
            return context.getCurrModelView()
        };
        eDwModel.prototype.getModelViewsShowInContext = function () {
            return this.mModelViewsShowInContext
        };
        eDwModel.prototype.activateModelView = function (iModelView) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (iModelView === this.getActiveModelView(this.mCurrContextName)) {
                                return [2]
                            }
                            return [4, this.setActiveModelView(iModelView)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.getFileOriginType = function () {
            return this.mOrigin
        };
        eDwModel.prototype.resetToDefault = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _a, _b, layer, initialModelView, changedHierNodesAndAttribs, _c, _d, modelViewContext, _e, _f,
                    modelView;
                var e_19, _g, e_20, _h, e_21, _j;
                return __generator(this, (function (_k) {
                    switch (_k.label) {
                        case 0:
                            try {
                                for (_a = __values(this.mLayers), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    layer = _b.value;
                                    layer.resetAttribs()
                                }
                            } catch (e_19_1) {
                                e_19 = {error: e_19_1}
                            } finally {
                                try {
                                    if (_b && !_b.done && (_g = _a.return)) _g.call(_a)
                                } finally {
                                    if (e_19) throw e_19.error
                                }
                            }
                            initialModelView = this.getInitialModelView(this.mInitialContextName);
                            return [4, this.setActiveModelView(initialModelView)];
                        case 1:
                            _k.sent();
                            changedHierNodesAndAttribs = l_makeNodeAttribArray(initialModelView.resetAttribs());
                            return [4, this.syncHCNodesState(changedHierNodesAndAttribs)];
                        case 2:
                            _k.sent();
                            try {
                                for (_c = __values(this.mModelViewContexts), _d = _c.next(); !_d.done; _d = _c.next()) {
                                    modelViewContext = _d.value;
                                    try {
                                        for (_e = (e_21 = void 0, __values(modelViewContext.ModelViews)), _f = _e.next(); !_f.done; _f = _e.next()) {
                                            modelView = _f.value;
                                            if (modelView === initialModelView) continue;
                                            modelView.resetAttribs()
                                        }
                                    } catch (e_21_1) {
                                        e_21 = {error: e_21_1}
                                    } finally {
                                        try {
                                            if (_f && !_f.done && (_j = _e.return)) _j.call(_e)
                                        } finally {
                                            if (e_21) throw e_21.error
                                        }
                                    }
                                }
                            } catch (e_20_1) {
                                e_20 = {error: e_20_1}
                            } finally {
                                try {
                                    if (_d && !_d.done && (_h = _c.return)) _h.call(_c)
                                } finally {
                                    if (e_20) throw e_20.error
                                }
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.syncLayersAttribsState = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var nodeIDsHCAndAttribs, _a, _b, layer;
                var e_22, _c;
                return __generator(this, (function (_d) {
                    switch (_d.label) {
                        case 0:
                            nodeIDsHCAndAttribs = [];
                            try {
                                for (_a = __values(this.mLayers), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    layer = _b.value;
                                    layer.getHCNodesAndAttribs(nodeIDsHCAndAttribs)
                                }
                            } catch (e_22_1) {
                                e_22 = {error: e_22_1}
                            } finally {
                                try {
                                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a)
                                } finally {
                                    if (e_22) throw e_22.error
                                }
                            }
                            return [4, this.setHCToAttrib(nodeIDsHCAndAttribs)];
                        case 1:
                            _d.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.getProperty = function (iPropName) {
            for (var i = 0; i < this.mProperties.length; i++) {
                var property = $(this.mProperties[i]);
                var propName = property.attr("name");
                if (propName === iPropName) return property.attr("val")
            }
            return ""
        };
        eDwModel.prototype.isVisibleForNodeHC = function (iNodeIDHC) {
            return this.mModelHC.getNodeVisibility(iNodeIDHC)
        };
        eDwModel.prototype.setVisibilityForNodesHC = function (iNodeIDsHC, iVisible) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.mModelHC.setNodesVisibility(iNodeIDsHC, iVisible)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.setVisibilitiesForNodesHC = function (iNodeIDVisMapHC) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.mModelHC.setNodesVisibilities(iNodeIDVisMapHC)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.getOpacityForNodeHC = function (iNodeIDHC) {
            return __awaiter(this, void 0, void 0, (function () {
                var opacity, opacities, iErrorMsg_1;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            opacity = NaN;
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, this.mModelHC.getNodesOpacity([iNodeIDHC])];
                        case 2:
                            opacities = _a.sent();
                            if (opacities.length && utils.isNumber(opacities[0])) {
                                opacity = opacities[0]
                            }
                            return [3, 4];
                        case 3:
                            iErrorMsg_1 = _a.sent();
                            return [3, 4];
                        case 4:
                            return [2, opacity]
                    }
                }))
            }))
        };
        eDwModel.prototype.setOpacityForNodesHC = function (iNodeIDsHC, iOpacity) {
            this.mModelHC.setNodesOpacity(iNodeIDsHC, iOpacity)
        };
        eDwModel.prototype.getModelIDHC = function () {
            return 0
        };
        eDwModel.prototype.parseHierarchy = function (iConfig, ioParentHierNode, iXMLNode) {
            if (this.isPart()) return;
            var children = $(iXMLNode).children("body,assembly,view");
            for (var i = 0; i < children.length; i++) {
                var childJQ = $(children[i]);
                var elemTag = childJQ.prop("tagName");
                var nodeAttribs = l_getProperties(childJQ);
                var newChild = ioParentHierNode.addChild(nodeAttribs.Name, elemTag, nodeAttribs, nodeAttribs.HOOPSID, ioParentHierNode);
                this.parseHierarchy(iConfig, newChild, childJQ)
            }
        };
        eDwModel.prototype.loadProperties = function (iPropsMapHC) {
            var propsToParse = iPropsMapHC.eDrawingsXMLData;
            console.debugLog("ViewerLoad", "extra model data = " + propsToParse);
            var doc;
            try {
                var parserXML = new DOMParser;
                doc = parserXML.parseFromString(propsToParse, "text/xml");
                var docJQ = $(doc);
                var data = docJQ.find("sceneData");
                if (data.length > 0) {
                    var sceneData = $(data[0]);
                    this.mOrigin = sceneData.attr("origin");
                    switch (sceneData.attr("type")) {
                        case"drawing":
                            this.mCategory = "DRAWING";
                            break;
                        case"part":
                            this.mCategory = "PART";
                            break;
                        case"assembly":
                            this.mCategory = "ASSEMBLY";
                            break;
                        default:
                            break
                    }
                }
                this.mProperties = docJQ.find("property");
                this.mModelViewsShowInContext = this.getProperty("modelViewsShowInContext") === "true" ? true : false;
                var lengthUnit = this.getProperty("lengthunit");
                var isValidUnit = eDwUnits_1.LengthTypeValues.indexOf(lengthUnit) > -1;
                this.mUserUnits.Length = isValidUnit ? lengthUnit : this.mUserUnits.Length;
                var angleUnit = this.getProperty("angleunit");
                isValidUnit = eDwUnits_1.AngleTypeValues.indexOf(angleUnit) > -1;
                this.mUserUnits.Angle = isValidUnit ? angleUnit : this.mUserUnits.Angle;
                if (this.mCategory === "DRAWING") {
                    this.parseModelViews(docJQ, "sheet", "views", "Unnamed Sheet", "sheet");
                    this.processLayers(iPropsMapHC)
                } else {
                    this.parseModelViews(docJQ, "configuration", "hierarchy", "Unnamed Config", "config")
                }
                if (this.getModelViews().length === 0) {
                    var attrib = new eDwNodeAttributes_3.eDwNodeAttributes;
                    attrib.Visible = true;
                    this.addModelViewInContext(new eDwModelView("eDrawingsDefault", "config", attrib, this.getModelIDHC(), this, null, true), true)
                }
            } catch (iErr) {
                var errors = doc ? doc.getElementsByTagName("parsererror") : null;
                if (errors && errors.length) {
                    var msg = "XML parser error" + iErr.message ? ": " + iErr.message : "" + "\n";
                    var elem = errors[0];
                    if (utils.isOfType(elem, "innerHTML")) {
                        msg += elem.innerText
                    }
                    console.warn(msg)
                }
            }
        };
        eDwModel.prototype.processLayers = function (iPropsMapHC) {
            var _this = this;
            var layersObj = {};
            this.mModelHC.getLayers().forEach((function (iLayerName, iLayerIDHC) {
                if (!iLayerName) return;
                var attribs = new eDwNodeAttributes_3.eDwNodeAttributes;
                attribs.Visible = iPropsMapHC[iLayerName] !== "off";
                var layer = new eDwLayer(iLayerName, iLayerIDHC, attribs);
                layersObj[iLayerName] = layer;
                layer.addNodes(_this.mModelHC.getNodesFromLayer(iLayerIDHC), _this)
            }));
            var layerNames = Object.keys(layersObj).sort();
            this.mLayers = layerNames.map((function (iName) {
                return layersObj[iName]
            }))
        };
        eDwModel.prototype.setActiveModelView = function (iModelView) {
            return __awaiter(this, void 0, void 0, (function () {
                var oldModelView, changedHierNodesAndAttribs, visAttrib, invisAttrib, iError_1;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!iModelView) return [3, 8];
                            oldModelView = this.getContext(this.mCurrContextName).Current;
                            this.mCurrContextName = iModelView.ContextName;
                            this.getContext(this.mCurrContextName).Current = iModelView;
                            changedHierNodesAndAttribs = [];
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 5, , 6]);
                            visAttrib = new eDwNodeAttributes_3.eDwNodeAttributes;
                            visAttrib.Visible = true;
                            invisAttrib = new eDwNodeAttributes_3.eDwNodeAttributes;
                            invisAttrib.Visible = false;
                            if (oldModelView && oldModelView !== iModelView) {
                                changedHierNodesAndAttribs = l_makeNodeAttribArray(oldModelView.Hierarchy.find("mAttribs", visAttrib, true), invisAttrib);
                                oldModelView.Hierarchy.setAttribs(invisAttrib)
                            }
                            if (this.mViewer.ViewerFeatureOpts.Debug) {
                                this.dumpModelViewStateHC("Before set active view = true")
                            }
                            changedHierNodesAndAttribs.push({HierNode: iModelView.Hierarchy, Attribs: visAttrib});
                            Array.prototype.push.apply(changedHierNodesAndAttribs, l_makeNodeAttribArray(iModelView.Hierarchy.find("mAttribs", invisAttrib, true, false), invisAttrib));
                            iModelView.Hierarchy.setAttribs(visAttrib);
                            return [4, this.syncHCNodesState(changedHierNodesAndAttribs)];
                        case 2:
                            _a.sent();
                            if (!changedHierNodesAndAttribs.length) return [3, 4];
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.NodeAttribChangeEvent, this.mViewer, changedHierNodesAndAttribs)];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            if (this.mViewer.ViewerFeatureOpts.Debug) {
                                this.dumpModelViewStateHC("After set active view = true")
                            }
                            this.mViewer.ViewMgr.setCamera(iModelView.getDefaultCamera(), 400);
                            return [3, 6];
                        case 5:
                            iError_1 = _a.sent();
                            console.debugLog("NodeVisibility", "activateModelView failed to set node visibilities.");
                            console.error(iError_1);
                            return [3, 6];
                        case 6:
                            return [4, l_notifyModelViewChange(this.mViewer, oldModelView, iModelView, this.isPart())];
                        case 7:
                            _a.sent();
                            _a.label = 8;
                        case 8:
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.setHCToAttrib = function (iNodeIDsHCAndAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                var iNodeIDsHCAndAttribs_1, iNodeIDsHCAndAttribs_1_1, nodeIDHCAndAttribs, nodeIDHC, attribs,
                    oldVisibility, oldOpacity, nodeNameHC, opacity, newVisibility, e_23_1;
                var e_23, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!iNodeIDsHCAndAttribs.length) return [2];
                            _b.label = 1;
                        case 1:
                            _b.trys.push([1, 9, 10, 11]);
                            iNodeIDsHCAndAttribs_1 = __values(iNodeIDsHCAndAttribs), iNodeIDsHCAndAttribs_1_1 = iNodeIDsHCAndAttribs_1.next();
                            _b.label = 2;
                        case 2:
                            if (!!iNodeIDsHCAndAttribs_1_1.done) return [3, 8];
                            nodeIDHCAndAttribs = iNodeIDsHCAndAttribs_1_1.value;
                            nodeIDHC = nodeIDHCAndAttribs.IDHC;
                            attribs = nodeIDHCAndAttribs.Attribs;
                            oldVisibility = void 0;
                            oldOpacity = void 0;
                            nodeNameHC = void 0;
                            if (!this.mViewer.ViewerFeatureOpts.Debug) return [3, 4];
                            return [4, this.getOpacityForNodeHC(nodeIDHC)];
                        case 3:
                            oldOpacity = _b.sent();
                            oldVisibility = this.isVisibleForNodeHC(nodeIDHC);
                            nodeNameHC = this.mModelHC.getNodeName(nodeIDHC);
                            _b.label = 4;
                        case 4:
                            if (!(oldVisibility !== attribs.Visible)) return [3, 6];
                            return [4, this.setVisibilityForNodesHC([nodeIDHC], attribs.Visible)];
                        case 5:
                            _b.sent();
                            _b.label = 6;
                        case 6:
                            opacity = attribs.Opaque === undefined ? NaN : attribs.Opaque ? 1 : .25;
                            if (attribs.Visible && utils.isNumber(opacity)) {
                                this.setOpacityForNodesHC([nodeIDHC], opacity)
                            }
                            if (this.mViewer.ViewerFeatureOpts.Debug) {
                                newVisibility = this.isVisibleForNodeHC(nodeIDHC);
                                console.debugLog("NodeVisibility", "HC Node (name = " + nodeNameHC + ", ID = " + nodeIDHC + ") | old visibility = " + oldVisibility + " | new visibility = " + newVisibility + " | intended visibility = " + attribs.Visible + " | old opacity = " + oldOpacity + " | intended opacity = " + opacity)
                            }
                            _b.label = 7;
                        case 7:
                            iNodeIDsHCAndAttribs_1_1 = iNodeIDsHCAndAttribs_1.next();
                            return [3, 2];
                        case 8:
                            return [3, 11];
                        case 9:
                            e_23_1 = _b.sent();
                            e_23 = {error: e_23_1};
                            return [3, 11];
                        case 10:
                            try {
                                if (iNodeIDsHCAndAttribs_1_1 && !iNodeIDsHCAndAttribs_1_1.done && (_a = iNodeIDsHCAndAttribs_1.return)) _a.call(iNodeIDsHCAndAttribs_1)
                            } finally {
                                if (e_23) throw e_23.error
                            }
                            return [7];
                        case 11:
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.syncHCNodesState = function (iHierNodesAndAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                var nodeIDsHCAndVisAttribs, nodeIDsHCAndInvisAttribs, iHierNodesAndAttribs_2, iHierNodesAndAttribs_2_1,
                    hierNodeAndAttribs, hierNode;
                var e_24, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            nodeIDsHCAndVisAttribs = [];
                            nodeIDsHCAndInvisAttribs = [];
                            try {
                                for (iHierNodesAndAttribs_2 = __values(iHierNodesAndAttribs), iHierNodesAndAttribs_2_1 = iHierNodesAndAttribs_2.next(); !iHierNodesAndAttribs_2_1.done; iHierNodesAndAttribs_2_1 = iHierNodesAndAttribs_2.next()) {
                                    hierNodeAndAttribs = iHierNodesAndAttribs_2_1.value;
                                    hierNode = hierNodeAndAttribs.HierNode;
                                    if (hierNode.HOOPSID && utils.isNumber(hierNode.HOOPSID)) {
                                        if (hierNodeAndAttribs.Attribs.Visible) {
                                            nodeIDsHCAndVisAttribs.push({
                                                IDHC: hierNode.HOOPSID,
                                                Attribs: hierNodeAndAttribs.Attribs
                                            })
                                        } else {
                                            nodeIDsHCAndInvisAttribs.push({
                                                IDHC: hierNode.HOOPSID,
                                                Attribs: hierNodeAndAttribs.Attribs
                                            })
                                        }
                                    }
                                }
                            } catch (e_24_1) {
                                e_24 = {error: e_24_1}
                            } finally {
                                try {
                                    if (iHierNodesAndAttribs_2_1 && !iHierNodesAndAttribs_2_1.done && (_a = iHierNodesAndAttribs_2.return)) _a.call(iHierNodesAndAttribs_2)
                                } finally {
                                    if (e_24) throw e_24.error
                                }
                            }
                            if (!nodeIDsHCAndVisAttribs.length) return [3, 3];
                            return [4, this.setHCToAttrib(nodeIDsHCAndVisAttribs)];
                        case 1:
                            _b.sent();
                            return [4, this.syncLayersAttribsState()];
                        case 2:
                            _b.sent();
                            _b.label = 3;
                        case 3:
                            return [4, this.setHCToAttrib(nodeIDsHCAndInvisAttribs)];
                        case 4:
                            _b.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwModel.prototype.parseModelViews = function (iDocJQ, iXMLDocModelViewSearchKeyword, iXMLDocModelViewSubElemSearchKeyword, iDefaultModelViewName, iModelViewCategory) {
            var modelViewsJQ = iDocJQ.find(iXMLDocModelViewSearchKeyword);
            console.debugLog("ModelViews", "parseModelViews - num model views = " + modelViewsJQ.length);
            for (var i = 0; i < modelViewsJQ.length; i++) {
                var modelViewJQ = $(modelViewsJQ[i]);
                var nodeAttribs = l_getProperties(modelViewJQ);
                if (!nodeAttribs.Name) {
                    nodeAttribs.Name = iDefaultModelViewName + (i + 1)
                }
                var cameraHC = l_getDefaultCamera(modelViewJQ);
                var isDefault = l_isDefault(l_trueFalseOrIndeterminate(modelViewJQ.attr("default")), nodeAttribs.Visible);
                var modelView = new eDwModelView(nodeAttribs.Name, iModelViewCategory, nodeAttribs, nodeAttribs.HOOPSID, this, cameraHC, isDefault);
                this.addModelViewInContext(modelView, isDefault);
                if (nodeAttribs.Visible) {
                    this.mInitialContextName = modelView.ContextName;
                    this.mCurrContextName = modelView.ContextName
                }
                var hierarchyNode = modelView.Hierarchy;
                this.parseHierarchy(modelView, hierarchyNode, modelViewJQ.find(iXMLDocModelViewSubElemSearchKeyword));
                l_addTables(this.mViewer, iDocJQ, this, hierarchyNode, modelView)
            }
        };
        eDwModel.prototype.addModelViewInContext = function (iModelView, iIsDefault) {
            var context = this.getContext(iModelView.ContextName);
            if (!context.ModelViews.length) {
                this.mModelViewContexts.push(context)
            }
            context.ModelViews.push(iModelView);
            var defaultModelView = iIsDefault ? iModelView : null;
            context.Initial = context.Initial || defaultModelView;
            context.Current = context.Current || context.Initial;
            return context
        };
        eDwModel.prototype.getValidContextName = function (iContextName) {
            var contextNames = this.getContextModelViewNames();
            var firstName = contextNames.length ? contextNames[0] : "";
            return iContextName || this.mCurrContextName || firstName
        };
        eDwModel.prototype.getContext = function (iContextName) {
            var e_25, _a;
            var contextName = this.getValidContextName(iContextName);
            var contexts = this.getAllContexts();
            try {
                for (var contexts_2 = __values(contexts), contexts_2_1 = contexts_2.next(); !contexts_2_1.done; contexts_2_1 = contexts_2.next()) {
                    var context = contexts_2_1.value;
                    if (context.ModelViews[0].ContextName === contextName) {
                        return context
                    }
                }
            } catch (e_25_1) {
                e_25 = {error: e_25_1}
            } finally {
                try {
                    if (contexts_2_1 && !contexts_2_1.done && (_a = contexts_2.return)) _a.call(contexts_2)
                } finally {
                    if (e_25) throw e_25.error
                }
            }
            return new ModelViewContext
        };
        eDwModel.prototype.getAllContexts = function () {
            var e_26, _a;
            var contexts = [];
            try {
                for (var _b = __values(this.mModelViewContexts), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var modelViewContext = _c.value;
                    if (!modelViewContext.ModelViews.length) {
                        continue
                    }
                    contexts.push(modelViewContext)
                }
            } catch (e_26_1) {
                e_26 = {error: e_26_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_26) throw e_26.error
                }
            }
            return contexts
        };
        eDwModel.prototype.getInitialModelView = function (iContextName) {
            if (iContextName === void 0) {
                iContextName = ""
            }
            return this.getContext(iContextName).Initial
        };
        eDwModel.prototype.dumpModelViewStateHC = function (iPrefixMsg) {
            var e_27, _a, e_28, _b, e_29, _c;
            var _this = this;
            var msg = iPrefixMsg + " -> (HC values) | ";
            var contextNames = this.getContextModelViewNames();
            try {
                for (var contextNames_2 = __values(contextNames), contextNames_2_1 = contextNames_2.next(); !contextNames_2_1.done; contextNames_2_1 = contextNames_2.next()) {
                    var contextName = contextNames_2_1.value;
                    var modelViews = this.getModelViews({Name: contextName});
                    try {
                        for (var modelViews_2 = (e_28 = void 0, __values(modelViews)), modelViews_2_1 = modelViews_2.next(); !modelViews_2_1.done; modelViews_2_1 = modelViews_2.next()) {
                            var modelView_1 = modelViews_2_1.value;
                            var nodeIDHC = modelView_1.Hierarchy.HOOPSID;
                            msg += modelView_1.ContextName + " ( " + modelView_1.SubName + ") - " + this.isVisibleForNodeHC(nodeIDHC) + " | "
                        }
                    } catch (e_28_1) {
                        e_28 = {error: e_28_1}
                    } finally {
                        try {
                            if (modelViews_2_1 && !modelViews_2_1.done && (_b = modelViews_2.return)) _b.call(modelViews_2)
                        } finally {
                            if (e_28) throw e_28.error
                        }
                    }
                }
            } catch (e_27_1) {
                e_27 = {error: e_27_1}
            } finally {
                try {
                    if (contextNames_2_1 && !contextNames_2_1.done && (_a = contextNames_2.return)) _a.call(contextNames_2)
                } finally {
                    if (e_27) throw e_27.error
                }
            }
            console.debugLog("NodeVisibility", msg);
            console.debugLog("NodeVisibility", "Active model view = " + this.mCurrContextName);
            var context = this.getContext(this.mCurrContextName);
            if (!context.ModelViews.length) return;
            var modelView = context.Current;
            var hierNodes = modelView.getNodes();
            var nodeVisibilityMap = {};
            try {
                for (var hierNodes_1 = __values(hierNodes), hierNodes_1_1 = hierNodes_1.next(); !hierNodes_1_1.done; hierNodes_1_1 = hierNodes_1.next()) {
                    var hierNode = hierNodes_1_1.value;
                    nodeVisibilityMap[hierNode.HOOPSID] = this.isVisibleForNodeHC(hierNode.HOOPSID)
                }
            } catch (e_29_1) {
                e_29 = {error: e_29_1}
            } finally {
                try {
                    if (hierNodes_1_1 && !hierNodes_1_1.done && (_c = hierNodes_1.return)) _c.call(hierNodes_1)
                } finally {
                    if (e_29) throw e_29.error
                }
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var promises, hierNodes_2, hierNodes_2_1, hierNode, i, opacities, hierNodes_3, hierNodes_3_1,
                        hierNode;
                    var e_30, _a, e_31, _b;
                    return __generator(this, (function (_c) {
                        switch (_c.label) {
                            case 0:
                                promises = [];
                                try {
                                    for (hierNodes_2 = __values(hierNodes), hierNodes_2_1 = hierNodes_2.next(); !hierNodes_2_1.done; hierNodes_2_1 = hierNodes_2.next()) {
                                        hierNode = hierNodes_2_1.value;
                                        utils.appendToArray(this.getOpacityForNodeHC(hierNode.HOOPSID), promises)
                                    }
                                } catch (e_30_1) {
                                    e_30 = {error: e_30_1}
                                } finally {
                                    try {
                                        if (hierNodes_2_1 && !hierNodes_2_1.done && (_a = hierNodes_2.return)) _a.call(hierNodes_2)
                                    } finally {
                                        if (e_30) throw e_30.error
                                    }
                                }
                                i = 0;
                                return [4, Promise.all(promises)];
                            case 1:
                                opacities = _c.sent();
                                try {
                                    for (hierNodes_3 = __values(hierNodes), hierNodes_3_1 = hierNodes_3.next(); !hierNodes_3_1.done; hierNodes_3_1 = hierNodes_3.next()) {
                                        hierNode = hierNodes_3_1.value;
                                        console.debugLog("NodeVisibility", hierNode.Name + " HOOPS ID " + hierNode.HOOPSID + " Visibility = " + nodeVisibilityMap[hierNode.HOOPSID] + " Opacity = " + opacities[i++])
                                    }
                                } catch (e_31_1) {
                                    e_31 = {error: e_31_1}
                                } finally {
                                    try {
                                        if (hierNodes_3_1 && !hierNodes_3_1.done && (_b = hierNodes_3.return)) _b.call(hierNodes_3)
                                    } finally {
                                        if (e_31) throw e_31.error
                                    }
                                }
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwModel.prototype.getHCModel = function () {
            return this.mModelHC
        };
        return eDwModel
    }();
    var ModelViewContext = function () {
        function ModelViewContext() {
            this.Initial = null;
            this.Current = null;
            this.ModelViews = []
        }

        ModelViewContext.prototype.getCurrModelView = function () {
            var firstModelView = this.ModelViews.length ? this.ModelViews[0] : null;
            return this.Current || firstModelView
        };
        return ModelViewContext
    }();
    var c_lengthUnitToMMFactor = 1e3;

    function l_addTables(iViewer, iDoc, iModel, ioHierachyNode, ioModelView) {
        var tables = $(iDoc).find("table");
        var numTables = tables.length;
        if (numTables > 0 && ioHierachyNode) {
            for (var i = 0; i < numTables; i++) {
                var tableJQ = $(tables[i]);
                var nodeAttribs = l_getProperties(tableJQ);
                if (!nodeAttribs.Name) {
                    nodeAttribs.Name = "Unnamed Table" + (i + 1)
                }
                var hierarchyNode = ioHierachyNode.addChild(nodeAttribs.Name, "table", nodeAttribs, nodeAttribs.HOOPSID, ioHierachyNode);
                iViewer.TableMgr.add(hierarchyNode)
            }
        }
    }

    var l_NodeProperties = function (_super) {
        __extends(l_NodeProperties, _super);

        function l_NodeProperties() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.Name = "";
            _this.HOOPSID = NaN;
            return _this
        }

        return l_NodeProperties
    }(eDwNodeAttributes_3.eDwNodeAttributes);

    function l_trueFalseOrIndeterminate(iVal) {
        if (iVal === undefined) return undefined;
        return iVal === "1" ? true : iVal === "0" ? false : undefined
    }

    function l_getProperties(iElemJQ) {
        var props = new l_NodeProperties;
        if (iElemJQ) {
            props.Name = utils.decodeURIComponent(iElemJQ.attr("name"));
            if (props.Name.charAt(0) == "<" && props.Name.charAt(props.Name.length - 1) == ">") {
                props.Name = props.Name.replace("<", "&lt;");
                props.Name = props.Name.replace(">", "&gt;")
            }
            props.Visible = l_trueFalseOrIndeterminate(iElemJQ.attr("visible"));
            props.Selectable = l_trueFalseOrIndeterminate(iElemJQ.attr("selectable"));
            props.Opaque = true;
            var color = Color_1.Color.create(parseInt(iElemJQ.attr("color"), 10));
            if (color.isValid()) {
                props.Red = color.r;
                props.Green = color.g;
                props.Blue = color.b;
                props.Opaque = color.isOpaque()
            } else {
                props.Opaque = iElemJQ.attr("transparent") === "1" ? false : true
            }
            props.DisplayMode = parseInt(iElemJQ.attr("displayMode"), 10);
            props.HOOPSID = parseInt(iElemJQ.attr("id"), 10)
        }
        return props
    }

    function l_getDefaultCamera(iElemJQ) {
        var perspectiveStr = iElemJQ.attr("camPerspective");
        if (!perspectiveStr) return undefined;
        var posPtHC = new eDwTypes_8.HC.Point3(parseFloat(iElemJQ.attr("camPosX")), parseFloat(iElemJQ.attr("camPosY")), parseFloat(iElemJQ.attr("camPosZ")));
        var tgtPtHC = new eDwTypes_8.HC.Point3(parseFloat(iElemJQ.attr("camTgtX")), parseFloat(iElemJQ.attr("camTgtY")), parseFloat(iElemJQ.attr("camTgtZ")));
        var upVecHC = new eDwTypes_8.HC.Point3(parseFloat(iElemJQ.attr("upX")), parseFloat(iElemJQ.attr("upY")), parseFloat(iElemJQ.attr("upZ")));
        var width = parseFloat(iElemJQ.attr("camFieldWidth"));
        var height = parseFloat(iElemJQ.attr("camFieldHeight"));
        var projHC = perspectiveStr === "true" ? eDwTypes_8.HC.Projection.Perspective : eDwTypes_8.HC.Projection.Orthographic;
        return eDwTypes_8.HC.Camera.create(posPtHC, tgtPtHC, upVecHC, projHC, width, height)
    }

    function l_makeNodeAttribArray(iHierNodes, iAttrib, iIgnoreActive) {
        if (iAttrib === void 0) {
            iAttrib = null
        }
        if (iIgnoreActive === void 0) {
            iIgnoreActive = true
        }
        return iHierNodes.map((function (iHierNode) {
            var attrib = new eDwNodeAttributes_3.eDwNodeAttributes;
            $.extend(attrib, iHierNode.getAttribs(iIgnoreActive));
            if (iAttrib) $.extend(attrib, iAttrib);
            return {HierNode: iHierNode, Attribs: attrib}
        }))
    }

    function l_notifyModelViewChange(iViewer, iPrevModelView, iCurrModelView, iIsPart) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, eDwEventMgr.get().fireEvent(eDwEvents_2.ModelViewChangeEvent, iViewer, iPrevModelView, iCurrModelView, !iIsPart)];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    function l_isDefault(iIsDefault, iIsVisible) {
        return iIsDefault || iIsDefault === undefined && iIsVisible
    }

    return eDwModel
}));
define("eDwModelView", ["require", "exports", "eDwHierarchyNode"], (function (require, exports, eDwHierarchyNode) {
    "use strict";
    var eDwModelView = function () {
        function eDwModelView(iName, Category, iAttribs, iNodeIDHC, iModel, iDefCameraHC, iIsDefault) {
            this.Category = Category;
            console.debugLog("ModelViews", "Model View name = " + iName + " category = " + this.Category + " isDefault = " + iIsDefault);
            this.setNames(iName);
            this.mIsDefault = iIsDefault;
            this.Nodes = {};
            this.mDefCameraHC = iDefCameraHC;
            this.Hierarchy = new eDwHierarchyNode(this.ContextName, this.Category, iAttribs, iNodeIDHC, null, this);
            this.Model = iModel
        }

        eDwModelView.prototype.getNodes = function () {
            var hierNodes = [];
            for (var hierNodeName in this.Nodes) {
                hierNodes.push(this.Nodes[hierNodeName])
            }
            return hierNodes
        };
        eDwModelView.prototype.getDefaultCamera = function () {
            return this.mDefCameraHC
        };
        eDwModelView.prototype.isDefault = function () {
            return this.mIsDefault
        };
        eDwModelView.prototype.resetAttribs = function () {
            return this.Hierarchy.resetAttribs()
        };
        eDwModelView.prototype.setNames = function (iName) {
            var dividerPos = iName.indexOf("\n");
            this.ContextName = iName;
            this.SubName = "";
            if (dividerPos > -1) {
                this.ContextName = iName.substring(0, dividerPos);
                this.SubName = iName.substring(dividerPos + 1)
            }
        };
        return eDwModelView
    }();
    return eDwModelView
}));
define("eDwMoveSectionPlaneCmd", ["require", "exports", "eDwTypes", "eDwSupportsHistoryCmd"], (function (require, exports, eDwTypes_9, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwMoveSectionPlaneCmd = function (_super) {
        __extends(eDwMoveSectionPlaneCmd, _super);

        function eDwMoveSectionPlaneCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialPntOnPlane = _this.mViewer.XSectionMgr.projectPoint(new eDwTypes_9.HC.Point3(0, 0, 0));
            return _this
        }

        eDwMoveSectionPlaneCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var altDir;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            altDir = this.mDir.copy().negate();
                            this.mViewer.XSectionMgr.moveCurrentAlongNormal(altDir);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwMoveSectionPlaneCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.moveCurrentAlongNormal(this.mDir);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwMoveSectionPlaneCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mFinalPntOnPlane = this.mViewer.XSectionMgr.projectPoint(new eDwTypes_9.HC.Point3(0, 0, 0));
                            this.mDir = this.mFinalPntOnPlane.subtract(this.mInitialPntOnPlane);
                            return [2]
                    }
                }))
            }))
        };
        eDwMoveSectionPlaneCmd.prototype.isCommitted = function () {
            return _super.prototype.isCommitted.call(this) && !!this.mInitialPntOnPlane && !!this.mFinalPntOnPlane
        };
        Object.defineProperty(eDwMoveSectionPlaneCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwMoveSectionPlaneCmd
    }(eDwSupportsHistoryCmd);
    return eDwMoveSectionPlaneCmd
}));
define("eDwNodeAttributes", ["require", "exports", "utils"], (function (require, exports, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.NodeDisplayState = exports.eDwNodeAttributes = void 0;
    var eDwNodeAttributes = function () {
        function eDwNodeAttributes() {
        }

        eDwNodeAttributes.prototype.getProp = function (iPropName) {
            return this[iPropName]
        };
        eDwNodeAttributes.prototype.setProp = function (iPropName, iValue) {
            return this[iPropName] = iValue
        };
        eDwNodeAttributes.prototype.copy = function () {
            return eDwNodeAttributes.mergeAttribs(new eDwNodeAttributes, this)
        };
        eDwNodeAttributes.prototype.set = function (iSourceAttribs) {
            return eDwNodeAttributes.setAttribs(this, iSourceAttribs)
        };
        eDwNodeAttributes.prototype.isOpaque = function () {
            return this.Opaque === undefined || this.Opaque
        };
        eDwNodeAttributes.setAttribs = function (ioTargetAttribs, iSourceAttribs) {
            var e_32, _a;
            var changedAttribNames = [];
            var entries = utils.getEntries(iSourceAttribs);
            try {
                for (var entries_1 = __values(entries), entries_1_1 = entries_1.next(); !entries_1_1.done; entries_1_1 = entries_1.next()) {
                    var _b = __read(entries_1_1.value, 2), attribKey = _b[0], attribValue = _b[1];
                    if (!utils.isEqual(ioTargetAttribs[attribKey], attribValue)) {
                        ioTargetAttribs[attribKey] = attribValue;
                        changedAttribNames.push(attribKey)
                    }
                }
            } catch (e_32_1) {
                e_32 = {error: e_32_1}
            } finally {
                try {
                    if (entries_1_1 && !entries_1_1.done && (_a = entries_1.return)) _a.call(entries_1)
                } finally {
                    if (e_32) throw e_32.error
                }
            }
            return changedAttribNames
        };
        eDwNodeAttributes.mergeAttribs = function (ioTargetAttribs, iSourceAttribs) {
            return eDwNodeAttributes.combineAttribs(ioTargetAttribs, iSourceAttribs, (function (iTargetValue, iSourceValue) {
                return iTargetValue || iSourceValue
            }))
        };
        eDwNodeAttributes.intersectAttribs = function (iSrcAttrib1, iSrcAttrib2) {
            return eDwNodeAttributes.combineAttribs(iSrcAttrib1, iSrcAttrib2, (function (iTargetValue, iSourceValue) {
                return iTargetValue && iSourceValue
            }))
        };
        eDwNodeAttributes.combineAttribs = function (iSrcAttrib1, iSrcAttrib2, iCombineFunc) {
            var e_33, _a;
            var fullAttribs = new eDwNodeAttributes;
            if (iSrcAttrib1 && iSrcAttrib2) {
                fullAttribs = l_syncAttributeKeys(iSrcAttrib1, iSrcAttrib2);
                var entries = utils.getEntries(fullAttribs);
                try {
                    for (var entries_2 = __values(entries), entries_2_1 = entries_2.next(); !entries_2_1.done; entries_2_1 = entries_2.next()) {
                        var entry = entries_2_1.value;
                        var attribKey = entry[0];
                        var value = iCombineFunc(iSrcAttrib1.getProp(attribKey), iSrcAttrib2.getProp(attribKey));
                        if (value !== undefined) {
                            fullAttribs.setProp(attribKey, value)
                        } else fullAttribs.setProp(attribKey, undefined)
                    }
                } catch (e_33_1) {
                    e_33 = {error: e_33_1}
                } finally {
                    try {
                        if (entries_2_1 && !entries_2_1.done && (_a = entries_2.return)) _a.call(entries_2)
                    } finally {
                        if (e_33) throw e_33.error
                    }
                }
            }
            var cNoAttribs = new eDwNodeAttributes;
            return utils.isEqual(fullAttribs, cNoAttribs) ? undefined : fullAttribs
        };
        return eDwNodeAttributes
    }();
    exports.eDwNodeAttributes = eDwNodeAttributes;
    var NodeDisplayState;
    (function (NodeDisplayState) {
        NodeDisplayState["Visible"] = "Visible";
        NodeDisplayState["Invisible"] = "Invisible";
        NodeDisplayState["Opaque"] = "Opaque";
        NodeDisplayState["Transparent"] = "Transparent"
    })(NodeDisplayState = exports.NodeDisplayState || (exports.NodeDisplayState = {}));

    function l_syncAttributeKeys(ioTargetAttribs, iSourceAttribs) {
        var e_34, _a;
        var attribs = $.extend({}, ioTargetAttribs);
        var entries = utils.getEntries(iSourceAttribs);
        try {
            for (var entries_3 = __values(entries), entries_3_1 = entries_3.next(); !entries_3_1.done; entries_3_1 = entries_3.next()) {
                var entry = entries_3_1.value;
                var attribKey = entry[0];
                if (!attribs[attribKey]) {
                    attribs[attribKey] = undefined
                }
            }
        } catch (e_34_1) {
            e_34 = {error: e_34_1}
        } finally {
            try {
                if (entries_3_1 && !entries_3_1.done && (_a = entries_3.return)) _a.call(entries_3)
            } finally {
                if (e_34) throw e_34.error
            }
        }
        return attribs
    }
}));
define("eDwOperationMixin", ["require", "exports"], (function (require, exports) {
    "use strict";
    var eDwOperationMixin = function () {
        function eDwOperationMixin() {
            this.mExclusive = true
        }

        Object.defineProperty(eDwOperationMixin.prototype, "Exclusive", {
            get: function () {
                return this.mExclusive
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwOperationMixin.prototype, "AllowsAggregation", {
            get: function () {
                return false
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwOperationMixin.prototype, "Aggregable", {
            get: function () {
                return false
            }, enumerable: false, configurable: true
        });
        return eDwOperationMixin
    }();
    return eDwOperationMixin
}));
define("eDwOperatorBaseDeps", ["require", "exports", "eDwSelObj", "eDwKeyMgr", "eDwTypes", "utils", "eDwGeomUtils"], (function (require, exports, eDwSelObj, eDwKeyMgr_1, eDwTypes_10, utils, eDwGeomUtils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwBaseOperator = exports.OperatorHC = exports.eDwOperatorMgr = void 0;
    var eDwOperatorMgr = function () {
        function eDwOperatorMgr(iViewer) {
            this.mOpsData = {};
            this.mOperatorMgrHC = iViewer.HCViewer.getOperatorManager();
            this.resetToDefault();
            var cameraZoomOp = this.mOperatorMgrHC.getOperator(eDwTypes_10.HC.OperatorId.Zoom);
            cameraZoomOp.setMouseWheelZoomInverted(false)
        }

        eDwOperatorMgr.prototype.registerCustomOperator = function (ioOp, iActivate) {
            if (iActivate === void 0) {
                iActivate = false
            }
            ioOp.OperatorID = this.mOperatorMgrHC.registerCustomOperator(ioOp);
            this.mOpsData[ioOp.OperatorID] = {Op: ioOp, ActivatedByDefault: iActivate};
            if (iActivate) this.push(ioOp.OperatorID);
            return ioOp.OperatorID
        };
        eDwOperatorMgr.prototype.unregisterCustomOperator = function (iOp) {
            this.unregisterCustomOperatorByID(iOp.OperatorID)
        };
        eDwOperatorMgr.prototype.unregisterCustomOperatorByID = function (iOpID) {
            if (this.popToOp(iOpID) === iOpID) {
                this.pop()
            }
            this.mOperatorMgrHC.unregisterCustomOperator(iOpID);
            delete this.mOpsData[iOpID]
        };
        eDwOperatorMgr.prototype.unregisterAll = function () {
            var _this = this;
            utils.forAll((function (iOpID, iOpData) {
                _this.unregisterCustomOperatorByID(iOpID)
            }), this.mOpsData)
        };
        eDwOperatorMgr.prototype.push = function (iOpID) {
            var activeOpID = this.getActiveOperatorID();
            if (activeOpID !== iOpID) {
                return this.mOperatorMgrHC.push(iOpID)
            }
            return false
        };
        eDwOperatorMgr.prototype.pop = function (iOpID) {
            var retOpID = eDwTypes_10.HC.OperatorId.None;
            if (!iOpID || iOpID && this.getActiveOperatorID() === iOpID) {
                retOpID = this.mOperatorMgrHC.pop() || eDwTypes_10.HC.OperatorId.None
            }
            return retOpID
        };
        eDwOperatorMgr.prototype.popToOp = function (iOpID) {
            var retOpID = eDwTypes_10.HC.OperatorId.None;
            var opStackPos = this.mOperatorMgrHC.indexOf(iOpID);
            if (opStackPos > -1) {
                while (this.getActiveOperatorID() !== iOpID) {
                    this.pop()
                }
                retOpID = iOpID
            }
            return retOpID
        };
        eDwOperatorMgr.prototype.getOperator = function (iOpID) {
            return this.mOperatorMgrHC.getOperator(iOpID)
        };
        eDwOperatorMgr.prototype.getActiveOperatorID = function () {
            return this.mOperatorMgrHC.peek()
        };
        eDwOperatorMgr.prototype.getOperatorIndex = function (iOp) {
            var opsStack = [];
            var numOps = this.mOperatorMgrHC.size();
            var index = -1;
            for (var i = 0; i < numOps; i++) {
                if (this.getOperator(this.getActiveOperatorID()) === iOp) {
                    index = i;
                    break
                }
                var op = this.mOperatorMgrHC.pop();
                if (op) opsStack.push(op)
            }
            var lastOpPos = opsStack.length - 1;
            for (var i = lastOpPos; i >= 0; i++) {
                this.mOperatorMgrHC.push(opsStack[i])
            }
            return index
        };
        eDwOperatorMgr.prototype.setOpID = function (iOpID, iIndex) {
            return this.mOperatorMgrHC.set(iOpID, iIndex)
        };
        eDwOperatorMgr.prototype.set = function (iOp, iIndex) {
            return this.setOpID(iOp.OperatorID, iIndex)
        };
        eDwOperatorMgr.prototype.resetToDefault = function () {
            var _this = this;
            for (var opIDKey in eDwTypes_10.HC.OperatorId) {
                var opID = parseInt(eDwTypes_10.HC.OperatorId[opIDKey], 10);
                if (utils.isNumber(opID) && opID != eDwTypes_10.HC.OperatorId.Navigate) {
                    this.removeByOpID(opID)
                }
            }
            utils.forAll((function (iOpID, iOpData) {
                if (iOpData.ActivatedByDefault) {
                    _this.push(iOpData.Op.OperatorID)
                }
            }), this.mOpsData)
        };
        eDwOperatorMgr.prototype.removeByOpID = function (iOpID) {
            this.mOperatorMgrHC.remove(iOpID)
        };
        return eDwOperatorMgr
    }();
    exports.eDwOperatorMgr = eDwOperatorMgr;
    var OperatorHC = function () {
        function OperatorHC(iOp) {
            this.mOp = iOp;
            this.OperatorID = NaN
        }

        OperatorHC.prototype.onActivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp) return [2];
                            _a = this.mOp.onActivate;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onActivate()];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp) return [2];
                            _a = this.mOp.onDeactivate;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onDeactivate()];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioMouseEvent) return [2];
                            _a = this.mOp.onMouseDown;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onMouseDown(ioMouseEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onMouseMove = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioMouseEvent) return [2];
                            _a = this.mOp.onMouseMove;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onMouseMove(ioMouseEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioMouseEvent) return [2];
                            _a = this.mOp.onMouseUp;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onMouseUp(ioMouseEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onMousewheel = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioMouseEvent) return [2];
                            _a = this.mOp.onMousewheel;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onMousewheel(ioMouseEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onTouchStart = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioTouchEvent) return [2];
                            _a = this.mOp.onTouchStart;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchStart(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onTouchMove = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioTouchEvent) return [2];
                            _a = this.mOp.onTouchMove;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchMove(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onTouchEnd = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioTouchEvent) return [2];
                            _a = this.mOp.onTouchEnd;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchEnd(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onKeyDown = function (ioKeyEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioKeyEvent) return [2];
                            _a = this.mOp.onKeyDown;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onKeyDown(ioKeyEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onKeyUp = function (ioKeyEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp || !ioKeyEvent) return [2];
                            _a = this.mOp.onKeyUp;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onKeyUp(ioKeyEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.onViewOrientationChange = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var op, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp) return [2];
                            op = this.mOp;
                            _a = op.onViewOrientationChange;
                            if (!_a) return [3, 2];
                            return [4, op.onViewOrientationChange()];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        OperatorHC.prototype.stopInteraction = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!this.mOp) return [2];
                            _a = this.mOp.stopInteraction;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.stopInteraction()];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [2]
                    }
                }))
            }))
        };
        return OperatorHC
    }();
    exports.OperatorHC = OperatorHC;
    var OperatorBaseHC = function () {
        function OperatorBaseHC(iViewer, iClickCB, iDoubleClickCB) {
            this.Viewer = iViewer;
            this.CurrTouches = [];
            this.DragPt = undefined;
            this.CurrInputInfo = undefined;
            this.ActiveMouseButton = "none";
            this.mDoPickTimeOutHandle = NaN;
            this.mClickCB = iClickCB;
            this.mDoubleClickCB = iDoubleClickCB
        }

        OperatorBaseHC.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (!ioMouseEvent) return [2];
                    if (eDwKeyMgr_1.eDwKeyMgr.isAnyPressed(ioMouseEvent)) {
                        this.setMouse(ioMouseEvent);
                        this.ActiveMouseButton = eDwKeyMgr_1.eDwKeyMgr.getMouseButtonPressed(ioMouseEvent)
                    }
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onMouseMove = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var pos, oldInputInfo;
                return __generator(this, (function (_a) {
                    if (!ioMouseEvent) return [2];
                    pos = ioMouseEvent.getPosition();
                    if (this.CurrInputInfo) {
                        oldInputInfo = this.CurrInputInfo;
                        this.setMouse(ioMouseEvent);
                        if (!oldInputInfo.DragPt.equals(this.CurrInputInfo.DragPt)) {
                            this.DragPt = this.CurrInputInfo.DragPt
                        }
                    }
                    console.debugLog("Operator", "move screen pt = " + JSON.stringify(pos));
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (!ioMouseEvent) return [2];
                    this.onUp(ioMouseEvent);
                    delete this.DragPt;
                    delete this.CurrInputInfo;
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onTouchStart = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (!ioTouchEvent) return [2];
                    console.debugLog("TouchOp", "Start - touch ID = " + ioTouchEvent.getId());
                    this.addTouch(ioTouchEvent);
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onTouchMove = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (!ioTouchEvent) return [2];
                    console.debugLog("TouchOp", "Move - touch ID = " + ioTouchEvent.getId());
                    if (!this.hasTouchMoved(ioTouchEvent)) {
                        ioTouchEvent.setHandled(true);
                        return [2]
                    }
                    this.updateTouch(ioTouchEvent);
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onTouchEnd = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    if (!ioTouchEvent) return [2];
                    console.debugLog("TouchOp", "End - touch ID = " + ioTouchEvent.getId());
                    ioTouchEvent.setHandled(false);
                    this.removeTouchById(ioTouchEvent.getId());
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    delete this.DragPt;
                    return [2]
                }))
            }))
        };
        OperatorBaseHC.getAsMouseEvent = function (iTouchEvent, iMouseInputType, iButton) {
            if (iButton === void 0) {
                iButton = eDwTypes_10.HC.Buttons.Left
            }
            if (iTouchEvent) {
                var pos = iTouchEvent.getPosition();
                var mouseEvent = new eDwTypes_10.HC.Event.MouseInputEvent(pos.x, pos.y, eDwTypes_10.HC.Button.None, iButton, eDwTypes_10.HC.KeyModifiers.None, iMouseInputType);
                mouseEvent.setHandled(iTouchEvent.getHandled());
                return mouseEvent
            }
            return null
        };
        OperatorBaseHC.prototype.isDragging = function () {
            return !!this.DragPt
        };
        OperatorBaseHC.prototype.addTouch = function (ioTouchEvent) {
            if (!this.getTouchById(ioTouchEvent.getId())) {
                var pnt3DHC = eDwGeomUtils.screenToWorld(ioTouchEvent.getPosition(), this.Viewer.getHCView());
                if (pnt3DHC) {
                    this.CurrTouches.push({Event: ioTouchEvent, DragPt: pnt3DHC, Pos: ioTouchEvent.getPosition()})
                }
            }
        };
        OperatorBaseHC.prototype.getTouchById = function (iTouchID) {
            for (var i = 0; i < this.CurrTouches.length; ++i) {
                if (iTouchID === this.CurrTouches[i].Event.getId()) {
                    return this.CurrTouches[i]
                }
            }
            return null
        };
        OperatorBaseHC.prototype.removeTouchById = function (iTouchID) {
            var _this = this;
            var dumpTouch = function () {
                var e_35, _a;
                var touchIDs = [];
                try {
                    for (var _b = __values(_this.CurrTouches), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var touch = _c.value;
                        touchIDs.push(touch.Event.getId())
                    }
                } catch (e_35_1) {
                    e_35 = {error: e_35_1}
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                    } finally {
                        if (e_35) throw e_35.error
                    }
                }
                console.debugLog("TouchOp", "touch IDs: " + JSON.stringify(touchIDs))
            };
            console.debugLog("TouchOp", "Touch IDs before remove:");
            dumpTouch();
            for (var i = 0; i < this.CurrTouches.length; ++i) {
                if (iTouchID === this.CurrTouches[i].Event.getId()) {
                    this.CurrTouches.splice(i, 1);
                    break
                }
            }
            console.debugLog("TouchOp", "Touch IDs after remove:");
            dumpTouch()
        };
        OperatorBaseHC.prototype.hasTouchMoved = function (ioTouchEvent) {
            if (!ioTouchEvent) return false;
            var touch = this.getTouchById(ioTouchEvent.getId());
            if (!touch) return false;
            var curPos = ioTouchEvent.getPosition();
            if (curPos.x !== Math.round(curPos.x) || curPos.y !== Math.round(curPos.y)) {
                return false
            }
            var origPos = touch.Event.getPosition();
            var epsX = 1, epsY = 1;
            var delta = eDwTypes_10.HC.Point2.subtract(curPos, origPos);
            return Math.abs(delta.x) > epsX && Math.abs(delta.y) > epsY
        };
        OperatorBaseHC.prototype.updateTouch = function (ioTouchEvent) {
            var touch = this.getTouchById(ioTouchEvent.getId());
            if (touch) {
                var inputVals = this.getInputValues(ioTouchEvent);
                if (inputVals) $.extend(touch, inputVals)
            }
        };
        OperatorBaseHC.prototype.setMouse = function (ioMouseEvent) {
            var inputValues = this.getInputValues(ioMouseEvent);
            if (inputValues) {
                this.CurrInputInfo = $.extend({Event: ioMouseEvent}, inputValues)
            }
        };
        OperatorBaseHC.prototype.onClick = function (ioInputEvent) {
            return this.mClickCB ? this.mClickCB(ioInputEvent) : false
        };
        OperatorBaseHC.prototype.onDoubleClick = function (ioInputEvent) {
            return this.mDoubleClickCB ? this.mDoubleClickCB(ioInputEvent) : false
        };
        OperatorBaseHC.prototype.onUp = function (ioMouseEvent) {
            var _this = this;
            var clearPickTimeOut = function () {
                if (utils.isNaN(_this.mDoPickTimeOutHandle)) return;
                clearTimeout(_this.mDoPickTimeOutHandle);
                _this.mDoPickTimeOutHandle = NaN;
                _this.ActiveMouseButton = "none"
            };
            var processClick = function (ioMouseEvent) {
                _this.onClick(ioMouseEvent);
                clearPickTimeOut()
            };
            var stopFurtherProcessing = false;
            if (this.ActiveMouseButton === "left") {
                stopFurtherProcessing = true;
                if (utils.isNaN(this.mDoPickTimeOutHandle)) {
                    this.mDoPickTimeOutHandle = setTimeout((function () {
                        processClick(ioMouseEvent)
                    }), 500)
                } else {
                    clearPickTimeOut();
                    stopFurtherProcessing = this.onDoubleClick(ioMouseEvent)
                }
            } else if (this.ActiveMouseButton !== "none") {
                processClick(ioMouseEvent);
                stopFurtherProcessing = true
            }
            return stopFurtherProcessing
        };
        OperatorBaseHC.prototype.getInputValues = function (ioInputEvent) {
            var pos2DHC = ioInputEvent.getPosition();
            var pnt3DHC = eDwGeomUtils.screenToWorld(pos2DHC, this.Viewer.getHCView());
            return pnt3DHC ? {Pos: pos2DHC, DragPt: pnt3DHC} : null
        };
        return OperatorBaseHC
    }();
    var eDwBaseOperator = function (_super) {
        __extends(eDwBaseOperator, _super);

        function eDwBaseOperator(iViewer) {
            var _this = this;
            var clickCB = function (ioInputEvent) {
                return _this.onClick(ioInputEvent)
            };
            var doubleClickCB = function (ioInputEvent) {
                return _this.onDoubleClick(ioInputEvent)
            };
            _this = _super.call(this, new OperatorBaseHC(iViewer, clickCB, doubleClickCB)) || this;
            _this.mConvertedTouchEventID = NaN;
            return _this
        }

        eDwBaseOperator.prototype.onTouchStart = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                var _this = this;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!ioTouchEvent) return [2];
                            if (!this.implementsTouch()) return [3, 3];
                            _a = this.mOp.onTouchStart;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchStart(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [3, 5];
                        case 3:
                            if (utils.isNumber(this.mConvertedTouchEventID)) return [2];
                            this.mConvertedTouchEventID = ioTouchEvent.getId();
                            return [4, this.wrapAndCallAsMouseEvent(ioTouchEvent, eDwTypes_10.HC.MouseInputType.Down, (function (ioMouseEvent) {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, this.onMouseDown(ioMouseEvent)];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            }))];
                        case 4:
                            _b.sent();
                            _b.label = 5;
                        case 5:
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseOperator.prototype.onTouchMove = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                var _this = this;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!ioTouchEvent) return [2];
                            if (!this.implementsTouch()) return [3, 3];
                            _a = this.mOp.onTouchMove;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchMove(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [3, 5];
                        case 3:
                            if (this.mConvertedTouchEventID !== ioTouchEvent.getId()) return [2];
                            return [4, this.wrapAndCallAsMouseEvent(ioTouchEvent, eDwTypes_10.HC.MouseInputType.Move, (function (ioMouseEvent) {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, this.onMouseMove(ioMouseEvent)];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            }))];
                        case 4:
                            _b.sent();
                            _b.label = 5;
                        case 5:
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseOperator.prototype.onTouchEnd = function (ioTouchEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var _a;
                var _this = this;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!ioTouchEvent) return [2];
                            if (!this.implementsTouch()) return [3, 3];
                            _a = this.mOp && this.mOp.onTouchEnd;
                            if (!_a) return [3, 2];
                            return [4, this.mOp.onTouchEnd(ioTouchEvent)];
                        case 1:
                            _a = _b.sent();
                            _b.label = 2;
                        case 2:
                            _a;
                            return [3, 5];
                        case 3:
                            if (this.mConvertedTouchEventID !== ioTouchEvent.getId()) return [2];
                            return [4, this.wrapAndCallAsMouseEvent(ioTouchEvent, eDwTypes_10.HC.MouseInputType.Up, (function (ioMouseEvent) {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, this.onMouseUp(ioMouseEvent)];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            }), this.convertTouchToButtonHC(ioTouchEvent))];
                        case 4:
                            _b.sent();
                            this.mConvertedTouchEventID = NaN;
                            _b.label = 5;
                        case 5:
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwBaseOperator.prototype, "Viewer", {
            get: function () {
                return this.mOp.Viewer
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwBaseOperator.prototype, "CurrInputInfo", {
            get: function () {
                return this.mOp.CurrInputInfo
            }, set: function (iInputInfo) {
                this.mOp.CurrInputInfo = iInputInfo
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwBaseOperator.prototype, "CurrTouches", {
            get: function () {
                return this.mOp.CurrTouches
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwBaseOperator.prototype, "ActiveMouseButton", {
            get: function () {
                return this.mOp.ActiveMouseButton
            }, set: function (iActiveMouseButton) {
                this.mOp.ActiveMouseButton = iActiveMouseButton
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwBaseOperator.prototype, "DragPt", {
            get: function () {
                return this.mOp.DragPt
            }, set: function (iPnt3DHC) {
                this.mOp.DragPt = iPnt3DHC
            }, enumerable: false, configurable: true
        });
        eDwBaseOperator.prototype.isDragging = function () {
            return this.mOp.isDragging()
        };
        eDwBaseOperator.prototype.hasTouchMoved = function (ioTouchEvent) {
            return this.mOp.hasTouchMoved(ioTouchEvent)
        };
        eDwBaseOperator.prototype.addTouch = function (ioTouchEvent) {
            this.mOp.addTouch(ioTouchEvent)
        };
        eDwBaseOperator.prototype.getTouchById = function (iTouchID) {
            return this.mOp.getTouchById(iTouchID)
        };
        eDwBaseOperator.prototype.removeTouchById = function (iTouchID) {
            this.mOp.removeTouchById(iTouchID)
        };
        eDwBaseOperator.prototype.wrapAndCallAsMouseEvent = function (ioTouchEvent, iInputType, iMouseFunc, iButton) {
            if (iButton === void 0) {
                iButton = eDwTypes_10.HC.Buttons.Left
            }
            return __awaiter(this, void 0, void 0, (function () {
                var mouseEvent;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            mouseEvent = OperatorBaseHC.getAsMouseEvent(ioTouchEvent, iInputType, iButton);
                            if (!mouseEvent) return [3, 2];
                            console.debugLog("TouchAsMouse", "Touch handled as mouse button " + iButton);
                            this.ActiveMouseButton = eDwKeyMgr_1.eDwKeyMgr.getMouseButtonPressed(mouseEvent);
                            return [4, iMouseFunc(mouseEvent)];
                        case 1:
                            _a.sent();
                            ioTouchEvent.setHandled(mouseEvent.getHandled());
                            _a.label = 2;
                        case 2:
                            return [2]
                    }
                }))
            }))
        };
        eDwBaseOperator.prototype.onClick = function (ioInputEvent) {
            console.debugLog("Click", "In eDwBaseOperator.onClick()");
            return false
        };
        eDwBaseOperator.prototype.onDoubleClick = function (ioInputEvent) {
            console.debugLog("Click", "In eDwBaseOperator.onDoubleClick()");
            return false
        };
        eDwBaseOperator.prototype.getPickResult = function (iEvent, iViewMgr, iPickConfig) {
            if (iPickConfig === void 0) {
                iPickConfig = new eDwTypes_10.HC.PickConfig(eDwTypes_10.HC.SelectionMask.All)
            }
            return __awaiter(this, void 0, void 0, (function () {
                var selObj;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            selObj = eDwSelObj.createEmpty();
                            if (!(iEvent && iViewMgr)) return [3, 2];
                            return [4, iViewMgr.pickFromPoint(iEvent.getPosition(), iPickConfig)];
                        case 1:
                            selObj = _a.sent();
                            _a.label = 2;
                        case 2:
                            return [2, selObj]
                    }
                }))
            }))
        };
        eDwBaseOperator.prototype.implementsTouch = function () {
            return this.constructor.prototype.hasOwnProperty("onTouchStart")
        };
        eDwBaseOperator.prototype.convertTouchToButtonHC = function (ioTouchEvent) {
            var buttonHC = eDwTypes_10.HC.Buttons.None;
            if (ioTouchEvent) {
                buttonHC = eDwTypes_10.HC.Buttons.Left;
                if (!this.hasTouchMoved(ioTouchEvent)) {
                    var touchInfo = this.getTouchById(ioTouchEvent.getId());
                    var startTime = touchInfo ? touchInfo.Event.getDate().getTime() : (new Date).getTime();
                    if ((new Date).getTime() - startTime > 1e3) {
                        buttonHC = eDwTypes_10.HC.Buttons.Right
                    }
                }
            }
            return buttonHC
        };
        return eDwBaseOperator
    }(OperatorHC);
    exports.eDwBaseOperator = eDwBaseOperator
}));
define("eDwPerspectiveCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwPerspectiveCmd = function (_super) {
        __extends(eDwPerspectiveCmd, _super);

        function eDwPerspectiveCmd(iViewer, iNewState) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitiallyActive = iViewer.getPerspectiveMode();
            _this.mFinallyActive = iNewState;
            return _this
        }

        eDwPerspectiveCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.setPerspectiveMode(this.mInitiallyActive);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwPerspectiveCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.setPerspectiveMode(this.mFinallyActive);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwPerspectiveCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.setPerspectiveMode(this.mFinallyActive);
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwPerspectiveCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwPerspectiveCmd
    }(eDwSupportsHistoryCmd);
    return eDwPerspectiveCmd
}));
define("eDwResetCmd", ["require", "exports", "eDwSupportsHistoryCmd", "eDwEventMgr", "eDwEvents"], (function (require, exports, eDwSupportsHistoryCmd, eDwEventMgr, eDwEvents_3) {
    "use strict";
    var eDwResetCmd = function (_super) {
        __extends(eDwResetCmd, _super);

        function eDwResetCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mPerspective = iViewer.getPerspectiveMode();
            _this.mExplosionLevel = iViewer.getExplosionLevel();
            _this.mDrawMode = iViewer.getDrawMode();
            _this.mAmbientOcclusion = iViewer.getHCView().getAmbientOcclusionEnabled();
            _this.mCamera = iViewer.getHCView().getCamera();
            _this.resetToHome();
            return _this
        }

        eDwResetCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.resetToPrevious()];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwResetCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.resetToHome()];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwResetCmd.prototype.resetToHome = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var viewMgr;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            viewMgr = this.mViewer.ViewMgr;
                            viewMgr.reset();
                            return [4, this.mViewer.SelectionMgr.unSelectAllObjects()];
                        case 1:
                            _a.sent();
                            this.mViewer.OperatorMgr.resetToDefault();
                            this.mViewer.setPerspectiveMode(false);
                            return [4, this.mViewer.getModel().resetToDefault()];
                        case 2:
                            _a.sent();
                            this.mViewer.setExplosionLevel(0);
                            this.mViewer.resetDrawMode();
                            this.mViewer.ViewMgr.enableAmbientOcclusion(false);
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_3.ResetSceneEvent, true)];
                        case 3:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwResetCmd.prototype.resetToPrevious = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mViewer.setPerspectiveMode(this.mPerspective);
                            this.mViewer.ViewMgr.setCamera(this.mCamera);
                            this.mViewer.setExplosionLevel(this.mExplosionLevel);
                            this.mViewer.setDrawMode(this.mDrawMode);
                            this.mViewer.ViewMgr.enableAmbientOcclusion(this.mAmbientOcclusion);
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_3.ResetSceneEvent, false)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        return eDwResetCmd
    }(eDwSupportsHistoryCmd);
    return eDwResetCmd
}));
define("eDwResultError", ["require", "exports", "eDwBaseError"], (function (require, exports, eDwBaseError) {
    "use strict";
    var eDwResultError = function (_super) {
        __extends(eDwResultError, _super);

        function eDwResultError(iResult) {
            var _this = _super.call(this, "Result Error") || this;
            _this.Result = iResult;
            return _this
        }

        return eDwResultError
    }(eDwBaseError);
    return eDwResultError
}));
define("eDwSectionFlipCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSectionFlipCmd = function (_super) {
        __extends(eDwSectionFlipCmd, _super);

        function eDwSectionFlipCmd(iViewer) {
            return _super.call(this, iViewer) || this
        }

        eDwSectionFlipCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.flipSectionPlane();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSectionFlipCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.flipSectionPlane();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSectionFlipCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.XSectionMgr.flipSectionPlane();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSectionFlipCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwSectionFlipCmd
    }(eDwSupportsHistoryCmd);
    return eDwSectionFlipCmd
}));
define("eDwSectionShowCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSectionShowCmd = function (_super) {
        __extends(eDwSectionShowCmd, _super);

        function eDwSectionShowCmd(iViewer, iShow) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialShow = true;
            _this.mFinalShow = iShow;
            return _this
        }

        eDwSectionShowCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.SectionVisibility = this.mInitialShow;
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSectionShowCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.SectionVisibility = this.mFinalShow;
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSectionShowCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.XSectionMgr.SectionVisibility = this.mFinalShow;
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSectionShowCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwSectionShowCmd
    }(eDwSupportsHistoryCmd);
    return eDwSectionShowCmd
}));
define("eDwSelMgr", ["require", "exports", "eDwSelObj", "eDwSelectionOperator", "eDwEventMgr", "eDwKeyMgr", "eDwTypes", "eDwEvents", "utils", "hcutils"], (function (require, exports, eDwSelObj, eDwSelectionOperator, eDwEventMgr, eDwKeyMgr_2, eDwTypes_11, eDwEvents_4, utils, hcutils_1) {
    "use strict";
    var eDwSelMgr = function () {
        function eDwSelMgr(iViewer) {
            iViewer.SelectionMgr = this;
            this.mViewer = iViewer;
            this.mSelMgrHC = iViewer.HCViewer.selectionManager;
            this.mSelectableObjsHC = [];
            var selectOp = new eDwSelectionOperator(iViewer, this);
            var opMgr = this.mViewer.OperatorMgr;
            this.mSelectOperatorIDHC = opMgr.registerCustomOperator(selectOp, true);
            this.mSelectOverlayNotifiers = {}
        }

        eDwSelMgr.prototype.setColorForViewMode = function (iMode) {
            var _this = this;
            var cNodeSelOutlineColor = new eDwTypes_11.HC.Color(0, 255, 0);
            var cNodeElmtSelOutlineColor = new eDwTypes_11.HC.Color(255, 255, 0);
            var cBeautifulGreen = new eDwTypes_11.HC.Color(4, 200, 5);
            var nodeSelColor;
            var nodeElmtSelColor;
            switch (iMode) {
                case eDwTypes_11.HC.DrawMode.WireframeOnShaded:
                    nodeSelColor = cBeautifulGreen;
                    nodeElmtSelColor = cBeautifulGreen;
                    break;
                case eDwTypes_11.HC.DrawMode.Shaded:
                    nodeSelColor = cBeautifulGreen;
                    nodeElmtSelColor = cBeautifulGreen;
                    break;
                case eDwTypes_11.HC.DrawMode.Wireframe:
                case eDwTypes_11.HC.DrawMode.HiddenLine:
                    nodeSelColor = eDwTypes_11.HC.Color.white();
                    nodeElmtSelColor = eDwTypes_11.HC.Color.white();
                    break;
                default:
                    var msg = "Unknown draw mode: " + iMode;
                    console.debugLog("Selection", msg);
                    throw new Error(msg)
            }
            this.mSelMgrHC.setNodeSelectionColor(nodeSelColor);
            this.mSelMgrHC.setNodeSelectionOutlineColor(cNodeSelOutlineColor);
            this.mSelMgrHC.setNodeElementSelectionColor(nodeElmtSelColor);
            this.mSelMgrHC.setNodeElementSelectionOutlineColor(cNodeElmtSelOutlineColor);
            if (this.mViewer.getModel().isDrawing() && !this.mViewer.ViewerFeatureOpts.Debug) {
                this.mSelMgrHC.setNodeSelectionHighlightMode(eDwTypes_11.HC.SelectionHighlightMode.OutlineOnly);
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.mSelMgrHC.setHighlightNodeSelection(false)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }
        };
        eDwSelMgr.prototype.unregister = function () {
            this.mViewer.OperatorMgr.unregisterCustomOperatorByID(this.mSelectOperatorIDHC);
            this.mViewer.SelectionMgr = null
        };
        eDwSelMgr.prototype.addSelectOverlayNotifier = function (iTypeIndex, iNotifier) {
            if (!this.mSelectOverlayNotifiers[iTypeIndex]) {
                this.mSelectOverlayNotifiers[iTypeIndex] = []
            }
            this.mSelectOverlayNotifiers[iTypeIndex].push(iNotifier)
        };
        eDwSelMgr.prototype.removeSelectOverlayNotifier = function (iTypeIndex, iNotifier) {
            var typeNotifiers = this.mSelectOverlayNotifiers[iTypeIndex];
            var pos = typeNotifiers.indexOf(iNotifier);
            if (pos > -1) {
                typeNotifiers.splice(pos, 1)
            }
            return false
        };
        eDwSelMgr.prototype.getSelectedNodeIDIndex = function (iHCNodeID) {
            return this.getSelectableIDsHC().indexOf(iHCNodeID)
        };
        eDwSelMgr.prototype.onSelection = function (iSelectionEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var keyMgr, ctrlKeyDown, shiftKeyDown, hierNodeSelObj, selObjIDHC, existingIdx, selectedAlready,
                    selObjExists, numOfSelObjsAtStart;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            keyMgr = eDwKeyMgr_2.eDwKeyMgr.get();
                            ctrlKeyDown = keyMgr.isDown("Control");
                            shiftKeyDown = keyMgr.isDown("Shift");
                            hierNodeSelObj = this.createHierNodeSelObj(eDwSelObj.extendHCSelObj(iSelectionEvent.getSelection()));
                            selObjIDHC = hierNodeSelObj.getIDHC();
                            existingIdx = this.getSelectedNodeIDIndex(selObjIDHC);
                            selectedAlready = existingIdx > -1;
                            l_debugDumpSelection(hierNodeSelObj.getIDHC(), hierNodeSelObj.getSelectionType());
                            selObjExists = utils.isNumber(selObjIDHC);
                            numOfSelObjsAtStart = this.mSelectableObjsHC.length;
                            if (!(numOfSelObjsAtStart && !ctrlKeyDown && !shiftKeyDown)) return [3, 2];
                            return [4, this.unSelectAllObjects(false)];
                        case 1:
                            _a.sent();
                            selectedAlready = false;
                            return [3, 5];
                        case 2:
                            if (!(ctrlKeyDown && !shiftKeyDown && selectedAlready && selObjExists)) return [3, 4];
                            this.mSelectableObjsHC.splice(existingIdx, 1);
                            return [4, this.unSelectObjs([hierNodeSelObj], this.mViewer.getModel().isDrawing())];
                        case 3:
                            _a.sent();
                            return [2];
                        case 4:
                            if (!ctrlKeyDown && shiftKeyDown && selectedAlready && selObjExists) {
                                return [2]
                            }
                            _a.label = 5;
                        case 5:
                            if (!selObjExists) return [3, 7];
                            if (!selectedAlready) this.mSelectableObjsHC.push(hierNodeSelObj);
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_4.SelectEvent, this.mViewer, [hierNodeSelObj])];
                        case 6:
                            _a.sent();
                            return [3, 9];
                        case 7:
                            if (!!numOfSelObjsAtStart) return [3, 9];
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_4.LeftClickEvent, this.mViewer)];
                        case 8:
                            _a.sent();
                            _a.label = 9;
                        case 9:
                            return [2]
                    }
                }))
            }))
        };
        eDwSelMgr.prototype.selectByID = function (iID) {
            return utils.isNumber(iID) ? this.executeSelection(iID) : false
        };
        eDwSelMgr.prototype.select = function (iCoords, iPickConfig) {
            return __awaiter(this, void 0, void 0, (function () {
                var pickCfg, selObj, hierNodeSelObj;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            pickCfg = iPickConfig ? iPickConfig : new eDwTypes_11.HC.PickConfig(eDwTypes_11.HC.SelectionMask.Face);
                            return [4, this.mViewer.ViewMgr.pickFromPoint(iCoords, pickCfg)];
                        case 1:
                            selObj = _a.sent();
                            if (this.isSelectionHandled(selObj)) {
                                return [2, false]
                            }
                            hierNodeSelObj = this.createHierNodeSelObj(selObj);
                            if (utils.isNumber(hierNodeSelObj.getIDHC())) {
                                return [2, this.executeSelection(hierNodeSelObj)]
                            }
                            this.mSelMgrHC.set(null);
                            return [2, false]
                    }
                }))
            }))
        };
        eDwSelMgr.prototype.isSelected = function (iHCNodeID) {
            return this.getSelectableIDsHC().indexOf(iHCNodeID) < 0 ? false : true
        };
        eDwSelMgr.prototype.append = function (iSelObj) {
            this.mSelMgrHC.add(iSelObj)
        };
        eDwSelMgr.prototype.unSelectAllObjects = function (iClearHCSelList) {
            if (iClearHCSelList === void 0) {
                iClearHCSelList = true
            }
            return __awaiter(this, void 0, void 0, (function () {
                var unselectedHCObjs;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            unselectedHCObjs = this.mSelectableObjsHC;
                            this.mSelectableObjsHC = [];
                            return [4, this.unSelectObjs(unselectedHCObjs, this.mViewer.getModel().isDrawing())];
                        case 1:
                            _a.sent();
                            if (unselectedHCObjs.length > 0 && iClearHCSelList) {
                                this.mSelMgrHC.selectNode(null)
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwSelMgr.prototype.setViewToSelectedFace = function () {
            var e_36, _a;
            var camera = null;
            var selObjs = this.mSelMgrHC.getResults();
            try {
                for (var selObjs_1 = __values(selObjs), selObjs_1_1 = selObjs_1.next(); !selObjs_1_1.done; selObjs_1_1 = selObjs_1.next()) {
                    var selObj = selObjs_1_1.value;
                    var faceObj = selObj.getFaceEntity();
                    if (faceObj) {
                        camera = this.mViewer.ViewMgr.setViewOrientationToDirection(faceObj.getNormal());
                        break
                    }
                }
            } catch (e_36_1) {
                e_36 = {error: e_36_1}
            } finally {
                try {
                    if (selObjs_1_1 && !selObjs_1_1.done && (_a = selObjs_1.return)) _a.call(selObjs_1)
                } finally {
                    if (e_36) throw e_36.error
                }
            }
            return camera
        };
        eDwSelMgr.prototype.getLastSelIDHC = function () {
            var selIDsHC = this.getSelectableIDsHC();
            if (selIDsHC.length > 0) {
                return selIDsHC[selIDsHC.length - 1]
            }
            return NaN
        };
        eDwSelMgr.prototype.getLastSelHierarchyNode = function () {
            var modelView = this.mViewer.getModel().getActiveModelView();
            return modelView.Nodes[this.getLastSelIDHC()]
        };
        eDwSelMgr.prototype.getSelectableIDsHC = function () {
            var e_37, _a;
            var selIDsHC = [];
            try {
                for (var _b = __values(this.mSelectableObjsHC), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var selObjHC = _c.value;
                    var selIDHC = selObjHC.getNodeId();
                    if (utils.isNumber(selIDHC)) selIDsHC.push(selIDHC)
                }
            } catch (e_37_1) {
                e_37 = {error: e_37_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_37) throw e_37.error
                }
            }
            return selIDsHC
        };
        eDwSelMgr.prototype.getSelHierarchyNodes = function () {

            console.log(`plm test getSelHierarchyNodes`)

            var e_38, _a;
            var selHierNodes = [];
            var modelView = this.mViewer.getModel().getActiveModelView();
            var selIDsHC = this.getSelectableIDsHC();
            try {
                for (var selIDsHC_1 = __values(selIDsHC), selIDsHC_1_1 = selIDsHC_1.next(); !selIDsHC_1_1.done; selIDsHC_1_1 = selIDsHC_1.next()) {
                    var selNodeID = selIDsHC_1_1.value;
                    selHierNodes.push(modelView.Nodes[selNodeID])
                }
            } catch (e_38_1) {
                e_38 = {error: e_38_1}
            } finally {
                try {
                    if (selIDsHC_1_1 && !selIDsHC_1_1.done && (_a = selIDsHC_1.return)) _a.call(selIDsHC_1)
                } finally {
                    if (e_38) throw e_38.error
                }
            }
            return selHierNodes
        };
        eDwSelMgr.prototype.isIDSelectable = function (iNodeIDHC) {
            var modelView = this.mViewer.getModel().getActiveModelView();
            var hierNode = modelView ? modelView.Nodes[iNodeIDHC] : null;
            return hierNode ? hierNode.isSelectable() : false
        };
        eDwSelMgr.prototype.setHighlightSelection = function (iType, iEnable) {
            var _this = this;
            var highlighted = false;
            var selMgr = this.mSelMgrHC;
            if (iType === "NODE") {
                highlighted = selMgr.getHighlightNodeSelection();
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, selMgr.setHighlightNodeSelection(iEnable)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            } else if (iType === "FACE") {
                highlighted = selMgr.getHighlightFaceElementSelection();
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, selMgr.setHighlightFaceElementSelection(iEnable)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            } else if (iType === "EDGE") {
                highlighted = selMgr.getHighlightLineElementSelection();
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, selMgr.setHighlightLineElementSelection(iEnable)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            } else if (iType === "VERTEX") {
                highlighted = selMgr.getHighlightPointElementSelection();
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, selMgr.setHighlightPointElementSelection(iEnable)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            } else {
                console.debugLog("Selection", "Unknown selection type: " + iType)
            }
            return highlighted
        };
        eDwSelMgr.prototype.setNodeSelectionHighlightMode = function (iSelHighlightMode) {
            var mapping = {};
            var revMapping = {};
            this.initMappings(mapping, revMapping);
            this.mSelMgrHC.setNodeSelectionHighlightMode(mapping[iSelHighlightMode]);
            return revMapping[this.mSelMgrHC.getNodeSelectionHighlightMode()]
        };
        eDwSelMgr.prototype.setNodeSelectionColor = function (iColor) {
            var oldColor = hcutils_1.coerceFromHCColor(this.mSelMgrHC.getNodeSelectionColor());
            this.mSelMgrHC.setNodeSelectionColor(hcutils_1.coerceToHCColor(iColor));
            return oldColor
        };
        eDwSelMgr.prototype.setNodeSelectionOutlineColor = function (iColor) {
            var oldColor = hcutils_1.coerceFromHCColor(this.mSelMgrHC.getNodeSelectionOutlineColor());
            this.mSelMgrHC.setNodeSelectionOutlineColor(hcutils_1.coerceToHCColor(iColor));
            return oldColor
        };
        eDwSelMgr.prototype.setElementSelectionHighlightMode = function (iSelHighlightMode) {
            var mapping = {};
            var revMapping = {};
            this.initMappings(mapping, revMapping);
            this.mSelMgrHC.setNodeElementSelectionHighlightMode(mapping[iSelHighlightMode]);
            return revMapping[this.mSelMgrHC.getNodeElementSelectionHighlightMode()]
        };
        eDwSelMgr.prototype.setElementSelectionColor = function (iColor) {
            var oldColor = hcutils_1.coerceFromHCColor(this.mSelMgrHC.getNodeElementSelectionColor());
            this.mSelMgrHC.setNodeElementSelectionColor(hcutils_1.coerceToHCColor(iColor));
            return oldColor
        };
        eDwSelMgr.prototype.setElementSelectionOutlineColor = function (iColor) {
            var oldColor = hcutils_1.coerceFromHCColor(this.mSelMgrHC.getNodeElementSelectionOutlineColor());
            this.mSelMgrHC.setNodeElementSelectionOutlineColor(hcutils_1.coerceToHCColor(iColor));
            return oldColor
        };
        eDwSelMgr.getSelObjFromPos = function (iPos, iPickConfig, iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var selObj, subEntityInfo;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, iViewer.getHCView().pickFromPoint(iPos, iPickConfig)];
                        case 1:
                            selObj = _a.sent();
                            subEntityInfo = eDwSelObj.getSubEntityInfo(selObj);
                            return [2, subEntityInfo.SubEntity ? selObj : null]
                    }
                }))
            }))
        };
        eDwSelMgr.prototype.initMappings = function (ioMapping, ioRevMapping) {
            var HCM = eDwTypes_11.HC.SelectionHighlightMode;
            ioRevMapping[ioMapping["Highlight"] = HCM.HighlightOnly] = "Highlight";
            ioMapping["HighlightAndOutline"] = HCM.HighlightAndOutline;
            ioRevMapping[HCM.HighlightAndOutline] = "HighlightAndOutline";
            ioRevMapping[ioMapping["Outline"] = HCM.OutlineOnly] = "Outline"
        };
        eDwSelMgr.prototype.createHierNodeSelObj = function (iSelObj) {
            var hierNode = this.mViewer.getModel().getHierarchyNode(iSelObj.getIDHC());
            var newSelObj = eDwSelObj.createEmpty();
            if (hierNode) {
                newSelObj = eDwSelObj.extendHCSelObj(eDwTypes_11.HC.Selection.SelectionItem.create(hierNode.HOOPSID, iSelObj.getIncludeId(), iSelObj.getFaceEntity(), iSelObj.getLineEntity(), iSelObj.getPointEntity()))
            }
            return newSelObj
        };
        eDwSelMgr.prototype.isSelectionHandled = function (iSelObjHC) {
            var e_39, _a;
            var index = iSelObjHC.overlayIndex();
            if (!utils.isNumber(index)) return false;
            var notifiers = this.mSelectOverlayNotifiers[index];
            if (!notifiers) return false;
            try {
                for (var notifiers_1 = __values(notifiers), notifiers_1_1 = notifiers_1.next(); !notifiers_1_1.done; notifiers_1_1 = notifiers_1.next()) {
                    var notifier = notifiers_1_1.value;
                    if (notifier.onSelect(iSelObjHC)) return true
                }
            } catch (e_39_1) {
                e_39 = {error: e_39_1}
            } finally {
                try {
                    if (notifiers_1_1 && !notifiers_1_1.done && (_a = notifiers_1.return)) _a.call(notifiers_1)
                } finally {
                    if (e_39) throw e_39.error
                }
            }
            return false
        };
        eDwSelMgr.prototype.unSelectObjs = function (iSelObjsHC, iIs2D) {
            return __awaiter(this, void 0, void 0, (function () {
                var modelView, iSelObjsHC_1, iSelObjsHC_1_1, selObjHC, selObj, hierNode, e_40_1;
                var e_40, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_4.UnselectEvent, this.mViewer, iSelObjsHC)];
                        case 1:
                            _b.sent();
                            if (!iIs2D) return [3, 9];
                            modelView = this.mViewer.getModel().getActiveModelView();
                            _b.label = 2;
                        case 2:
                            _b.trys.push([2, 7, 8, 9]);
                            iSelObjsHC_1 = __values(iSelObjsHC), iSelObjsHC_1_1 = iSelObjsHC_1.next();
                            _b.label = 3;
                        case 3:
                            if (!!iSelObjsHC_1_1.done) return [3, 6];
                            selObjHC = iSelObjsHC_1_1.value;
                            selObj = eDwSelObj.extendHCSelObj(selObjHC);
                            hierNode = modelView.Nodes[selObj.getIDHC()];
                            if (!hierNode) return [3, 5];
                            return [4, hierNode.showBoundingBox(this.mViewer, "off")];
                        case 4:
                            _b.sent();
                            _b.label = 5;
                        case 5:
                            iSelObjsHC_1_1 = iSelObjsHC_1.next();
                            return [3, 3];
                        case 6:
                            return [3, 9];
                        case 7:
                            e_40_1 = _b.sent();
                            e_40 = {error: e_40_1};
                            return [3, 9];
                        case 8:
                            try {
                                if (iSelObjsHC_1_1 && !iSelObjsHC_1_1.done && (_a = iSelObjsHC_1.return)) _a.call(iSelObjsHC_1)
                            } finally {
                                if (e_40) throw e_40.error
                            }
                            return [7];
                        case 9:
                            return [2]
                    }
                }))
            }))
        };
        eDwSelMgr.prototype.addUniqueToSelectableObjsHC = function (iSelObjHC) {
            var e_41, _a;
            try {
                for (var _b = __values(this.mSelectableObjsHC), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var selObjHC = _c.value;
                    if (selObjHC.equals(iSelObjHC)) return
                }
            } catch (e_41_1) {
                e_41 = {error: e_41_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_41) throw e_41.error
                }
            }
            this.mSelectableObjsHC.push(iSelObjHC)
        };
        eDwSelMgr.prototype.executeSelection = function (iSelection) {
            var nodeIDHC;
            var selObjHC;
            if (utils.isNumber(iSelection)) {
                nodeIDHC = iSelection
            } else {
                nodeIDHC = iSelection.getIDHC();
                if (!utils.isNumber(nodeIDHC)) return false;
                selObjHC = iSelection
            }

            function selectNodeHC(iSelMgr, iSelModeHC) {
                var _this = this;
                var viewer = iSelMgr.mViewer;
                var model = viewer.getModel();
                var modelView = model.getActiveModelView();
                var hierNode = modelView.Nodes[nodeIDHC];
                if (hierNode) {
                    if (model.isDrawing()) {
                        var shown = false;
                        var index = iSelMgr.getSelectedNodeIDIndex(nodeIDHC);
                        var setState = iSelModeHC === eDwTypes_11.HC.SelectionMode.Set;
                        if (setState) {
                            if (index > -1) {
                                iSelMgr.mSelectableObjsHC.splice(index, 1)
                            }
                            var unselObjsHC_1 = iSelMgr.mSelectableObjsHC;
                            iSelMgr.mSelectableObjsHC = [];
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, iSelMgr.unSelectObjs(unselObjsHC_1, true)];
                                            case 1:
                                                _a.sent();
                                                return [4, hierNode.showBoundingBox(viewer, "on")];
                                            case 2:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })();
                            shown = true
                        } else {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, hierNode.showBoundingBox(viewer, "toggle")];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })();
                            shown = index > -1 ? false : true
                        }
                        if (shown) {
                            var selObjDupHC_1 = eDwTypes_11.HC.Selection.SelectionItem.create(hierNode.HOOPSID);
                            iSelMgr.addUniqueToSelectableObjsHC(selObjDupHC_1);
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_4.SelectEvent, viewer, [selObjDupHC_1])];
                                            case 1:
                                                _a.sent();
                                                l_debugDumpSelection(selObjDupHC_1.getNodeId(), selObjDupHC_1.getSelectionType());
                                                return [2]
                                        }
                                    }))
                                }))
                            })()
                        }
                    } else {
                        var selMgrHC = iSelMgr.mSelMgrHC;
                        if (!selObjHC) {
                            selMgrHC.selectNode(nodeIDHC, iSelModeHC);
                            var selObj = eDwSelObj.extendHCSelObj(selMgrHC.getLast());
                            if (selObj.getIDHC() === nodeIDHC) {
                                iSelMgr.addUniqueToSelectableObjsHC(selObj)
                            }
                        } else {
                            if (iSelModeHC === eDwTypes_11.HC.SelectionMode.Add) {
                                selMgrHC.add(selObjHC)
                            } else if (iSelModeHC === eDwTypes_11.HC.SelectionMode.Set) {
                                selMgrHC.set(selObjHC)
                            } else {
                                var wasSelected = selMgrHC.isSelected(selObjHC);
                                selMgrHC.toggle(selObjHC);
                                if (wasSelected) {
                                    var index = iSelMgr.mSelectableObjsHC.indexOf(selObjHC);
                                    if (index > -1) {
                                        iSelMgr.mSelectableObjsHC.splice(index, 1)
                                    }
                                }
                            }
                            if (selMgrHC.isSelected(selObjHC)) {
                                iSelMgr.addUniqueToSelectableObjsHC(selObjHC)
                            }
                        }
                    }
                    return eDwTypes_11.HC.SelectionType.Part
                }
                return eDwTypes_11.HC.SelectionType.None
            }

            var ret = false;
            try {
                var selType = eDwTypes_11.HC.SelectionType.None;
                var keyMgr = eDwKeyMgr_2.eDwKeyMgr.get();
                if (!keyMgr.isDown("Control") && !keyMgr.isDown("Shift")) {
                    selType = selectNodeHC(this, eDwTypes_11.HC.SelectionMode.Set);
                    ret = true
                } else {
                    var existingIdx = this.getSelectedNodeIDIndex(nodeIDHC);
                    if (existingIdx > -1) {
                        if (keyMgr.isDown("Control")) {
                            this.mSelMgrHC.remove(this.mSelectableObjsHC[existingIdx]);
                            this.mSelectableObjsHC.splice(existingIdx, 1)
                        } else if (keyMgr.isDown("Shift")) {
                            ret = true
                        }
                    } else {
                        selType = selectNodeHC(this, eDwTypes_11.HC.SelectionMode.Add);
                        if (this.getSelectedNodeIDIndex(nodeIDHC) > -1) {
                            ret = true
                        }
                    }
                }
                if (selType !== eDwTypes_11.HC.SelectionType.None) {
                    l_debugDumpSelection(nodeIDHC, selType)
                }
            } catch (iErr) {
                console.log("eDwSelMgr.selectByID failed")
            }
            return ret
        };
        Object.defineProperty(eDwSelMgr.prototype, "Length", {
            get: function () {
                return this.mSelectableObjsHC.length
            }, enumerable: false, configurable: true
        });
        return eDwSelMgr
    }();

    function l_debugDumpSelection(iID, iSelType) {
        console.debugLog("Selection", "Selected Obj ID: " + iID + " - type: " + eDwTypes_11.HC.SelectionType[iSelType])
    }

    return eDwSelMgr
}));
define("eDwSelObj", ["require", "exports", "eDwTypes", "eDwGeomUtils", "hcutils", "utils"], (function (require, exports, eDwTypes_12, eDwGeomUtils_1, hcutils_2, utils) {
    "use strict";
    var eDwSelObj = function () {
        function eDwSelObj(iSelObjHC, iToLocalTransformHC) {
            if (iToLocalTransformHC === void 0) {
                iToLocalTransformHC = null
            }
            utils.populateMixinObjectFromClasses(this, [eDwTypes_12.HC.Selection.SelectionItem]);
            $.extend(true, this, iSelObjHC);
            this.setPointInLocalSpace(iSelObjHC.getPosition(), iToLocalTransformHC)
        }

        eDwSelObj.prototype.getIDHC = function () {
            var nodeIDHC = this.getNodeId();
            return utils.isNumber(nodeIDHC) ? nodeIDHC : NaN
        };
        eDwSelObj.prototype.getLocalPoint = function () {
            return this.mLocalPnt
        };
        eDwSelObj.prototype.getWorldPoint = function () {
            return this.getPosition()
        };
        eDwSelObj.prototype.getAsLocalPoint = function (iWorldPtHC) {
            return this.mToLocalTransformHC && iWorldPtHC ? this.mToLocalTransformHC.transform(iWorldPtHC) : iWorldPtHC
        };
        eDwSelObj.prototype.getAsWorldPoint = function (iLocalPtHC) {
            var toWorldTransformHC = this.mToLocalTransformHC ? eDwTypes_12.HC.Matrix.inverse(this.mToLocalTransformHC) : null;
            return toWorldTransformHC && iLocalPtHC ? toWorldTransformHC.transform(iLocalPtHC) : iLocalPtHC
        };
        eDwSelObj.prototype.getLocalVector = function () {
            var _this = this;
            return this.getVectorInfo((function (iPntWCHC) {
                return _this.getAsLocalPoint(iPntWCHC)
            })).Vec
        };
        eDwSelObj.prototype.getWorldVector = function () {
            return this.getVectorInfo().Vec
        };
        eDwSelObj.prototype.getAsLocalVector = function (iWorldVecHC) {
            var normalMatrix = this.mToLocalTransformHC ? this.mToLocalTransformHC.normalMatrix() : null;
            return iWorldVecHC && normalMatrix ? normalMatrix.transform(iWorldVecHC) : null
        };
        eDwSelObj.prototype.getAsWorldVector = function (iLocalVecHC) {
            var toWorldTransformHC = this.mToLocalTransformHC ? eDwTypes_12.HC.Matrix.inverse(this.mToLocalTransformHC) : null;
            var normalMatrix = toWorldTransformHC ? toWorldTransformHC.normalMatrix() : null;
            return iLocalVecHC && normalMatrix ? normalMatrix.transform(iLocalVecHC) : null
        };
        eDwSelObj.prototype.getToLocalTransform = function () {
            return this.mToLocalTransformHC
        };
        eDwSelObj.prototype.findAngle = function (iSelObj) {
            var e_42, _a;
            var _this = this;
            var selObj1Type = eDwSelObj.getSubEntityInfo(this).SubEntityTypeName;
            var selObj2Type = eDwSelObj.getSubEntityInfo(iSelObj).SubEntityTypeName;
            if (!selObj1Type || !selObj2Type || selObj2Type === "Point" || selObj1Type === "Point") {
                return NaN
            }
            var toLocalFunc;
            if (this.getToLocalTransform().equals(iSelObj.getToLocalTransform())) {
                toLocalFunc = function (iPntWCHC) {
                    return _this.getAsLocalPoint(iPntWCHC)
                }
            }
            var selObjVecInfo1 = this.getVectorInfo(toLocalFunc);
            var selObjVecInfo2 = iSelObj.getVectorInfo(toLocalFunc);
            if (selObj1Type !== selObj2Type) {
                var curveVecInfo = selObjVecInfo1;
                var faceVecInfo = selObjVecInfo2;
                if (selObj1Type === "Face") {
                    curveVecInfo = selObjVecInfo2;
                    faceVecInfo = selObjVecInfo1
                }
                var surfPlane = eDwTypes_12.HC.Plane.createFromPointAndNormal(faceVecInfo.Pts[0], faceVecInfo.Vec);
                faceVecInfo.Pts[0] = eDwGeomUtils_1.dropPointOnPlane(curveVecInfo.Pts[0], surfPlane);
                faceVecInfo.Pts[1] = eDwGeomUtils_1.dropPointOnPlane(curveVecInfo.Pts[1], surfPlane);
                faceVecInfo.Vec = eDwTypes_12.HC.Point3.subtract(faceVecInfo.Pts[0], faceVecInfo.Pts[1])
            }
            if (!selObjVecInfo1.Vec || !selObjVecInfo1.Pts || !selObjVecInfo2.Vec || !selObjVecInfo2.Pts) return NaN;
            var normal3DHC = eDwTypes_12.HC.Point3.cross(selObjVecInfo1.Vec, selObjVecInfo2.Vec);
            if (!eDwGeomUtils_1.isValidHCPoint(normal3DHC) || normal3DHC.length() < eDwGeomUtils_1.cAbsLengthTol) {
                return eDwTypes_12.HC.Point3.dot(selObjVecInfo1.Vec, selObjVecInfo1.Vec) * 180
            }
            var planeNormal = normal3DHC.copy();
            planeNormal.normalize();
            var pts3DHC = [];
            try {
                for (var _b = __values(__spreadArray(__spreadArray([], __read(selObjVecInfo1.Pts)), __read(selObjVecInfo2.Pts))), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var pnt3DHC = _c.value;
                    pts3DHC.push(eDwGeomUtils_1.dropPointOnPlane(pnt3DHC, eDwTypes_12.HC.Plane.createFromPointAndNormal(selObjVecInfo1.Pts[0], planeNormal)))
                }
            } catch (e_42_1) {
                e_42 = {error: e_42_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_42) throw e_42.error
                }
            }
            var betweenVec3DHC = eDwTypes_12.HC.Point3.subtract(pts3DHC[2], pts3DHC[0]);
            var crossVec3DHC = eDwTypes_12.HC.Point3.cross(betweenVec3DHC, selObjVecInfo2.Vec);
            var normalLen = normal3DHC.length();
            var t1 = eDwTypes_12.HC.Point3.dot(crossVec3DHC, normal3DHC) / (normalLen * normalLen);
            var intPt3DHC = eDwTypes_12.HC.Point3.add(pts3DHC[0], selObjVecInfo1.Vec.scale(t1));
            var newVec13DHC = eDwTypes_12.HC.Point3.subtract(pts3DHC[0], intPt3DHC);
            var newVec23DHC = eDwTypes_12.HC.Point3.subtract(pts3DHC[1], intPt3DHC);
            var vec13DHC = newVec23DHC;
            if (newVec13DHC.length() > newVec23DHC.length()) vec13DHC = newVec13DHC;
            var newVec33DHC = eDwTypes_12.HC.Point3.subtract(pts3DHC[2], intPt3DHC);
            var newVec43DHC = eDwTypes_12.HC.Point3.subtract(pts3DHC[3], intPt3DHC);
            var vec23DHC = newVec43DHC;
            if (newVec33DHC.length() > newVec43DHC.length()) vec23DHC = newVec33DHC;
            vec13DHC.normalize();
            vec23DHC.normalize();
            return Math.acos(eDwTypes_12.HC.Point3.dot(vec13DHC, vec23DHC)) * 180 / Math.PI
        };
        eDwSelObj.extendHCSelObj = function (ioSelObj, iToLocalTransformHC) {
            if (iToLocalTransformHC === void 0) {
                iToLocalTransformHC = null
            }
            utils.populateMixinObjectFromClasses(ioSelObj, [eDwSelObj]);
            if (utils.isInstanceOf(ioSelObj, eDwSelObj)) {
                var pos2DHC = ioSelObj.getPosition();
                if (pos2DHC) {
                    ioSelObj.setPointInLocalSpace(pos2DHC, iToLocalTransformHC)
                }
                return ioSelObj
            }
            throw new TypeError("eDwSelObj is undefined")
        };
        eDwSelObj.createEmpty = function () {
            return new eDwSelObj(eDwTypes_12.HC.Selection.SelectionItem.create())
        };
        eDwSelObj.getLocalTransform = function (ioSelObjHC, iModel) {
            var toLocalTransformHC = new eDwTypes_12.HC.Matrix;
            var subEntityInfo = eDwSelObj.getSubEntityInfo(ioSelObjHC);
            if (subEntityInfo.SubEntity) {
                var selObj = eDwSelObj.extendHCSelObj(ioSelObjHC);
                var selObjIDHC = selObj.getIDHC();
                var selHierNode = iModel.getHierarchyNode(selObjIDHC);
                if (selHierNode && selHierNode.Category === "view") {
                    var modelHC = iModel.getHCModel();
                    var parentNodeHC = modelHC.getNodeParent(selHierNode.HOOPSID);
                    var parentNetMatrixHC = modelHC.getNodeNetMatrix(parentNodeHC);
                    var selNetMatrixHC = modelHC.getNodeNetMatrix(selObjIDHC);
                    var invParentNetMatrix = parentNetMatrixHC.inverseAndDeterminant()[0] || new eDwTypes_12.HC.Matrix;
                    var matrixHC = eDwTypes_12.HC.Matrix.multiply(selNetMatrixHC, invParentNetMatrix);
                    toLocalTransformHC = eDwTypes_12.HC.Matrix.inverse(matrixHC) || new eDwTypes_12.HC.Matrix
                }
            }
            return toLocalTransformHC
        };
        eDwSelObj.getMinDistInfo = function (iSelPropsHC, iSelObjs, iModel) {
            return __awaiter(this, void 0, void 0, (function () {
                function getMinDistPtToFace(iPointHC, iSelObj, iFaceSelObj, iModelHC) {
                    return __awaiter(this, void 0, void 0, (function () {
                        var lineRay;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    lineRay = new eDwTypes_12.HC.Ray(iPointHC, new eDwTypes_12.HC.Point3(0, 0, 0));
                                    return [4, getMinDistLineToFace(lineRay, iSelObj, iFaceSelObj, iModelHC)];
                                case 1:
                                    return [2, _a.sent()]
                            }
                        }))
                    }))
                }

                function getMinDistLineToFace(iRayHC, iSelObj, iFaceSelObj, iModelHC) {
                    return __awaiter(this, void 0, void 0, (function () {
                        var distItem;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, iModelHC.computeMinimumFaceLineDistance(iFaceSelObj.getNodeId(), iFaceSelObj.getFaceEntity().getCadFaceIndex(), iRayHC)];
                                case 1:
                                    distItem = _a.sent();
                                    return [2, adjustDistance(iSelObj, iFaceSelObj, distItem)]
                            }
                        }))
                    }))
                }

                function adjustDistance(iSelObj, iFaceSelObj, ioDistItem) {
                    var toLocalTransformHC = iSelObj.getToLocalTransform();
                    var toLocalTransformForFaceHC = iFaceSelObj.getToLocalTransform();
                    if (toLocalTransformHC && toLocalTransformForFaceHC && toLocalTransformHC.equals(toLocalTransformForFaceHC)) {
                        ioDistItem.distance *= toLocalTransformHC.upperLeft3x3Determinant()
                    }
                    return ioDistItem
                }

                var selEntInfoHC0, selEntInfoHC1, modelHC, vertSelObj, faceSelObj, faceProp, pos2DHC, faceSelObj0,
                    faceSelObj1, faceProp0, faceProp1, distItem, edgeSelObj, edgeProp, faceSelObj, faceProp, pntsWCHC,
                    lineHC;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (2 !== iSelObjs.length) return [2, null];
                            selEntInfoHC0 = eDwSelObj.getSubEntityInfo(iSelObjs[0]);
                            selEntInfoHC1 = eDwSelObj.getSubEntityInfo(iSelObjs[1]);
                            modelHC = iModel.getHCModel();
                            if (!(selEntInfoHC0.SubEntityTypeName === "Point" && selEntInfoHC1.SubEntityTypeName === "Face" || selEntInfoHC1.SubEntityTypeName === "Point" && selEntInfoHC0.SubEntityTypeName === "Face")) return [3, 3];
                            vertSelObj = iSelObjs[0];
                            faceSelObj = iSelObjs[1];
                            faceProp = iSelPropsHC[1];
                            if (selEntInfoHC1.SubEntityTypeName === "Point" && selEntInfoHC0.SubEntityTypeName === "Face") {
                                vertSelObj = iSelObjs[1];
                                faceSelObj = iSelObjs[0];
                                faceProp = iSelPropsHC[0]
                            }
                            pos2DHC = vertSelObj.getPosition();
                            if (!pos2DHC) {
                                throw new TypeError("vertSelObj position is undefined")
                            }
                            if (!(faceProp instanceof eDwTypes_12.HC.SubentityProperties.PlaneElement)) return [3, 2];
                            return [4, getMinDistPtToFace(vertSelObj.getPosition(), vertSelObj, faceSelObj, modelHC)];
                        case 1:
                            return [2, _a.sent()];
                        case 2:
                            return [3, 10];
                        case 3:
                            if (!(selEntInfoHC0.SubEntityTypeName === "Face" && selEntInfoHC1.SubEntityTypeName === "Face")) return [3, 6];
                            faceSelObj0 = iSelObjs[0], faceSelObj1 = iSelObjs[1];
                            faceProp0 = iSelPropsHC[0], faceProp1 = iSelPropsHC[1];
                            if (!(faceProp0 instanceof eDwTypes_12.HC.SubentityProperties.PlaneElement && faceProp1 instanceof eDwTypes_12.HC.SubentityProperties.PlaneElement)) return [3, 5];
                            return [4, modelHC.computeMinimumFaceFaceDistance(faceSelObj0.getNodeId(), faceSelObj0.getFaceEntity().getCadFaceIndex(), faceSelObj1.getNodeId(), faceSelObj1.getFaceEntity().getCadFaceIndex())];
                        case 4:
                            distItem = _a.sent();
                            return [2, adjustDistance(faceSelObj0, faceSelObj1, distItem)];
                        case 5:
                            return [3, 10];
                        case 6:
                            if (!(selEntInfoHC0.SubEntityTypeName === "Line" && selEntInfoHC1.SubEntityTypeName === "Face" || selEntInfoHC1.SubEntityTypeName === "Line" && selEntInfoHC0.SubEntityTypeName === "Face")) return [3, 10];
                            edgeSelObj = iSelObjs[0];
                            edgeProp = iSelPropsHC[0];
                            faceSelObj = iSelObjs[1];
                            faceProp = iSelPropsHC[1];
                            if (selEntInfoHC1.SubEntityTypeName === "Line" && selEntInfoHC0.SubEntityTypeName === "Face") {
                                faceSelObj = iSelObjs[0];
                                faceProp = iSelPropsHC[0];
                                edgeSelObj = iSelObjs[1];
                                edgeProp = iSelPropsHC[1]
                            }
                            if (!(edgeProp instanceof eDwTypes_12.HC.SubentityProperties.CircleElement && faceProp instanceof eDwTypes_12.HC.SubentityProperties.PlaneElement)) return [3, 8];
                            return [4, getMinDistPtToFace(edgeProp.origin, edgeSelObj, faceSelObj, modelHC)];
                        case 7:
                            return [2, _a.sent()];
                        case 8:
                            if (!(edgeProp instanceof eDwTypes_12.HC.SubentityProperties.LineElement && faceProp instanceof eDwTypes_12.HC.SubentityProperties.PlaneElement)) return [3, 10];
                            pntsWCHC = edgeSelObj.getLineEntity().getPoints();
                            if (!(pntsWCHC.length === 2)) return [3, 10];
                            lineHC = new eDwTypes_12.HC.Ray(pntsWCHC[0], pntsWCHC[1]);
                            return [4, getMinDistLineToFace(lineHC, edgeSelObj, faceSelObj, modelHC)];
                        case 9:
                            return [2, _a.sent()];
                        case 10:
                            return [2, null]
                    }
                }))
            }))
        };
        eDwSelObj.getSelObjProperty = function (iSelObjHC, iModel) {
            return __awaiter(this, void 0, void 0, (function () {
                var subEntityProperty, subEntityInfo, subEntityTypeName, selObj, subEntityID, modelHC, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            subEntityProperty = null;
                            subEntityInfo = eDwSelObj.getSubEntityInfo(iSelObjHC);
                            subEntityTypeName = "Unknown";
                            if (!subEntityInfo.SubEntity) return [3, 6];
                            selObj = eDwSelObj.extendHCSelObj(iSelObjHC);
                            subEntityTypeName = subEntityInfo.SubEntityTypeName;
                            subEntityID = eDwSelObj.getSubEntityID(subEntityInfo.SubEntity);
                            modelHC = iModel.getHCModel();
                            _a = subEntityTypeName;
                            switch (_a) {
                                case"Line":
                                    return [3, 1];
                                case"Face":
                                    return [3, 3];
                                case"Point":
                                    return [3, 5]
                            }
                            return [3, 5];
                        case 1:
                            return [4, modelHC.getEdgeProperty(selObj.getIDHC(), subEntityID)];
                        case 2:
                            subEntityProperty = _b.sent();
                            return [3, 6];
                        case 3:
                            return [4, modelHC.getFaceProperty(selObj.getIDHC(), subEntityID)];
                        case 4:
                            subEntityProperty = _b.sent();
                            return [3, 6];
                        case 5:
                            return [3, 6];
                        case 6:
                            return [2, {Property: subEntityProperty, Name: subEntityTypeName}]
                    }
                }))
            }))
        };
        eDwSelObj.setSelObjSubEntityColor = function (iSelObjsHC, iModel, iColor) {
            var color = iColor ? hcutils_2.coerceToHCColor(iColor) : null;
            return eDwSelObj.setSelObjSubEntity(iSelObjsHC, iModel, color)
        };
        eDwSelObj.setSelObjSubEntityHighlight = function (iSelObjsHC, iModel, iHighlight) {
            return eDwSelObj.setSelObjSubEntity(iSelObjsHC, iModel, iHighlight)
        };
        eDwSelObj.getSubEntityInfo = function (iSelObjHC) {
            function checkIfSelectable(iSubEntity, iSelTypeMask) {
                return eDwSelObj.getSubEntityBits(iSubEntity) & iSelTypeMask ? true : false
            }

            var subEntity = null;
            var typeName = "";
            var isSelectable = false;
            if (iSelObjHC) {
                if (subEntity = iSelObjHC.getPointEntity()) {
                    typeName = "Point";
                    isSelectable = true
                } else if (subEntity = iSelObjHC.getLineEntity()) {
                    typeName = "Line";
                    var cEdgeSelMeasureHC = 4;
                    isSelectable = checkIfSelectable(subEntity, cEdgeSelMeasureHC)
                } else if (subEntity = iSelObjHC.getFaceEntity()) {
                    typeName = "Face";
                    var cFaceSelMeasureHC = 1;
                    isSelectable = checkIfSelectable(subEntity, cFaceSelMeasureHC)
                }
            }
            return {SubEntity: subEntity, SubEntityTypeName: typeName, IsSelectable: isSelectable}
        };
        eDwSelObj.getSubEntityTypeName = function (iSubEntityType) {
            if (!iSubEntityType) return "";
            return utils.getObjectTypeName(iSubEntityType).slice(0, -6)
        };
        eDwSelObj.getSubEntityID = function (iSubEntity) {
            return iSubEntity ? iSubEntity._elementIndex : NaN
        };
        eDwSelObj.getSubEntityBits = function (iSubEntity) {
            return iSubEntity ? iSubEntity._elementBits : NaN
        };
        eDwSelObj.prototype.setPointInLocalSpace = function (iWorldPtHC, iToLocalTransformHC) {
            if (iToLocalTransformHC) {
                this.mLocalPnt = iWorldPtHC ? iToLocalTransformHC.transform(iWorldPtHC) : null;
                this.mToLocalTransformHC = iToLocalTransformHC
            }
        };
        eDwSelObj.setSelObjSubEntity = function (iSelObjsHC, iModel, iSetting) {
            var e_43, _a;
            if (!iSelObjsHC || !iSelObjsHC.length) return [];
            var modelHC = iModel.getHCModel();
            var subEntityIDs = [];
            try {
                for (var iSelObjsHC_2 = __values(iSelObjsHC), iSelObjsHC_2_1 = iSelObjsHC_2.next(); !iSelObjsHC_2_1.done; iSelObjsHC_2_1 = iSelObjsHC_2.next()) {
                    var selObjHC = iSelObjsHC_2_1.value;
                    var nodeID = selObjHC.getNodeId();
                    var subEntityInfo = eDwSelObj.getSubEntityInfo(selObjHC);
                    var subEntityID = eDwSelObj.getSubEntityID(subEntityInfo.SubEntity);
                    var isColor = typeof iSetting === "object" ? true : false;
                    var action = "setNode" + subEntityInfo.SubEntityTypeName + (isColor ? "Color" : "Highlighted");
                    action = !iSetting && isColor ? "un" + action : action;
                    try {
                        modelHC[action](nodeID, subEntityID, iSetting);
                        subEntityIDs.push(subEntityID)
                    } catch (iExcp) {
                    }
                }
            } catch (e_43_1) {
                e_43 = {error: e_43_1}
            } finally {
                try {
                    if (iSelObjsHC_2_1 && !iSelObjsHC_2_1.done && (_a = iSelObjsHC_2.return)) _a.call(iSelObjsHC_2)
                } finally {
                    if (e_43) throw e_43.error
                }
            }
            return subEntityIDs
        };
        eDwSelObj.prototype.getVectorInfo = function (iTransformPointFunc) {
            if (iTransformPointFunc === void 0) {
                iTransformPointFunc = function (iPntHC) {
                    return iPntHC
                }
            }
            var vec3DHC;
            var startCrvPt3DHC;
            var endCrvPt3DHC;
            var entityHC;
            if (entityHC = this.getLineEntity()) {
                var crvPtsWC3DHC = entityHC.getPoints();
                var numPts = crvPtsWC3DHC.length;
                if (numPts > 1) {
                    startCrvPt3DHC = iTransformPointFunc(crvPtsWC3DHC[0]);
                    endCrvPt3DHC = iTransformPointFunc(crvPtsWC3DHC[numPts - 1]);
                    vec3DHC = eDwTypes_12.HC.Point3.subtract(endCrvPt3DHC, startCrvPt3DHC);
                    if (vec3DHC.length() < eDwGeomUtils_1.cAbsLengthTol) {
                        endCrvPt3DHC = iTransformPointFunc(crvPtsWC3DHC[1]);
                        vec3DHC = eDwTypes_12.HC.Point3.subtract(endCrvPt3DHC, startCrvPt3DHC);
                        if (vec3DHC.length() < eDwGeomUtils_1.cAbsLengthTol) {
                            console.warn("eDwSelObj.getVectorInfo failed")
                        }
                    }
                }
                vec3DHC.normalize()
            } else if (entityHC = this.getFaceEntity()) {
                vec3DHC = entityHC.getNormal();
                vec3DHC.normalize();
                startCrvPt3DHC = iTransformPointFunc(entityHC.getPosition());
                endCrvPt3DHC = eDwTypes_12.HC.Point3.add(startCrvPt3DHC, vec3DHC)
            }
            return {Vec: vec3DHC, Pts: [startCrvPt3DHC, endCrvPt3DHC]}
        };
        return eDwSelObj
    }();
    return eDwSelObj
}));
define("eDwSelectionOperator", ["require", "exports", "eDwBaseSelOperator", "eDwEventMgr", "eDwUILocalize", "eDwEvents", "eDwTypes", "eDwGeomUtils", "utils"], (function (require, exports, eDwBaseSelOperator, eDwEventMgr, eDwUILocalize_3, eDwEvents_5, eDwTypes_13, eDwGeomUtils, utils) {
    "use strict";
    var eDwSelectionOperator = function (_super) {
        __extends(eDwSelectionOperator, _super);

        function eDwSelectionOperator(iViewer, iSelMgr) {
            var _this = _super.call(this, iViewer, iSelMgr) || this;
            _this.mCalloutTimeoutHandle = NaN;
            _this.mNameCallout = null;
            _this.mSelObjIDHC = NaN;
            _this.mMousePosCopy = null;
            _super.prototype.pushHighlightSelectionState.call(_this, "NODE", true);
            _super.prototype.pushHighlightSelectionState.call(_this, "FACE", true);
            _super.prototype.pushHighlightSelectionState.call(_this, "EDGE", false);
            _super.prototype.pushHighlightSelectionState.call(_this, "VERTEX", false);
            _super.prototype.pushElementSelectionHighlightMode.call(_this, "HighlightAndOutline");
            return _this
        }

        eDwSelectionOperator.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(ioMouseEvent && this.CurrInputInfo)) return [3, 2];
                            return [4, _super.prototype.onMouseUp.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            return [2]
                    }
                }))
            }))
        };
        eDwSelectionOperator.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!ioMouseEvent) return [3, 2];
                            return [4, _super.prototype.onMouseDown.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            return [2]
                    }
                }))
            }))
        };
        eDwSelectionOperator.prototype.onMouseMove = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var pos, activeOpID, selObj, op_1;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!ioMouseEvent) return [3, 4];
                            pos = ioMouseEvent.getPosition();
                            activeOpID = this.Viewer.OperatorMgr.getActiveOperatorID();
                            if (!(!this.CurrInputInfo && this.Viewer.getModel().isAssembly() && activeOpID === this.OperatorID)) return [3, 2];
                            this.mMousePosCopy = pos.copy();
                            if (!this.mMousePosCopy) return [2];
                            return [4, this.Viewer.ViewMgr.pickFromPoint(this.mMousePosCopy, new eDwTypes_13.HC.PickConfig(eDwTypes_13.HC.SelectionMask.Face))];
                        case 1:
                            selObj = _a.sent();
                            this.mSelObjIDHC = selObj.getIDHC();
                            op_1 = this;
                            this.mCalloutTimeoutHandle = setTimeout((function () {
                                op_1.updateCallout()
                            }), 1e3);
                            _a.label = 2;
                        case 2:
                            return [4, _super.prototype.onMouseMove.call(this, ioMouseEvent)];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            return [2]
                    }
                }))
            }))
        };
        eDwSelectionOperator.prototype.onDoubleClick = function (ioInputEvent) {
            var _this = this;
            var stopFurtherProcessing = false;
            if (!ioInputEvent) return stopFurtherProcessing;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var pnt2DHC, haveSelection;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                pnt2DHC = ioInputEvent.getPosition();
                                return [4, this.doPick(pnt2DHC)];
                            case 1:
                                haveSelection = _a.sent();
                                _super.prototype.onDoubleClick.call(this, ioInputEvent);
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_5.LeftDoubleClickEvent, this.Viewer, pnt2DHC, haveSelection)];
                            case 2:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            return stopFurtherProcessing
        };
        eDwSelectionOperator.prototype.onClick = function (ioInputEvent) {
            var _this = this;
            var processButton = function (iAppEvent) {
                if (!_this.isDragging()) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            var haveSelection;
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, this.doPick(pos2DHC)];
                                    case 1:
                                        haveSelection = _a.sent();
                                        return [4, eventMgr.fireEvent(iAppEvent, this.Viewer, pos2DHC, haveSelection)];
                                    case 2:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }
            };
            var stopFurtherProcessing = false;
            var pos2DHC = ioInputEvent.getPosition();
            var eventMgr = eDwEventMgr.get();
            switch (this.ActiveMouseButton) {
                case"left": {
                    processButton(eDwEvents_5.LeftClickEvent);
                    stopFurtherProcessing = true;
                    break
                }
                case"middle": {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_5.MiddleClickEvent, this.Viewer, pos2DHC)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })();
                    stopFurtherProcessing = true;
                    break
                }
                case"right": {
                    processButton(eDwEvents_5.RightClickEvent);
                    stopFurtherProcessing = true;
                    break
                }
                default:
                    break
            }
            return stopFurtherProcessing
        };
        eDwSelectionOperator.prototype.updateCallout = function () {
            if (this.CurrInputInfo || !this.mMousePosCopy) {
                return
            }
            var isSameID = this.mNameCallout ? this.mNameCallout.isSameID(this.mSelObjIDHC) : false;
            if (isSameID) return;
            var markupMgrHC = this.Viewer.getHCMarkupManager();
            try {
                if (this.mNameCallout) {
                    markupMgrHC.unregisterMarkup(this.mNameCallout.MarkupID);
                    this.mNameCallout = null;
                    if (utils.isNumber(this.mCalloutTimeoutHandle)) {
                        clearTimeout(this.mCalloutTimeoutHandle);
                        this.mCalloutTimeoutHandle = NaN
                    }
                }
                if (utils.isNumber(this.mSelObjIDHC)) {
                    var model = this.Viewer.getModel();
                    var hierNode = model.getHierarchyNode(this.mSelObjIDHC);
                    if (!hierNode) return;
                    var name_2 = hierNode.Name || eDwUILocalize_3.eDwUILocalize.getString("Strings.CompNameUnknwon");
                    var pos = eDwTypes_13.HC.Point2.add(this.mMousePosCopy.copy(), new eDwTypes_13.HC.Point2(0, 20));
                    this.mNameCallout = new NameCallout(this.Viewer, this.mSelObjIDHC, name_2, pos);
                    this.mNameCallout.MarkupID = markupMgrHC.registerMarkup(this.mNameCallout)
                }
            } catch (iExcp) {
                this.mNameCallout = null
            }
            markupMgrHC.refreshMarkup()
        };
        eDwSelectionOperator.prototype.doPick = function (iCoords) {
            return __awaiter(this, void 0, void 0, (function () {
                var isDrawing, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            isDrawing = this.Viewer.getModel().isDrawing();
                            if (!isDrawing) return [3, 2];
                            return [4, this.doPickInDrawing(iCoords)];
                        case 1:
                            _a = _b.sent();
                            return [3, 4];
                        case 2:
                            return [4, this.Viewer.SelectionMgr.select(iCoords)];
                        case 3:
                            _a = _b.sent();
                            _b.label = 4;
                        case 4:
                            return [2, _a]
                    }
                }))
            }))
        };
        eDwSelectionOperator.prototype.doPickInDrawing = function (iCoords) {
            return __awaiter(this, void 0, void 0, (function () {
                var selSuccess, model, activeSheetHierNode, childHierarchyMap, children, viewIDsHC, i, currentNode,
                    pickConfig, selObj, selObjIDHC, hierNode, viewIDsHC_1, viewIDsHC_1_1, viewIDHC, bboxHC, viewHC,
                    selPt3D, e_44_1;
                var e_44, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            selSuccess = false;
                            model = this.Viewer.getModel();
                            activeSheetHierNode = model.getActiveModelView();
                            childHierarchyMap = activeSheetHierNode.Hierarchy.getChildrenAndKeys();
                            children = Object.keys(childHierarchyMap);
                            viewIDsHC = [];
                            for (i = children.length - 1; i > -1; --i) {
                                currentNode = childHierarchyMap[children[i]];
                                viewIDsHC.push(currentNode.HOOPSID)
                            }
                            pickConfig = new eDwTypes_13.HC.PickConfig(eDwTypes_13.HC.SelectionMask.All);
                            return [4, this.Viewer.ViewMgr.pickFromPoint(iCoords, pickConfig)];
                        case 1:
                            selObj = _b.sent();
                            selObjIDHC = selObj.getIDHC();
                            if (!utils.isNaN(selObjIDHC)) return [3, 3];
                            return [4, this.Viewer.SelectionMgr.select(iCoords)];
                        case 2:
                            selSuccess = _b.sent();
                            _b.label = 3;
                        case 3:
                            hierNode = model.getHierarchyNode(selObjIDHC);
                            if (!hierNode) return [3, 6];
                            if (!(viewIDsHC.indexOf(hierNode.HOOPSID) > -1)) return [3, 5];
                            return [4, this.Viewer.SelectionMgr.selectByID(hierNode.HOOPSID)];
                        case 4:
                            selSuccess = _b.sent();
                            _b.label = 5;
                        case 5:
                            return [3, 13];
                        case 6:
                            _b.trys.push([6, 11, 12, 13]);
                            viewIDsHC_1 = __values(viewIDsHC), viewIDsHC_1_1 = viewIDsHC_1.next();
                            _b.label = 7;
                        case 7:
                            if (!!viewIDsHC_1_1.done) return [3, 10];
                            viewIDHC = viewIDsHC_1_1.value;
                            return [4, model.getBoundingBoxOfIDsHC([viewIDHC])];
                        case 8:
                            bboxHC = _b.sent();
                            if (bboxHC.isDegenerate()) return [3, 9];
                            viewHC = this.Viewer.getHCView();
                            selPt3D = viewHC.unprojectPoint(iCoords, 0);
                            if (!selPt3D) return [3, 9];
                            selPt3D.z = bboxHC.center().z;
                            if (eDwGeomUtils.isPoint3DInBox(selPt3D, bboxHC)) {
                                selSuccess = this.Viewer.SelectionMgr.selectByID(viewIDHC);
                                return [3, 10]
                            }
                            _b.label = 9;
                        case 9:
                            viewIDsHC_1_1 = viewIDsHC_1.next();
                            return [3, 7];
                        case 10:
                            return [3, 13];
                        case 11:
                            e_44_1 = _b.sent();
                            e_44 = {error: e_44_1};
                            return [3, 13];
                        case 12:
                            try {
                                if (viewIDsHC_1_1 && !viewIDsHC_1_1.done && (_a = viewIDsHC_1.return)) _a.call(viewIDsHC_1)
                            } finally {
                                if (e_44) throw e_44.error
                            }
                            return [7];
                        case 13:
                            return [2, selSuccess]
                    }
                }))
            }))
        };
        return eDwSelectionOperator
    }(eDwBaseSelOperator);
    var NameCallout = function (_super) {
        __extends(NameCallout, _super);

        function NameCallout(iVewer, iSelObjIDHC, iText, iPos) {
            var _this = _super.call(this) || this;
            _this.mViewer = iVewer;
            _this.mTextBox = new eDwTypes_13.HC.Markup.Shape.TextBox;
            _this.mTextBox.getBoxPortion().setFillColor(eDwTypes_13.HC.Color.white());
            _this.mTextBox.getBoxPortion().setFillOpacity(1);
            _this.mMarkupID = "";
            _this.mSelObjIDHC = iSelObjIDHC;
            _this.mTextBox.getTextPortion().setFontFamily("Arial");
            _this.mTextBox.setPosition(iPos);
            _this.mTextBox.setTextString(iText);
            return _this
        }

        NameCallout.prototype.draw = function () {
            var str = this.mTextBox.getTextString();
            if (str === "") return;
            var renderer = this.mViewer.getHCMarkupManager().getRenderer();
            renderer.drawTextBox(this.mTextBox)
        };
        NameCallout.prototype.isSameID = function (iSelObjIDHC) {
            return this.mSelObjIDHC === iSelObjIDHC || isNaN(iSelObjIDHC) && isNaN(this.mSelObjIDHC) ? true : false
        };
        Object.defineProperty(NameCallout.prototype, "MarkupID", {
            get: function () {
                return this.mMarkupID
            }, set: function (iMarkupID) {
                this.mMarkupID = iMarkupID
            }, enumerable: false, configurable: true
        });
        return NameCallout
    }(eDwTypes_13.HC.Markup.MarkupItem);
    return eDwSelectionOperator
}));
define("eDwServiceMgr", ["require", "exports", "eDwTimer", "eDwResultError"], (function (require, exports, eDwTimer, eDwResultError) {
    "use strict";
    var eDwServiceMgr = function () {
        function eDwServiceMgr(iServerURL, iDisable) {
            this.mServerURL = iServerURL.replace(/(\/*)$/, "");
            this.mAdvancedServicesDisabled = iDisable;
            this.mPluginFiles = [];
            this.mBaseCacheDirs = []
        }

        eDwServiceMgr.create = function (iServerURL, iDisable) {
            if (iDisable === void 0) {
                iDisable = false
            }
            if (!eDwServiceMgr.sServiceMgr) {
                eDwServiceMgr.sServiceMgr = new eDwServiceMgr(iServerURL, iDisable)
            }
        };
        eDwServiceMgr.get = function () {
            return eDwServiceMgr.sServiceMgr
        };
        eDwServiceMgr.usesWebServices = function () {
            return false
        };
        eDwServiceMgr.prototype.disableAdvancedServices = function (iDisable) {
            if (iDisable === void 0) {
                iDisable = true
            }
            this.mAdvancedServicesDisabled = iDisable
        };
        eDwServiceMgr.prototype.getFileFromServer = function (iFileURL, iLoadAsNativeType) {
            if (iLoadAsNativeType === void 0) {
                iLoadAsNativeType = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, l_getFileFromServer(iFileURL, iLoadAsNativeType, true)];
                        case 1:
                            return [2, _a.sent()]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.getFileFromServerModelCache = function (iModelKey, iFileName, iLoadAsNativeType) {
            if (iLoadAsNativeType === void 0) {
                iLoadAsNativeType = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                var fileInfo, baseCacheDirs, baseCacheDirs_1, baseCacheDirs_1_1, dir, filePath, contents, iExcp_6,
                    e_45_1;
                var e_45, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            fileInfo = {URL: ""};
                            if (this.mAdvancedServicesDisabled || !eDwServiceMgr.usesWebServices()) {
                                return [2, fileInfo]
                            }
                            return [4, this.getBaseCacheDirs()];
                        case 1:
                            baseCacheDirs = _b.sent();
                            _b.label = 2;
                        case 2:
                            _b.trys.push([2, 9, 10, 11]);
                            baseCacheDirs_1 = __values(baseCacheDirs), baseCacheDirs_1_1 = baseCacheDirs_1.next();
                            _b.label = 3;
                        case 3:
                            if (!!baseCacheDirs_1_1.done) return [3, 8];
                            dir = baseCacheDirs_1_1.value;
                            filePath = dir + "/" + iModelKey + "/" + iFileName;
                            _b.label = 4;
                        case 4:
                            _b.trys.push([4, 6, , 7]);
                            return [4, l_getFileFromServer(filePath, iLoadAsNativeType, false)];
                        case 5:
                            contents = _b.sent();
                            if (contents) {
                                fileInfo.Contents = contents;
                                fileInfo.URL = this.mServerURL + "/" + filePath;
                                return [2, fileInfo]
                            }
                            return [3, 7];
                        case 6:
                            iExcp_6 = _b.sent();
                            return [3, 7];
                        case 7:
                            baseCacheDirs_1_1 = baseCacheDirs_1.next();
                            return [3, 3];
                        case 8:
                            return [3, 11];
                        case 9:
                            e_45_1 = _b.sent();
                            e_45 = {error: e_45_1};
                            return [3, 11];
                        case 10:
                            try {
                                if (baseCacheDirs_1_1 && !baseCacheDirs_1_1.done && (_a = baseCacheDirs_1.return)) _a.call(baseCacheDirs_1)
                            } finally {
                                if (e_45) throw e_45.error
                            }
                            return [7];
                        case 11:
                            return [2, fileInfo]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.getClientPublicIP = function (iGetClientPublicIP) {
            return __awaiter(this, void 0, void 0, (function () {
                var ret, iExcp_7;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!iGetClientPublicIP || this.mAdvancedServicesDisabled || !eDwServiceMgr.usesWebServices()) {
                                return [2, "0.0.0.0"]
                            }
                            if (!iGetClientPublicIP || this.mAdvancedServicesDisabled) return [2, ""];
                            ret = "";
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, $.get("https://api.ipify.org", "", $.noop(), "text")];
                        case 2:
                            ret = _a.sent();
                            return [3, 4];
                        case 3:
                            iExcp_7 = _a.sent();
                            console.warn("Failed to get client public IP: " + iExcp_7.name + " - " + iExcp_7.message);
                            if (!iExcp_7.message) {
                                iExcp_7.message = "Possible CORS failure.  See the browser " + "console output for more details."
                            }
                            throw iExcp_7;
                        case 4:
                            return [2, ret]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.convert = function (ioParams) {
            return __awaiter(this, void 0, void 0, (function () {
                var result, clientIP, params, modelLoadTimer;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            result = {
                                FileName: "",
                                ModelCacheName: "",
                                ErrorCode: "",
                                ErrorData: [],
                                ServerID: "",
                                LicenseKey: ""
                            };
                            if (!ioParams.URL) return [2, result];
                            result.FileName = ioParams.URL;
                            if (!(ioParams.URL.indexOf("http") === 0 && !this.mAdvancedServicesDisabled && eDwServiceMgr.usesWebServices())) return [3, 3];
                            return [4, this.getClientPublicIP(ioParams.ValidateClientIP)];
                        case 1:
                            clientIP = _a.sent();
                            params = {
                                data: {iFileURL: ioParams.URL},
                                headers: {"X-Forwarded-For": clientIP},
                                cache: false
                            };
                            modelLoadTimer = new eDwTimer;
                            return [4, this.ajax("GET", "EDrawingsService.svc/Conversion", params)];
                        case 2:
                            result = _a.sent();
                            modelLoadTimer.ellapsed().dumpToConsole("Model Load");
                            return [3, 4];
                        case 3:
                            ioParams.URL = "";
                            _a.label = 4;
                        case 4:
                            return [2, result]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.removeNamedCache = function (iModelKey, iAllowRemove) {
            return __awaiter(this, void 0, void 0, (function () {
                var iExcp_8;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!iAllowRemove || this.mAdvancedServicesDisabled || !eDwServiceMgr.usesWebServices()) {
                                return [2]
                            }
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, this.ajax("GET", "EDrawingsService.svc/RemoveNamedCache", {data: {iModelKey: iModelKey}})];
                        case 2:
                            _a.sent();
                            return [3, 4];
                        case 3:
                            iExcp_8 = _a.sent();
                            console.warn("Could not remove the cache: " + iModelKey);
                            console.warn(iExcp_8.message);
                            throw iExcp_8;
                        case 4:
                            return [2]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.load = function (iElemOrClassID, iPanelHTML) {
            return __awaiter(this, void 0, void 0, (function () {
                var loadedHTML;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!eDwServiceMgr.usesWebServices()) return [2];
                            return [4, this.ajax("GET", iPanelHTML, {dataType: "html"})];
                        case 1:
                            loadedHTML = _a.sent();
                            $(iElemOrClassID).html(loadedHTML);
                            return [2]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.fileUpload = function (iJQObj, iOptions) {
            return __awaiter(this, void 0, void 0, (function () {
                var paramsObj;
                return __generator(this, (function (_a) {
                    if (this.mAdvancedServicesDisabled || !eDwServiceMgr.usesWebServices()) {
                        return [2]
                    }
                    paramsObj = {url: this.mServerURL + "/EDrawingsService.svc/FileUploadConversion"};
                    if (iOptions) $.extend(paramsObj, iOptions);
                    iJQObj.fileupload(paramsObj);
                    return [2]
                }))
            }))
        };
        eDwServiceMgr.prototype.importDependencies = function (iPluginKeyNames) {
            return __awaiter(this, void 0, void 0, (function () {
                var pluginFiles, iPluginKeyNames_1, iPluginKeyNames_1_1, pluginKeyName, pluginFileName, e_46_1, _a;
                var e_46, _b;
                return __generator(this, (function (_c) {
                    switch (_c.label) {
                        case 0:
                            pluginFiles = [];
                            _c.label = 1;
                        case 1:
                            _c.trys.push([1, 6, 7, 8]);
                            iPluginKeyNames_1 = __values(iPluginKeyNames), iPluginKeyNames_1_1 = iPluginKeyNames_1.next();
                            _c.label = 2;
                        case 2:
                            if (!!iPluginKeyNames_1_1.done) return [3, 5];
                            pluginKeyName = iPluginKeyNames_1_1.value;
                            return [4, this.getValidPluginFileName(pluginKeyName)];
                        case 3:
                            pluginFileName = _c.sent();
                            if (pluginFileName) pluginFiles.push(pluginFileName);
                            _c.label = 4;
                        case 4:
                            iPluginKeyNames_1_1 = iPluginKeyNames_1.next();
                            return [3, 2];
                        case 5:
                            return [3, 8];
                        case 6:
                            e_46_1 = _c.sent();
                            e_46 = {error: e_46_1};
                            return [3, 8];
                        case 7:
                            try {
                                if (iPluginKeyNames_1_1 && !iPluginKeyNames_1_1.done && (_b = iPluginKeyNames_1.return)) _b.call(iPluginKeyNames_1)
                            } finally {
                                if (e_46) throw e_46.error
                            }
                            return [7];
                        case 8:
                            if (!pluginFiles.length) return [3, 10];
                            return [4, this.importPlugins(pluginFiles)];
                        case 9:
                            _a = _c.sent();
                            return [3, 11];
                        case 10:
                            _a = [];
                            _c.label = 11;
                        case 11:
                            return [2, _a]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.importPlugins = function (iPluginNames) {
            return __awaiter(this, void 0, void 0, (function () {
                var pluginNames, importedPluginPromises, pluginFiles, _a, pluginFiles_1, pluginFiles_1_1, pluginFile,
                    pluginPromise, iExcp_9;
                var e_47, _b;
                return __generator(this, (function (_c) {
                    switch (_c.label) {
                        case 0:
                            pluginNames = [];
                            importedPluginPromises = [];
                            _c.label = 1;
                        case 1:
                            _c.trys.push([1, 5, , 6]);
                            _a = iPluginNames;
                            if (_a) return [3, 3];
                            return [4, this.getPluginFiles()];
                        case 2:
                            _a = _c.sent();
                            _c.label = 3;
                        case 3:
                            pluginFiles = _a;
                            try {
                                for (pluginFiles_1 = __values(pluginFiles), pluginFiles_1_1 = pluginFiles_1.next(); !pluginFiles_1_1.done; pluginFiles_1_1 = pluginFiles_1.next()) {
                                    pluginFile = pluginFiles_1_1.value;
                                    try {
                                        pluginPromise = this.importPlugin(pluginFile);
                                        if (pluginPromise) {
                                            importedPluginPromises.push(pluginPromise)
                                        }
                                    } catch (iExcp) {
                                        console.warn("Plugin failed to load: " + iExcp.message)
                                    }
                                }
                            } catch (e_47_1) {
                                e_47 = {error: e_47_1}
                            } finally {
                                try {
                                    if (pluginFiles_1_1 && !pluginFiles_1_1.done && (_b = pluginFiles_1.return)) _b.call(pluginFiles_1)
                                } finally {
                                    if (e_47) throw e_47.error
                                }
                            }
                            return [4, Promise.all(importedPluginPromises).then((function (iPluginClassNames) {
                                pluginNames = iPluginClassNames
                            }))];
                        case 4:
                            _c.sent();
                            return [3, 6];
                        case 5:
                            iExcp_9 = _c.sent();
                            console.warn("Failed to find any external plugins - " + iExcp_9.message);
                            return [3, 6];
                        case 6:
                            return [2, pluginNames]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.importPlugin = function (iPluginFile) {
            return __awaiter(this, void 0, void 0, (function () {
                var pluginName, script, matches, iExcp_10;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            pluginName = "";
                            if (!eDwServiceMgr.usesWebServices()) return [2, pluginName];
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 4, , 5]);
                            return [4, new Promise((function (resolve_1, reject_1) {
                                require([iPluginFile], resolve_1, reject_1)
                            }))];
                        case 2:
                            _a.sent();
                            return [4, $.getScript(iPluginFile)];
                        case 3:
                            script = _a.sent();
                            matches = script.match(/return ([a-z,A-Z,0-9,-,_,.]*Plugin)/);
                            if (matches && matches.length > 0) {
                                pluginName = matches[1]
                            } else {
                                console.warn("Could not locate external plugin name in file " + iPluginFile)
                            }
                            return [3, 5];
                        case 4:
                            iExcp_10 = _a.sent();
                            console.warn("Failed to load external plugin - " + iExcp_10.message);
                            return [3, 5];
                        case 5:
                            return [2, pluginName]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.getPluginFiles = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _a, _b, iExcp_11;
                return __generator(this, (function (_c) {
                    switch (_c.label) {
                        case 0:
                            if (!eDwServiceMgr.usesWebServices()) return [2, this.mPluginFiles];
                            if (!!this.mPluginFiles.length) return [3, 7];
                            _c.label = 1;
                        case 1:
                            _c.trys.push([1, 6, , 7]);
                            if (!this.mAdvancedServicesDisabled) return [3, 3];
                            console.debugLog("ServiceMgr", "Loading static plugin list");
                            _a = this;
                            return [4, this.ajax("GET", "js/staticPluginList.json", {})];
                        case 2:
                            _a.mPluginFiles = _c.sent();
                            return [3, 5];
                        case 3:
                            console.debugLog("ServiceMgr", "Finding plugins...");
                            _b = this;
                            return [4, this.ajax("GET", "EDrawingsService.svc/GetPlugins", {})];
                        case 4:
                            _b.mPluginFiles = _c.sent();
                            _c.label = 5;
                        case 5:
                            return [3, 7];
                        case 6:
                            iExcp_11 = _c.sent();
                            console.warn("No plugins available.");
                            return [3, 7];
                        case 7:
                            return [2, this.mPluginFiles]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.extendLicense = function (iKey) {
            return __awaiter(this, void 0, void 0, (function () {
                var params;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (this.mAdvancedServicesDisabled || !eDwServiceMgr.usesWebServices()) {
                                return [2]
                            }
                            params = {data: {iKey: iKey}, cache: false};
                            return [4, this.ajax("GET", "EDrawingsService.svc/ExtendLicense", params)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.getBaseCacheDirs = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!!this.mBaseCacheDirs.length) return [3, 2];
                            this.mBaseCacheDirs = [];
                            this.mGetBaseCacheDirsPromise = $.get("cacheDirs.xml", (function (iDoc) {
                                var cacheDirs = iDoc.getElementsByTagName("modelSearchDirectory");
                                var numDirs = cacheDirs.length;
                                for (var i = 0; i < numDirs; ++i) {
                                    var cacheDir = cacheDirs[i].textContent;
                                    cacheDir = cacheDir ? cacheDir.split("/").pop().trim() : null;
                                    if (cacheDir) {
                                        _this.mBaseCacheDirs.push(cacheDir);
                                        console.debugLog("ServiceMgr", "Added cache dir: " + cacheDir)
                                    }
                                }
                            }), "xml").fail((function (iJQXHR, iStatus, iError) {
                                console.warn("Could not get model cache directories: " + iStatus + ": " + iError)
                            }));
                            return [4, this.mGetBaseCacheDirsPromise];
                        case 1:
                            _a.sent();
                            return [3, 4];
                        case 2:
                            return [4, this.mGetBaseCacheDirsPromise];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            return [2, this.mBaseCacheDirs]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.getValidPluginFileName = function (iPluginKey) {
            return __awaiter(this, void 0, void 0, (function () {
                var allPluginFileNames, foundPluginFileName, allPluginFileNames_1, allPluginFileNames_1_1,
                    pluginFileName;
                var e_48, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            return [4, this.getPluginFiles()];
                        case 1:
                            allPluginFileNames = _b.sent();
                            foundPluginFileName = "";
                            try {
                                for (allPluginFileNames_1 = __values(allPluginFileNames), allPluginFileNames_1_1 = allPluginFileNames_1.next(); !allPluginFileNames_1_1.done; allPluginFileNames_1_1 = allPluginFileNames_1.next()) {
                                    pluginFileName = allPluginFileNames_1_1.value;
                                    if (pluginFileName.indexOf("/" + iPluginKey + ".") > -1) {
                                        foundPluginFileName = pluginFileName
                                    }
                                }
                            } catch (e_48_1) {
                                e_48 = {error: e_48_1}
                            } finally {
                                try {
                                    if (allPluginFileNames_1_1 && !allPluginFileNames_1_1.done && (_a = allPluginFileNames_1.return)) _a.call(allPluginFileNames_1)
                                } finally {
                                    if (e_48) throw e_48.error
                                }
                            }
                            return [2, foundPluginFileName]
                    }
                }))
            }))
        };
        eDwServiceMgr.prototype.ajax = function (iMethod, iService, iParams) {
            return __awaiter(this, void 0, void 0, (function () {
                var paramsObj, retAJAX, iExcp_12;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            paramsObj = {type: iMethod, url: this.mServerURL + "/" + iService, async: true};
                            if (iParams) $.extend(paramsObj, iParams);
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, $.ajax(paramsObj)];
                        case 2:
                            retAJAX = _a.sent();
                            return [3, 4];
                        case 3:
                            iExcp_12 = _a.sent();
                            console.warn("AJAX " + iMethod + " failed for " + iService + ": " + iExcp_12.message);
                            throw iExcp_12;
                        case 4:
                            return [2, retAJAX]
                    }
                }))
            }))
        };
        return eDwServiceMgr
    }();

    function l_getFileFromServer(iFileURL, iLoadAsNativeType, iAllowThrow) {
        return __awaiter(this, void 0, void 0, (function () {
            var jqNativePlugin, _a, iExcp_13, res;
            return __generator(this, (function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!eDwServiceMgr.usesWebServices()) return [2, null];
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 6, , 7]);
                        jqNativePlugin = $;
                        if (!iLoadAsNativeType) return [3, 3];
                        return [4, jqNativePlugin.getNative(iFileURL)];
                    case 2:
                        _a = _b.sent();
                        return [3, 5];
                    case 3:
                        return [4, $.get(iFileURL)];
                    case 4:
                        _a = _b.sent();
                        _b.label = 5;
                    case 5:
                        return [2, _a];
                    case 6:
                        iExcp_13 = _b.sent();
                        if (iAllowThrow) {
                            res = {ErrorCode: "UnknownError", ErrorData: ["Status = " + iExcp_13.status]};
                            switch (iExcp_13.status) {
                                case 404:
                                    res.ErrorCode = "Model file not found.";
                                    break;
                                default:
                                    break
                            }
                            throw new eDwResultError(res)
                        }
                        return [3, 7];
                    case 7:
                        return [2, null]
                }
            }))
        }))
    }

    return eDwServiceMgr
}));
define("eDwSetHierNodeAttribsCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSetHierNodeAttribsCmd = function (_super) {
        __extends(eDwSetHierNodeAttribsCmd, _super);

        function eDwSetHierNodeAttribsCmd(iViewer, iHierNodes, iAttrib) {
            var e_49, _a;
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialHierNodeAttribs = [];
            _this.mFinalHierNodeAttribs = [];
            var finalAttrib = $.extend(true, {}, iAttrib);
            try {
                for (var iHierNodes_2 = __values(iHierNodes), iHierNodes_2_1 = iHierNodes_2.next(); !iHierNodes_2_1.done; iHierNodes_2_1 = iHierNodes_2.next()) {
                    var hierNode = iHierNodes_2_1.value;
                    var initialAttrib = $.extend(true, {}, hierNode.getAttribs());
                    _this.mInitialHierNodeAttribs.push({HierNode: hierNode, Attribs: initialAttrib});
                    _this.mFinalHierNodeAttribs.push({HierNode: hierNode, Attribs: finalAttrib})
                }
            } catch (e_49_1) {
                e_49 = {error: e_49_1}
            } finally {
                try {
                    if (iHierNodes_2_1 && !iHierNodes_2_1.done && (_a = iHierNodes_2.return)) _a.call(iHierNodes_2)
                } finally {
                    if (e_49) throw e_49.error
                }
            }
            return _this
        }

        eDwSetHierNodeAttribsCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, l_setAttribs(this.mViewer.getModel(), this.mInitialHierNodeAttribs)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetHierNodeAttribsCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, l_setAttribs(this.mViewer.getModel(), this.mFinalHierNodeAttribs)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetHierNodeAttribsCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, l_setAttribs(this.mViewer.getModel(), this.mFinalHierNodeAttribs)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSetHierNodeAttribsCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwSetHierNodeAttribsCmd
    }(eDwSupportsHistoryCmd);

    function l_setAttribs(iModel, iAttribs) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, iModel.setAttribs(iAttribs)];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    return eDwSetHierNodeAttribsCmd
}));
define("eDwSetLayerVisibilityCmd", ["require", "exports", "eDwSetNodeVisibilityCmd", "eDwNodeAttributes"], (function (require, exports, eDwSetNodeVisibilityCmd, eDwNodeAttributes_4) {
    "use strict";
    var eDwSetLayerVisibilityCmd = function (_super) {
        __extends(eDwSetLayerVisibilityCmd, _super);

        function eDwSetLayerVisibilityCmd(iViewer, iLayers, iVisible) {
            var e_50, _a;
            var _this = _super.call(this, iViewer, l_getNodeIDsHC(iLayers), iVisible) || this;
            _this.mLayersAndVisibilities = [];
            try {
                for (var iLayers_1 = __values(iLayers), iLayers_1_1 = iLayers_1.next(); !iLayers_1_1.done; iLayers_1_1 = iLayers_1.next()) {
                    var layer = iLayers_1_1.value;
                    var visible = layer.getAttribs().Visible;
                    _this.mLayersAndVisibilities.push({Layer: layer, Visible: visible});
                    var attribs = new eDwNodeAttributes_4.eDwNodeAttributes;
                    attribs.Visible = iVisible;
                    layer.setAttribs(attribs)
                }
            } catch (e_50_1) {
                e_50 = {error: e_50_1}
            } finally {
                try {
                    if (iLayers_1_1 && !iLayers_1_1.done && (_a = iLayers_1.return)) _a.call(iLayers_1)
                } finally {
                    if (e_50) throw e_50.error
                }
            }
            return _this
        }

        eDwSetLayerVisibilityCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.resetVisibility()];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetLayerVisibilityCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.setVisibility()];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetLayerVisibilityCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, this.setVisibility()];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSetLayerVisibilityCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwSetLayerVisibilityCmd.prototype.resetVisibility = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.setVisibility(true)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwSetLayerVisibilityCmd.prototype.setVisibility = function (iReset) {
            if (iReset === void 0) {
                iReset = false
            }
            return __awaiter(this, void 0, void 0, (function () {
                var _a, _b, layerAndVis, attribs;
                var e_51, _c;
                return __generator(this, (function (_d) {
                    switch (_d.label) {
                        case 0:
                            try {
                                for (_a = __values(this.mLayersAndVisibilities), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    layerAndVis = _b.value;
                                    attribs = new eDwNodeAttributes_4.eDwNodeAttributes;
                                    attribs.Visible = iReset ? layerAndVis.Visible : this.mVisible;
                                    layerAndVis.Layer.setAttribs(attribs)
                                }
                            } catch (e_51_1) {
                                e_51 = {error: e_51_1}
                            } finally {
                                try {
                                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a)
                                } finally {
                                    if (e_51) throw e_51.error
                                }
                            }
                            return [4, this.mViewer.getModel().syncLayersAttribsState()];
                        case 1:
                            _d.sent();
                            return [2]
                    }
                }))
            }))
        };
        return eDwSetLayerVisibilityCmd
    }(eDwSetNodeVisibilityCmd);

    function l_getNodeIDsHC(iLayers) {
        var e_52, _a;
        var nodeIDsHC = [];
        try {
            for (var iLayers_2 = __values(iLayers), iLayers_2_1 = iLayers_2.next(); !iLayers_2_1.done; iLayers_2_1 = iLayers_2.next()) {
                var layer = iLayers_2_1.value;
                nodeIDsHC = nodeIDsHC.concat(layer.getNodeIDsHC())
            }
        } catch (e_52_1) {
            e_52 = {error: e_52_1}
        } finally {
            try {
                if (iLayers_2_1 && !iLayers_2_1.done && (_a = iLayers_2.return)) _a.call(iLayers_2)
            } finally {
                if (e_52) throw e_52.error
            }
        }
        return nodeIDsHC
    }

    return eDwSetLayerVisibilityCmd
}));
define("eDwSetNodeVisibilityCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSetNodeVisibilityCmd = function (_super) {
        __extends(eDwSetNodeVisibilityCmd, _super);

        function eDwSetNodeVisibilityCmd(iViewer, iNodeIDsHC, iVisible) {
            var e_53, _a;
            var _this = _super.call(this, iViewer) || this;
            _this.mNodeIDs = iNodeIDsHC;
            _this.mVisible = iVisible;
            var model = _this.mViewer.getModel();
            _this.mNodeIDVisMap = {};
            try {
                for (var iNodeIDsHC_2 = __values(iNodeIDsHC), iNodeIDsHC_2_1 = iNodeIDsHC_2.next(); !iNodeIDsHC_2_1.done; iNodeIDsHC_2_1 = iNodeIDsHC_2.next()) {
                    var nodeIDHC = iNodeIDsHC_2_1.value;
                    _this.mNodeIDVisMap[nodeIDHC] = model.isVisibleForNodeHC(nodeIDHC)
                }
            } catch (e_53_1) {
                e_53 = {error: e_53_1}
            } finally {
                try {
                    if (iNodeIDsHC_2_1 && !iNodeIDsHC_2_1.done && (_a = iNodeIDsHC_2.return)) _a.call(iNodeIDsHC_2)
                } finally {
                    if (e_53) throw e_53.error
                }
            }
            return _this
        }

        eDwSetNodeVisibilityCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.mViewer.getModel().setVisibilitiesForNodesHC(this.mNodeIDVisMap)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetNodeVisibilityCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            return [4, this.mViewer.getModel().setVisibilityForNodesHC(this.mNodeIDs, this.mVisible)];
                        case 2:
                            _a.sent();
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetNodeVisibilityCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, this.mViewer.getModel().setVisibilityForNodesHC(this.mNodeIDs, this.mVisible)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSetNodeVisibilityCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwSetNodeVisibilityCmd
    }(eDwSupportsHistoryCmd);
    return eDwSetNodeVisibilityCmd
}));
define("eDwSetViewCameraCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSetViewCameraCmd = function (_super) {
        __extends(eDwSetViewCameraCmd, _super);

        function eDwSetViewCameraCmd(iViewer, iSetViewCB) {
            if (iSetViewCB === void 0) {
                iSetViewCB = function (iViewer) {
                    return iViewer.SelectionMgr.setViewToSelectedFace()
                }
            }
            var _this = _super.call(this, iViewer) || this;
            _this.mSetViewCB = iSetViewCB;
            return _this
        }

        eDwSetViewCameraCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mInitialViewCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetViewCameraCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mFinalViewCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetViewCameraCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var viewHC;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (this.mViewer.getModel().isDrawing()) return [2];
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            viewHC = this.mViewer.getHCView();
                            this.mInitialViewCamera = viewHC.getCamera();
                            this.mFinalViewCamera = this.setView();
                            return [2]
                    }
                }))
            }))
        };
        eDwSetViewCameraCmd.prototype.isCommitted = function () {
            return _super.prototype.isCommitted.call(this) && !!this.mInitialViewCamera && !!this.mFinalViewCamera
        };
        Object.defineProperty(eDwSetViewCameraCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        eDwSetViewCameraCmd.prototype.setView = function () {
            return this.mSetViewCB(this.mViewer)
        };
        return eDwSetViewCameraCmd
    }(eDwSupportsHistoryCmd);
    return eDwSetViewCameraCmd
}));
define("eDwSetViewCmd", ["require", "exports", "eDwSetViewCameraCmd"], (function (require, exports, eDwSetViewCameraCmd) {
    "use strict";
    var eDwSetViewCmd = function (_super) {
        __extends(eDwSetViewCmd, _super);

        function eDwSetViewCmd(iViewer, iOrientation) {
            var _this = _super.call(this, iViewer) || this;
            _this.mViewOrientation = iOrientation;
            return _this
        }

        eDwSetViewCmd.prototype.setView = function () {
            return this.mViewer.ViewMgr.setViewOrientation(this.mViewOrientation)
        };
        return eDwSetViewCmd
    }(eDwSetViewCameraCmd);
    return eDwSetViewCmd
}));
define("eDwSetViewNormalToSectionCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwSetViewNormalToSectionCmd = function (_super) {
        __extends(eDwSetViewNormalToSectionCmd, _super);

        function eDwSetViewNormalToSectionCmd(iViewer) {
            return _super.call(this, iViewer) || this
        }

        eDwSetViewNormalToSectionCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mInitialCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetViewNormalToSectionCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mFinalCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwSetViewNormalToSectionCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var viewHC;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            viewHC = this.mViewer.getHCView();
                            this.mInitialCamera = viewHC.getCamera();
                            this.mFinalCamera = this.mViewer.XSectionMgr.setViewToSectionPlane();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwSetViewNormalToSectionCmd.prototype, "Committed", {
            get: function () {
                return _super.prototype.isCommitted.call(this) && !!this.mInitialCamera && !!this.mFinalCamera
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwSetViewNormalToSectionCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwSetViewNormalToSectionCmd
    }(eDwSupportsHistoryCmd);
    return eDwSetViewNormalToSectionCmd
}));
define("eDwShowOnlyCmd", ["require", "exports", "eDwCommandMgr", "eDwCompositeCmd", "eDwSetHierNodeAttribsCmd", "eDwNodeAttributes"], (function (require, exports, eDwCommandMgr, eDwCompositeCmd, eDwSetHierNodeAttribsCmd, eDwNodeAttributes_5) {
    "use strict";
    var eDwShowOnlyCmd = function (_super) {
        __extends(eDwShowOnlyCmd, _super);

        function eDwShowOnlyCmd(iViewer, iHierNodes) {
            if (iHierNodes === void 0) {
                iHierNodes = []
            }
            var _this = _super.call(this, iViewer) || this;
            _this.FinalState = true;
            var model = iViewer.getModel();
            var modelView = model.getActiveModelView();
            var modelViewHierNode = modelView.Hierarchy;
            var childHierNodes = [];
            modelViewHierNode.getAllChildren(childHierNodes);
            if (iHierNodes.length) {
                childHierNodes = childHierNodes.filter((function (hierNode) {
                    return iHierNodes.indexOf(hierNode) === -1
                }));
                _this.FinalState = false;
                var attribs_1 = new eDwNodeAttributes_5.eDwNodeAttributes;
                attribs_1.Visible = true;
                _this.mSetHierNodeVisCmd = new eDwSetHierNodeAttribsCmd(_this.mViewer, iHierNodes, attribs_1)
            }
            _this.InitialState = !_this.FinalState;
            var attribs = new eDwNodeAttributes_5.eDwNodeAttributes;
            attribs.Visible = _this.FinalState;
            _this.mSetHierNodeAttribsCmd = new eDwSetHierNodeAttribsCmd(_this.mViewer, childHierNodes, attribs);
            return _this
        }

        eDwShowOnlyCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var cmdMgr;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            cmdMgr = eDwCommandMgr.get();
                            return [4, cmdMgr.run(this.mSetHierNodeAttribsCmd, "commit")];
                        case 1:
                            _a.sent();
                            return [4, cmdMgr.run(this.mSetHierNodeVisCmd, "commit")];
                        case 2:
                            _a.sent();
                            return [4, _super.prototype.commit.call(this)];
                        case 3:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwShowOnlyCmd.prototype.isCommitted = function () {
            var visCmdCommitted = this.mSetHierNodeVisCmd ? this.mSetHierNodeVisCmd.isCommitted : true;
            return _super.prototype.isCommitted.call(this) && visCmdCommitted && this.mSetHierNodeAttribsCmd.isCommitted()
        };
        Object.defineProperty(eDwShowOnlyCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwShowOnlyCmd
    }(eDwCompositeCmd);
    ///PLM TEST
    eDwShowOnlyCmdg = eDwShowOnlyCmd;
    return eDwShowOnlyCmd
}));
define("eDwShowSectionCapCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwShowSectionCapCmd = function (_super) {
        __extends(eDwShowSectionCapCmd, _super);

        function eDwShowSectionCapCmd(iViewer, iVisible) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialVisibility = _this.mViewer.XSectionMgr.SectionCapVisibility;
            _this.mFinalVisibility = iVisible;
            return _this
        }

        eDwShowSectionCapCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.SectionCapVisibility = this.mInitialVisibility;
                            return [2, true]
                    }
                }))
            }))
        };
        eDwShowSectionCapCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.XSectionMgr.SectionCapVisibility = this.mFinalVisibility;
                            return [2, true]
                    }
                }))
            }))
        };
        eDwShowSectionCapCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            this.mViewer.XSectionMgr.SectionCapVisibility = this.mFinalVisibility;
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwShowSectionCapCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwShowSectionCapCmd
    }(eDwSupportsHistoryCmd);
    return eDwShowSectionCapCmd
}));
define("eDwSupportsHistoryCmd", ["require", "exports", "eDwHistoryMgr", "eDwCmd"], (function (require, exports, eDwHistoryMgr, eDwCmd) {
    "use strict";
    var eDwSupportsHistoryCmd = function (_super) {
        __extends(eDwSupportsHistoryCmd, _super);

        function eDwSupportsHistoryCmd(iViewer) {
            var _this = _super.call(this, iViewer) || this;
            _this.mAddedToHistory = false;
            _this.mUndone = false;
            return _this
        }

        eDwSupportsHistoryCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var ret;
                return __generator(this, (function (_a) {
                    ret = this.isCommitted() && !this.isUndone();
                    this.mUndone = true;
                    return [2, ret]
                }))
            }))
        };
        eDwSupportsHistoryCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var ret;
                return __generator(this, (function (_a) {
                    ret = this.isCommitted() && this.isUndone();
                    this.mUndone = false;
                    return [2, ret]
                }))
            }))
        };
        eDwSupportsHistoryCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            eDwHistoryMgr.get().push(this);
                            this.mAddedToHistory = true;
                            return [2]
                    }
                }))
            }))
        };
        eDwSupportsHistoryCmd.prototype.cancel = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.cancel.call(this)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwSupportsHistoryCmd.prototype.isCommitted = function () {
            return this.mAddedToHistory
        };
        eDwSupportsHistoryCmd.prototype.isUndone = function () {
            return this.mUndone
        };
        return eDwSupportsHistoryCmd
    }(eDwCmd);
    return eDwSupportsHistoryCmd
}));
define("eDwTableMgr", ["require", "exports"], (function (require, exports) {
    "use strict";
    var eDwTableMgr = function () {
        function eDwTableMgr(iViewer) {
            this.mViewer = iViewer;
            this.mTables = []
        }

        eDwTableMgr.prototype.numTables = function () {
            return this.mTables.length
        };
        eDwTableMgr.prototype.getTables = function () {
            return this.mTables
        };
        eDwTableMgr.prototype.add = function (iHierNode) {
            if (!iHierNode || iHierNode.Category !== "table") return;
            this.mTables.push(iHierNode)
        };
        return eDwTableMgr
    }();
    return eDwTableMgr
}));
define("eDwTimer", ["require", "exports", "utils"], (function (require, exports, utils) {
    "use strict";
    var eDwTimer = function () {
        function eDwTimer() {
            this.start()
        }

        eDwTimer.prototype.start = function () {
            this.mMilliSeconds = 0;
            this.mSeconds = 0;
            this.mMinutes = 0;
            this.mHours = 0;
            this.mDays = 0;
            this.mStart = new Date
        };
        eDwTimer.prototype.ellapsed = function () {
            var endDate = new Date;
            var timeDiff = endDate.valueOf() - this.mStart.valueOf();
            this.mMilliSeconds = Math.round(timeDiff % 1e3);
            timeDiff = Math.floor(timeDiff / 1e3);
            this.mSeconds = Math.round(timeDiff % 60);
            timeDiff = Math.floor(timeDiff / 60);
            this.mMinutes = Math.round(timeDiff % 60);
            timeDiff = Math.floor(timeDiff / 60);
            this.mHours = Math.round(timeDiff % 24);
            this.mDays = Math.floor(timeDiff / 24);
            return this
        };
        eDwTimer.prototype.dumpToConsole = function (iPreface) {
            function asTime(iNumber) {
                var number = utils.isNumber(iNumber) ? iNumber : 0;
                return number < 10 ? "0" + iNumber : iNumber.toString()
            }

            var preface = iPreface ? iPreface + " " : "";
            var hours = this.mDays * 24 + this.mHours;
            console.debugLog("Timer", preface + "Elapsed time = " + asTime(hours) + ":" + asTime(this.mMinutes) + ":" + asTime(this.mSeconds) + " and " + this.mMilliSeconds + " milliseconds")
        };
        Object.defineProperty(eDwTimer.prototype, "Days", {
            get: function () {
                return this.mDays
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwTimer.prototype, "Hours", {
            get: function () {
                return this.mHours
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwTimer.prototype, "Minutes", {
            get: function () {
                return this.mMinutes
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwTimer.prototype, "Seconds", {
            get: function () {
                return this.mSeconds
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwTimer.prototype, "MilliSeconds", {
            get: function () {
                return this.mMilliSeconds
            }, enumerable: false, configurable: true
        });
        return eDwTimer
    }();
    return eDwTimer
}));
define("eDwTouchOpsMgr", ["require", "exports", "utils"], (function (require, exports, utils) {
    "use strict";
    var eDwTouchOpsMgr = function () {
        function eDwTouchOpsMgr(iViewer) {
            iViewer.TouchOpsMgr = this;
            this.mViewer = iViewer
        }

        eDwTouchOpsMgr.prototype.unregister = function () {
            var e_54, _a;
            if (!eDwTouchOpsMgr.isTouchEnabled()) return;
            try {
                for (var _b = __values(this.mTouchOpIDs), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var touchOpID = _c.value;
                    this.mViewer.OperatorMgr.unregisterCustomOperatorByID(touchOpID)
                }
            } catch (e_54_1) {
                e_54 = {error: e_54_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_54) throw e_54.error
                }
            }
            delete this.mViewer.TouchOpsMgr
        };
        eDwTouchOpsMgr.prototype.addOp = function (iOp) {
            if (!eDwTouchOpsMgr.isTouchEnabled()) return -1;
            var opID = this.mViewer.OperatorMgr.registerCustomOperator(iOp, true);
            this.mTouchOpIDs.push(opID);
            return opID
        };
        eDwTouchOpsMgr.prototype.removeOp = function (iOpID) {
            if (!eDwTouchOpsMgr.isTouchEnabled() || iOpID < 0) return;
            var opIndex = this.mTouchOpIDs.indexOf(iOpID);
            if (opIndex > -1) {
                this.mTouchOpIDs.splice(opIndex, 1);
                this.mViewer.OperatorMgr.unregisterCustomOperatorByID(iOpID)
            }
        };
        eDwTouchOpsMgr.isTouchEnabled = function () {
            function matchMedia(iFeature) {
                return window.matchMedia && window.matchMedia(iFeature).matches ? true : false
            }

            var enabled = false;
            if ("PointerEvent" in window && "maxTouchPoints" in navigator) {
                var maxTouchPoints = navigator.maxTouchPoints;
                if (utils.isNumber(maxTouchPoints)) {
                    if (navigator.maxTouchPoints > 0) {
                        enabled = true
                    } else if (navigator.maxTouchPoints === 0 && matchMedia("(any-pointer:coarse)")) {
                        enabled = true
                    }
                }
            } else {
                if (matchMedia("(any-pointer:coarse)")) {
                    enabled = true
                } else if ("TouchEvent" in window || "ontouchstart" in window) {
                    enabled = true
                }
            }
            console.debugLog("TouchOps", "Touch enabled = " + enabled);
            return enabled
        };
        eDwTouchOpsMgr.initJQTouch = function () {
            if (!eDwTouchOpsMgr.isTouchEnabled()) return false;
            var origMouseFuncs = {};
            origMouseFuncs["_mouseInit"] = $.ui.mouse.prototype._mouseInit;
            origMouseFuncs["_mouseDestroy"] = $.ui.mouse.prototype._mouseDestroy;

            function touchCommon(iMouseFuncName, iMouseFunc) {
                var action = iMouseFuncName === "_mouseInit" ? "bind" : "unbind";
                iMouseFunc.element[action]({
                    touchstart: $.proxy(iMouseFunc, "_touchStart"),
                    touchmove: $.proxy(iMouseFunc, "_touchMove"),
                    touchend: $.proxy(iMouseFunc, "_touchEnd")
                });
                origMouseFuncs[iMouseFuncName].call(iMouseFunc)
            }

            function processEvent(iEvent, iEventName) {
                if (iEvent.touches.length === 1) {
                    iEvent.preventDefault();
                    var touch = iEvent.changedTouches[0];
                    var newEvent = document.createEvent("MouseEvents");
                    newEvent.initMouseEvent(iEventName, true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
                    iEvent.target.dispatchEvent(newEvent)
                }
            }

            var touchStarted = false;
            $.extend($.ui.mouse.prototype, {
                _touchStart: function (iEvent) {
                    if (!iEvent || !iEvent.originalEvent) return;
                    var touchEvent = iEvent.originalEvent;
                    if (!touchStarted && this._mouseCapture(touchEvent.changedTouches[0])) {
                        touchStarted = true;
                        this._touchMoved = false;
                        processEvent(touchEvent, "mouseover");
                        processEvent(touchEvent, "mousemove");
                        processEvent(touchEvent, "mousedown")
                    }
                }, _touchMove: function (iEvent) {
                    if (!iEvent || !iEvent.originalEvent || !touchStarted) return;
                    this._touchMoved = true;
                    processEvent(iEvent.originalEvent, "mousemove")
                }, _touchEnd: function (iEvent) {
                    if (!iEvent || !iEvent.originalEvent || !touchStarted) return;
                    var touchEvent = iEvent.originalEvent;
                    processEvent(touchEvent, "mouseup");
                    processEvent(touchEvent, "mouseout");
                    if (!this._touchMoved) processEvent(touchEvent, "click");
                    touchStarted = false
                }, _mouseInit: function () {
                    touchCommon("_mouseInit", this)
                }, _mouseDestroy: function () {
                    touchCommon("_mouseDestroy", this)
                }
            });
            return true
        };
        return eDwTouchOpsMgr
    }();
    return eDwTouchOpsMgr
}));
define("eDwTypes", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.EntityMode = exports.SectionPlaneOrientation = exports.HCI = exports.HC = void 0;
    var HC = Communicator;
    exports.HC = HC;
    var HCI = Communicator.Internal;
    exports.HCI = HCI;
    exports.SectionPlaneOrientation = {
        XY: {
            Plane: HC.Plane.createFromPointAndNormal(new HC.Point3(0, 0, 0), new HC.Point3(0, 0, 1)),
            Index: 0
        },
        YZ: {Plane: HC.Plane.createFromPointAndNormal(new HC.Point3(0, 0, 0), new HC.Point3(1, 0, 0)), Index: 1},
        ZX: {Plane: HC.Plane.createFromPointAndNormal(new HC.Point3(0, 0, 0), new HC.Point3(0, 1, 0)), Index: 2}
    };
    exports.EntityMode = {FACE: 1, EDGE: 2, VERTEX: 4, HOLE: 8, ALL: 4294967295}
}));
define("eDwUI", ["require", "exports", "eDwTypes", "eDwKeyMgr", "eDwUIBaseEventHandlers", "eDwCommandMgr", "eDwZoomToFitCmd", "eDwDrawModeCmd", "eDwAnimateCmd", "eDwAmbientOcclusionCmd", "eDwPerspectiveCmd", "eDwSetViewCmd", "eDwSetViewCameraCmd", "eDwCompositeCmd", "eDwSectionFlipCmd", "eDwSetViewNormalToSectionCmd", "eDwShowSectionCapCmd", "eDwSectionShowCmd", "eDwChangeSectionPlaneCmd", "eDwUIPluginMgr", "eDwEventMgr", "eDwUIMessageReporter", "eDwTouchOpsMgr", "eDwUILocalize", "eDwUIShortcutMenu", "eDwUIUtils", "eDrawingsWebViewerUtils", "eDwEvents", "utils", "jqutils"], (function (require, exports, eDwTypes_14, eDwKeyMgr_3, eDwUIBaseEventHandlers, eDwCommandMgr, eDwZoomToFitCmd, eDwDrawModeCmd, eDwAnimateCmd, eDwAmbientOcclusionCmd, eDwPerspectiveCmd, eDwSetViewCmd, eDwSetViewCameraCmd, eDwCompositeCmd, eDwSectionFlipCmd, eDwSetViewNormalToSectionCmd, eDwShowSectionCapCmd, eDwSectionShowCmd, eDwChangeSectionPlaneCmd, eDwUIPluginMgr, eDwEventMgr, eDwUIMessageReporter, eDwTouchOpsMgr, eDwUILocalize_4, eDwUIShortcutMenu_1, eDwUIUtils, eDrawingsWVUtils, eDwEvents, utils, jqutils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwUI = void 0;
    var eDwUI = function () {
        function eDwUI() {
            this.mUIEventHandlers = new UIEventHandlers(this, eDwUIUtils.getViewerElementName(), c_canvasID);
            this.mItemActiveCallbacks = {};
            this.mItemDeactiveCallbacks = {};
            eDwTouchOpsMgr.initJQTouch();
            this.awfulUIHacks()
        }

        eDwUI.prototype.initUIEvents = function (iViewerFeatOpts) {
            this.mViewerFeatureOpts = iViewerFeatOpts;
            this.registerHTMLEvents()
        };
        eDwUI.prototype.init = function (iViewer) {
            var _this = this;
            this.mViewer = iViewer;
            this.centerBottomBar();
            this.mViewer.XSectionMgr.SectionCapVisibility = true;
            $("#edrawings-section-capping-button").addClass("state-on-button");
            $("#edrawings-section-show-button").addClass("state-on-button");
            eDwUIUtils.hide(".edrawings-ui-main", false);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents.ResetSceneEvent, true)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUI.prototype.toggleFullScreen = function () {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var methodName, viewerElem, iExcp_14;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                methodName = "exitFullScreen()";
                                _a.label = 1;
                            case 1:
                                _a.trys.push([1, 6, , 7]);
                                if (!l_isFullScreen()) return [3, 3];
                                document.exitFullscreen = document.exitFullscreen || utils.getFirstMatchedMethodObj(document, "xitFullscreen");
                                if (!document.exitFullscreen) {
                                    console.warn("exitFullscreen() does not exist.");
                                    return [2]
                                }
                                return [4, document.exitFullscreen()];
                            case 2:
                                _a.sent();
                                return [3, 5];
                            case 3:
                                methodName = "requestFullscreen()";
                                viewerElem = $("#edrawings-viewer")[0];
                                viewerElem.requestFullscreen = viewerElem.requestFullscreen || utils.getFirstMatchedMethodObj(viewerElem, "equestFullscreen");
                                if (!viewerElem.requestFullscreen) {
                                    console.warn("requestFullscreen() does not exist.");
                                    return [2]
                                }
                                return [4, viewerElem.requestFullscreen()];
                            case 4:
                                _a.sent();
                                _a.label = 5;
                            case 5:
                                return [3, 7];
                            case 6:
                                iExcp_14 = _a.sent();
                                console.warn(methodName + " failed.  It took too long.");
                                return [3, 7];
                            case 7:
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUI.prototype.unregister = function () {
            this.unregisterHTMLEvents();
            UIEventHandlers.doModelDataUnloadActions(this.mViewer)
        };
        eDwUI.prototype.setDrawMode = function (iValue) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var drawModeCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                drawModeCmd = new eDwDrawModeCmd(this.mViewer, iValue);
                                return [4, eDwCommandMgr.get().run(drawModeCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUI.prototype.setInitialDrawMode = function () {
            if (!this.mViewer.ViewerFeatureOpts.RenderType) return;
            this.setDrawMode(this.mViewer.ViewerFeatureOpts.RenderType)
        };
        eDwUI.prototype.setPerspectiveMode = function (iValue) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var perspectiveCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                perspectiveCmd = new eDwPerspectiveCmd(this.mViewer, iValue);
                                return [4, eDwCommandMgr.get().run(perspectiveCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUI.prototype.hideAllOtherPanels = function (iPanelCSSClassName) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!(iPanelCSSClassName !== ".edrawings-hud-menu")) return [3, 2];
                            return [4, this.hideActiveHUDMenu()];
                        case 1:
                            _a.sent();
                            _a.label = 2;
                        case 2:
                            if (!(iPanelCSSClassName !== ".edrawings-submenu")) return [3, 4];
                            return [4, this.hideActiveSubmenu()];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide();
                            return [2]
                    }
                }))
            }))
        };
        eDwUI.prototype.onClick = function (iID, iActivate) {
            var activateCallback = this.mItemActiveCallbacks[iID];
            var deactivateCallback = this.mItemDeactiveCallbacks[iID];
            if (iActivate) {
                if (activateCallback) activateCallback()
            } else {
                if (deactivateCallback) deactivateCallback()
            }
            return activateCallback || deactivateCallback ? true : false
        };
        eDwUI.prototype.registerHTMLEvents = function () {
            var _this = this;
            this.mUIEventHandlers.addHTMLEventHandlers(this.mViewerFeatureOpts);
            this.mModelDataLoadCompleteHandler = function (iEvent, iViewer) {
                _this.mViewer = iViewer;
                eDwUIBaseEventHandlers.doModelDataLoadCompleteActions(_this.mUIEventHandlers, iViewer)
            };
            $("#" + c_canvasID).on("edw:ModelDataLoadComplete", this.mModelDataLoadCompleteHandler);
            var self = this;
            this.registerButtonForClickEffect("edrawings-section-flip-button", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var sectionFlipCmd;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    sectionFlipCmd = new eDwSectionFlipCmd(this.mViewer);
                                    return [4, eDwCommandMgr.get().run(sectionFlipCmd, "commit")];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            this.registerButtonForClickEffect("edrawings-section-normal-button", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var setViewNormalToSectionCmd;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    setViewNormalToSectionCmd = new eDwSetViewNormalToSectionCmd(this.mViewer);
                                    return [4, eDwCommandMgr.get().run(setViewNormalToSectionCmd, "commit")];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));

            function setXSectionOrientation(iEvent, iUI, iOrientation) {
                iUI.setXSectionOrientation(iOrientation);
                eDwUIUtils.scrollToTarget(jqutils.getAsJQueryObj(iEvent.currentTarget))
            }

            $("#edrawings-section-xz-button").on("click.edw", (function (iEvent) {
                return setXSectionOrientation(iEvent, _this, eDwTypes_14.SectionPlaneOrientation.ZX)
            }));
            $("#edrawings-section-yz-button").on("click.edw", (function (iEvent) {
                return setXSectionOrientation(iEvent, _this, eDwTypes_14.SectionPlaneOrientation.YZ)
            }));
            $("#edrawings-section-xy-button").on("click.edw", (function (iEvent) {
                return setXSectionOrientation(iEvent, _this, eDwTypes_14.SectionPlaneOrientation.XY)
            }));
            $("#edrawings-section-capping-button").on("click.edw", (function (iEvent) {
                var buttonJQ = jqutils.getAsJQueryObj(iEvent.currentTarget);
                var visibility = !buttonJQ.hasClass("state-on-button");
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var showCapsCmd;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    showCapsCmd = new eDwShowSectionCapCmd(this.mViewer, visibility);
                                    return [4, eDwCommandMgr.get().run(showCapsCmd, "commit")];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })();
                buttonJQ.toggleClass("state-on-button");
                eDwUIUtils.scrollToTarget(buttonJQ)
            }));
            $("#edrawings-section-show-button").on("click.edw", (function (iEvent) {
                var buttonJQ = jqutils.getAsJQueryObj(iEvent.currentTarget);
                var showSection = !buttonJQ.hasClass("state-on-button");
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var showSectionCmd;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    showSectionCmd = new eDwSectionShowCmd(this.mViewer, showSection);
                                    return [4, eDwCommandMgr.get().run(showSectionCmd, "commit")];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })();
                buttonJQ.toggleClass("state-on-button");
                eDwUIUtils.scrollToTarget(buttonJQ)
            }));
            this.mItemActiveCallbacks["#edrawings-button-section"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    function compositeSectionDone(ioCmd) {
                        ioCmd.clearSubCmds();
                        self.mViewer.XSectionMgr.deactivateCurrent();
                        self.mViewer.XSectionMgr.turnOnSectionPlane(false)
                    }

                    var self;
                    var _this = this;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                eDwUIUtils.addPanelModeEvents("#edrawings-section-menu", ".edw.section", "#edrawings-button-section");
                                this.mCompositeXSectionCmd = new eDwCompositeCmd(this.mViewer);
                                eDwCommandMgr.get().add(this.mCompositeXSectionCmd);
                                this.mCompositeXSectionCmd.initCmdActionImplementation({
                                    compositeInit: function (ioCmd) {
                                        return __awaiter(_this, void 0, void 0, (function () {
                                            return __generator(this, (function (_a) {
                                                this.mViewer.XSectionMgr.turnOnSectionPlane(true);
                                                this.setXSectionOrientation();
                                                return [2]
                                            }))
                                        }))
                                    }, compositeUndo: function (ioCmd) {
                                        return __awaiter(_this, void 0, void 0, (function () {
                                            return __generator(this, (function (_a) {
                                                return [2, true]
                                            }))
                                        }))
                                    }, compositeRedo: function (ioCmd) {
                                        return __awaiter(_this, void 0, void 0, (function () {
                                            return __generator(this, (function (_a) {
                                                return [2, true]
                                            }))
                                        }))
                                    }, compositeCommit: function (ioCmd) {
                                        return __awaiter(_this, void 0, void 0, (function () {
                                            return __generator(this, (function (_a) {
                                                compositeSectionDone(ioCmd);
                                                return [2]
                                            }))
                                        }))
                                    }, compositeCancel: function (ioCmd) {
                                        return __awaiter(_this, void 0, void 0, (function () {
                                            return __generator(this, (function (_a) {
                                                compositeSectionDone(ioCmd);
                                                return [2]
                                            }))
                                        }))
                                    }
                                });
                                self = this;
                                if (!!this.mViewer.getModel().isDrawing()) return [3, 2];
                                return [4, this.setActiveSubmenu("#edrawings-button-section", "#edrawings-section-menu")];
                            case 1:
                                _a.sent();
                                _a.label = 2;
                            case 2:
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemDeactiveCallbacks["#edrawings-button-section"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                eDwUIUtils.deactivateMoveInput(".edw.section");
                                return [4, eDwCommandMgr.get().remove(this.mCompositeXSectionCmd, "cancel")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            eDwEventMgr.get().addEventHandlerFunc(eDwEvents.DeactivateUIOpEvent, (function (iActiveButtonsJQ) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                if (!(iActiveButtonsJQ[0].id === "edrawings-button-section")) return [3, 2];
                                return [4, this.mItemDeactiveCallbacks["#edrawings-button-section"]()];
                            case 1:
                                _a.sent();
                                _a.label = 2;
                            case 2:
                                return [2]
                        }
                    }))
                }))
            }));

            function activateDebugPanel(iActivate, iHandlers) {
                return __awaiter(this, void 0, void 0, (function () {
                    var shortcutMenu;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, togglePanel(iActivate, "#edrawings-button-debug", "#edrawings-debug-menu", ".edw.debug", iHandlers)];
                            case 1:
                                _a.sent();
                                if (iActivate) {
                                    shortcutMenu = eDwUIShortcutMenu_1.eDwUIShortcutMenu.get();
                                    if (!shortcutMenu.isEmpty()) {
                                        shortcutMenu.addMenuSeparator(c_debugGroupName)
                                    }
                                    shortcutMenu.addMenuItem(c_debugGroupName, "NOLOCALIZE:Show Matrices", (function (iEvent, iUIItemJQ, iArg) {
                                        if (utils.isOfType(iArg, "attr")) {
                                            var nodeIDHC = parseInt(iArg.attr("data-hoopsid"), 10);
                                            if (utils.isNumber(nodeIDHC)) {
                                                var modelHC = self.mViewer.getModel().getHCModel();
                                                var matrixHC = modelHC.getNodeMatrix(nodeIDHC);
                                                var msg = "<div>Matrix = " + JSON.stringify(matrixHC) + "</div>";
                                                matrixHC = modelHC.getNodeNetMatrix(nodeIDHC);
                                                msg += "<div>Net matrix = " + JSON.stringify(matrixHC) + "</div>";
                                                eDwUIMessageReporter.showMessageInDebugPanel(msg)
                                            }
                                        }
                                        eDwUIShortcutMenu_1.eDwUIShortcutMenu.hide()
                                    }))
                                } else {
                                    eDwUIShortcutMenu_1.eDwUIShortcutMenu.get().removeAllMenuItems(c_debugGroupName)
                                }
                                return [2]
                        }
                    }))
                }))
            }

            this.mItemActiveCallbacks["#edrawings-button-debug"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateDebugPanel(true, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemDeactiveCallbacks["#edrawings-button-debug"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateDebugPanel(false, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            eDwEventMgr.get().addEventHandlerFunc(eDwEvents.DeactivateUIOpEvent, (function (iActiveButtonsJQ) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                if (!(iActiveButtonsJQ[0].id === "edrawings-button-debug")) return [3, 2];
                                return [4, this.mItemDeactiveCallbacks["#edrawings-button-debug"]()];
                            case 1:
                                _a.sent();
                                _a.label = 2;
                            case 2:
                                return [2]
                        }
                    }))
                }))
            }));
            this.mItemActiveCallbacks["#edrawings-button-reset"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var _this = this;
                    return __generator(this, (function (_a) {
                        eDwUIUtils.resetToHomeView(this.mViewer);
                        window.setTimeout((function () {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, eDwUIUtils.deactivateUI()];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })()
                        }), 1e3);
                        return [2]
                    }))
                }))
            };
            $(document).on(c_fullScreenChange, (function (iEvent) {
                if (l_isFullScreen()) {
                    l_fullScreenBtnJS.removeClass(c_restoreClass)
                } else {
                    l_fullScreenBtnJS.addClass(c_restoreClass);
                    $("#edrawings-canvas-canvas-container").css({"background-color": ""})
                }
            }));
            $("#edrawings-button-fs").on("click.edw", (function () {
                _this.toggleFullScreen()
            }));

            function clickDrawMode(iUI, iMode) {
                var _this = this;
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    iUI.setDrawMode(iMode);
                                    return [4, iUI.hideActiveHUDMenu()];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }

            $("#edrawings-button-shaded-hlrr").on("click.edw", (function () {
                clickDrawMode(_this, "HiddenLinesRemoved")
            }));
            $("#edrawings-button-shaded-hlrv").on("click.edw", (function () {
                clickDrawMode(_this, "HiddenLinesVisible")
            }));
            $("#edrawings-button-shaded-wireframe").on("click.edw", (function () {
                clickDrawMode(_this, "Wireframe")
            }));
            $("#edrawings-button-shaded-full").on("click.edw", (function () {
                clickDrawMode(_this, "ShadedWithEdges")
            }));
            $("#edrawings-button-shaded-noedges").on("click.edw", (function () {
                clickDrawMode(_this, "Shaded")
            }));
            this.mItemActiveCallbacks["#edrawings-button-animate"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var animateCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                animateCmd = new eDwAnimateCmd(this.mViewer);
                                return [4, eDwCommandMgr.get().run(animateCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemDeactiveCallbacks["#edrawings-button-animate"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.mItemActiveCallbacks["#edrawings-button-animate"]()];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            $("#edrawings-button-frame-file-open").on("click.edw", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.hideActiveHUDMenu()];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            this.mItemActiveCallbacks["#edrawings-button-view"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.setActiveHUDMenu("#edrawings-button-view", "#edrawings-hud-view-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemActiveCallbacks["#edrawings-button-help"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var version, viewerHC;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                version = "<div>" + eDwUILocalize_4.eDwUILocalize.getString("Text.Version") + eDrawingsWVUtils.getViewerVersion() + "</div>";
                                if (this.mViewerFeatureOpts.Debug) {
                                    viewerHC = this.mViewer.HCViewer;
                                    version += "<div>" + eDwUILocalize_4.eDwUILocalize.getString("Text.HCVersion") + " " + viewerHC.getViewerVersionString() + "</div><div>" + eDwUILocalize_4.eDwUILocalize.getString("Text.FormatVersion") + " " + viewerHC.getFormatVersionString() + "<div>"
                                }
                                $("#edrawings-version").html(version);
                                return [4, this.setActiveHUDMenu("#edrawings-button-help", "#edrawings-hud-help-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            $("#edrawings-hud-help-close").on("click.edw", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.hideActiveHUDMenu()];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            this.mItemActiveCallbacks["#edrawings-button-zoomtofit"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var viewHC, curModelView, nodeID, zoomToFitCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                viewHC = this.mViewer.getHCView();
                                curModelView = this.mViewer.getModel().getActiveModelView();
                                nodeID = curModelView.Hierarchy.HOOPSID;
                                zoomToFitCmd = new eDwZoomToFitCmd(this.mViewer, nodeID, viewHC.getCamera());
                                return [4, eDwCommandMgr.get().run(zoomToFitCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemActiveCallbacks["#edrawings-button-shaded"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.setActiveHUDMenu("#edrawings-button-shaded", "#edrawings-hud-shaded-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };

            function togglePanel(iActivate, iButtonID, iPanelID, iInputEventIDSuffix, iHandlers) {
                return __awaiter(this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                if (!iActivate) return [3, 2];
                                return [4, self.setActiveSubmenu(iButtonID, iPanelID)];
                            case 1:
                                _a.sent();
                                eDwUIUtils.addPanelModeEvents(iPanelID, iInputEventIDSuffix, iButtonID);
                                return [3, 3];
                            case 2:
                                eDwUIUtils.deactivateMoveInput(iInputEventIDSuffix);
                                _a.label = 3;
                            case 3:
                                return [2]
                        }
                    }))
                }))
            }

            function activateSheetPanel(iActivate, iHandlers) {
                return __awaiter(this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, togglePanel(iActivate, "#edrawings-button-sheet-tree", "#edrawings-sheet-tree-menu", ".edw.sheet", iHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            }

            this.mItemActiveCallbacks["#edrawings-button-sheet-tree"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateSheetPanel(true, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemDeactiveCallbacks["#edrawings-button-sheet-tree"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateSheetPanel(false, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            eDwEventMgr.get().addEventHandlerFunc(eDwEvents.DeactivateUIOpEvent, (function (iActiveButtonsJQ) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                if (!(iActiveButtonsJQ[0].id === "edrawings-button-sheet-tree")) return [3, 2];
                                return [4, this.mItemDeactiveCallbacks["#edrawings-button-sheet-tree"]()];
                            case 1:
                                _a.sent();
                                _a.label = 2;
                            case 2:
                                return [2]
                        }
                    }))
                }))
            }));

            function activateLayerPanel(iActivate, iHandlers) {
                return __awaiter(this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, togglePanel(iActivate, "#edrawings-button-layer-control", "#edrawings-layer-control-menu", ".edw.layer", iHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            }

            this.mItemActiveCallbacks["#edrawings-button-layer-control"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateLayerPanel(true, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemDeactiveCallbacks["#edrawings-button-layer-control"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, activateLayerPanel(false, this.mUIEventHandlers)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            eDwEventMgr.get().addEventHandlerFunc(eDwEvents.DeactivateUIOpEvent, (function (iActiveButtonsJQ) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                if (!(iActiveButtonsJQ[0].id === "edrawings-button-layer-control")) return [3, 2];
                                return [4, this.mItemDeactiveCallbacks["#edrawings-button-layer-control"]()];
                            case 1:
                                _a.sent();
                                _a.label = 2;
                            case 2:
                                return [2]
                        }
                    }))
                }))
            }));
            eDwKeyMgr_3.eDwKeyMgr.get().add({key: "F11"}, "keydown", (function (iEvent) {
                iEvent.preventDefault();
                _this.toggleFullScreen();
                iEvent.stopPropagation()
            }));
            this.mItemActiveCallbacks["#edrawings-button-view-settings"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.setActiveHUDMenu("#edrawings-button-view-settings", "#edrawings-hud-view-settings-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            this.mItemActiveCallbacks["#edrawings-button-languages"] = function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.setActiveHUDMenu("#edrawings-button-languages", "#edrawings-hud-languages-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            };
            var ambientOcc = $("#edrawings-button-view-ambient-occlusion");
            ambientOcc.on("click.edw", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var buttonActive, ambientOcclCmd;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    buttonActive = ambientOcc.hasClass("state-on-button");
                                    return [4, this.hideActiveHUDMenu()];
                                case 1:
                                    _a.sent();
                                    if (buttonActive) ambientOcc.removeClass("state-on-button"); else ambientOcc.addClass("state-on-button");
                                    ambientOcclCmd = new eDwAmbientOcclusionCmd(this.mViewer, !buttonActive);
                                    return [4, eDwCommandMgr.get().run(ambientOcclCmd, "commit")];
                                case 2:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            $("#edrawings-button-view-perspective").on("click.edw", (function () {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var perspectiveMode;
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.hideActiveHUDMenu()];
                                case 1:
                                    _a.sent();
                                    perspectiveMode = !this.mViewer.getPerspectiveMode();
                                    this.setPerspectiveMode(perspectiveMode);
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            this.registerButtonForClickEffect("edrawings-button-view-top", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Top)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-bottom", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Bottom)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-left", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Left)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-right", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Right)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-front", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Front)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-back", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Back)
            }));
            this.registerButtonForClickEffect("edrawings-button-view-iso", (function () {
                _this.setViewOrientation(eDwTypes_14.HC.ViewOrientation.Iso)
            }))
        };
        eDwUI.prototype.unregisterHTMLEvents = function () {
            this.mUIEventHandlers.removeHTMLEventHandlers();
            $("#" + c_canvasID).off("edw:ModelDataLoadComplete", this.mModelDataLoadCompleteHandler);
            $("#edrawings-section-xz-button").off("click.edw");
            $("#edrawings-section-yz-button").off("click.edw");
            $("#edrawings-section-xy-button").off("click.edw");
            $("#edrawings-section-capping-button").off("click.edw");
            $("#edrawings-section-show-button").off("click.edw");
            $("#edrawings-button-fs").off("click.edw");
            $("#edrawings-button-shaded-hlrr").off("click.edw");
            $("#edrawings-button-shaded-hlrv").off("click.edw");
            $("#edrawings-button-shaded-wireframe").off("click.edw");
            $("#edrawings-button-shaded-full").off("click.edw");
            $("#edrawings-button-shaded-noedges").off("click.edw");
            $("#edrawings-button-sheets").off("click.edw");
            $("#edrawings-button-frame-file-open").off("click.edw");
            $("#edrawings-button-view-ambient-occlusion").off("click.edw");
            $("#edrawings-button-view-perspective").off("click.edw");
            $("#edrawings-hud-help-close").off("click.edw");
            $(document).off(c_fullScreenChange);
            $(document).off("click.edw");
            $(document).off("mousedown.edw");
            $(document).off("dblclick.edw");
            this.unregisterButtonForClickEffect("edrawings-section-flip-button");
            this.unregisterButtonForClickEffect("edrawings-section-normal-button");
            this.unregisterButtonForClickEffect("edrawings-face-normal-button");
            this.unregisterButtonForClickEffect("edrawings-button-view-top");
            this.unregisterButtonForClickEffect("edrawings-button-view-bottom");
            this.unregisterButtonForClickEffect("edrawings-button-view-left");
            this.unregisterButtonForClickEffect("edrawings-button-view-right");
            this.unregisterButtonForClickEffect("edrawings-button-view-front");
            this.unregisterButtonForClickEffect("edrawings-button-view-back");
            this.unregisterButtonForClickEffect("edrawings-button-view-iso")
        };
        eDwUI.prototype.setActiveSubmenu = function (iButtonID, iPanelID) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwUIUtils.activateUI(iButtonID, iPanelID)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUI.prototype.hideActiveSubmenu = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwUIUtils.deactivateUI(".edrawings-tool-button", ".edrawings-submenu")];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUI.prototype.centerBottomBar = function (iWidth, iHeight) {
            $(".tool-bar").css({height: "auto"});
            var barJQ = $(".tool-bar");
            var viewerElemJQ = $(eDwUIUtils.getViewerElementID());
            var leftButtonsJQ = $(".edrawings-icon-set.left");
            var rightButtonsJQ = $(".edrawings-icon-set.right");
            var centerButtonsJQ = $(".edrawings-icon-set.center");
            var width = (iWidth ? iWidth : viewerElemJQ.width()) - 1;
            barJQ.css({position: "absolute"});
            leftButtonsJQ.css({left: 1 + "px", position: "absolute"});
            rightButtonsJQ.css({right: 1 + "px", position: "absolute"});
            centerButtonsJQ.css({left: width / 2 - 52 / 2 + "px", position: "absolute"})
        };
        eDwUI.prototype.setActiveHUDMenu = function (iButtonID, iPanelID) {
            return __awaiter(this, void 0, void 0, (function () {
                var buttonJQ, buttonOffset, posx, posy, canvasWidth, panelJQ, panelWidth;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.hideActiveHUDMenu()];
                        case 1:
                            _a.sent();
                            return [4, eDwUIUtils.activateUI(iButtonID, iPanelID)];
                        case 2:
                            _a.sent();
                            if (iButtonID !== "#edrawings-button-help") {
                                buttonJQ = $(iButtonID);
                                buttonOffset = buttonJQ.offset();
                                posx = buttonOffset.left;
                                posy = buttonOffset.top + parseInt(buttonJQ.css("marginTop")) + parseInt(buttonJQ.css("borderTopWidth")) + buttonJQ.height();
                                canvasWidth = $("#edrawings-canvas").width();
                                panelJQ = $(iPanelID);
                                panelWidth = panelJQ[0].offsetWidth;
                                if (posx + panelWidth > canvasWidth) {
                                    posx = canvasWidth - panelWidth - 10
                                }
                                panelJQ.css({top: posy + "px", left: posx + "px"})
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwUI.prototype.hideActiveHUDMenu = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwUIUtils.deactivateUI(".edrawings-hud-button", ".edrawings-hud-menu")];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUI.prototype.registerButtonForClickEffect = function (iButtonID, iHandler) {
            var butJQ = $("#" + iButtonID);
            butJQ.on("mousedown.edw", (function () {
                butJQ.addClass("edrawings-on-state");
                eDwUIUtils.scrollToTarget(butJQ)
            }));
            butJQ.on("mouseup.edw", (function () {
                butJQ.removeClass("edrawings-on-state");
                iHandler()
            }))
        };
        eDwUI.prototype.unregisterButtonForClickEffect = function (iButtonID) {
            var butJQ = $("#" + iButtonID);
            butJQ.off("mousedown.edw");
            butJQ.off("mouseup.edw")
        };
        eDwUI.prototype.setViewOrientation = function (iOrientation) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var setViewCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                setViewCmd = new eDwSetViewCmd(this.mViewer, iOrientation);
                                return [4, eDwCommandMgr.get().run(setViewCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [4, this.hideActiveHUDMenu()];
                            case 2:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUI.prototype.setXSectionOrientation = function (iNewSection) {
            var _this = this;

            function setActive(iButtonID, iIsActive) {
                $(iButtonID)[iIsActive ? "addClass" : "removeClass"]("state-on-button")
            }

            var sectionMgr = this.mViewer.XSectionMgr;
            var sectionIndex = iNewSection ? iNewSection.Index : sectionMgr.SectionIndex;
            var planeFromEnum = null;
            switch (sectionIndex) {
                case eDwTypes_14.SectionPlaneOrientation.YZ.Index:
                    setActive("#edrawings-section-xy-button", false);
                    setActive("#edrawings-section-yz-button", true);
                    setActive("#edrawings-section-xz-button", false);
                    planeFromEnum = eDwTypes_14.SectionPlaneOrientation.YZ;
                    break;
                case eDwTypes_14.SectionPlaneOrientation.ZX.Index:
                    setActive("#edrawings-section-xy-button", false);
                    setActive("#edrawings-section-yz-button", false);
                    setActive("#edrawings-section-xz-button", true);
                    planeFromEnum = eDwTypes_14.SectionPlaneOrientation.ZX;
                    break;
                case eDwTypes_14.SectionPlaneOrientation.XY.Index:
                    eDwUIUtils.hide("#edrawings-section-xy-button", false);
                    eDwUIUtils.hide("#edrawings-section-yz-button", false);
                    eDwUIUtils.hide("#edrawings-section-xz-button", false);
                    setActive("#edrawings-section-xy-button", true);
                    setActive("#edrawings-section-yz-button", false);
                    setActive("#edrawings-section-xz-button", false);
                    planeFromEnum = eDwTypes_14.SectionPlaneOrientation.XY;
                    break;
                default:
                    console.debugLog("UI", "Unsupported section plane orientation");
                    break
            }
            var origPlaneEnum = null;
            if (sectionIndex !== sectionMgr.SectionIndex) {
                switch (sectionMgr.SectionIndex) {
                    case eDwTypes_14.SectionPlaneOrientation.YZ.Index:
                        origPlaneEnum = eDwTypes_14.SectionPlaneOrientation.YZ;
                        break;
                    case eDwTypes_14.SectionPlaneOrientation.ZX.Index:
                        origPlaneEnum = eDwTypes_14.SectionPlaneOrientation.ZX;
                        break;
                    case eDwTypes_14.SectionPlaneOrientation.XY.Index:
                        origPlaneEnum = eDwTypes_14.SectionPlaneOrientation.XY;
                        break;
                    default:
                        console.debugLog("UI", "Unsupported initial section plane orientation");
                        break
                }
                if (planeFromEnum && origPlaneEnum) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            var changeSectionPlaneCmd;
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        changeSectionPlaneCmd = new eDwChangeSectionPlaneCmd(this.mViewer, origPlaneEnum, planeFromEnum);
                                        return [4, eDwCommandMgr.get().run(changeSectionPlaneCmd, "commit")];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }
            }
        };
        eDwUI.prototype.awfulUIHacks = function () {
            var _this = this;
            l_init = function () {
                $("#edrawings-face-normal-button").removeClass("edrawings-inactive");
                _this.registerButtonForClickEffect("edrawings-face-normal-button", (function () {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            var setViewCameraCmd;
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        setViewCameraCmd = new eDwSetViewCameraCmd(this.mViewer);
                                        return [4, eDwCommandMgr.get().run(setViewCameraCmd, "commit")];
                                    case 1:
                                        _a.sent();
                                        return [4, this.hideActiveHUDMenu()];
                                    case 2:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }))
            };
            l_uninit = function () {
                $("#edrawings-face-normal-button").addClass("edrawings-inactive");
                _this.unregisterButtonForClickEffect("edrawings-face-normal-button")
            }
        };
        return eDwUI
    }();
    exports.eDwUI = eDwUI;
    var UIEventHandlers = function (_super) {
        __extends(UIEventHandlers, _super);

        function UIEventHandlers(iUI, iViewerHTMLID, iViewerHTMLCanvasID) {
            var _this = _super.call(this, iViewerHTMLID, iViewerHTMLCanvasID) || this;
            _this.mUI = iUI;
            return _this
        }

        UIEventHandlers.prototype.addHTMLEventHandlers = function (iViewerFeatOpts) {
            var _this = this;
            _super.prototype.addHTMLEventHandlers.call(this, iViewerFeatOpts);
            $("#edrawings-viewer").on("click.edw", ".edrawings-tool-button", (function (iEvent) {
                _this.onClick(iEvent, ".edrawings-tool-button")
            }));
            $("#edrawings-viewer").on("click.edw", ".edrawings-hud-button", (function (iEvent) {
                _this.onClick(iEvent, ".edrawings-hud-button", ".edrawings-submenu")
            }));
            this.mUIHTMLEventMgr.addEventHandler("window", "beforeunload", (function (iEvent) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        this.mUI.unregister();
                        return [2]
                    }))
                }))
            }));
            this.mUIHTMLEventMgr.addEventHandler("window", "Timeout", (function (iEvent) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        this.mUI.unregister();
                        return [2]
                    }))
                }))
            }));
            $(".edrawings-menu-close").on("click.edw", (function (iEvent) {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.deactivateActiveButton(".edrawings-tool-button")];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            var viewerJQ = $(eDwUIUtils.getViewerElementID());
            viewerJQ.on("edw:ChangeViewerStyling", (function (iEvent, iStyleClassName) {
                viewerJQ.removeClass("edrawings-viewer-regular");
                viewerJQ.removeClass("edrawings-viewer-timeout");
                if (iStyleClassName) viewerJQ.addClass(iStyleClassName)
            }));
            viewerJQ.on("edw:HidePanels", (function (iEvent, iSkipPanelsWithClass) {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.mUI.hideAllOtherPanels(iSkipPanelsWithClass)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            viewerJQ.on("edw:ReInitViewer", (function (iEvent, iViewerFeatOpts) {
                _this.mUI.unregister();
                _this.mUI.initUIEvents(iViewerFeatOpts)
            }))
        };
        UIEventHandlers.prototype.removeHTMLEventHandlers = function () {
            _super.prototype.removeHTMLEventHandlers.call(this);
            $(".edrawings-menu-close").off("click.edw");
            $("#edrawings-viewer").off("click.edw", ".edrawings-tool-button");
            $("#edrawings-viewer").off("click.edw", ".edrawings-hud-button");
            var viewerJQ = $(eDwUIUtils.getViewerElementID());
            viewerJQ.off("edw:ChangeViewerStyling");
            viewerJQ.off("edw:HidePanels");
            viewerJQ.off("edw:ReInitViewer")
        };
        UIEventHandlers.doModelDataUnloadActions = function (iViewer) {
            eDwUIBaseEventHandlers.doModelDataUnloadActions(iViewer)
        };
        UIEventHandlers.prototype.onInit = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var viewerFeatureOpts, model, isDrawing;
                return __generator(this, (function (_a) {
                    viewerFeatureOpts = iViewer.ViewerFeatureOpts;
                    model = iViewer.getModel();
                    isDrawing = model.isDrawing();
                    eDwUIUtils.hide("#edrawings-button-reset", false);
                    eDwUIUtils.hide("#edrawings-button-shaded", isDrawing);
                    eDwUIUtils.hide("#edrawings-button-view-settings", isDrawing);
                    eDwUIUtils.hide("#edrawings-button-animate", isDrawing);
                    eDwUIUtils.hide("#edrawings-button-section", isDrawing);
                    eDwUIUtils.hide("#edrawings-button-view", isDrawing);
                    eDwUIUtils.hide("#edrawings-button-debug", !viewerFeatureOpts.Debug);
                    eDwUIUtils.hide("#edrawings-button-tables-control", isDrawing || iViewer.TableMgr.numTables() === 0);
                    eDwUIUtils.hide("#edrawings-button-sheet-tree", !isDrawing);
                    eDwUIUtils.hide("#edrawings-button-layer-control", !isDrawing);
                    eDwUIUtils.hide(".edrawings-icon-set.center", isDrawing);
                    this.removeHTMLEventHandlers();
                    return [2]
                }))
            }))
        };
        UIEventHandlers.prototype.onInitFullUI = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onInitFullUI.call(this, iViewer)];
                        case 1:
                            _a.sent();
                            this.addHTMLEventHandlers(iViewer.ViewerFeatureOpts);
                            this.mUI.init(iViewer);
                            eDwUIUtils.hide("#WaitBanner", true);
                            return [2]
                    }
                }))
            }))
        };
        UIEventHandlers.prototype.onSelect = function (iViewer, iSelObjs) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onSelect.call(this, iViewer, iSelObjs)];
                        case 1:
                            _a.sent();
                            if (l_init) l_init();
                            return [2]
                    }
                }))
            }))
        };
        UIEventHandlers.prototype.onUnselect = function (iViewer, iSelObjs) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onUnselect.call(this, iViewer, iSelObjs)];
                        case 1:
                            _a.sent();
                            if (l_uninit) l_uninit();
                            return [2]
                    }
                }))
            }))
        };
        UIEventHandlers.prototype.onTimeout = function (iViewer) {
            eDwUIUtils.hide("#TimeoutBanner", false);
            $(eDwUIUtils.getViewerElementID()).trigger("edw:ChangeViewerStyling", "edrawings-viewer-timeout")
        };
        UIEventHandlers.prototype.onStartAnimation = function (iViewer) {
            var eDwViewer = iViewer;
            $("#edrawings-canvas").on("click.edw", (function () {
                eDwViewer.ViewMgr.stop()
            }));
            var animateBtnJQ = $("#edrawings-button-animate");
            animateBtnJQ.removeClass("edrawings-animate-play-icon");
            animateBtnJQ.addClass("edrawings-animate-pause-icon")
        };
        UIEventHandlers.prototype.onStopAnimation = function (iViewer) {
            var animateBtnJQ = $("#edrawings-button-animate");
            animateBtnJQ.addClass("edrawings-animate-play-icon");
            animateBtnJQ.removeClass("edrawings-animate-pause-icon")
        };
        UIEventHandlers.prototype.onAmbientOcclusionChange = function (iViewer, iAmbientOcclusionOn) {
            var ambientOccButton = $("#edrawings-button-view-ambient-occlusion");
            if (iAmbientOcclusionOn) {
                if (!ambientOccButton.hasClass("state-on-button")) {
                    ambientOccButton.addClass("state-on-button")
                }
            } else {
                if (ambientOccButton.hasClass("state-on-button")) {
                    ambientOccButton.removeClass("state-on-button")
                }
            }
        };
        UIEventHandlers.prototype.onProjectionModeChange = function (iViewer, iPerspectiveOn) {
            var perspectiveButton = $("#edrawings-button-view-perspective");
            if (iPerspectiveOn) {
                if (!perspectiveButton.hasClass("state-on-button")) {
                    perspectiveButton.addClass("state-on-button")
                }
            } else {
                if (perspectiveButton.hasClass("state-on-button")) {
                    perspectiveButton.removeClass("state-on-button")
                }
            }
        };
        UIEventHandlers.prototype.onDrawModeChange = function (iViewer, iDrawMode) {
            function setActive(iButtonID, iIsActive) {
                if (iIsActive && !$(iButtonID).hasClass("state-on-button")) {
                    $(iButtonID).addClass("state-on-button")
                } else if (!iIsActive && $(iButtonID).hasClass("state-on-button")) {
                    $(iButtonID).removeClass("state-on-button")
                }
            }

            function setActiveInGroup(iButtonID) {
                setActive("#edrawings-button-shaded-full", false);
                setActive("#edrawings-button-shaded-noedges", false);
                setActive("#edrawings-button-shaded-wireframe", false);
                setActive("#edrawings-button-shaded-hlrr", false);
                setActive("#edrawings-button-shaded-hlrv", false);
                setActive(iButtonID, true)
            }

            switch (iDrawMode) {
                case"ShadedWithEdges":
                    setActiveInGroup("#edrawings-button-shaded-full");
                    break;
                case"Shaded":
                    setActiveInGroup("#edrawings-button-shaded-noedges");
                    break;
                case"HiddenLinesRemoved":
                    setActiveInGroup("#edrawings-button-shaded-hlrr");
                    break;
                case"HiddenLinesVisible":
                    setActiveInGroup("#edrawings-button-shaded-hlrv");
                    break;
                case"Wireframe":
                    setActiveInGroup("#edrawings-button-shaded-wireframe");
                    break;
                default:
                    throw new Error("Unknown draw mode in UI:" + iDrawMode)
            }
        };
        UIEventHandlers.prototype.onClick = function (iEvent, iButtonCSSClassName, iPanelCSSClassName) {
            var _this = this;
            if (iPanelCSSClassName === void 0) {
                iPanelCSSClassName = ""
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var targetJQ, buttonClickedID, deactivatedButtonID;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                                buttonClickedID = targetJQ.closest(iButtonCSSClassName).attr("id");
                                return [4, this.deactivateActiveButton(iButtonCSSClassName, iPanelCSSClassName)];
                            case 1:
                                deactivatedButtonID = _a.sent();
                                if (deactivatedButtonID === buttonClickedID) return [2];
                                this.handleClick("#" + buttonClickedID, true);
                                return [2]
                        }
                    }))
                }))
            })()
        };
        UIEventHandlers.prototype.deactivateActiveButton = function (iButtonCSSClassName, iPanelCSSClassName) {
            if (iPanelCSSClassName === void 0) {
                iPanelCSSClassName = ""
            }
            return __awaiter(this, void 0, void 0, (function () {
                var activeButtonID, activeButtonJQ;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            activeButtonID = "";
                            activeButtonJQ = $(iButtonCSSClassName + ".active-button");
                            return [4, this.mUI.hideAllOtherPanels(iPanelCSSClassName)];
                        case 1:
                            _a.sent();
                            if (activeButtonJQ.length) {
                                activeButtonID = activeButtonJQ[0].id;
                                this.handleClick("#" + activeButtonID, false)
                            }
                            return [2, activeButtonID]
                    }
                }))
            }))
        };
        UIEventHandlers.prototype.handleClick = function (iButtonID, iActivate) {
            eDwUIUtils.scrollToTarget($(iButtonID));
            if (!this.mUI.onClick(iButtonID, iActivate)) {
                var pluginMgr = eDwUIPluginMgr.get();
                pluginMgr.onClick(iButtonID, iActivate)
            }
        };
        return UIEventHandlers
    }(eDwUIBaseEventHandlers);
    var c_fullScreenChange = "fullscreenchange.edw MSFullscreenChange.edw" + " webkitfullscreenchange.edw";
    var c_restoreClass = "edrawings-button-fs-restore";
    var c_canvasID = "edrawings-canvas";
    var c_debugGroupName = "Debug";
    var l_fullScreenBtnJS;
    var l_init;
    var l_uninit;

    function l_isFullScreen() {
        if (!l_fullScreenBtnJS) l_fullScreenBtnJS = $("#edrawings-button-fs");
        return l_fullScreenBtnJS.hasClass(c_restoreClass)
    }
}));
define("eDwUIBaseEventHandlers", ["require", "exports", "eDwEventMgr", "eDwUIHTMLEventMgr", "eDwCommandMgr", "eDwChangeModelViewCmd", "eDwCompositeCmd", "eDwSetLayerVisibilityCmd", "eDwUIPluginMgr", "eDwEvents", "eDwUIUtils", "eDwUIShortcutMenu", "utils", "jqutils", "eDwUILocalize", "eDwUIHTMLGenerator", "eDwNodeAttributes"], (function (require, exports, eDwEventMgr, eDwUIHTMLEventMgr, eDwCommandMgr, eDwChangeModelViewCmd, eDwCompositeCmd, eDwSetLayerVisibilityCmd, eDwUIPluginMgr, eDwEvents, eDwUIUtils, eDwUIShortcutMenu_2, utils, jqutils, eDwUILocalize_5, eDwUIHTMLGenerator_1, eDwNodeAttributes_6) {
    "use strict";
    var eDwUIBaseEventHandlers = function () {
        function eDwUIBaseEventHandlers(iViewerHTMLID, iViewerHTMLCanvasID) {
            this.mViewerHTMLID = iViewerHTMLID;
            this.mViewerHTMLCanvasID = iViewerHTMLCanvasID;
            this.mUIHTMLEventMgr = new eDwUIHTMLEventMgr
        }

        eDwUIBaseEventHandlers.prototype.addHTMLEventHandlers = function (iViewerFeatOpts) {
            var _this = this;
            this.mViewerFeatureOpts = iViewerFeatOpts;
            var eventMgrHTML = this.mUIHTMLEventMgr;
            eventMgrHTML.addEventHandler("window", "resize", (function (iEvent) {
                _this.onResize(iEvent, _this.mViewer)
            }));
            eDwEventMgr.get().addEventHandlerFunc(eDwEvents.ResetSceneEvent, l_onResize);
            eDwUIUtils.addSubTreeArrowEventHandler(eventMgrHTML, "#edrawings-sheet-tree-menu");
            eventMgrHTML.addDelegatedEventHandler("#edrawings-sheet-tree-menu .edrawings-submenu-list-item", "dblclick", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                eDwUIUtils.scrollToTarget(targetJQ);
                if (targetJQ.hasClass("edrawings-root")) {
                    return
                }
                var selObjIDHC = eDwUIUtils.getIDHC(targetJQ);
                if (isNaN(selObjIDHC) || selObjIDHC < 0) {
                    return
                }
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        var cmdMgr, zoomToViewCmd, targetModelView, model, modelHC, modelViews, modelViews_3,
                            modelViews_3_1, modelView, modelViewHCID, modelViewChildren, activeModelView,
                            changeModelViewCmd;
                        var e_55, _a;
                        return __generator(this, (function (_b) {
                            switch (_b.label) {
                                case 0:
                                    cmdMgr = eDwCommandMgr.get();
                                    zoomToViewCmd = new eDwCompositeCmd(this.mViewer);
                                    zoomToViewCmd.initCmdActionImplementation();
                                    return [4, cmdMgr.add(zoomToViewCmd)];
                                case 1:
                                    _b.sent();
                                    targetModelView = null;
                                    model = this.mViewer.getModel();
                                    modelHC = model.getHCModel();
                                    modelViews = model.getAllModelViews();
                                    try {
                                        for (modelViews_3 = __values(modelViews), modelViews_3_1 = modelViews_3.next(); !modelViews_3_1.done; modelViews_3_1 = modelViews_3.next()) {
                                            modelView = modelViews_3_1.value;
                                            modelViewHCID = modelView.Hierarchy.HOOPSID;
                                            modelViewChildren = modelHC.getNodeChildren(modelViewHCID);
                                            if (-1 !== modelViewChildren.indexOf(selObjIDHC)) {
                                                targetModelView = modelView;
                                                break
                                            }
                                        }
                                    } catch (e_55_1) {
                                        e_55 = {error: e_55_1}
                                    } finally {
                                        try {
                                            if (modelViews_3_1 && !modelViews_3_1.done && (_a = modelViews_3.return)) _a.call(modelViews_3)
                                        } finally {
                                            if (e_55) throw e_55.error
                                        }
                                    }
                                    activeModelView = this.mViewer.getModel().getActiveModelView();
                                    if (!(targetModelView && targetModelView !== activeModelView)) return [3, 3];
                                    this.mViewer.SelectionMgr.selectByID(selObjIDHC);
                                    changeModelViewCmd = new eDwChangeModelViewCmd(this.mViewer, targetModelView);
                                    return [4, cmdMgr.run(changeModelViewCmd, "commit")];
                                case 2:
                                    _b.sent();
                                    _b.label = 3;
                                case 3:
                                    this.onLeftDoubleClick(this.mViewer);
                                    return [4, cmdMgr.remove(zoomToViewCmd, "commit")];
                                case 4:
                                    _b.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            var switchModelView = function (iEvent) {
                eDwUIUtils.switchModelView(iEvent, _this.mViewer, ".item-tree-text")
            };
            eventMgrHTML.addDelegatedEventHandler("#edrawings-sheet-tree-menu .edrawings-root", "click", switchModelView);
            eDwUIUtils.addSubTreeArrowEventHandler(this.mUIHTMLEventMgr, "#edrawings-debug-menu");
            var inputSelectorName = "#edrawings-console-debug-categories " + ".edrawings-menu-search-input";
            eventMgrHTML.addDelegatedEventHandler(inputSelectorName, "blur", (function (iEvent) {
                var e_56, _a;
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                var inputElem = targetJQ[0];
                var categories = inputElem.value.split(",");
                if (categories.length === 0) return;
                try {
                    for (var categories_1 = __values(categories), categories_1_1 = categories_1.next(); !categories_1_1.done; categories_1_1 = categories_1.next()) {
                        var category = categories_1_1.value;
                        category = category.trim();
                        if (!category) continue;
                        console.debugLogCategories.push(category);
                        var pos = console.excludeDebugLogCategories.indexOf(category);
                        if (pos > -1) {
                            console.excludeDebugLogCategories.slice(pos, 1)
                        }
                    }
                } catch (e_56_1) {
                    e_56 = {error: e_56_1}
                } finally {
                    try {
                        if (categories_1_1 && !categories_1_1.done && (_a = categories_1.return)) _a.call(categories_1)
                    } finally {
                        if (e_56) throw e_56.error
                    }
                }
            }));
            var selectorName = "#edrawings-debug-menu .edrawings-submenu-list-item";
            eventMgrHTML.addDelegatedEventHandler(selectorName, "click", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                eDwUIUtils.scrollToTarget(targetJQ);
                var id = eDwUIUtils.getIDHC(targetJQ);
                if (isNaN(id)) return;
                $(selectorName).removeClass("edrawings-list-selected");
                $(targetJQ).addClass("edrawings-list-selected");
                _this.mViewer.SelectionMgr.selectByID(id)
            }));
            eventMgrHTML.addDelegatedEventHandler("#edrawings-debug-menu .edrawings-submenu-list-item", "dblclick", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                eDwUIUtils.scrollToTarget(targetJQ);
                var id = eDwUIUtils.getIDHC(targetJQ);
                if (isNaN(id)) return;
                _this.onLeftDoubleClick(_this.mViewer)
            }));
            eventMgrHTML.addEventHandler("#edrawings-debug-menu .edrawings-menu-search-cancel", "click", (function (iEvent) {
                $("#edrawings-debug-menu " + ".edrawings-menu-search-input").val("");
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                eDwUIUtils.searchPanelList(_this.mViewer, targetJQ)
            }));
            eventMgrHTML.addEventHandler("#edrawings-debug-menu .edrawings-menu-search-input", "keyup", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                eDwUIUtils.searchPanelList(_this.mViewer, targetJQ)
            }));
            eventMgrHTML.addDelegatedEventHandler("#edrawings-layer-control-menu .item-layer-checkbox", "click", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                var layerName = eDwUIUtils.getSpanText(targetJQ.next("span.item-tree-text"));
                var isVisible = targetJQ.prop("checked");
                _this.setOneLayerVisibility(layerName, isVisible)
            }));
            eventMgrHTML.addDelegatedEventHandler("#edrawings-layer-control-menu .layer-all", "click", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                var isVisible = targetJQ.prop("checked");
                _this.setAllLayerVisibility(isVisible)
            }));
            eventMgrHTML.addEventHandler("#edrawings-filename-block", "mouseover", (function (iEvent) {
                var filenameJQ = jqutils.getAsJQueryObj(iEvent.target);
                if (filenameJQ.length === 1 && filenameJQ[0].scrollWidth > filenameJQ.width()) {
                    var mouseEvent = iEvent;
                    l_positionTicker(mouseEvent, filenameJQ, $("#edrawings-filename-text").text())
                }
            }));
            eventMgrHTML.addEventHandler("#edrawings-filename-block", "mouseout", (function (iEvent) {
                l_hideTicker()
            }));
            eventMgrHTML.addDelegatedEventHandler("document .edrawings-submenu-list-item", "mouseover", (function (iEvent) {
                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                var itemTreeTextJQ = targetJQ.find(".item-tree-text");
                var edrawingsSubmenuListJQ = targetJQ.closest(".edrawings-submenu-list");
                if (edrawingsSubmenuListJQ.length === 1 && itemTreeTextJQ.length === 1 && itemTreeTextJQ[0].scrollWidth > itemTreeTextJQ.width()) {
                    var mouseEvent = iEvent;
                    l_positionTicker(mouseEvent, itemTreeTextJQ, itemTreeTextJQ.text())
                }
            }));
            eventMgrHTML.addDelegatedEventHandler("document .edrawings-submenu-list-item", "mouseout", (function (iEvent) {
                l_hideTicker()
            }));
            eventMgrHTML.addEventHandler("#edrawings-hud-bar              .edrawings-arrow-wrapper:has(> .edrawings-arrow-left)", "click", (function (iEvent) {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, l_scrollUIBar($("#edrawings-hud-bar .edrawings-hud-bar-content"), ".edrawings-hud-button", ".edrawings-hud-menu", -c_hudBarIconWidth)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            eventMgrHTML.addEventHandler("#edrawings-hud-bar              .edrawings-arrow-wrapper:has(> .edrawings-arrow-right)", "click", (function (iEvent) {
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, l_scrollUIBar($("#edrawings-hud-bar .edrawings-hud-bar-content"), ".edrawings-hud-button", ".edrawings-hud-menu", c_hudBarIconWidth)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            eDwUIUtils.enableScrollOnTouch(eventMgrHTML, "#edrawings-hud-bar .edrawings-hud-bar-content", "#edrawings-hud-bar", (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwUIUtils.deactivateUI(".edrawings-hud-button", ".edrawings-hud-menu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            }));
            eventMgrHTML.addEventHandler("#edrawings-left-bar              .edrawings-arrow-wrapper:has(> .edrawings-arrow-up)", "click", (function (iEvent) {
                var barJQ = $("#edrawings-left-bar");
                var contentJQ = barJQ.find(".edrawings-tool-bar-content");
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, l_scrollUIBar(contentJQ, ".edrawings-tool-button", ".edrawings-submenu", -c_toolBarIconWidth, barJQ)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            eventMgrHTML.addEventHandler("#edrawings-left-bar              .edrawings-arrow-wrapper:has(> .edrawings-arrow-down)", "click", (function (iEvent) {
                var barJQ = $("#edrawings-left-bar");
                var contentJQ = barJQ.find(".edrawings-tool-bar-content");
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, l_scrollUIBar(contentJQ, ".edrawings-tool-button", ".edrawings-submenu", c_toolBarIconWidth, barJQ)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }));
            eDwUIUtils.enableScrollOnTouch(eventMgrHTML, "#edrawings-left-bar .edrawings-tool-bar-content", "#edrawings-left-bar", (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwUIUtils.deactivateUI(".edrawings-tool-button", ".edrawings-submenu")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.addDefaultHTMLPanelCloseEventHandlers = function () {
            if (this.mViewerFeatureOpts.Debug) {
                eDwUIUtils.addCloseEventHandler("#edrawings-debug-menu", this.mUIHTMLEventMgr)
            }
            eDwUIUtils.addCloseEventHandler("#edrawings-sheet-tree-menu", this.mUIHTMLEventMgr);
            eDwUIUtils.addCloseEventHandler("#edrawings-layer-control-menu", this.mUIHTMLEventMgr)
        };
        eDwUIBaseEventHandlers.doModelDataLoadCompleteActions = function (ioEventHandlerObj, iViewer) {
            ioEventHandlerObj.mViewer = iViewer;
            l_loadUIPlugins(iViewer);
            eDwUILocalize_5.eDwUILocalize.localize(document.body);
            var handlerObj = ioEventHandlerObj;
            var eventMgr = eDwEventMgr.get();
            eventMgr.addEventHandlerObj(eDwEvents.InitEvent, handlerObj, "onInit");
            eventMgr.addEventHandlerObj(eDwEvents.InitFullUIEvent, handlerObj, "onInitFullUI");
            eventMgr.addEventHandlerObj(eDwEvents.SelectEvent, handlerObj, "onSelect");
            eventMgr.addEventHandlerObj(eDwEvents.UnselectEvent, handlerObj, "onUnselect");
            eventMgr.addEventHandlerObj(eDwEvents.StartAnimationEvent, handlerObj, "onStartAnimation");
            eventMgr.addEventHandlerObj(eDwEvents.StopAnimationEvent, handlerObj, "onStopAnimation");
            eventMgr.addEventHandlerObj(eDwEvents.LeftDoubleClickEvent, handlerObj, "onLeftDoubleClick");
            eventMgr.addEventHandlerObj(eDwEvents.TimeoutEvent, handlerObj, "onTimeout");
            eventMgr.addEventHandlerObj(eDwEvents.DrawModeChangeEvent, handlerObj, "onDrawModeChange");
            eventMgr.addEventHandlerObj(eDwEvents.ProjModeChangeEvent, handlerObj, "onProjectionModeChange");
            eventMgr.addEventHandlerObj(eDwEvents.NodeAttribChangeEvent, handlerObj, "onNodeAttribChanged");
            eventMgr.addEventHandlerObj(eDwEvents.ResetSceneEvent, handlerObj, "onResetScene");
            eventMgr.addEventHandlerObj(eDwEvents.AmbientOcclChangeEvent, handlerObj, "onAmbientOcclusionChange");
            eventMgr.addEventHandlerObj(eDwEvents.DoneEvent, handlerObj, "onDone");
            eventMgr.addEventHandlerObj(eDwEvents.ModelViewChangeEvent, handlerObj, "onModelViewChange")
        };
        eDwUIBaseEventHandlers.prototype.removeHTMLEventHandlers = function () {
            eDwUIUtils.disableScrollOnTouch(this.mUIHTMLEventMgr, "#edrawings-hud-bar .edrawings-hud-bar-content");
            eDwUIUtils.disableScrollOnTouch(this.mUIHTMLEventMgr, "#edrawings-left-bar .edrawings-tool-bar-content");
            this.mUIHTMLEventMgr.removeAllEventHandlers();
            eDwUIShortcutMenu_2.eDwUIShortcutMenu.destroy()
        };
        eDwUIBaseEventHandlers.doModelDataUnloadActions = function (iViewer) {
            l_unloadUIPlugins();
            if (iViewer) iViewer.unregister();
            eDwEventMgr.get().removeAllEventHandlers()
        };
        eDwUIBaseEventHandlers.prototype.onInit = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    this.mViewer = iViewer;
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onInitFullUI = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwUIUtils.updateUI(iViewer, iViewer.getModel().getActiveModelView(), true)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onDone = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    iViewer.destroy();
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onSelect = function (iViewer, iSelObjs) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    this.handleSelectionChange(iViewer, iSelObjs, true);
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onUnselect = function (iViewer, iSelObjs) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    this.handleSelectionChange(iViewer, iSelObjs, false);
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onLeftDoubleClick = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    eDwUIUtils.zoomToFit(iViewer);
                    eDwUIShortcutMenu_2.eDwUIShortcutMenu.hide();
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onModelViewChange = function (iViewer, iPrevModelView, iCurrModelView, iIsAssembly) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwUIUtils.updateUI(iViewer, iCurrModelView)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onNodeAttribChanged = function (iViewer, iHierNodesAndAttribs) {
            return __awaiter(this, void 0, void 0, (function () {
                function getAllDSCSSClasses(iHierNode) {
                    var classes = "";
                    for (var displayState in eDwNodeAttributes_6.NodeDisplayState) {
                        classes += "edrawings-" + iHierNode.Category + "-" + displayState.toLowerCase() + " "
                    }
                    return classes
                }

                var iHierNodesAndAttribs_3, iHierNodesAndAttribs_3_1, hierNodeAndAttribs, iHierNodesAndAttribs_4,
                    iHierNodesAndAttribs_4_1, hierNodeAndAttribs, hierNode, attribs, listItemDiv, iconDiv, newCSS;
                var e_57, _a, e_58, _b;
                return __generator(this, (function (_c) {
                    if (iViewer.ViewerFeatureOpts.Debug) {
                        try {
                            for (iHierNodesAndAttribs_3 = __values(iHierNodesAndAttribs), iHierNodesAndAttribs_3_1 = iHierNodesAndAttribs_3.next(); !iHierNodesAndAttribs_3_1.done; iHierNodesAndAttribs_3_1 = iHierNodesAndAttribs_3.next()) {
                                hierNodeAndAttribs = iHierNodesAndAttribs_3_1.value;
                                console.debugLog("NodeAttribChanged", "Node (name = " + hierNodeAndAttribs.HierNode.Name + ", ID = " + hierNodeAndAttribs.HierNode.HOOPSID + ") attributes = " + JSON.stringify(hierNodeAndAttribs.Attribs))
                            }
                        } catch (e_57_1) {
                            e_57 = {error: e_57_1}
                        } finally {
                            try {
                                if (iHierNodesAndAttribs_3_1 && !iHierNodesAndAttribs_3_1.done && (_a = iHierNodesAndAttribs_3.return)) _a.call(iHierNodesAndAttribs_3)
                            } finally {
                                if (e_57) throw e_57.error
                            }
                        }
                    }
                    try {
                        for (iHierNodesAndAttribs_4 = __values(iHierNodesAndAttribs), iHierNodesAndAttribs_4_1 = iHierNodesAndAttribs_4.next(); !iHierNodesAndAttribs_4_1.done; iHierNodesAndAttribs_4_1 = iHierNodesAndAttribs_4.next()) {
                            hierNodeAndAttribs = iHierNodesAndAttribs_4_1.value;
                            hierNode = hierNodeAndAttribs.HierNode;
                            attribs = hierNodeAndAttribs.Attribs;
                            listItemDiv = $('[data-hoopsid="' + hierNode.HOOPSID + '"][class~="edrawings-submenu-list-item"]');
                            iconDiv = listItemDiv.children("div.edrawings-tree-icon");
                            iconDiv.removeClass(getAllDSCSSClasses(hierNode));
                            newCSS = eDwUIHTMLGenerator_1.eDwUINodeHTMLGenerator.getDisplayStateCSSClass(hierNode, attribs);
                            iconDiv.addClass(newCSS)
                        }
                    } catch (e_58_1) {
                        e_58 = {error: e_58_1}
                    } finally {
                        try {
                            if (iHierNodesAndAttribs_4_1 && !iHierNodesAndAttribs_4_1.done && (_b = iHierNodesAndAttribs_4.return)) _b.call(iHierNodesAndAttribs_4)
                        } finally {
                            if (e_58) throw e_58.error
                        }
                    }
                    return [2]
                }))
            }))
        };
        eDwUIBaseEventHandlers.prototype.onResize = function (iEvent, iViewer) {
            if (iViewer) iViewer.HCViewer.resizeCanvas();
            l_onResize()
        };
        eDwUIBaseEventHandlers.prototype.setOneLayerVisibility = function (layerName, isVisible) {
            var e_59, _a;
            var layers = this.mViewer.getModel().getLayers();
            var layer;
            try {
                for (var layers_1 = __values(layers), layers_1_1 = layers_1.next(); !layers_1_1.done; layers_1_1 = layers_1.next()) {
                    layer = layers_1_1.value;
                    if (layer.getName() === layerName) break
                }
            } catch (e_59_1) {
                e_59 = {error: e_59_1}
            } finally {
                try {
                    if (layers_1_1 && !layers_1_1.done && (_a = layers_1.return)) _a.call(layers_1)
                } finally {
                    if (e_59) throw e_59.error
                }
            }
            if (!layer) return;
            this.setLayersVisibility([layer], isVisible);
            var eachLayer = $("#edrawings-layer-control-menu .item-layer-checkbox");
            var isAnyShow = false, isAnyHidden = false;
            $.each(eachLayer, (function (iIdx, iTarget) {
                if ($(iTarget).prop("checked")) {
                    isAnyShow = true
                } else {
                    isAnyHidden = true
                }
            }));
            var allLayerBox = $("#edrawings-layer-control-menu .layer-all");
            if (isAnyShow && isAnyHidden) {
                allLayerBox.prop("indeterminate", true)
            }
            if (isAnyShow && !isAnyHidden) {
                allLayerBox.prop("indeterminate", false);
                allLayerBox.prop("checked", true)
            }
            if (!isAnyShow && isAnyHidden) {
                allLayerBox.prop("indeterminate", false);
                allLayerBox.prop("checked", false)
            }
        };
        eDwUIBaseEventHandlers.prototype.setAllLayerVisibility = function (iVisible) {
            var activeModelView = this.mViewer.getModel().getActiveModelView();
            if (!activeModelView || !activeModelView.Hierarchy) return;
            this.setLayersVisibility(this.mViewer.getModel().getLayers(), iVisible);
            var eachLayer = $("#edrawings-layer-control-menu .item-layer-checkbox");
            if (iVisible) {
                eachLayer.prop("checked", true)
            } else {
                eachLayer.prop("checked", false)
            }
        };
        eDwUIBaseEventHandlers.prototype.setLayersVisibility = function (iLayers, iVisible) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var setNodeVisCmd;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                setNodeVisCmd = new eDwSetLayerVisibilityCmd(this.mViewer, iLayers, iVisible);
                                return [4, eDwCommandMgr.get().run(setNodeVisCmd, "commit")];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwUIBaseEventHandlers.prototype.handleSelectionChange = function (iViewer, iSelObjs, iIsObjSelected) {
            var e_60, _a;
            var model = iViewer.getModel();
            if (!model.isDrawing()) return;
            var activeModelView = model.getActiveModelView();
            try {
                for (var iSelObjs_1 = __values(iSelObjs), iSelObjs_1_1 = iSelObjs_1.next(); !iSelObjs_1_1.done; iSelObjs_1_1 = iSelObjs_1.next()) {
                    var selObj = iSelObjs_1_1.value;
                    var selIDHC = selObj.getNodeId();
                    if (!utils.isNumber(selIDHC)) continue;
                    var selHierNode = activeModelView.Nodes[selIDHC];
                    eDwUIUtils.scrollToTreeNode(selHierNode, iIsObjSelected)
                }
            } catch (e_60_1) {
                e_60 = {error: e_60_1}
            } finally {
                try {
                    if (iSelObjs_1_1 && !iSelObjs_1_1.done && (_a = iSelObjs_1.return)) _a.call(iSelObjs_1)
                } finally {
                    if (e_60) throw e_60.error
                }
            }
        };
        return eDwUIBaseEventHandlers
    }();
    var c_hudBarIconWidth = 2 + 44;
    var c_toolBarIconWidth = 5 + 2 + 44;
    var c_hudBarContentThresholdWidth = 2 + 2 * 46;
    var c_filenameBlockThresholdWidth = 50;
    var c_toolBarContentThresholdHeight = 2 * 46;

    function l_loadUIPlugins(iViewer) {
        var _this = this;
        if (!iViewer) return;
        try {
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var pluginMgr;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                pluginMgr = eDwUIPluginMgr.get();
                                return [4, pluginMgr.loadPlugins(["eDwUIHierNodeVisMenuItemsPlugin", "eDwUIMoveComponentPlugin", "eDwUIModelViewTabsPlugin", "eDwUIExplodePlugin", "eDwUIConfigurationsPlugin", "eDwUIComponentTreePlugin", "eDwUIMeasurePlugin","plmTestPlugin"], iViewer)];
                            case 1:
                                _a.sent();
                                return [4, pluginMgr.loadDynamicPlugins(iViewer)];
                            case 2:
                                _a.sent();
                                return [4, eDwUIUtils.loadComponentHTML()];
                            case 3:
                                _a.sent();
                                iViewer.resetDrawMode();
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents.InitFullUIEvent, iViewer)];
                            case 4:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        } catch (iExcp) {
            console.warn("Plugin loading did not complete.")
        }
    }

    function l_unloadUIPlugins() {
        eDwUIPluginMgr.get().destroy()
    }

    function l_resizeTopBar() {
        var topBarJQ = $("#edrawings-top-bar");
        var filenameBlockJQ = $("#edrawings-filename-block");
        var hudBarJQ = $("#edrawings-hud-bar");
        var hudBarContentJQ = hudBarJQ.find(".edrawings-hud-bar-content");
        var filenameBlockOffset = filenameBlockJQ.offset();
        var filenameBlockInnerWidth = filenameBlockJQ.css("display") === "none" ? 0 : filenameBlockJQ.innerWidth();
        var filenameBlockRight = filenameBlockOffset.left + filenameBlockInnerWidth;
        var hudBarOffset = hudBarJQ.offset();
        var leftButtonWrapperJQ = hudBarJQ.find(".edrawings-arrow-left").parent(".edrawings-arrow-wrapper");
        var rightButtonWrapperJQ = hudBarJQ.find(".edrawings-arrow-right").parent(".edrawings-arrow-wrapper");
        if (topBarJQ.hasClass("edrawings-collided-hud-bar")) {
            if (filenameBlockOffset.left !== hudBarOffset.left && Math.abs(filenameBlockRight - hudBarOffset.left) > 1) {
                hudBarJQ.offset({left: Math.ceil(filenameBlockRight), top: hudBarOffset.top});
                l_resizeTopBar()
            } else if (hudBarContentJQ[0].scrollWidth === 0 || hudBarContentJQ.width() >= hudBarContentJQ[0].scrollWidth) {
                topBarJQ.removeClass("edrawings-collided-hud-bar");
                hudBarJQ.removeClass("edrawings-collided");
                hudBarJQ.css({left: ""})
            }
        } else {
            if (filenameBlockOffset.left !== hudBarOffset.left && filenameBlockRight > hudBarOffset.left) {
                hudBarJQ.offset({left: Math.ceil(filenameBlockRight), top: hudBarOffset.top});
                topBarJQ.addClass("edrawings-collided-hud-bar");
                hudBarJQ.addClass("edrawings-collided")
            }
        }
        eDwUIUtils.adjustScrollArrows(hudBarContentJQ[0].scrollLeft, hudBarContentJQ[0].scrollWidth, hudBarContentJQ.width(), true, leftButtonWrapperJQ, rightButtonWrapperJQ, hudBarJQ);
        if (topBarJQ.hasClass("edrawings-collided-hud-bar")) {
            if (hudBarContentJQ.innerWidth() < c_hudBarContentThresholdWidth) {
                if (filenameBlockJQ.width() > c_filenameBlockThresholdWidth) {
                    if (topBarJQ.hasClass("edrawings-out-of-view")) {
                        topBarJQ.removeClass("edrawings-out-of-view")
                    }
                } else {
                    topBarJQ.addClass("edrawings-out-of-view")
                }
            } else {
                if (filenameBlockJQ[0].scrollWidth - filenameBlockInnerWidth > 1) {
                    if (filenameBlockJQ.width() < c_filenameBlockThresholdWidth) {
                        topBarJQ.addClass("edrawings-out-of-view")
                    } else {
                        topBarJQ.removeClass("edrawings-out-of-view")
                    }
                } else {
                    topBarJQ.removeClass("edrawings-out-of-view")
                }
            }
        } else {
            topBarJQ.removeClass("edrawings-out-of-view")
        }
    }

    function l_resizeToolBar() {
        var leftBarJQ = $("#edrawings-left-bar.edrawings-tool-bar");
        var leftBarContentJQ = leftBarJQ.find(".edrawings-bottom-centered-icons");
        var toolBarContentJQ = leftBarContentJQ.find(".edrawings-tool-bar-content");
        var upButtonWrapperJQ = leftBarContentJQ.find(".edrawings-arrow-up").parent(".edrawings-arrow-wrapper");
        var downButtonWrapperJQ = leftBarContentJQ.find(".edrawings-arrow-down").parent(".edrawings-arrow-wrapper");
        if (leftBarJQ.hasClass("edrawings-collided")) {
            if (toolBarContentJQ[0].scrollHeight > 0 && toolBarContentJQ[0].scrollHeight <= leftBarContentJQ.innerHeight()) {
                leftBarJQ.removeClass("edrawings-collided")
            }
        } else {
            if (leftBarContentJQ[0].scrollHeight > 0 && leftBarContentJQ[0].scrollHeight > Math.round(leftBarContentJQ.innerHeight())) {
                leftBarJQ.addClass("edrawings-collided")
            }
        }
        eDwUIUtils.adjustScrollArrows(toolBarContentJQ[0].scrollTop, toolBarContentJQ[0].scrollHeight, toolBarContentJQ.height(), false, upButtonWrapperJQ, downButtonWrapperJQ, leftBarJQ);
        if (leftBarJQ.hasClass("edrawings-collided")) {
            if (toolBarContentJQ.innerHeight() < c_toolBarContentThresholdHeight) {
                leftBarJQ.addClass("edrawings-out-of-view")
            } else {
                leftBarJQ.removeClass("edrawings-out-of-view")
            }
        } else {
            leftBarJQ.removeClass("edrawings-out-of-view")
        }
    }

    function l_onResize() {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                l_resizeTopBar();
                l_resizeToolBar();
                l_positionMenuPanelCollapseButton();
                l_fixMenuPanelInwardToolbar();
                return [2]
            }))
        }))
    }

    function l_positionTicker(iMouseEvent, iItemJQ, iText) {
        var tickerMinWidth = 100;
        var tickerMinHeight = 34;
        var scrollWidthPadding = 2;
        var tickerJQ = $(".edrawings-ticker");
        var itemOffset = iItemJQ.offset();
        var tickerLeft = iMouseEvent.clientX;
        var tickerWidth = iItemJQ[0].scrollWidth + scrollWidthPadding;
        var tickerTop = itemOffset.top - tickerMinHeight;
        var tickerAnimation = false;
        tickerJQ.text(iText);
        if (iMouseEvent.clientX + iItemJQ[0].scrollWidth + scrollWidthPadding >= window.innerWidth) {
            var diff = iMouseEvent.clientX + iItemJQ[0].scrollWidth + scrollWidthPadding - window.innerWidth;
            if (iMouseEvent.clientX >= diff) {
                tickerLeft = iMouseEvent.clientX - diff;
                tickerWidth = iItemJQ[0].scrollWidth + scrollWidthPadding
            } else {
                tickerLeft = 0;
                tickerAnimation = true;
                if (window.innerWidth > tickerMinWidth) {
                    tickerWidth = window.innerWidth
                } else {
                    tickerWidth = tickerMinWidth
                }
                var threeTimes = [iText, iText, iText].join("   ");
                tickerJQ.text(threeTimes)
            }
        }
        if (itemOffset.top - tickerMinHeight <= 0) {
            if (itemOffset.top + iItemJQ[0].clientHeight + tickerMinHeight <= window.innerHeight) {
                tickerTop = itemOffset.top + iItemJQ[0].clientHeight
            } else {
                var diff = iMouseEvent.clientY + tickerMinHeight - window.innerHeight;
                if (iMouseEvent.clientY > diff) {
                    tickerTop = iMouseEvent.clientY - diff
                } else {
                    tickerTop = 0
                }
            }
        }
        var tickerwrapJQ = tickerJQ.closest(".edrawings-ticker-wrapper");
        tickerwrapJQ.offset({
            left: tickerLeft,
            top: tickerTop
        }).css("width", tickerWidth).removeClass("edrawings-ui-hide");
        if (tickerAnimation) {
            tickerwrapJQ.addClass("edrawings-animation")
        }
    }

    function l_hideTicker() {
        var tickerwrapJQ = $(".edrawings-ticker-wrapper");
        if (!tickerwrapJQ.hasClass("edrawings-ui-hide")) {
            var tickerJQ = tickerwrapJQ.find(".edrawings-ticker");
            tickerJQ.text("");
            tickerwrapJQ.addClass("edrawings-ui-hide").removeClass("edrawings-animation").css("left", "").css("top", "").css("width", "")
        }
    }

    function l_positionMenuPanelCollapseButton() {
        var activeButtonsJQ = $(".edrawings-tool-button.active-button");
        if (activeButtonsJQ.length) {
            if (eDwUIUtils.scrollToTarget(activeButtonsJQ)) {
                l_resizeToolBar()
            }
            var collapsedPanelsJQ = $(".edrawings-submenu.active.edrawings-collapsed");
            if (collapsedPanelsJQ.length) {
                var attrStyle = collapsedPanelsJQ.find(".edrawings-menu-panel-arrow-collapse").attr("style");
                if (!!attrStyle) {
                    eDwUIUtils.positionMenuPanelArrowCollapseButton(collapsedPanelsJQ, activeButtonsJQ)
                }
            }
        }
    }

    function l_fixMenuPanelInwardToolbar() {
        var panelsJQ = $(".edrawings-submenu.active:not(.edrawings-collapsed),            .edrawings-hud-menu.active");
        panelsJQ.each((function (iIndex, iPanel) {
            var panelJQ = $(iPanel);
            eDwUIUtils.fixMenuPanelInwardToolbar(panelJQ)
        }))
    }

    function l_scrollUIBar(iContentJQ, iDeactivateButtonClass, iDeactivateMenuClass, iScrollDist, iBarJQ) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(iContentJQ && iContentJQ.length > 0)) return [3, 2];
                        return [4, eDwUIUtils.deactivateUI(iDeactivateButtonClass, iDeactivateMenuClass)];
                    case 1:
                        _a.sent();
                        eDwUIUtils.executeScrolling(iScrollDist, 0, iContentJQ, iBarJQ);
                        _a.label = 2;
                    case 2:
                        return [2]
                }
            }))
        }))
    }

    return eDwUIBaseEventHandlers
}));
define("eDwUIBasePlugin", ["require", "exports", "eDwUIHTMLEventMgr", "eDwEventMgr", "eDwEvents", "eDwUIShortcutMenu", "eDwUILocalize", "eDwUIUtils", "utils"], (function (require, exports, eDwUIHTMLEventMgr, eDwEventMgr, eDwEvents_6, eDwUIShortcutMenu_3, eDwUILocalize_6, eDwUIUtils, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwUIBasePlugin = void 0;
    var eDwUIBasePlugin = function () {
        function eDwUIBasePlugin(iPluginClassName, iViewer, iButtonInfo, iViewerFeatOpts) {
            var _this = this;
            if (iViewer === void 0) {
                iViewer = null
            }
            if (iButtonInfo === void 0) {
                iButtonInfo = null
            }
            if (iViewerFeatOpts === void 0) {
                iViewerFeatOpts = null
            }
            console.debugLog("UIPlugin", "Constructed " + iPluginClassName + " plugin.");
            this.mPluginClassName = iPluginClassName;
            this.mViewer = iViewer;
            this.mViewerFeatOpts = iViewerFeatOpts || iViewer && iViewer.ViewerFeatureOpts;
            this.mUIHTMLEventMgr = new eDwUIHTMLEventMgr;
            this.mPluginDependencies = [];
            this.mPluginButtonInfo = iButtonInfo;
            this.mPanelIDs = [];
            if (iViewer) {
                eDwUIShortcutMenu_3.eDwUIShortcutMenu.get().setPluginCheck(iPluginClassName, (function (iPluginName) {
                    return _this.check(iPluginName)
                }))
            }
        }

        eDwUIBasePlugin.prototype.init = function (iPanelsToLoad) {
            return __awaiter(this, void 0, void 0, (function () {
                var promises, iPanelsToLoad_1, iPanelsToLoad_1_1, panelToLoad;
                var e_61, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            this.addAppObjEvent(eDwEvents_6.ActivateUIOpEvent, "onActivate", true);
                            this.addAppObjEvent(eDwEvents_6.DeactivateUIOpEvent, "onDeactivate", true);
                            if (!iPanelsToLoad) return [3, 2];
                            promises = [];
                            try {
                                for (iPanelsToLoad_1 = __values(iPanelsToLoad), iPanelsToLoad_1_1 = iPanelsToLoad_1.next(); !iPanelsToLoad_1_1.done; iPanelsToLoad_1_1 = iPanelsToLoad_1.next()) {
                                    panelToLoad = iPanelsToLoad_1_1.value;
                                    utils.appendToArray(eDwUIUtils.loadPanel(panelToLoad.ID, panelToLoad.HTML), promises);
                                    this.mPanelIDs.push(panelToLoad.ID)
                                }
                            } catch (e_61_1) {
                                e_61 = {error: e_61_1}
                            } finally {
                                try {
                                    if (iPanelsToLoad_1_1 && !iPanelsToLoad_1_1.done && (_a = iPanelsToLoad_1.return)) _a.call(iPanelsToLoad_1)
                                } finally {
                                    if (e_61) throw e_61.error
                                }
                            }
                            return [4, Promise.all(promises)];
                        case 1:
                            _b.sent();
                            this.localize();
                            _b.label = 2;
                        case 2:
                            this.addEventHandlers();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIBasePlugin.prototype.onClick = function (iActivate) {
        };
        eDwUIBasePlugin.prototype.destroy = function () {
            this.removeEventHandlers();
            this.addAppObjEvent(eDwEvents_6.ActivateUIOpEvent, "onActivate", false);
            this.addAppObjEvent(eDwEvents_6.DeactivateUIOpEvent, "onDeactivate", false);
            console.debugLog("UIPlugin", "Destroyed " + this.mPluginClassName + " plugin.")
        };
        eDwUIBasePlugin.prototype.initPluginButton = function () {
            if (this.mPluginButtonInfo) {
                var buttonJQ = $(this.mPluginButtonInfo.ID);
                if (buttonJQ) {
                    buttonJQ.removeClass("edrawings-icon-plugin");
                    eDwUIUtils.hide(this.mPluginButtonInfo.ID, false)
                }
            }
        };
        eDwUIBasePlugin.prototype.check = function (iPluginClassName) {
            return iPluginClassName === this.PluginClassName
        };
        eDwUIBasePlugin.prototype.isButtonForThisPlugin = function (iButtonJQ) {
            return iButtonJQ && iButtonJQ.length && this.mPluginButtonInfo && this.mPluginButtonInfo.ID && this.mPluginButtonInfo.ID.indexOf(iButtonJQ[0].id) > -1 ? true : false
        };
        eDwUIBasePlugin.prototype.addEventHandlers = function () {
            eDwEventMgr.get().addEventHandlerObj(eDwEvents_6.UpdateLocalizationEvent, this, "onLocalizationChange")
        };
        eDwUIBasePlugin.prototype.removeEventHandlers = function () {
            eDwEventMgr.get().removeEventHandlerObj(eDwEvents_6.UpdateLocalizationEvent, this, "onLocalizationChange");
            this.mUIHTMLEventMgr.removeAllEventHandlers()
        };
        eDwUIBasePlugin.prototype.onActivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    return [2, this.isButtonForThisPlugin(iButtonJQ)]
                }))
            }))
        };
        eDwUIBasePlugin.prototype.onDeactivate = function (iButtonJQ) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    return [2, this.isButtonForThisPlugin(iButtonJQ)]
                }))
            }))
        };
        eDwUIBasePlugin.prototype.onLocalizationChange = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    this.localize();
                    return [2]
                }))
            }))
        };
        eDwUIBasePlugin.prototype.addAppObjEvent = function (iAppEvent, iEventObjMethod, iAdd) {
            var eventMgr = eDwEventMgr.get();
            var eventMgrMethod = iAdd ? "addEventHandlerObj" : "removeEventHandlerObj";
            eventMgr[eventMgrMethod](iAppEvent, this, iEventObjMethod)
        };
        eDwUIBasePlugin.prototype.localize = function (iElem) {
            var e_62, _a;
            var elems = iElem ? [iElem] : this.mPanelIDs.map((function (iID) {
                return document.getElementById(iID)
            }));
            try {
                for (var elems_1 = __values(elems), elems_1_1 = elems_1.next(); !elems_1_1.done; elems_1_1 = elems_1.next()) {
                    var elem = elems_1_1.value;
                    eDwUILocalize_6.eDwUILocalize.localize(elem)
                }
            } catch (e_62_1) {
                e_62 = {error: e_62_1}
            } finally {
                try {
                    if (elems_1_1 && !elems_1_1.done && (_a = elems_1.return)) _a.call(elems_1)
                } finally {
                    if (e_62) throw e_62.error
                }
            }
        };
        Object.defineProperty(eDwUIBasePlugin.prototype, "PluginClassName", {
            get: function () {
                return this.mPluginClassName
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwUIBasePlugin.prototype, "PluginButtonID", {
            get: function () {
                return this.mPluginButtonInfo ? this.mPluginButtonInfo.ID : ""
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwUIBasePlugin.prototype, "Dependencies", {
            get: function () {
                return this.mPluginDependencies
            }, enumerable: false, configurable: true
        });
        return eDwUIBasePlugin
    }();
    exports.eDwUIBasePlugin = eDwUIBasePlugin
}));
define("eDwUIDebugHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator", "eDwTypes"], (function (require, exports, eDwUIHTMLGenerator_2, eDwTypes_15) {
    "use strict";
    var _a;
    var eDwUIDebugHTMLGenerator = function (_super) {
        __extends(eDwUIDebugHTMLGenerator, _super);

        function eDwUIDebugHTMLGenerator(iViewer, iPanelUIID) {
            var _this = _super.call(this, iViewer, iPanelUIID) || this;
            _this.mHCModel = iViewer.getModel().getHCModel();
            return _this
        }

        eDwUIDebugHTMLGenerator.prototype.getNodeFromID = function (iNodeID) {
            return l_getHCNode(iNodeID)
        };
        eDwUIDebugHTMLGenerator.prototype.getPostSpanHTML = function (iAdditionalClasses) {
            return ""
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetName = function (iNode) {
            return this.mHCModel.getNodeName(l_getHCNode(iNode)) || "unknown node name"
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetID = function (iNode) {
            return l_getHCNode(iNode)
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetParentID = function (iNode) {
            return this.mHCModel.getNodeParent(l_getHCNode(iNode)) || NaN
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetChildren = function (iNode) {
            return this.mHCModel.getNodeChildren(l_getHCNode(iNode))
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeHasChildren = function (iNode) {
            return this.forNodeGetChildren(iNode).length > 0
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetDataAttributes = function (iNode) {
            return _super.prototype.forNodeGetDataAttributes.call(this, iNode)
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetElementContent = function (iNode) {
            var _this = this;
            var nodeIDHC = this.forNodeGetID(iNode);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    var meshIDs, numMeshIDs;
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.mHCModel.getMeshIds([nodeIDHC])];
                            case 1:
                                meshIDs = _a.sent();
                                numMeshIDs = meshIDs.length;
                                console.debugLog("DebugPanel", "Node ID: " + nodeIDHC + " Num mesh IDs: " + numMeshIDs);
                                return [2]
                        }
                    }))
                }))
            })();
            return this.forNodeGetName(iNode) + " ID: " + nodeIDHC + " TYPE: " + c_nodeTypes[this.mHCModel.getNodeType(nodeIDHC)] + " VISIBLE: " + this.mHCModel.getNodeVisibility(nodeIDHC)
        };
        eDwUIDebugHTMLGenerator.prototype.forNodeGetIconCSSClass = function (iNode) {
            return "edrawings-body-visible"
        };
        return eDwUIDebugHTMLGenerator
    }(eDwUIHTMLGenerator_2.eDwUINodeHTMLGenerator);
    var c_nodeTypes = (_a = {}, _a[eDwTypes_15.HC.NodeType.AssemblyNode] = "Assembly", _a[eDwTypes_15.HC.NodeType.Body] = "Body", _a[eDwTypes_15.HC.NodeType.BodyInstance] = "Body Instance", _a[eDwTypes_15.HC.NodeType.BrepBody] = "BRep Body", _a[eDwTypes_15.HC.NodeType.CadView] = "CAD View", _a[eDwTypes_15.HC.NodeType.DrawingSheet] = "Drawing Sheet", _a[eDwTypes_15.HC.NodeType.Part] = "Part", _a[eDwTypes_15.HC.NodeType.PartInstance] = "Part Instance", _a[eDwTypes_15.HC.NodeType.Pmi] = "PMI", _a[eDwTypes_15.HC.NodeType.PmiBody] = "PMI Body", _a[eDwTypes_15.HC.NodeType.PointsBody] = "Points Body", _a[eDwTypes_15.HC.NodeType.TessBody] = "Tessellation Body", _a[eDwTypes_15.HC.NodeType.Unknown] = "Unknown", _a[eDwTypes_15.HC.NodeType.ViewFrame] = "View Frame", _a[eDwTypes_15.HC.NodeType.WireBody] = "Wire Body", _a);

    function l_isHCNode(iNode) {
        return !isNaN(iNode)
    }

    function l_getHCNode(iNode) {
        if (!l_isHCNode(iNode)) {
            throw new Error("Not an HC node:\n" + JSON.stringify(iNode))
        }
        return iNode
    }

    return eDwUIDebugHTMLGenerator
}));
define("eDwUIHTMLEventMgr", ["require", "exports", "utils", "jqutils"], (function (require, exports, utils, jqutils) {
    "use strict";
    var eDwUIHTMLEventMgr = function () {
        function eDwUIHTMLEventMgr(iGroupName) {
            this.mGroupName = iGroupName || "defKey-" + utils.genUniqueID()
        }

        eDwUIHTMLEventMgr.prototype.addDelegatedEventHandler = function (iElemSelector, iEventName, iEventHandler) {
            return eDwUIHTMLEventMgr.addDelegatedEventHandler(iElemSelector, iEventName, iEventHandler, this.mGroupName)
        };
        eDwUIHTMLEventMgr.prototype.addEventHandler = function (iElemID, iEventName, iEventHandler) {
            return eDwUIHTMLEventMgr.addEventHandler(iElemID, iEventName, iEventHandler, this.mGroupName)
        };
        eDwUIHTMLEventMgr.prototype.addXSSEventHandler = function (iEventName, iEventHandler, iEnforceSecurity) {
            if (iEnforceSecurity === void 0) {
                iEnforceSecurity = false
            }
            return eDwUIHTMLEventMgr.addXSSEventHandler(iEventName, iEventHandler, iEnforceSecurity, this.mGroupName)
        };
        eDwUIHTMLEventMgr.prototype.removeAllEventHandlers = function () {
            eDwUIHTMLEventMgr.removeAllEventHandlers(this.mGroupName)
        };
        eDwUIHTMLEventMgr.prototype.removeEventHandlers = function (iElemID, iEventName) {
            return eDwUIHTMLEventMgr.removeEventHandlers(iElemID, iEventName, this.mGroupName)
        };
        eDwUIHTMLEventMgr.addDelegatedEventHandler = function (iElemSelector, iEventName, iEventHandler, iGroupName) {
            if (iGroupName === void 0) {
                iGroupName = cDefaultGroupName
            }
            if (!iElemSelector || !iEventName || !iEventHandler) return false;
            var selectors = iElemSelector.split(" ");
            if (selectors.length < 2) return false;
            var ancestorElementID = selectors.shift();
            var classes = selectors.join().replace(".", "");
            return eDwUIHTMLEventMgr.commonAddEventHandler(iGroupName, ancestorElementID, iEventName, iEventHandler, classes)
        };
        eDwUIHTMLEventMgr.addEventHandler = function (iElemID, iEventName, iEventHandler, iGroupName) {
            if (iGroupName === void 0) {
                iGroupName = cDefaultGroupName
            }
            if (!iElemID || !iEventName || !iEventHandler) return false;
            return eDwUIHTMLEventMgr.commonAddEventHandler(iGroupName, iElemID, iEventName, iEventHandler)
        };
        eDwUIHTMLEventMgr.addXSSEventHandler = function (iEventName, iEventHandler, iEnforceSecurity, iGroupName) {
            if (iEnforceSecurity === void 0) {
                iEnforceSecurity = false
            }
            if (iGroupName === void 0) {
                iGroupName = cDefaultGroupName
            }
            if (!iEventName || !iEventHandler) return false;
            var eventHandlerFunc = function (iEvent) {
                if (utils.isOfType(iEvent, "origin")) {
                    if (iEnforceSecurity && iEvent.origin !== window.location.origin) {
                        return
                    }
                    if (iEvent.data.EventName === iEventName) {
                        iEventHandler(iEvent.data)
                    }
                }
            };
            return eDwUIHTMLEventMgr.commonAddEventHandler(iGroupName, "window", "message", eventHandlerFunc)
        };
        eDwUIHTMLEventMgr.removeAllEventHandlers = function (iGroupName) {
            if (iGroupName === void 0) {
                iGroupName = cDefaultGroupName
            }
            var eventHandlerData = eDwUIHTMLEventMgr.sEventHandlerGrouping[iGroupName || cDefaultGroupName];
            for (var eventName in eventHandlerData) {
                if (eventHandlerData.hasOwnProperty(eventName)) {
                    var handlersOfEvent = eventHandlerData[eventName];
                    for (var elemID in handlersOfEvent) {
                        if (handlersOfEvent.hasOwnProperty(elemID)) {
                            this.removeEventHandlersByID(elemID, eventName, handlersOfEvent)
                        }
                    }
                    delete eventHandlerData[eventName]
                }
            }
            eventHandlerData = {}
        };
        eDwUIHTMLEventMgr.removeEventHandlers = function (iElemID, iEventName, iGroupName) {
            if (iGroupName === void 0) {
                iGroupName = cDefaultGroupName
            }
            var handlersRemoved = false;
            var eventHandlerData = eDwUIHTMLEventMgr.sEventHandlerGrouping[iGroupName || cDefaultGroupName];
            if (eventHandlerData.hasOwnProperty(iEventName)) {
                var handlersOfEvent = eventHandlerData[iEventName];
                if (handlersOfEvent.hasOwnProperty(iElemID)) {
                    handlersRemoved = this.removeEventHandlersByID(iElemID, iEventName, handlersOfEvent)
                }
            }
            return handlersRemoved
        };
        eDwUIHTMLEventMgr.commonAddEventHandler = function (iEventGroupName, iElemID, iEventName, iEventHandler, iElemClasses) {
            var e_63, _a, e_64, _b;
            if (iElemClasses === void 0) {
                iElemClasses = ""
            }
            if (!iElemID) return false;
            var elements = [];
            if (iElemID === "window") elements.push(window); else if (iElemID === "document") elements.push(document); else elements = $(iElemID).toArray();
            if (!elements.length) return false;
            var groupingMap = eDwUIHTMLEventMgr.sEventHandlerGrouping = eDwUIHTMLEventMgr.sEventHandlerGrouping || {};
            var group = groupingMap[iEventGroupName] = groupingMap[iEventGroupName] || {};
            var handlersOfEvent = group[iEventName] = group[iEventName] || {};
            var elemHandlers = handlersOfEvent[iElemID];
            if (!elemHandlers) {
                elemHandlers = handlersOfEvent[iElemID] = {MainDispatcher: null, Handlers: []}
            }
            if (elemHandlers.MainDispatcher) {
                try {
                    for (var elements_1 = __values(elements), elements_1_1 = elements_1.next(); !elements_1_1.done; elements_1_1 = elements_1.next()) {
                        var element = elements_1_1.value;
                        element.removeEventListener(iEventName, elemHandlers.MainDispatcher, true)
                    }
                } catch (e_63_1) {
                    e_63 = {error: e_63_1}
                } finally {
                    try {
                        if (elements_1_1 && !elements_1_1.done && (_a = elements_1.return)) _a.call(elements_1)
                    } finally {
                        if (e_63) throw e_63.error
                    }
                }
            }
            elemHandlers.MainDispatcher = function (ioEvent) {
                eventDispatcher(ioEvent, elemHandlers.Handlers)
            };
            try {
                for (var elements_2 = __values(elements), elements_2_1 = elements_2.next(); !elements_2_1.done; elements_2_1 = elements_2.next()) {
                    var element = elements_2_1.value;
                    element.addEventListener(iEventName, elemHandlers.MainDispatcher, true);
                    // console.log(`plm test addEvent:  ${iEventName}`)
                    
                    elemHandlers.Handlers.push({
                        EventTarget: element,
                        ElementID: iElemID,
                        TargetElemClasses: iElemClasses,
                        Handler: iEventHandler
                    })
                }
            } catch (e_64_1) {
                e_64 = {error: e_64_1}
            } finally {
                try {
                    if (elements_2_1 && !elements_2_1.done && (_b = elements_2.return)) _b.call(elements_2)
                } finally {
                    if (e_64) throw e_64.error
                }
            }
            console.debugLog("UIEventMgr", "Added event - name = " + iEventName + ", id = " + iElemID + ", classes = " + iElemClasses + ", Num handlers = " + elemHandlers.Handlers.length);
            return true
        };
        eDwUIHTMLEventMgr.removeEventHandlersByID = function (iElemID, iEventName, ioHandlersOfEvent) {
            var e_65, _a;
            var handlersRemoved = false;
            var elemHandlers = ioHandlersOfEvent[iElemID];
            if (elemHandlers && elemHandlers.Handlers.length) {
                console.debugLog("UIEventMgr", "Removed " + elemHandlers.Handlers.length + " handlers for event " + iEventName + " on element ID " + iElemID);
                try {
                    for (var _b = __values(elemHandlers.Handlers), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var handler = _c.value;
                        handler.EventTarget.removeEventListener(iEventName, elemHandlers.MainDispatcher, true)
                    }
                } catch (e_65_1) {
                    e_65 = {error: e_65_1}
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                    } finally {
                        if (e_65) throw e_65.error
                    }
                }
                elemHandlers.Handlers = [];
                handlersRemoved = true
            } else {
                console.debugLog("UIEventMgr", "Tried to remove handlers for event " + iEventName + " on element ID " + iElemID + " but they were removed already.")
            }
            return handlersRemoved
        };
        return eDwUIHTMLEventMgr
    }();
    var cDefaultGroupName = "global";

    function eventDispatcher(ioEvent, iHandlerObjs) {
        var e_66, _a;
        if (!iHandlerObjs || !iHandlerObjs.length) return;
        console.debugLog("UIEvents", "Event = " + ioEvent.type + ", Num handlers = " + iHandlerObjs.length);
        var runHandler = false;
        var targetJQ = jqutils.getAsJQueryObj(ioEvent.target);
        while (targetJQ.length && !runHandler) {
            try {
                for (var iHandlerObjs_1 = (e_66 = void 0, __values(iHandlerObjs)), iHandlerObjs_1_1 = iHandlerObjs_1.next(); !iHandlerObjs_1_1.done; iHandlerObjs_1_1 = iHandlerObjs_1.next()) {
                    var handlerObj = iHandlerObjs_1_1.value;
                    var targetClassName = targetJQ.className;
                    console.debugLog("UIEvents", "  element ID = " + handlerObj.ElementID + ", target classes = " + handlerObj.TargetElemClasses + (targetClassName ? ", event target classes = " + targetClassName : ""));
                    var targetElemClasses = handlerObj.TargetElemClasses;
                    var classes = targetElemClasses ? targetElemClasses.split(" ") : [];
                    var numMatches = 0;
                    for (var j = 0; j < classes.length; j++) {
                        numMatches += targetJQ.hasClass(classes[j]) ? 1 : 0
                    }
                    if (numMatches !== classes.length) continue;
                    handlerObj.Handler(ioEvent);
                    runHandler = true;
                    var eventJQ = $(ioEvent);
                    if (ioEvent.cancelable && ioEvent.cancelBubble || eventJQ.isPropagationStopped && eventJQ.isPropagationStopped()) {
                        return
                    }
                }
            } catch (e_66_1) {
                e_66 = {error: e_66_1}
            } finally {
                try {
                    if (iHandlerObjs_1_1 && !iHandlerObjs_1_1.done && (_a = iHandlerObjs_1.return)) _a.call(iHandlerObjs_1)
                } finally {
                    if (e_66) throw e_66.error
                }
            }
            targetJQ = jqutils.getAsJQueryObj(targetJQ.parent());
            if (!runHandler && targetJQ.length) {
                console.debugLog("UIEvents", "Events not found on target, checking parent " + "id=" + targetJQ.id + ", class=" + targetJQ.className)
            } else if (!runHandler) {
                console.debugLog("UIEvents", "No matching events found on target.")
            } else {
                console.debugLog("UIEvents", "Done processing event handlers.")
            }
        }
    }

    return eDwUIHTMLEventMgr
}));
define("eDwUIHTMLGenerator", ["require", "exports", "eDwHierarchyNode", "utils"], (function (require, exports, eDwHierarchyNode, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwUINodeHTMLGenerator = exports.eDwUIHTMLGenerator = void 0;
    var cDefaultInitialLeftPaddingInPX = 4;
    var cDefaultLeftPaddingInPX = 27;
    var eDwUIHTMLGenerator = function () {
        function eDwUIHTMLGenerator(iPanelUIID) {
            this.mPanelUIID = iPanelUIID
        }

        eDwUIHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    return [2, ""]
                }))
            }))
        };
        return eDwUIHTMLGenerator
    }();
    exports.eDwUIHTMLGenerator = eDwUIHTMLGenerator;
    var eDwUINodeHTMLGenerator = function (_super) {
        __extends(eDwUINodeHTMLGenerator, _super);

        function eDwUINodeHTMLGenerator(iViewer, iPanelUIID, iInitialLeftPaddingInPX, iLeftPaddingInPX) {
            if (iInitialLeftPaddingInPX === void 0) {
                iInitialLeftPaddingInPX = cDefaultInitialLeftPaddingInPX
            }
            if (iLeftPaddingInPX === void 0) {
                iLeftPaddingInPX = cDefaultLeftPaddingInPX
            }
            var _this = _super.call(this, iPanelUIID) || this;
            _this.mViewer = iViewer;
            _this.mPanelUIID = iPanelUIID;
            _this.mLeftPaddingInPX = iLeftPaddingInPX;
            _this.mInitialLeftPaddingInPX = iInitialLeftPaddingInPX;
            return _this
        }

        eDwUINodeHTMLGenerator.prototype.generateHTMLForChildNodes = function (iParentNode, iIncludeAllDescendents, iLeftPaddingInPX) {
            var e_67, _a;
            if (iIncludeAllDescendents === void 0) {
                iIncludeAllDescendents = false
            }
            if (iLeftPaddingInPX === void 0) {
                iLeftPaddingInPX = NaN
            }
            var generatedHTML = "";
            var offset = this.computeOffset(iLeftPaddingInPX);
            var childrenNodes = this.forNodeGetChildren(iParentNode);
            try {
                for (var childrenNodes_1 = __values(childrenNodes), childrenNodes_1_1 = childrenNodes_1.next(); !childrenNodes_1_1.done; childrenNodes_1_1 = childrenNodes_1.next()) {
                    var childNode = childrenNodes_1_1.value;
                    var descendentsHTML = iIncludeAllDescendents ? this.generateHTMLForChildNodes(childNode, iIncludeAllDescendents, offset) : "";
                    if (!this.shouldIncludeNode(childNode) && descendentsHTML.length === 0) {
                        continue
                    }
                    var moreClasses = descendentsHTML ? " edrawings-tree-expanded " : "";
                    var nodeHTML = this.generateHTMLForNode(childNode, offset, moreClasses);
                    generatedHTML += nodeHTML + descendentsHTML
                }
            } catch (e_67_1) {
                e_67 = {error: e_67_1}
            } finally {
                try {
                    if (childrenNodes_1_1 && !childrenNodes_1_1.done && (_a = childrenNodes_1.return)) _a.call(childrenNodes_1)
                } finally {
                    if (e_67) throw e_67.error
                }
            }
            return generatedHTML
        };
        eDwUINodeHTMLGenerator.prototype.generateHTMLForNode = function (iNode, iLeftPaddingInPX, iAdditionalClasses, iIgnoreChildren) {
            if (iAdditionalClasses === void 0) {
                iAdditionalClasses = ""
            }
            if (iIgnoreChildren === void 0) {
                iIgnoreChildren = false
            }
            var additionalClasses = iAdditionalClasses.replace("edrawings-tree-expanded", "");
            var expanded = iAdditionalClasses.length !== additionalClasses.length;
            var highlight = this.getHighlightClass(iNode);
            var nonRootClass = additionalClasses.indexOf("edrawings-root") > -1 || highlight === "" ? "" : " edrawings-list-option";
            var currOffset = utils.isNaN(iLeftPaddingInPX) ? this.mInitialLeftPaddingInPX + "px" : iLeftPaddingInPX + "px";
            var generatedHTML = "<div class='edrawings-submenu-list-item" + highlight + " " + additionalClasses + "' style='padding-left: " + currOffset + "; width:calc(100% - " + currOffset + ");' " + this.forNodeGetDataAttributes(iNode) + ">";
            generatedHTML += this.getPreSpanHTML(iNode, additionalClasses, expanded, iIgnoreChildren);
            generatedHTML += "<span class='item-tree-text" + highlight + " " + additionalClasses + "' " + this.forNodeGetDataAttributes(iNode) + "style='margin-left: 0px;'>" + this.forNodeGetElementContent(iNode) + "</span>";
            generatedHTML += this.getPostSpanHTML(nonRootClass + " " + additionalClasses);
            generatedHTML += "</div>";
            return generatedHTML
        };
        eDwUINodeHTMLGenerator.prototype.getNodeFromID = function (iNodeID) {
            var model = this.mViewer.getModel();
            return model.getHierarchyNode(iNodeID)
        };
        eDwUINodeHTMLGenerator.getDisplayStateCSSClass = function (iHierNode, iNewAttrib) {
            if (!iHierNode) return "";
            var classCSS = "edrawings-" + iHierNode.Category;
            classCSS += iHierNode.isActive() ? "" : "-inactive";
            var dummyNode = eDwHierarchyNode.create(iNewAttrib);
            var displayState = iNewAttrib ? dummyNode.getDisplayState(iHierNode.getAttribs()) : iHierNode.getDisplayState();
            switch (displayState) {
                case"Visible":
                case"Transparent":
                case"Invisible":
                    classCSS += "-" + displayState.toLowerCase();
                    break;
                default:
                    console.debugLog("UI", "Invalid node display type: " + displayState)
            }
            return classCSS
        };
        eDwUINodeHTMLGenerator.prototype.shouldIncludeNode = function (iNode) {
            var searchField = $(this.mPanelUIID + " .edrawings-menu-search-input");
            if (searchField && searchField.val()) {
                var regex = new RegExp(searchField.val(), "i");
                if (this.forNodeGetName(iNode).search(regex) < 0) return false
            }
            return true
        };
        eDwUINodeHTMLGenerator.prototype.getHighlightClass = function (iNode) {
            var isSelected = this.mViewer.SelectionMgr.isSelected(this.forNodeGetID(iNode));
            return isSelected ? " edrawings-list-selected " : ""
        };
        eDwUINodeHTMLGenerator.prototype.getPreSpanIconHTML = function (iNode, iAdditionalClasses, iNodeExpanded, iIgnoreChildren) {
            var generatedHTML = "";
            if (!iIgnoreChildren && this.forNodeHasChildren(iNode)) {
                generatedHTML += "edrawings-tree-arrow " + "edrawings-tree-arrow-space-common ";
                if (iNodeExpanded) generatedHTML += "edrawings-tree-expanded "
            } else {
                generatedHTML += "edrawings-tree-space " + "edrawings-tree-arrow-space-common "
            }
            return generatedHTML
        };
        eDwUINodeHTMLGenerator.prototype.getPreSpanHTML = function (iNode, iAdditionalClasses, iNodeExpanded, iIgnoreChildren) {
            var generatedHTML = "<div class='" + this.getPreSpanIconHTML(iNode, iAdditionalClasses, iNodeExpanded, iIgnoreChildren);
            var nodeIconClass = this.forNodeGetIconCSSClass(iNode);
            generatedHTML += iAdditionalClasses + "' data-hoopsid='" + this.forNodeGetID(iNode) + "'> </div> <div class='" + nodeIconClass + " " + iAdditionalClasses + " edrawings-tree-icon'> </div>";
            return generatedHTML
        };
        eDwUINodeHTMLGenerator.prototype.getPostSpanHTML = function (iAdditionalClasses) {
            return "<div class='edrawings-submenu-list-item-button " + iAdditionalClasses + "'> </div>"
        };
        eDwUINodeHTMLGenerator.prototype.computeOffset = function (iLeftPaddingInPX) {
            if (iLeftPaddingInPX === void 0) {
                iLeftPaddingInPX = NaN
            }
            return utils.isNaN(iLeftPaddingInPX) ? this.mInitialLeftPaddingInPX : iLeftPaddingInPX + this.mLeftPaddingInPX
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetName = function (iNode) {
            return eDwUINodeHTMLGenerator.getHierarchyNode(iNode).Name
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetID = function (iNode) {
            return eDwUINodeHTMLGenerator.getHierarchyNode(iNode).HOOPSID
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetParentID = function (iNode) {
            var parentHierNode = eDwUINodeHTMLGenerator.getHierarchyNode(iNode).Parent;
            return parentHierNode ? parentHierNode.HOOPSID : NaN
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetChildren = function (iNode) {
            var childrenObj = eDwUINodeHTMLGenerator.getHierarchyNode(iNode).getChildrenAndKeys();
            return Object.keys(childrenObj).map((function (key) {
                return childrenObj[key]
            }))
        };
        eDwUINodeHTMLGenerator.prototype.forNodeHasChildren = function (iNode) {
            return this.forNodeGetChildren(iNode).length > 0
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetDataAttributes = function (iNode) {
            var parentNodeID = this.forNodeGetParentID(iNode);
            return " data-hoopsid='" + this.forNodeGetID(iNode) + "' " + (parentNodeID !== undefined ? "data-hoopsparentid='" + parentNodeID + "' " : "")
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetElementContent = function (iNode) {
            return this.forNodeGetName(iNode)
        };
        eDwUINodeHTMLGenerator.prototype.forNodeGetIconCSSClass = function (iNode) {
            return eDwUINodeHTMLGenerator.getDisplayStateCSSClass(eDwUINodeHTMLGenerator.getHierarchyNode(iNode))
        };
        eDwUINodeHTMLGenerator.getHierarchyNode = function (iNode) {
            if (!eDwHierarchyNode.isHierarchyNode(iNode)) {
                throw new Error("Not a hierarchy node:\n" + JSON.stringify(iNode))
            }
            return iNode
        };
        return eDwUINodeHTMLGenerator
    }(eDwUIHTMLGenerator);
    exports.eDwUINodeHTMLGenerator = eDwUINodeHTMLGenerator
}));


define("eDwUIHierNodeVisMenuItemsPlugin", ["require", "exports", "eDwCommandMgr", "eDwSetHierNodeAttribsCmd", "eDwShowOnlyCmd", "eDwUIUtils", "eDwEventMgr", "eDwUIShortcutMenu", "eDwKeyMgr", "eDwEvents", "eDwUIBasePlugin", "utils", "jqutils"], (function (require, exports, eDwCommandMgr, eDwSetHierNodeAttribsCmd, eDwShowOnlyCmd, eDwUIUtils, eDwEventMgr, eDwUIShortcutMenu_4, eDwKeyMgr_4, eDwEvents_7, eDwUIBasePlugin_1, utils, jqutils) {
    "use strict";
    var eDwUIHierNodeVisMenuItemPlugin = function (_super) {
        __extends(eDwUIHierNodeVisMenuItemPlugin, _super);

        function eDwUIHierNodeVisMenuItemPlugin(iViewer, iViewerFeatOpts) {
            return _super.call(this, "HideShow", iViewer) || this
        }

        eDwUIHierNodeVisMenuItemPlugin.prototype.init = function () {
            return __awaiter(this, void 0, void 0, (function () {
                function isNotPartModel(iViewer) {
                    return !iViewer.getModel().isPart()
                }

                var shortcutMenu, isVisibleForASMAndDRW, isVisibleForASM, isVisibleNonRootForASMAndDRW;
                var _this = this;
                return __generator(this, (function (_a) {
                    _super.prototype.init.call(this);
                    shortcutMenu = eDwUIShortcutMenu_4.eDwUIShortcutMenu.get();
                    if (!shortcutMenu.isEmpty()) {
                        shortcutMenu.addMenuSeparator(this.PluginClassName)
                    }
                    isVisibleForASMAndDRW = function (iViewer, iIsSelected) {
                        return iIsSelected && isNotPartModel(iViewer)
                    };
                    isVisibleForASM = function (iViewer, iIsSelected) {
                        return iIsSelected && iViewer.getModel().isAssembly()
                    };
                    isVisibleNonRootForASMAndDRW = function (iViewer, iIsSelected) {
                        var model = iViewer.getModel();
                        var modelViewHierNode = model.getActiveModelView().Hierarchy;
                        var lastSelHierNode = iViewer.SelectionMgr.getLastSelHierarchyNode();
                        return iIsSelected && (model.isDrawing() || model.isAssembly() && modelViewHierNode !== lastSelHierNode.Parent)
                    };
                    shortcutMenu.addMenuItem(this.PluginClassName, "Strings.HideShow", (function (iEvent, iUIItemJQ, iArg) {
                        var selMgr = _this.mViewer.SelectionMgr;
                        var selHierNodes = selMgr.getSelHierarchyNodes();
                        if (selHierNodes && selHierNodes.length) {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    var attribs, selHideShowCmd;
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                attribs = selHierNodes[0].getAttribs().copy();
                                                attribs.Visible = !attribs.Visible;
                                                selHideShowCmd = new eDwSetHierNodeAttribsCmd(this.mViewer, selHierNodes, attribs);
                                                return [4, eDwCommandMgr.get().run(selHideShowCmd, "commit")];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })()
                        }
                        eDwUIShortcutMenu_4.eDwUIShortcutMenu.hide()
                    }), isVisibleForASMAndDRW);
                    shortcutMenu.addMenuItem(this.PluginClassName, "Strings.TransparentSolid", (function (iEvent, iUIItemJQ, iArg) {
                        (function () {
                            return __awaiter(_this, void 0, void 0, (function () {
                                var selMgr, selHierNodes, attribs, selTransSolidCmd;
                                return __generator(this, (function (_a) {
                                    switch (_a.label) {
                                        case 0:
                                            selMgr = this.mViewer.SelectionMgr;
                                            selHierNodes = selMgr.getSelHierarchyNodes();
                                            if (!(selHierNodes && selHierNodes.length)) return [3, 2];
                                            attribs = selHierNodes[0].getAttribs().copy();
                                            attribs.Opaque = !attribs.Opaque;
                                            selTransSolidCmd = new eDwSetHierNodeAttribsCmd(this.mViewer, selHierNodes, attribs);
                                            return [4, eDwCommandMgr.get().run(selTransSolidCmd, "commit")];
                                        case 1:
                                            _a.sent();
                                            _a.label = 2;
                                        case 2:
                                            return [2]
                                    }
                                }))
                            }))
                        })();
                        eDwUIShortcutMenu_4.eDwUIShortcutMenu.hide()
                    }), isVisibleForASM);
                    shortcutMenu.addMenuItem(this.PluginClassName, "Strings.HideOthers", (function (iEvent, iUIItemJQ, iArg) {
                        (function () {
                            return __awaiter(_this, void 0, void 0, (function () {
                                var selMgr, showOnlyCmd;
                                return __generator(this, (function (_a) {
                                    switch (_a.label) {
                                        case 0:
                                            console.log(`plm test:HideOthers`)
                                            selMgr = this.mViewer.SelectionMgr;
                                            showOnlyCmd = new eDwShowOnlyCmd(this.mViewer, selMgr.getSelHierarchyNodes());
                                            return [4, eDwCommandMgr.get().run(showOnlyCmd, "commit")];
                                        case 1:
                                            _a.sent();
                                            return [2]
                                    }
                                }))
                            }))
                        })();
                        eDwUIShortcutMenu_4.eDwUIShortcutMenu.hide()
                    }), isVisibleNonRootForASMAndDRW);
                    shortcutMenu.addMenuItem(this.PluginClassName, "Strings.Show.All", (function (iEvent, iUIItemJQ, iArg) {
                        (function () {
                            return __awaiter(_this, void 0, void 0, (function () {
                                var showAllCmd;
                                return __generator(this, (function (_a) {
                                    switch (_a.label) {
                                        case 0:
                                            showAllCmd = new eDwShowOnlyCmd(this.mViewer);
                                            return [4, eDwCommandMgr.get().run(showAllCmd, "commit")];
                                        case 1:
                                            _a.sent();
                                            return [2]
                                    }
                                }))
                            }))
                        })();
                        eDwUIShortcutMenu_4.eDwUIShortcutMenu.hide()
                    }), isNotPartModel);
                    this.mUIHTMLEventMgr.addDelegatedEventHandler("#edrawings-viewer .edrawings-submenu-list-item-button", "click", (function (iEvent) {
                        console.debugLog("UIPlugin", "HideShow menu button click");
                        var selected = false;
                        var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                        var parentJQ = targetJQ.parent();
                        eDwUIUtils.scrollToTarget(parentJQ);
                        var selIDHC = eDwUIUtils.getIDHC(parentJQ);
                        if (!isNaN(selIDHC)) {
                            var existingIdx = _this.mViewer.SelectionMgr.getSelectedNodeIDIndex(selIDHC);
                            selected = existingIdx > -1 ? true : _this.mViewer.SelectionMgr.selectByID(selIDHC)
                        }
                        if (selected) {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, this.fireEvent(iEvent, eDwEvents_7.RightClickEvent)];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })()
                        }
                    }));
                    console.debugLog("UIPlugin", "Added HideShow click event handler");
                    this.mUIHTMLEventMgr.addDelegatedEventHandler("#edrawings-viewer .edrawings-submenu-list-item", "mouseup", (function (iEvent) {
                        console.debugLog("UIPlugin", "HideShow menu mouseup");
                        if (_this.mViewer.ViewerFeatureOpts.Debug) {
                            var positions = eDwUIUtils.getEventPositions(iEvent);
                            console.log("Event position x: " + positions[0].x + ", y:" + positions[0].y)
                        }
                        var eventJQ = $(iEvent);
                        var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                        eDwUIUtils.scrollToTarget(targetJQ);
                        if (!targetJQ || !targetJQ.length || !eventJQ || !eventJQ.length || targetJQ.hasClass("edrawings-root") || targetJQ.hasClass("edrawings-tree-arrow") || targetJQ.hasClass("edrawings-tree-expanded") || targetJQ.hasClass("edrawings-tree-icon") || targetJQ.hasClass("edrawings-exclusive")) {
                            return
                        }
                        if (!targetJQ.hasClass("edrawings-submenu-list-item")) return;
                        var mouseEvent = iEvent;
                        var pressedRMB = eDwKeyMgr_4.eDwKeyMgr.isRMBPressed(mouseEvent);
                        var selected = false;
                        var selIDHC = eDwUIUtils.getIDHC(targetJQ);
                        if (utils.isNumber(selIDHC)) {
                            if (!eDwKeyMgr_4.eDwKeyMgr.get().isDown("Shift")) {
                                selected = _this.mViewer.SelectionMgr.selectByID(selIDHC)
                            } else {
                                var selector = ".edrawings-submenu-list-item" + ".edrawings-list-selected:has([data-hoopsid])";
                                var filter = ".edrawings-submenu-list-item:has([data-hoopsid])";
                                var collectionPrevJQ = targetJQ.prevUntil(selector, filter);
                                if (collectionPrevJQ.length === 0 || collectionPrevJQ.last().prev(selector).length === 0) {
                                    collectionPrevJQ = $([])
                                }
                                var collectionNextJQ = targetJQ.nextUntil(selector, filter);
                                if (collectionNextJQ.length === 0 || collectionNextJQ.last().next(selector).length === 0) {
                                    collectionNextJQ = $([])
                                }
                                var collectionJQ = $([]).add(collectionPrevJQ).add(targetJQ).add(collectionNextJQ);
                                collectionJQ.each((function (iIdx, iElement) {
                                    var elementJQ = $(iElement);
                                    var selIDHC = eDwUIUtils.getIDHC(elementJQ);
                                    _this.mViewer.SelectionMgr.selectByID(selIDHC)
                                }));
                                selected = true;
                                iEvent.preventDefault()
                            }
                        } else {
                            selected = !targetJQ.hasClass("edrawings-list-selected");
                            targetJQ[selected ? "addClass" : "removeClass"]("edrawings-list-selected")
                        }
                        (function () {
                            return __awaiter(_this, void 0, void 0, (function () {
                                return __generator(this, (function (_a) {
                                    switch (_a.label) {
                                        case 0:
                                            if (!(selected && pressedRMB)) return [3, 2];
                                            return [4, this.fireEvent(iEvent, eDwEvents_7.RightClickEvent)];
                                        case 1:
                                            _a.sent();
                                            _a.label = 2;
                                        case 2:
                                            return [2]
                                    }
                                }))
                            }))
                        })()
                    }));
                    console.debugLog("UIPlugin", "Added HideShow mouseup event handler");
                    return [2]
                }))
            }))
        };
        eDwUIHierNodeVisMenuItemPlugin.prototype.check = function (iPluginName) {
            return _super.prototype.check.call(this, iPluginName) || iPluginName === undefined
        };
        eDwUIHierNodeVisMenuItemPlugin.prototype.fireEvent = function (iEvent, iAppEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var positions;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!iEvent || !iAppEvent || !this.mViewer) return [2];
                            if (!(iAppEvent === eDwEvents_7.RightClickEvent)) return [3, 2];
                            positions = eDwUIUtils.getEventPositions(iEvent);
                            return [4, eDwEventMgr.get().fireEvent(iAppEvent, this.mViewer, positions[0], $(iEvent.target), this.PluginClassName)];
                        case 1:
                            _a.sent();
                            return [3, 4];
                        case 2:
                            if (!(iAppEvent === eDwEvents_7.UnselectEvent)) return [3, 4];
                            return [4, eDwEventMgr.get().fireEvent(iAppEvent, this.mViewer, [])];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            return [2]
                    }
                }))
            }))
        };
        return eDwUIHierNodeVisMenuItemPlugin
    }(eDwUIBasePlugin_1.eDwUIBasePlugin);
    return eDwUIHierNodeVisMenuItemPlugin
}));
define("eDwUILayerHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator", "eDwLayer", "utils"], (function (require, exports, eDwUIHTMLGenerator_3, eDwLayer, utils) {
    "use strict";
    var eDwUILayerHTMLGenerator = function (_super) {
        __extends(eDwUILayerHTMLGenerator, _super);

        function eDwUILayerHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUILayerHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML, layers, layers_2, layers_2_1, layer;
                var e_68, _a;
                return __generator(this, (function (_b) {
                    generatedHTML = "";
                    layers = this.mViewer.getModel().getLayers();
                    if (layers.length) {
                        generatedHTML += "<div class='edrawings-submenu-list-item " + "edrawings-root' style='padding-left: " + this.mInitialLeftPaddingInPX + "px; " + "width:calc(100% - " + this.mInitialLeftPaddingInPX + "px);'> " + "<input id='layer-all' class='layer-all " + " edrawings-layer-checkbox-style' " + " type='checkbox' checked> " + "<span class='item-tree-text' " + "data-i18n-inner='Strings.Name'>" + "Name</span></div>" + "<hr style='margin-top:0;margin-left:5px;" + "margin-right:10px;'>"
                    }
                    try {
                        for (layers_2 = __values(layers), layers_2_1 = layers_2.next(); !layers_2_1.done; layers_2_1 = layers_2.next()) {
                            layer = layers_2_1.value;
                            if (!this.shouldIncludeNode(layer)) continue;
                            generatedHTML += this.generateHTMLForNode(layer, NaN, "edrawings-root " + iAdditionalClasses, true)
                        }
                    } catch (e_68_1) {
                        e_68 = {error: e_68_1}
                    } finally {
                        try {
                            if (layers_2_1 && !layers_2_1.done && (_a = layers_2.return)) _a.call(layers_2)
                        } finally {
                            if (e_68) throw e_68.error
                        }
                    }
                    return [2, generatedHTML]
                }))
            }))
        };
        eDwUILayerHTMLGenerator.prototype.getPreSpanHTML = function (iLayer, iAdditionalClasses, iNodeExpanded, iIgnoreChildren) {
            return "<input class='item-layer-checkbox" + " edrawings-layer-checkbox-style' type='checkbox' " + (iLayer.getAttribs().Visible ? "checked" : "unchecked") + ">"
        };
        eDwUILayerHTMLGenerator.prototype.getPostSpanHTML = function (iAdditionalClasses) {
            return ""
        };
        eDwUILayerHTMLGenerator.prototype.shouldIncludeNode = function (iLayer) {
            return true
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetName = function (iNode) {
            return l_getLayer(iNode).getName()
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetID = function (iNode) {
            return l_getLayer(iNode).getIDHC()
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetParentID = function (iNode) {
            return NaN
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetChildren = function (iNode) {
            var childNodes = [];
            if (this.mViewer.ViewerFeatureOpts.Debug) {
                childNodes = l_getLayer(iNode).getNodeIDsHC()
            }
            return childNodes
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetDataAttributes = function (iNode) {
            return ""
        };
        eDwUILayerHTMLGenerator.prototype.forNodeGetIconCSSClass = function (iNode) {
            return ""
        };
        return eDwUILayerHTMLGenerator
    }(eDwUIHTMLGenerator_3.eDwUINodeHTMLGenerator);

    function l_getLayer(iNode) {
        if (!utils.isInstanceOf(iNode, eDwLayer)) {
            throw new Error("Not a layer:\n" + JSON.stringify(iNode))
        }
        return iNode
    }

    return eDwUILayerHTMLGenerator
}));
define("eDwUILocalize", ["require", "exports", "eDwLanguages", "eDwEvents", "eDwEventMgr", "eDwUIHTMLEventMgr", "eDwUIUtils", "eDwUIHTMLGenerator", "jqutils", "utils"], (function (require, exports, eDwLanguages_1, eDwEvents_8, eDwEventMgr, eDwUIHTMLEventMgr, eDwUIUtils, eDwUIHTMLGenerator_4, jqutils, utils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwUILocalize = void 0;
    var eDwUILocalize = function () {
        function eDwUILocalize() {
        }

        eDwUILocalize.initialize = function (iLocale) {
            return __awaiter(this, void 0, void 0, (function () {
                var localizations, entry, localeRefMap, localeUIGen, html;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            localizations = eDwLanguages_1.default;
                            for (entry in localizations) {
                                localeRefMap = localizations[entry];
                                eDwUILocalize.sLocaleMap.set(localeRefMap.Locale.Code, localeRefMap)
                            }
                            eDwUILocalize.setLocale(iLocale);
                            if (!eDwUILocalize.sCurrLocaleRefMap) {
                                eDwUILocalize.matchLocaleToBrowser();
                                if (!eDwUILocalize.sCurrLocaleRefMap) {
                                    if (!this.setLocale("en-US")) {
                                        console.error("Locale (en-US) not set!")
                                    }
                                }
                            }
                            localeUIGen = new LocaleUIHTMLGenerator(c_langPanelID);
                            return [4, localeUIGen.generateHTML()];
                        case 1:
                            html = _a.sent();
                            eDwUIUtils.refreshList($(c_langListID), html);
                            eDwUIHTMLEventMgr.addEventHandler("window", "languagechange", (function () {
                                eDwUILocalize.matchLocaleToBrowser()
                            }));
                            eDwUIHTMLEventMgr.addXSSEventHandler("OwnerAppLocaleChangeEvent", (function (iEventData) {
                                var locale = eDwUILocalize.sCurrLocaleRefMap.Locale.Code;
                                if (!locale || locale === iEventData.Locale) {
                                    return
                                }
                                eDwUILocalize.changeLocale(iEventData.Locale)
                            }));
                            eDwUIHTMLEventMgr.addDelegatedEventHandler(c_langListItems, "click", (function (iEvent) {
                                var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
                                eDwUILocalize.changeLocale(targetJQ.data("i18n-locale"));
                                eDwUIUtils.deactivateUI(".edrawings-hud-button", ".edrawings-hud-menu");
                                $(c_langListItems).removeClass("edrawings-list-selected");
                                targetJQ.addClass("edrawings-list-selected")
                            }));
                            eDwUILocalize.addLocalizationHandlers();
                            return [2]
                    }
                }))
            }))
        };
        eDwUILocalize.getString = function (iKey) {
            var e_69, _a, e_70, _b;
            if (!iKey) {
                console.error("Key is empty.");
                return "[Localization key is empty]"
            }
            var prefix = "";
            var langRefMaps = [eDwUILocalize.sCurrLocaleRefMap, eDwUILocalize.sLocaleMap.get("en-US")];
            try {
                for (var langRefMaps_1 = __values(langRefMaps), langRefMaps_1_1 = langRefMaps_1.next(); !langRefMaps_1_1.done; langRefMaps_1_1 = langRefMaps_1.next()) {
                    var langRefMap = langRefMaps_1_1.value;
                    var cKeys = iKey.split(".");
                    try {
                        for (var cKeys_1 = (e_70 = void 0, __values(cKeys)), cKeys_1_1 = cKeys_1.next(); !cKeys_1_1.done; cKeys_1_1 = cKeys_1.next()) {
                            var key = cKeys_1_1.value;
                            var value = langRefMap[key];
                            if (typeof value === "string") return prefix + value; else langRefMap = value
                        }
                    } catch (e_70_1) {
                        e_70 = {error: e_70_1}
                    } finally {
                        try {
                            if (cKeys_1_1 && !cKeys_1_1.done && (_b = cKeys_1.return)) _b.call(cKeys_1)
                        } finally {
                            if (e_70) throw e_70.error
                        }
                    }
                    prefix = "[Unlocalized value]"
                }
            } catch (e_69_1) {
                e_69 = {error: e_69_1}
            } finally {
                try {
                    if (langRefMaps_1_1 && !langRefMaps_1_1.done && (_a = langRefMaps_1.return)) _a.call(langRefMaps_1)
                } finally {
                    if (e_69) throw e_69.error
                }
            }
            return "[localized value is missing for key ${iKey}]"
        };
        eDwUILocalize.localize = function (iElem) {
            var e_71, _a;
            try {
                for (var _b = __values(eDwUILocalize.sLocalizationHandlerFuncs), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var localizationHandlerFunc = _c.value;
                    localizationHandlerFunc(eDwUILocalize.sCurrLocaleRefMap, iElem)
                }
            } catch (e_71_1) {
                e_71 = {error: e_71_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_71) throw e_71.error
                }
            }
        };
        eDwUILocalize.formatNumber = function (iValue) {
            try {
                return eDwUILocalize.sCurrNumberFormat.format(iValue)
            } catch (iExcp) {
                console.error(iExcp)
            }
            return iValue.toString()
        };
        eDwUILocalize.addLocalizationHandlers = function () {
            function localizationHandlerFuncFactory(iName, iElemLocalizationFunc) {
                return function (iLocaleRefMap, iParentElem) {
                    if (!iName) return;
                    var name = iName.toLowerCase();
                    var selector = "[data-i18n-" + name + "]:not([data-i18n-" + name + "=''])";
                    var elems = document.querySelectorAll(selector);
                    var numElems = elems.length;
                    for (var i = 0; i < numElems; ++i) {
                        var elem = elems[i];
                        var localizationKey = "i18n" + utils.capitalizeWord(name);
                        iElemLocalizationFunc(elem, iName, localizationKey)
                    }
                }
            }

            eDwUILocalize.sLocalizationHandlerFuncs.add(localizationHandlerFuncFactory("inner", (function (iElem, iName, iLocalizationKey) {
                var elem = iElem;
                elem[iName + "Text"] = eDwUILocalize.getString(iElem.dataset[iLocalizationKey])
            })));
            eDwUILocalize.sLocalizationHandlerFuncs.add(localizationHandlerFuncFactory("title", (function (iElem, iName, iLocalizationKey) {
                iElem.setAttribute(iName, eDwUILocalize.getString(iElem.dataset[iLocalizationKey]))
            })))
        };
        eDwUILocalize.changeLocale = function (iLocale) {
            if (!eDwUILocalize.setLocale(iLocale)) return;
            eDwUILocalize.localize(document.body);
            eDwEventMgr.get().fireEvent(eDwEvents_8.UpdateLocalizationEvent)
        };
        eDwUILocalize.setLocale = function (iLocale) {
            var localeRef = eDwUILocalize.sLocaleMap.get(iLocale);
            if (!localeRef) {
                var supportedLocale = eDwUILocalize.findSupportedLocale(iLocale);
                if (!supportedLocale) return false;
                localeRef = eDwUILocalize.sLocaleMap.get(supportedLocale)
            }
            if (eDwUILocalize.sCurrLocaleRefMap === localeRef) return false;
            eDwUILocalize.sCurrLocaleRefMap = localeRef;
            eDwUILocalize.sCurrNumberFormat = new Intl.NumberFormat(localeRef.Locale.Code);
            return true
        };
        eDwUILocalize.matchLocaleToBrowser = function () {
            var e_72, _a;
            var localeRefMap = eDwUILocalize.sCurrLocaleRefMap || {Locale: {Code: "en-US"}};
            var locale = localeRefMap.Locale.Code;
            try {
                for (var _b = __values(navigator.languages), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var browserLocale = _c.value;
                    if (eDwUILocalize.sLocaleMap.has(browserLocale)) {
                        locale = browserLocale;
                        break
                    }
                    var supportedLocale = eDwUILocalize.findSupportedLocale(browserLocale);
                    if (supportedLocale) {
                        locale = supportedLocale;
                        break
                    }
                }
            } catch (e_72_1) {
                e_72 = {error: e_72_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_72) throw e_72.error
                }
            }
            eDwUILocalize.changeLocale(locale)
        };
        eDwUILocalize.findSupportedLocale = function (iLocale) {
            var e_73, _a;
            var locale = "";
            if (iLocale) {
                try {
                    for (var _b = __values(eDwUILocalize.sLocaleMap.keys()), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var supportedLocale = _c.value;
                        if (supportedLocale.indexOf(iLocale) === 0) {
                            locale = supportedLocale;
                            break
                        }
                    }
                } catch (e_73_1) {
                    e_73 = {error: e_73_1}
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                    } finally {
                        if (e_73) throw e_73.error
                    }
                }
            }
            return locale
        };
        eDwUILocalize.sLocaleMap = new Map;
        eDwUILocalize.sLocalizationHandlerFuncs = new Set;
        eDwUILocalize.sCurrNumberFormat = null;
        return eDwUILocalize
    }();
    exports.eDwUILocalize = eDwUILocalize;
    var c_langPanelID = "#edrawings-hud-lang-menu";
    var c_langListID = "#edrawings-lang-list";
    var c_langListItems = c_langListID + " .edrawings-submenu-list-item";
    var LocaleUIHTMLGenerator = function (_super) {
        __extends(LocaleUIHTMLGenerator, _super);

        function LocaleUIHTMLGenerator(iPanelUIID) {
            return _super.call(this, iPanelUIID) || this
        }

        LocaleUIHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            if (iAdditionalClasses === void 0) {
                iAdditionalClasses = ""
            }
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML, localizations, localeKey, localRef, additionalClasses;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.generateHTML.call(this, iAdditionalClasses)];
                        case 1:
                            generatedHTML = _a.sent();
                            localizations = eDwLanguages_1.default;
                            for (localeKey in localizations) {
                                localRef = localizations[localeKey].Locale;
                                if (localRef) {
                                    additionalClasses = iAdditionalClasses;
                                    if (eDwUILocalize.sCurrLocaleRefMap.Locale === localRef) {
                                        additionalClasses += " edrawings-list-selected"
                                    }
                                    generatedHTML += "<div class='edrawings-submenu-list-item " + additionalClasses + " edrawings-exclusive'" + " data-i18n-locale='" + localRef.Code + "'>" + localRef.NativeName + "</div>"
                                }
                            }
                            return [2, generatedHTML]
                    }
                }))
            }))
        };
        return LocaleUIHTMLGenerator
    }(eDwUIHTMLGenerator_4.eDwUIHTMLGenerator)
}));
define("eDwUIMessageReporter", ["require", "exports", "eDwUILocalize", "eDwUIUtils", "utils", "jqutils"], (function (require, exports, eDwUILocalize_7, eDwUIUtils, utils, jqutils) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.showMessageInDebugPanel = exports.showMessagePanelFromCSScontent = exports.showResultPanel = exports.showServerLoadErrorPanel = void 0;

    function showServerLoadErrorPanel(iServerID, iModelCacheName) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LoadFailure1"), "edrawings-server-load-failure-1")];
                    case 1:
                        _a.sent();
                        return [4, l_showServerError(iServerID, iModelCacheName)];
                    case 2:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    exports.showServerLoadErrorPanel = showServerLoadErrorPanel;

    function showResultPanel(iResult) {
        return __awaiter(this, void 0, void 0, (function () {
            var showButtons, _a;
            return __generator(this, (function (_b) {
                switch (_b.label) {
                    case 0:
                        showButtons = false;
                        if (!utils.isOfType(iResult, "ServerID")) return [3, 2];
                        return [4, l_showConversionResultPanel(iResult)];
                    case 1:
                        showButtons = _b.sent();
                        return [3, 5];
                    case 2:
                        _a = iResult.ErrorCode;
                        return [3, 3];
                    case 3:
                        return [4, l_showPanelGeneric(iResult)];
                    case 4:
                        showButtons = _b.sent();
                        return [3, 5];
                    case 5:
                        return [2, showButtons]
                }
            }))
        }))
    }

    exports.showResultPanel = showResultPanel;

    function showMessagePanelFromCSScontent(iTextClass, iTextKey, iOptions) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString(iTextKey), iTextClass)];
                    case 1:
                        _a.sent();
                        return [4, l_showMessagePanel()];
                    case 2:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    exports.showMessagePanelFromCSScontent = showMessagePanelFromCSScontent;

    function showMessageInDebugPanel(iMsg) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, l_showMessagePanel(iMsg, null, true, true)];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    exports.showMessageInDebugPanel = showMessageInDebugPanel;

    function l_showConversionResultPanel(iResult) {
        return __awaiter(this, void 0, void 0, (function () {
            var showButtons, _a, str;
            return __generator(this, (function (_b) {
                switch (_b.label) {
                    case 0:
                        showButtons = l_shouldShowButtons();
                        _a = iResult.ErrorCode;
                        switch (_a) {
                            case"URLNotAccessible":
                                return [3, 1];
                            case"UnsupportedFileType":
                                return [3, 4];
                            case"UnknownLicenseError":
                                return [3, 7];
                            case"LicenseVersionMismatch":
                                return [3, 10];
                            case"NoMoreLicenses":
                                return [3, 13];
                            case"CannotConnectToLicenseServer":
                                return [3, 16];
                            case"LicenseExpired":
                                return [3, 19];
                            case"UnknownError":
                                return [3, 22]
                        }
                        return [3, 25];
                    case 1:
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.URLInaccessible");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iResult.ErrorData[0]), "edrawings-server-url-inaccessible")];
                    case 2:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, false, "edrawings-error-title edrawings-dialog-no-close")];
                    case 3:
                        _b.sent();
                        return [3, 29];
                    case 4:
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.UnsupportedFileType");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iResult.FileName), "edrawings-server-unsupported-file-type")];
                    case 5:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, showButtons, "edrawings-error-title edrawings-dialog-no-close")];
                    case 6:
                        _b.sent();
                        return [3, 29];
                    case 7:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.UnknownLicenseError"), "edrawings-unknown-license-error")];
                    case 8:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Warning", true, false, "edrawings-warn-title edrawings-dialog-no-close")];
                    case 9:
                        _b.sent();
                        return [3, 29];
                    case 10:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LicenseVersionMismatch"), "edrawings-license-version-mismatch-error")];
                    case 11:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Warning", true, false, "edrawings-warn-title edrawings-dialog-no-close")];
                    case 12:
                        _b.sent();
                        return [3, 29];
                    case 13:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.NoMoreLicenses"), "edrawings-no-licenses-error")];
                    case 14:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Warning", true, false, "edrawings-warn-title edrawings-dialog-no-close")];
                    case 15:
                        _b.sent();
                        return [3, 29];
                    case 16:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.CannotConnectToLicenseServer"), "edrawings-license-server-connection-error")];
                    case 17:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Warning", true, false, "edrawings-warn-title edrawings-dialog-no-close")];
                    case 18:
                        _b.sent();
                        return [3, 29];
                    case 19:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LicenseExpired"), "edrawings-license-expired-error")];
                    case 20:
                        _b.sent();
                        return [4, l_showMessagePanel("", "Titles.Warning", true, false, "edrawings-warn-title edrawings-dialog-no-close")];
                    case 21:
                        _b.sent();
                        return [3, 29];
                    case 22:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.UnknownError"), "edrawings-unknown-error")];
                    case 23:
                        _b.sent();
                        return [4, l_showServerError(iResult.ServerID, iResult.ModelCacheName)];
                    case 24:
                        _b.sent();
                        return [3, 29];
                    case 25:
                        if (!l_isDebug()) return [3, 27];
                        return [4, l_showPanelGeneric(iResult)];
                    case 26:
                        _b.sent();
                        return [3, 28];
                    case 27:
                        showServerLoadErrorPanel(iResult.ServerID, iResult.ModelCacheName);
                        _b.label = 28;
                    case 28:
                        return [3, 29];
                    case 29:
                        return [2, showButtons]
                }
            }))
        }))
    }

    function l_showPanelGeneric(iResult) {
        return __awaiter(this, void 0, void 0, (function () {
            var _a, str, msg, classes, _b, _c, data;
            var e_74, _d;
            return __generator(this, (function (_e) {
                switch (_e.label) {
                    case 0:
                        _a = iResult.ErrorCode;
                        switch (_a) {
                            case"AJAXFailure":
                                return [3, 1];
                            case"IncompleteFileProcessing":
                                return [3, 4];
                            case"ModelLoadInViewerFailed":
                                return [3, 7]
                        }
                        return [3, 11];
                    case 1:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.AJAXFailure"), "edrawings-server-ajax-failure")];
                    case 2:
                        _e.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, false, "edrawings-error-title edrawings-dialog-no-close")];
                    case 3:
                        _e.sent();
                        return [3, 13];
                    case 4:
                        return [4, l_addParagraphToPanelText(eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.UnableToProcessFile"), "edrawings-unable-process-file")];
                    case 5:
                        _e.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, true, "edrawings-error-title edrawings-dialog-no-close")];
                    case 6:
                        _e.sent();
                        return [3, 13];
                    case 7:
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Viewer.LoadFailure");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iResult.ErrorData[0]), "edrawings-viewer-load-failure")];
                    case 8:
                        _e.sent();
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LoadFailure3");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iResult.ErrorData[1]), "edrawings-server-load-failure-3")];
                    case 9:
                        _e.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, true, "edrawings-error-title edrawings-dialog-no-close")];
                    case 10:
                        _e.sent();
                        return [3, 13];
                    case 11:
                        msg = "";
                        classes = "edrawings-dialog-no-close";
                        switch (iResult.ErrorCode) {
                            case"Error":
                                classes += " edrawings-error-title";
                                break;
                            case"Warn":
                                classes += " edrawings-warn-title";
                                break;
                            default:
                                classes += " edrawings-info-title";
                                msg += "<div>" + iResult.ErrorCode + "</div>";
                                break
                        }
                        try {
                            for (_b = __values(iResult.ErrorData), _c = _b.next(); !_c.done; _c = _b.next()) {
                                data = _c.value;
                                msg += "<div style='white-space: nowrap'>" + data + "</div>"
                            }
                        } catch (e_74_1) {
                            e_74 = {error: e_74_1}
                        } finally {
                            try {
                                if (_c && !_c.done && (_d = _b.return)) _d.call(_b)
                            } finally {
                                if (e_74) throw e_74.error
                            }
                        }
                        return [4, l_showMessagePanel(msg, null, true, false, classes)];
                    case 12:
                        _e.sent();
                        return [3, 13];
                    case 13:
                        return [2, l_shouldShowButtons()]
                }
            }))
        }))
    }

    function l_addParagraphToPanelText(iText, iTextClass) {
        return __awaiter(this, void 0, void 0, (function () {
            var msgPanelTextJQ, div;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, l_getDialogPanelTextElem()];
                    case 1:
                        msgPanelTextJQ = _a.sent();
                        div = document.createElement("div");
                        div.classList.add(iTextClass);
                        div.classList.add("edrawings-dialog-content");
                        div.innerText = iText;
                        msgPanelTextJQ.append(div);
                        return [2]
                }
            }))
        }))
    }

    function l_showMessagePanel(iMsg, iTitleKey, iModal, iShowButtons, iDlgClasses) {
        if (iMsg === void 0) {
            iMsg = ""
        }
        if (iTitleKey === void 0) {
            iTitleKey = ""
        }
        if (iModal === void 0) {
            iModal = true
        }
        if (iShowButtons === void 0) {
            iShowButtons = false
        }
        if (iDlgClasses === void 0) {
            iDlgClasses = ""
        }
        return __awaiter(this, void 0, void 0, (function () {
            var msgPanelTextJQ, opts, msgPanel, msgPanelTitleJQ, text;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!iDlgClasses) {
                            if (!iTitleKey) iTitleKey = "Titles.Info";
                            iDlgClasses = "edrawings-info-title edrawings-dialog-no-close"
                        }
                        return [4, l_getDialogPanelTextElem()];
                    case 1:
                        msgPanelTextJQ = _a.sent();
                        if (iMsg) msgPanelTextJQ.html(iMsg);
                        opts = {
                            modal: iModal,
                            width: window.innerWidth * .6,
                            minWidth: 200,
                            dialogClass: iDlgClasses,
                            closeOnEscape: iShowButtons
                        };
                        msgPanel = $("#edrawings-dialog-panel");
                        if (iShowButtons) {
                            $.extend(opts, {
                                buttons: {
                                    Ok: function () {
                                        msgPanel.dialog("close")
                                    }
                                }, close: function (iEvent) {
                                    $(".edrawings-dialog-content").remove()
                                }
                            })
                        }
                        $.extend(opts, {
                            beforeClose: function (iEvent) {
                                jqutils.getAsJQueryObj(iEvent.target).closest(".ui-dialog").siblings(".ui-widget-overlay").addBack().off("drop")
                            }, open: function (iEvent) {
                                jqutils.getAsJQueryObj(iEvent.target).closest(".ui-dialog").siblings(".ui-widget-overlay").addBack().on("drop", (function (iEvent2) {
                                    iEvent2.preventDefault();
                                    iEvent2.stopPropagation()
                                }))
                            }
                        });
                        eDwUIUtils.hide("#WaitBanner", true);
                        msgPanel.dialog(opts);
                        if (iDlgClasses.indexOf("edrawings") > -1 && iDlgClasses.indexOf("title") > -1) {
                            msgPanelTitleJQ = msgPanel.prev().find(".ui-dialog-title");
                            text = "";
                            if (msgPanelTitleJQ) {
                                if (iTitleKey) {
                                    text = eDwUILocalize_7.eDwUILocalize.getString(iTitleKey)
                                } else {
                                    text = msgPanelTitleJQ.css("content").replace(/^['"]+|\\|(;\s?})+|['"]$/g, "")
                                }
                            }
                            msgPanelTitleJQ.text(text)
                        }
                        return [2]
                }
            }))
        }))
    }

    function l_shouldShowButtons() {
        var viewerHTMLElem = $(eDwUIUtils.getViewerElementID()).get(0);
        return $._data(viewerHTMLElem, "events").dragover
    }

    function l_isDebug() {
        var viewerFeatOpts = {Debug: false};
        eDwUIUtils.getRequestedQueryStringParams(location.href, viewerFeatOpts, false);
        return viewerFeatOpts.Debug || false
    }

    function l_getDialogPanelTextElem() {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!!lDialogTextJQ.length) return [3, 2];
                        return [4, eDwUIUtils.loadPanel("#edrawings-dialog-panel", "dialogpanel.html")];
                    case 1:
                        _a.sent();
                        lDialogTextJQ = $("#edrawings-dialog-panel-text");
                        _a.label = 2;
                    case 2:
                        return [2, lDialogTextJQ]
                }
            }))
        }))
    }

    function l_showServerError(iServerID, iModelCacheName) {
        return __awaiter(this, void 0, void 0, (function () {
            var str;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LoadFailure2");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iServerID), "edrawings-server-load-failure-2")];
                    case 1:
                        _a.sent();
                        str = eDwUILocalize_7.eDwUILocalize.getString("Errors.Server.LoadFailure3");
                        return [4, l_addParagraphToPanelText(str.replace("{0}", iModelCacheName), "edrawings-server-load-failure-3")];
                    case 2:
                        _a.sent();
                        return [4, l_showMessagePanel("", "Titles.Error", true, false, "edrawings-error-title edrawings-dialog-no-close")];
                    case 3:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    var lDialogTextJQ = $()
}));
define("eDwUIModelViewHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator"], (function (require, exports, eDwUIHTMLGenerator_5) {
    "use strict";
    var eDwUIModelViewHTMLGenerator = function (_super) {
        __extends(eDwUIModelViewHTMLGenerator, _super);

        function eDwUIModelViewHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUIModelViewHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML;
                return __generator(this, (function (_a) {
                    generatedHTML = this.generateTopModelViewHTML(iAdditionalClasses);
                    generatedHTML += this.generateSubModelViewHTML(iAdditionalClasses);
                    return [2, generatedHTML]
                }))
            }))
        };
        eDwUIModelViewHTMLGenerator.prototype.generateTopModelViewHTML = function (iAdditionalClasses) {
            this.mAsSubNode = false;
            var model = this.mViewer.getModel();
            var contextModelViews = model.getCurrModelViewsOfContexts();
            return this.genHTML(contextModelViews, iAdditionalClasses)
        };
        eDwUIModelViewHTMLGenerator.prototype.generateSubModelViewHTML = function (iAdditionalClasses, iContextOpts) {
            this.mAsSubNode = true;
            var generatedHTML = "";
            var subModelViewCntrJQ = $(".edrawings-modelview-sub-container", this.mPanelUIID);
            if (!subModelViewCntrJQ.hasClass(".edrawings-ui-hide")) {
                var model = this.mViewer.getModel();
                var subModelViews = model.getModelViews(iContextOpts);
                generatedHTML = this.genHTML(subModelViews, iAdditionalClasses)
            }
            return generatedHTML
        };
        eDwUIModelViewHTMLGenerator.prototype.shouldIncludeNode = function (iHierNode) {
            var isModelView = iHierNode.Category === "sheet" || iHierNode.Category === "config";
            return isModelView ? _super.prototype.shouldIncludeNode.call(this, iHierNode) : false
        };
        eDwUIModelViewHTMLGenerator.prototype.getPreSpanIconHTML = function (iNode, iAdditionalClasses, iNodeExpanded, iIgnoreChildren) {
            return ""
        };
        eDwUIModelViewHTMLGenerator.prototype.forNodeGetName = function (iNode) {
            var hierNode = eDwUIHTMLGenerator_5.eDwUINodeHTMLGenerator.getHierarchyNode(iNode);
            var modelView = hierNode.getModelView();
            return this.mAsSubNode ? modelView.SubName : modelView.ContextName
        };
        eDwUIModelViewHTMLGenerator.prototype.forNodeGetIconCSSClass = function (iNode) {
            return this.mAsSubNode ? "edrawings-disp-state-visible" : _super.prototype.forNodeGetIconCSSClass.call(this, iNode)
        };
        eDwUIModelViewHTMLGenerator.prototype.genHTML = function (iModelViews, iAdditionalClasses) {
            var e_75, _a;
            var generatedHTML = "";
            try {
                for (var iModelViews_1 = __values(iModelViews), iModelViews_1_1 = iModelViews_1.next(); !iModelViews_1_1.done; iModelViews_1_1 = iModelViews_1.next()) {
                    var modelView = iModelViews_1_1.value;
                    if (!this.shouldIncludeNode(modelView.Hierarchy)) return "";
                    generatedHTML += this.generateHTMLForNode(modelView.Hierarchy, NaN, "edrawings-root " + iAdditionalClasses, true)
                }
            } catch (e_75_1) {
                e_75 = {error: e_75_1}
            } finally {
                try {
                    if (iModelViews_1_1 && !iModelViews_1_1.done && (_a = iModelViews_1.return)) _a.call(iModelViews_1)
                } finally {
                    if (e_75) throw e_75.error
                }
            }
            return generatedHTML
        };
        return eDwUIModelViewHTMLGenerator
    }(eDwUIHTMLGenerator_5.eDwUINodeHTMLGenerator);
    return eDwUIModelViewHTMLGenerator
}));
define("eDwUIPluginMgr", ["require", "exports", "eDwServiceMgr", "eDwGenericError", "utils"], (function (require, exports, eDwServiceMgr, eDwGenericError, utils) {
    "use strict";
    var eDwUIPluginMgr = function () {
        function eDwUIPluginMgr() {
            this.clearPluginData()
        }

        eDwUIPluginMgr.prototype.loadPlugins = function (iPluginClassNames, iViewer, iViewerFeatOpts) {
            return __awaiter(this, void 0, void 0, (function () {
                var promises, iPluginClassNames_1, iPluginClassNames_1_1, pluginClassName;
                var e_76, _a;
                return __generator(this, (function (_b) {
                    switch (_b.label) {
                        case 0:
                            if (!iPluginClassNames.length) return [2];
                            promises = [];
                            try {
                                for (iPluginClassNames_1 = __values(iPluginClassNames), iPluginClassNames_1_1 = iPluginClassNames_1.next(); !iPluginClassNames_1_1.done; iPluginClassNames_1_1 = iPluginClassNames_1.next()) {
                                    pluginClassName = iPluginClassNames_1_1.value;
                                    if (!pluginClassName) continue;
                                    l_appendPromiseToArray(this.loadPlugin(pluginClassName, iViewer, iViewerFeatOpts), promises)
                                }
                            } catch (e_76_1) {
                                e_76 = {error: e_76_1}
                            } finally {
                                try {
                                    if (iPluginClassNames_1_1 && !iPluginClassNames_1_1.done && (_a = iPluginClassNames_1.return)) _a.call(iPluginClassNames_1)
                                } finally {
                                    if (e_76) throw e_76.error
                                }
                            }
                            return [4, Promise.all(promises)];
                        case 1:
                            _b.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIPluginMgr.prototype.loadDynamicPlugins = function (iViewer) {
            return __awaiter(this, void 0, void 0, (function () {
                var pluginClassNames;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwServiceMgr.get().importPlugins()];
                        case 1:
                            pluginClassNames = _a.sent();
                            return [4, this.loadPlugins(pluginClassNames, iViewer)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwUIPluginMgr.prototype.onClick = function (iID, iActivate) {
            var plugin = this.mIDToPluginMap[iID];
            if (plugin) {
                plugin.onClick(iActivate);
                return true
            }
            return false
        };
        eDwUIPluginMgr.prototype.destroy = function () {
            var e_77, _a;
            try {
                for (var _b = __values(this.mUIPlugins), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var plugin = _c.value;
                    plugin.destroy()
                }
            } catch (e_77_1) {
                e_77 = {error: e_77_1}
            } finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                } finally {
                    if (e_77) throw e_77.error
                }
            }
            this.clearPluginData();
            eDwUIPluginMgr.sMgr = null
        };
        eDwUIPluginMgr.get = function () {
            if (!eDwUIPluginMgr.sMgr) {
                eDwUIPluginMgr.sMgr = new eDwUIPluginMgr
            }
            return eDwUIPluginMgr.sMgr
        };
        eDwUIPluginMgr.prototype.clearPluginData = function () {
            this.mUIPlugins = [];
            this.mIDToPluginMap = {};
            this.mPluginClassNameProcessed = {}
        };
        eDwUIPluginMgr.prototype.loadPlugin = function (iPluginClassName, iViewer, iViewerFeatOpts) {
            var e_78, _a;
            var _this = this;
            var onPluginLoaded = function (iGenericPluginClassConstructor) {
                return __awaiter(_this, void 0, void 0, (function () {
                    var plugin, pluginButtonID, pluginClassNames, loadedPluginPromises, pluginClassNames_1,
                        pluginClassNames_1_1, pluginClassName, iExcp_15;
                    var e_79, _a;
                    return __generator(this, (function (_b) {
                        switch (_b.label) {
                            case 0:
                                _b.trys.push([0, 6, , 7]);
                                plugin = new iGenericPluginClassConstructor(iViewer, iViewerFeatOpts);
                                this.mUIPlugins.push(plugin);
                                pluginButtonID = plugin.PluginButtonID;
                                if (pluginButtonID) {
                                    this.mIDToPluginMap[pluginButtonID] = plugin
                                }
                                console.debugLog("UIPlugin", "Dynamically loaded " + iPluginClassName);
                                if (!plugin.Dependencies.length) return [3, 4];
                                return [4, eDwServiceMgr.get().importDependencies(plugin.Dependencies)];
                            case 1:
                                pluginClassNames = _b.sent();
                                return [4, this.loadPlugins(pluginClassNames, iViewer, iViewerFeatOpts)];
                            case 2:
                                _b.sent();
                                loadedPluginPromises = [];
                                try {
                                    for (pluginClassNames_1 = __values(pluginClassNames), pluginClassNames_1_1 = pluginClassNames_1.next(); !pluginClassNames_1_1.done; pluginClassNames_1_1 = pluginClassNames_1.next()) {
                                        pluginClassName = pluginClassNames_1_1.value;
                                        if (!pluginClassName) continue;
                                        try {
                                            l_appendPromiseToArray(this.loadPlugin(pluginClassName, iViewer, iViewerFeatOpts), loadedPluginPromises)
                                        } catch (iExcp) {
                                            console.warn("Importing dependencies for " + iPluginClassName + " failed - " + iExcp.message)
                                        }
                                    }
                                } catch (e_79_1) {
                                    e_79 = {error: e_79_1}
                                } finally {
                                    try {
                                        if (pluginClassNames_1_1 && !pluginClassNames_1_1.done && (_a = pluginClassNames_1.return)) _a.call(pluginClassNames_1)
                                    } finally {
                                        if (e_79) throw e_79.error
                                    }
                                }
                                return [4, Promise.all(loadedPluginPromises)];
                            case 3:
                                _b.sent();
                                _b.label = 4;
                            case 4:
                                return [4, plugin.init()];
                            case 5:
                                _b.sent();
                                console.debugLog("UIPlugin", "Initialized " + iPluginClassName);
                                return [3, 7];
                            case 6:
                                iExcp_15 = _b.sent();
                                console.warn("Constructing " + iPluginClassName + " failed - " + iExcp_15.message);
                                return [3, 7];
                            case 7:
                                return [2]
                        }
                    }))
                }))
            };
            try {
                try {
                    for (var _b = __values(this.mUIPlugins), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var plugin = _c.value;
                        if (plugin.PluginClassName === iPluginClassName) {
                            console.debugLog("UIPlugin", iPluginClassName + " already loaded");
                            return Promise.resolve()
                        }
                    }
                } catch (e_78_1) {
                    e_78 = {error: e_78_1}
                } finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b)
                    } finally {
                        if (e_78) throw e_78.error
                    }
                }
                console.debugLog("UIPlugin", "Attempting dynamic load of " + iPluginClassName);
                return new Promise((function (iResolveFunc, iRejectFunc) {
                    if (_this.mPluginClassNameProcessed[iPluginClassName]) {
                        iResolveFunc()
                    } else {
                        _this.mPluginClassNameProcessed[iPluginClassName] = true;
                        require([iPluginClassName], (function (iClassConstructor) {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        switch (_a.label) {
                                            case 0:
                                                return [4, onPluginLoaded(iClassConstructor).then(iResolveFunc, (function (iReason) {
                                                    if (iRejectFunc) iRejectFunc(iReason); else {
                                                        var msg = JSON.stringify(iReason);
                                                        console.debugLog("UIPlugin", msg);
                                                        throw new eDwGenericError("")
                                                    }
                                                }))];
                                            case 1:
                                                _a.sent();
                                                return [2]
                                        }
                                    }))
                                }))
                            })()
                        }))
                    }
                }))
            } catch (iExcp) {
                console.warn("Dynamic load failed for " + iPluginClassName + " - " + iExcp.message);
                return Promise.reject()
            }
        };
        return eDwUIPluginMgr
    }();

    function l_appendPromiseToArray(iPromise, ioPromises) {
        utils.appendToArray(iPromise, ioPromises)
    }

    return eDwUIPluginMgr
}));
define("eDwUISheetTreeHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator"], (function (require, exports, eDwUIHTMLGenerator_6) {
    "use strict";
    var eDwUISheetTreeHTMLGenerator = function (_super) {
        __extends(eDwUISheetTreeHTMLGenerator, _super);

        function eDwUISheetTreeHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUISheetTreeHTMLGenerator.prototype.shouldIncludeNode = function (iHierNode) {
            if (iHierNode.Category === "layer") return false;
            return _super.prototype.shouldIncludeNode.call(this, iHierNode)
        };
        return eDwUISheetTreeHTMLGenerator
    }(eDwUIHTMLGenerator_6.eDwUINodeHTMLGenerator);
    return eDwUISheetTreeHTMLGenerator
}));
define("eDwUIShortcutMenu", ["require", "exports", "eDwUIHTMLEventMgr", "eDwGenericError", "eDwEventMgr", "eDwEvents", "eDwUIUtils"], (function (require, exports, eDwUIHTMLEventMgr, eDwGenericError, eDwEventMgr, eDwEvents_9, eDwUIUtils) {
    "use strict";

    Object.defineProperty(exports, "__esModule", {value: true});
    exports.eDwUIShortcutMenu = void 0;
    var eDwUIShortcutMenu = function () {
        function eDwUIShortcutMenu() {
            var _this = this;
            this.mMenuHandlers = {};
            this.mMenuVisibilityHandlerObjs = {};
            this.mCheckPluginHandlers = {};
            $(c_menuID).menu({
                select: function (iEvent, iUIItemJQ) {
                    var itemJQ = iUIItemJQ.item;
                    if (!itemJQ || itemJQ.hasClass(".ui-state-disabled")) return;
                    var handler = _this.mMenuHandlers[itemJQ.attr("id")];
                    if (handler) {
                        handler(iEvent, iUIItemJQ, _this.mArg)
                    } else {
                        console.debugLog("shortcutmenu", "Missing shortcut menu handler: " + itemJQ.attr("class"))
                    }
                }
            });
            eDwUIShortcutMenu.hide();
            this.mUIHTMLEventMgr = new eDwUIHTMLEventMgr;
            this.mUIHTMLEventMgr.addEventHandler("document", "contextmenu", eDwUIUtils.inhibitEventBehavior);
            var showShortcutMenu = function (iViewer, iScreenPos, iArg, iPluginName) {
                return __awaiter(_this, void 0, void 0, (function () {
                    var menuItemID, visibilityHandlerObj, pluginHandler, visState, handlerExists;
                    return __generator(this, (function (_a) {
                        this.mArg = iArg;
                        for (menuItemID in this.mMenuVisibilityHandlerObjs) {
                            visibilityHandlerObj = this.mMenuVisibilityHandlerObjs[menuItemID];
                            pluginHandler = this.mCheckPluginHandlers[visibilityHandlerObj.PluginName];
                            visState = pluginHandler ? !pluginHandler(iPluginName) : false;
                            handlerExists = visibilityHandlerObj.VisHandler;
                            visState = visState || (handlerExists ? !visibilityHandlerObj.VisHandler(iViewer, iArg) : false);
                            eDwUIUtils.hide("#" + menuItemID, visState)
                        }
                        console.debugLog("shortcutmenu", "shortcut menu pos = x: " + iScreenPos.x + ", y: " + iScreenPos.y);
                        eDwUIShortcutMenu.show(iScreenPos.x, iScreenPos.y);
                        return [2]
                    }))
                }))
            };
            var hideShortcutMenu = function (iViewer) {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        eDwUIShortcutMenu.hide();
                        return [2]
                    }))
                }))
            };
            var eventMgr = eDwEventMgr.get();
            eventMgr.addEventHandlerFunc(eDwEvents_9.RightClickEvent, showShortcutMenu);
            eventMgr.addEventHandlerFunc(eDwEvents_9.UnselectEvent, hideShortcutMenu);
            eventMgr.addEventHandlerFunc(eDwEvents_9.LeftClickEvent, hideShortcutMenu)
        }

        eDwUIShortcutMenu.prototype.isEmpty = function () {
            return !$(c_menuID + " ul").length && !$(c_menuID + " li").length
        };
        eDwUIShortcutMenu.prototype.removeAllEventHandlers = function () {
            this.mUIHTMLEventMgr.removeAllEventHandlers();
            var eventMgr = eDwEventMgr.get();
            eventMgr.removeEventHandlerFunc(eDwEvents_9.RightClickEvent, "showShortcutMenu");
            eventMgr.removeEventHandlerFunc(eDwEvents_9.UnselectEvent, "hideShortcutMenu");
            this.mMenuHandlers = {};
            this.mCheckPluginHandlers = {}
        };
        eDwUIShortcutMenu.prototype.destroy = function () {
            eDwUIShortcutMenu.hide();
            this.removeAllEventHandlers();
            $(c_menuID + " ul").remove();
            $(c_menuID + " li").remove();
            eDwUIShortcutMenu.sMenu = null
        };
        eDwUIShortcutMenu.prototype.addMenuItem = function (iPluginName, iContentKey, iHandlerFunc, iIsVisibleFunc, iInitHideMenuItem, iParentMenuSelector) {
            if (iHandlerFunc === void 0) {
                iHandlerFunc = null
            }
            if (iIsVisibleFunc === void 0) {
                iIsVisibleFunc = l_shouldBeVisible
            }
            if (iInitHideMenuItem === void 0) {
                iInitHideMenuItem = true
            }
            if (iParentMenuSelector === void 0) {
                iParentMenuSelector = c_menuID
            }
            if (!iContentKey) {
                console.debugLog("shortcutmenu", "Missing menu item content key.");
                throw new eDwGenericError("Missing menu item content key.")
            }
            var menuJQ = $(iParentMenuSelector);
            var menuItemJQ = l_insertInMenu("li", iPluginName, iContentKey, menuJQ);
            var menuItemID = menuItemJQ.attr("id");
            eDwUIUtils.hide("#" + menuItemID, iInitHideMenuItem);
            if (iHandlerFunc) {
                this.mMenuHandlers[menuItemID] = iHandlerFunc
            }
            var handlerObj = this.mMenuVisibilityHandlerObjs[menuItemID];
            if (!handlerObj) {
                handlerObj = this.mMenuVisibilityHandlerObjs[menuItemID] = {
                    VisHandler: iIsVisibleFunc,
                    PluginName: iPluginName
                }
            } else {
                handlerObj.VisHandler = iIsVisibleFunc;
                handlerObj.PluginName = iPluginName
            }
        };
        eDwUIShortcutMenu.prototype.addSubMenu = function (iPluginName, iContentKey, iHideSubMenu, iParentMenuSelector) {
            if (iHideSubMenu === void 0) {
                iHideSubMenu = false
            }
            if (iParentMenuSelector === void 0) {
                iParentMenuSelector = c_menuID
            }
            var subMenuJQ = $(iParentMenuSelector);
            l_insertInMenu("ul", iPluginName, iContentKey, subMenuJQ);
            if (iHideSubMenu) eDwUIShortcutMenu.hide()
        };
        eDwUIShortcutMenu.prototype.addMenuSeparator = function (iPluginName) {
            this.addMenuItem(iPluginName, "edrawings-shortcut-divider", null, (function (iViewer, iArg) {
                if (l_getNumVisMenuItems()) {
                    return l_shouldBeVisible(iViewer, iArg)
                }
                return false
            }))
        };
        eDwUIShortcutMenu.prototype.setPluginCheck = function (iPluginNameKey, iCheckFunc) {
            if (iPluginNameKey) {
                this.mCheckPluginHandlers[iPluginNameKey] = iCheckFunc;
                return true
            }
            return false
        };
        eDwUIShortcutMenu.prototype.removeAllMenuItems = function (iPluginName, iParentMenuSelector) {
            if (iParentMenuSelector === void 0) {
                iParentMenuSelector = c_menuID
            }
            this.removeMenuItem(iPluginName, "", iParentMenuSelector)
        };
        eDwUIShortcutMenu.prototype.removeMenuItem = function (iPluginName, iMenuItemCSSClassName, iParentMenuSelector) {
            if (iParentMenuSelector === void 0) {
                iParentMenuSelector = c_menuID
            }
            var menuItemJQ = l_removeFromMenu(iParentMenuSelector, iPluginName, iMenuItemCSSClassName);
            var menuItemID = menuItemJQ.attr("id");
            delete this.mMenuHandlers[menuItemID];
            delete this.mMenuVisibilityHandlerObjs[menuItemID];
            $(iParentMenuSelector).menu("refresh")
        };
        eDwUIShortcutMenu.prototype.removeSubMenu = function (iPluginName, iSubMenuCSSClassName, iParentMenuSelector) {
            if (iParentMenuSelector === void 0) {
                iParentMenuSelector = c_menuID
            }
            l_removeFromMenu(iParentMenuSelector, iPluginName, iSubMenuCSSClassName)
        };
        eDwUIShortcutMenu.get = function () {
            if (!eDwUIShortcutMenu.sMenu) {
                eDwUIShortcutMenu.sMenu = new eDwUIShortcutMenu
            }
            return eDwUIShortcutMenu.sMenu
        };
        eDwUIShortcutMenu.destroy = function () {
            if (eDwUIShortcutMenu.sMenu) eDwUIShortcutMenu.sMenu.destroy()
        };
        eDwUIShortcutMenu.show = function (iX, iY, iParentRect) {
            var numVisMenuItems = l_getNumVisMenuItems();
            if (!numVisMenuItems) return;
            var menuJQ = $(c_menuID);
            var viewerElemJQ = $("#edrawings-canvas");
            var parentRect = iParentRect ? iParentRect : {Width: viewerElemJQ.width(), Height: viewerElemJQ.height()};
            var posx = iX;
            var posy = iY;
            var menuHeight = menuJQ.height();
            var menuWidth = menuJQ.width();
            if (posx + menuWidth > parentRect.Width) {
                posx = parentRect.Width - menuWidth - 5
            }
            if (posy + menuHeight > parentRect.Height) {
                posy = parentRect.Height - menuHeight - 5
            }
            menuJQ.css({top: posy + "px", left: posx + "px"});
            eDwUIUtils.hide(c_menuID, false)
        };
        eDwUIShortcutMenu.hide = function () {
            eDwUIUtils.hide(c_menuID, true);
            eDwUIUtils.hide(c_menuID + " ul", true);
            eDwUIUtils.hide(c_menuID + " li", true)
        };
        return eDwUIShortcutMenu
    }();
    exports.eDwUIShortcutMenu = eDwUIShortcutMenu;

     //PLM TEST
    eDwUIShortcutMenu_4g = eDwUIShortcutMenu;

    var c_menuID = "#edrawings-shortcut-menu";
    var c_divider = "-";
    var c_dummyText = "dummy";

    function l_validatePlugin(iPluginName) {
        if (!iPluginName) {
            console.debugLog("shortcutmenu", "Missing menu group name.");
            throw new eDwGenericError("Missing menu group name.")
        }
    }

    function l_genMenuElemJQ(iElementStyle, iContentKey) {
        var text = c_dummyText;
        var localizationInfo = "";
        var subID = iContentKey.toLowerCase().replace(/\./g, "-");
        if (iContentKey.indexOf("NOLOCALIZE:") === 0) {
            text = subID = iContentKey.split(":")[1];
            subID = subID.toLowerCase().replace(/[^[A-Za-z0-9]/g, "-")
        } else if (iContentKey === "edrawings-shortcut-divider") {
            text = c_divider
        } else {
            localizationInfo = "data-i18n-inner='" + iContentKey + "'"
        }
        return $("<" + iElementStyle + " class ='edrawings-shortcut-menu-text' " + (localizationInfo + " id='edrawings-" + subID + "-id'>" + text) + ("</" + iElementStyle + ">"))
    }

    function l_insertInMenu(iElementStyle, iPluginName, iContentKey, iParentMenuJQ) {
        l_validatePlugin(iPluginName);
        var menuElemJQ = l_genMenuElemJQ(iElementStyle, iContentKey);
        menuElemJQ.attr("plugin-name", iPluginName);
        iParentMenuJQ.append(menuElemJQ);
        iParentMenuJQ.menu("refresh");
        if (menuElemJQ.text() === c_dummyText) menuElemJQ.text("");
        return menuElemJQ
    }

    function l_removeFromMenu(iParentMenuSelector, iPluginName, iMenuItemCSSClassName) {
        return $(iParentMenuSelector).find("[plugin-name='" + iPluginName + "']" + iMenuItemCSSClassName).remove()
    }

    function l_getNumVisMenuItems(iPluginName) {
        var menuItems = $(c_menuID + " li");
        var hiddenMenuItems = $(c_menuID + " li.edrawings-ui-hide");
        if (iPluginName) {
            menuItems = menuItems.find("[plugin-name='" + iPluginName + "']");
            hiddenMenuItems = hiddenMenuItems.find("[plugin-name='" + iPluginName + "']")
        }
        return menuItems.length - hiddenMenuItems.length
    }

    function l_shouldBeVisible(iViewer, iArg) {
        return typeof iArg === "boolean" ? false : true
    }
}));
define("eDwUITableHTMLGenerator", ["require", "exports", "eDwUIHTMLGenerator"], (function (require, exports, eDwUIHTMLGenerator_7) {
    "use strict";
    var eDwUITableHTMLGenerator = function (_super) {
        __extends(eDwUITableHTMLGenerator, _super);

        function eDwUITableHTMLGenerator(iViewer, iPanelUIID) {
            return _super.call(this, iViewer, iPanelUIID) || this
        }

        eDwUITableHTMLGenerator.prototype.generateHTML = function (iAdditionalClasses) {
            return __awaiter(this, void 0, void 0, (function () {
                var generatedHTML, activeModelView, tableNodes, tableNodes_1, tableNodes_1_1, tableNode;
                var e_80, _a;
                return __generator(this, (function (_b) {
                    generatedHTML = "";
                    activeModelView = this.mViewer.getModel().getActiveModelView();
                    if (activeModelView && activeModelView.Hierarchy) {
                        tableNodes = activeModelView.Hierarchy.find("Category", "table");
                        try {
                            for (tableNodes_1 = __values(tableNodes), tableNodes_1_1 = tableNodes_1.next(); !tableNodes_1_1.done; tableNodes_1_1 = tableNodes_1.next()) {
                                tableNode = tableNodes_1_1.value;
                                if (!this.shouldIncludeNode(tableNode)) continue;
                                generatedHTML += this.generateHTMLForNode(tableNode, NaN, "edrawings-root " + iAdditionalClasses, true)
                            }
                        } catch (e_80_1) {
                            e_80 = {error: e_80_1}
                        } finally {
                            try {
                                if (tableNodes_1_1 && !tableNodes_1_1.done && (_a = tableNodes_1.return)) _a.call(tableNodes_1)
                            } finally {
                                if (e_80) throw e_80.error
                            }
                        }
                    }
                    return [2, generatedHTML]
                }))
            }))
        };
        eDwUITableHTMLGenerator.prototype.getPreSpanIconHTML = function (iNode, iAdditionalClasses, iNodeExpanded, iIgnoreChildren) {
            return ""
        };
        return eDwUITableHTMLGenerator
    }(eDwUIHTMLGenerator_7.eDwUINodeHTMLGenerator);
    return eDwUITableHTMLGenerator
}));
define("eDwUIUtils", ["require", "exports", "eDwView", "eDwServiceMgr", "eDwCommandMgr", "eDwChangeModelViewCmd", "eDwZoomToFitCmd", "eDwResetCmd", "eDwUISheetTreeHTMLGenerator", "eDwUILayerHTMLGenerator", "eDwUIDebugHTMLGenerator", "eDwEventMgr", "eDwAJAXError", "eDwResultError", "eDwTypes", "eDwEvents", "eDwUIMessageReporter", "utils", "jqutils", "eDwKeyMgr"], (function (require, exports, eDwView, eDwServiceMgr, eDwCommandMgr, eDwChangeModelViewCmd, eDwZoomToFitCmd, eDwResetCmd, eDwUISheetTreeHTMLGenerator, eDwUILayerHTMLGenerator, eDwUIDebugHTMLGenerator, eDwEventMgr, eDwAJAXError, eDwResultError, eDwTypes_16, eDwEvents_10, eDwUIMessageReporter, utils, jqutils, eDwKeyMgr_5) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.getEventPositions = exports.adjustScrollArrows = exports.disableScrollOnTouch = exports.enableScrollOnTouch = exports.executeScrolling = exports.positionMenuPanelArrowCollapseButton = exports.fixMenuPanelInwardToolbar = exports.normalizeModelInfo = exports.viewFile = exports.makeResult = exports.getViewerElementID = exports.getViewerElementName = exports.resetToHomeView = exports.isStateOn = exports.isIDInJQuery = exports.deactivateUI = exports.activateUI = exports.getIDHC = exports.scrollToTarget = exports.getPosition = exports.getRequestedQueryStringParams = exports.hide = exports.loadPanel = exports.getSpanText = exports.getTarget = exports.getText = exports.addPanelModeEvents = exports.refreshList = exports.populateModelViewPanel = exports.inhibitEventBehavior = exports.loadComponentHTML = exports.deactivateMoveInput = exports.addCloseEventHandler = exports.scrollToTreeNode = exports.expandSelected = exports.switchModelView = exports.adjustModelViewSelection = exports.adjustListSelection = exports.searchPanelList = exports.zoomToFit = exports.addSubTreeArrowEventHandler = exports.updateUI = exports.getUIPanelID = exports.setUIGenerator = exports.getUIGenerator = exports.createUIGenerators = void 0;

    function createUIGenerators(iViewer) {
        var panelID = "#edrawings-sheet-tree-menu";
        l_generators[panelID] = new eDwUISheetTreeHTMLGenerator(iViewer, panelID);
        panelID = "#edrawings-layer-control-menu";
        l_generators[panelID] = new eDwUILayerHTMLGenerator(iViewer, panelID);
        panelID = "#edrawings-debug-menu";
        l_generators[panelID] = new eDwUIDebugHTMLGenerator(iViewer, panelID)
    }

    exports.createUIGenerators = createUIGenerators;

    function getUIGenerator(iName) {
        return l_generators[iName]
    }

    exports.getUIGenerator = getUIGenerator;

    function setUIGenerator(iName, iGen) {
        l_generators[iName] = iGen
    }

    exports.setUIGenerator = setUIGenerator;

    function getUIPanelID(iTargetJQ) {
        var panelJQ = iTargetJQ.closest(".edrawings-submenu");
        return panelJQ ? "#" + panelJQ[0].id : ""
    }

    exports.getUIPanelID = getUIPanelID;

    function updateUI(iViewer, iModelView, iInit) {
        if (iInit === void 0) {
            iInit = false
        }
        return __awaiter(this, void 0, void 0, (function () {
            var model, listHTML, listJQ, gen, modelViews, modelViews_4, modelViews_4_1, modelView;
            var e_81, _a;
            return __generator(this, (function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!iViewer) return [3, 2];
                        if (iViewer.ViewerFeatureOpts.Debug) l_populateDebugPanel(iViewer);
                        model = iViewer.getModel();
                        if (!iModelView) return [3, 2];
                        if (iModelView === model.getActiveModelView() && model.isDrawing()) {
                            listHTML = "";
                            listJQ = $("#edrawings-sheet-tree-menu .edrawings-submenu-list");
                            gen = getUIGenerator("#edrawings-sheet-tree-menu");
                            modelViews = iViewer.getModel().getAllModelViews();
                            try {
                                for (modelViews_4 = __values(modelViews), modelViews_4_1 = modelViews_4.next(); !modelViews_4_1.done; modelViews_4_1 = modelViews_4.next()) {
                                    modelView = modelViews_4_1.value;
                                    listHTML += gen.generateHTMLForNode(modelView.Hierarchy, NaN, "edrawings-root")
                                }
                            } catch (e_81_1) {
                                e_81 = {error: e_81_1}
                            } finally {
                                try {
                                    if (modelViews_4_1 && !modelViews_4_1.done && (_a = modelViews_4.return)) _a.call(modelViews_4)
                                } finally {
                                    if (e_81) throw e_81.error
                                }
                            }
                            listJQ.empty();
                            listJQ.append(listHTML)
                        }
                        adjustModelViewSelection(iModelView, "[class~='config-tree-text']", "edrawings-list-selected");
                        if (!iInit) return [3, 2];
                        return [4, l_populateLayerPanel(iViewer)];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        return [2]
                }
            }))
        }))
    }

    exports.updateUI = updateUI;

    function addSubTreeArrowEventHandler(ioUIHTMLEventMgr, iTreeNodeID) {
        ioUIHTMLEventMgr.addDelegatedEventHandler(iTreeNodeID + " .edrawings-tree-arrow", "click", (function (iEvent) {
            if (!iEvent) return;
            var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
            if (!targetJQ[0]) return;

            function collapseListNode(iTargetJQ) {
                var parentElemJQ = iTargetJQ[0] ? jqutils.getAsJQueryObj(iTargetJQ[0].parentElement) : $();
                if (!parentElemJQ.hasClass("edrawings-submenu-list")) {
                    parentElemJQ = parentElemJQ[0] ? jqutils.getAsJQueryObj(parentElemJQ[0].parentElement) : $()
                }
                if (!parentElemJQ[0]) {
                    console.warn("No list found for the collapsable element.");
                    return
                }
                var parentElem = parentElemJQ[0];
                var childElemsJQ = parentElemJQ.children("[data-hoopsparentid='" + iTargetJQ.data("hoopsid") + "']");
                $.each(childElemsJQ, (function (iArg, iElem) {
                    collapseListNode($(iElem));
                    parentElem.removeChild(iElem)
                }))
            }

            if (targetJQ.hasClass("edrawings-tree-expanded")) {
                collapseListNode(targetJQ);
                targetJQ.removeClass("edrawings-tree-expanded")
            } else {
                var appendJQ = targetJQ.closest(".edrawings-submenu-list-item");
                var panelID = getUIPanelID(appendJQ);
                var gen = getUIGenerator(panelID);
                var nodeToExpandHC = parseInt(targetJQ.data("hoopsid"), 10);
                var node = gen.getNodeFromID(nodeToExpandHC);
                if (node === undefined) {
                    console.debugLog("ListUI", "There is no node for the ID");
                    return
                }
                var offset = parseInt($(appendJQ).css("padding-left"), 10);
                appendJQ.after(gen.generateHTMLForChildNodes(node, false, offset));
                targetJQ.addClass("edrawings-tree-expanded")
            }
        }))
    }

    exports.addSubTreeArrowEventHandler = addSubTreeArrowEventHandler;

    function zoomToFit(iViewer) {
        var _this = this;
        (function () {
            return __awaiter(_this, void 0, void 0, (function () {
                var nodeIDHC, activeModelView, zoomToFitCmd;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            nodeIDHC = iViewer.SelectionMgr.getLastSelIDHC();
                            if (utils.isNaN(nodeIDHC)) {
                                activeModelView = iViewer.getModel().getActiveModelView();
                                nodeIDHC = activeModelView.Hierarchy.HOOPSID
                            }
                            zoomToFitCmd = new eDwZoomToFitCmd(iViewer, nodeIDHC, iViewer.getHCView().getCamera());
                            return [4, eDwCommandMgr.get().run(zoomToFitCmd, "commit")];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        })()
    }

    exports.zoomToFit = zoomToFit;

    function searchPanelList(iViewer, iElemJQ) {
        var panelID = getUIPanelID(iElemJQ);
        var listJQ = $(panelID + " .edrawings-submenu-list");
        var activeModelView = iViewer.getModel().getActiveModelView();
        var activeModelViewNode = activeModelView.Hierarchy;
        if (activeModelViewNode) {
            listJQ.empty();
            iViewer.SelectionMgr.unSelectAllObjects();
            var gen = getUIGenerator(panelID);
            var inputVal = $(panelID + " .edrawings-menu-search-input").val();
            listJQ.append(gen.generateHTMLForChildNodes(activeModelViewNode, inputVal.length > 0))
        }
    }

    exports.searchPanelList = searchPanelList;

    function adjustListSelection(iListSelector, iTargetClass) {
        var elemsJQ = $(iListSelector);
        if (elemsJQ.length) {
            l_highlightAndScrollToTarget($(elemsJQ[0]), iTargetClass)
        }
    }

    exports.adjustListSelection = adjustListSelection;

    function adjustModelViewSelection(iModelView, iFilter, iTargetClass) {
        var targetSpans = $("span[data-hoopsid='" + iModelView.Hierarchy.HOOPSID + "']");
        if (targetSpans.length > 0) {
            var viewTab = targetSpans.filter(iFilter);
            if (viewTab.length > 0) {
                l_highlightAndScrollToTarget(viewTab.parent(), iTargetClass)
            }
        }
    }

    exports.adjustModelViewSelection = adjustModelViewSelection;

    function switchModelView(iEvent, iViewer, iClassForNodeID) {
        var _this = this;
        if (!iEvent) return;
        var targetJQ = jqutils.getAsJQueryObj(iEvent.target);
        if (!targetJQ.length) return;
        var modelViewDivJQ = $(iClassForNodeID, targetJQ);
        if (!modelViewDivJQ.length) return;
        var model = iViewer.getModel();
        var nodeIDHC = parseInt(modelViewDivJQ.data("hoopsid"), 10);
        var modelViewHierNode = model.getHierarchyNode(nodeIDHC);
        var newModelView = modelViewHierNode.getModelView();
        var currModelView = model.getActiveModelView();
        if (newModelView === currModelView) return;
        if (!model.getModelViewsShowInContext() && currModelView && newModelView.ContextName !== currModelView.ContextName) {
            var currContextModelViews = model.getModelViews({Name: currModelView.ContextName});
            var index = currContextModelViews.indexOf(currModelView);
            if (index > -1) {
                var newContextModelViews = model.getModelViews({Name: newModelView.ContextName});
                newModelView = newContextModelViews[index]
            }
        }
        (function () {
            return __awaiter(_this, void 0, void 0, (function () {
                var changeModelViewCmd;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            changeModelViewCmd = new eDwChangeModelViewCmd(iViewer, newModelView);
                            return [4, eDwCommandMgr.get().run(changeModelViewCmd, "commit")];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        })()
    }

    exports.switchModelView = switchModelView;

    function expandSelected(iViewer, iSelHierNode) {
        var activeModelView = iViewer.getModel().getActiveModelView();

        function expandNode(iTargetJQ) {
            if (!iTargetJQ.length) return;
            if (!iTargetJQ.hasClass("edrawings-tree-expanded")) {
                var panelUIID = getUIPanelID(iTargetJQ);
                if (!$(panelUIID).is(":visible")) return;
                var gen = getUIGenerator(panelUIID);
                var offset = parseInt($(iTargetJQ).css("padding-left"), 10);
                var nodeToExpand = parseInt(iTargetJQ.data("hoopsid"), 10);
                var hierarchyNode = activeModelView.Nodes[nodeToExpand];
                var appendNode = iTargetJQ.closest(".edrawings-submenu-list-item");
                appendNode.after(gen.generateHTMLForChildNodes(hierarchyNode, false, offset));
                iTargetJQ.addClass("edrawings-tree-expanded")
            }
        }

        var hierNode = iSelHierNode.Parent;
        while (hierNode && hierNode !== activeModelView.Hierarchy) {
            var expandNodes = $('[data-hoopsid="' + hierNode.HOOPSID + '"][class~="edrawings-tree-arrow"]');
            $.each(expandNodes, (function (iIdx, iTarget) {
                expandNode($(iTarget))
            }));
            hierNode = hierNode.Parent
        }
    }

    exports.expandSelected = expandSelected;

    function scrollToTreeNode(iSelHierNode, iSetSelected) {
        var treeItem = {
            node: $("span[data-hoopsid='" + iSelHierNode.HOOPSID + "']:not(.config-tab-text)"),
            ownerNode: $("div[data-hoopsid='" + iSelHierNode.HOOPSID + "']")
        };
        if (treeItem.ownerNode.length) {
            var classAction_1 = iSetSelected ? "addClass" : "removeClass";
            $.each(treeItem.node, (function (iIdx, iTarget) {
                $(iTarget)[classAction_1]("edrawings-list-selected")
            }));
            $.each(treeItem.ownerNode, (function (iIdx, iTarget) {
                var targetJQ = $(iTarget);
                targetJQ[classAction_1]("edrawings-list-selected");
                if (!targetJQ.hasClass("edrawings-submenu-list-item")) {
                    return
                }
                targetJQ.find(".edrawings-submenu-list-item-button")[classAction_1]("edrawings-list-option");
                var panel = targetJQ.closest(".edrawings-menu");
                var panelHiddenState = panel.is(":hidden");
                hide(panel.attr("id"), false);
                if (iSetSelected) {
                    scrollToTarget(targetJQ, panelHiddenState ? "none" : "slow")
                }
                hide(panel.attr("id"), panelHiddenState)
            }))
        }
    }

    exports.scrollToTreeNode = scrollToTreeNode;

    function addCloseEventHandler(iPanelID, iUIHTMLEventMgr) {
        iUIHTMLEventMgr.addDelegatedEventHandler(iPanelID + " .edrawings-menu-close", "click", (function (iEvent) {
            hide(iPanelID, true)
        }))
    }

    exports.addCloseEventHandler = addCloseEventHandler;

    function deactivateMoveInput(iInputEventIDSuffix) {
        $(document).off("mousemove" + iInputEventIDSuffix);
        $(document).off("mousedown" + iInputEventIDSuffix);
        $(document).off("mouseup" + iInputEventIDSuffix);
        $(document).off("click" + iInputEventIDSuffix)
    }

    exports.deactivateMoveInput = deactivateMoveInput;

    function loadComponentHTML() {
        return __awaiter(this, void 0, void 0, (function () {
            var loadPromises;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        loadPromises = [];
                        utils.appendToArray(loadPanel("#edrawings-sheet-tree-menu", "sheetspanel.html"), loadPromises);
                        utils.appendToArray(loadPanel("#edrawings-layer-control-menu", "layerspanel.html"), loadPromises);
                        utils.appendToArray(loadPanel("#edrawings-debug-menu", "debugpanel.html"), loadPromises);
                        return [4, Promise.all(loadPromises)];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    exports.loadComponentHTML = loadComponentHTML;

    function inhibitEventBehavior(iEvent) {
        iEvent.preventDefault();
        iEvent.stopPropagation()
    }

    exports.inhibitEventBehavior = inhibitEventBehavior;

    function populateModelViewPanel(iPanelSubListUIID, iPanelUIID, iTextClass) {
        return __awaiter(this, void 0, void 0, (function () {
            var listModelViewMenuJQ, gen, generatedHTML;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        listModelViewMenuJQ = $(iPanelSubListUIID);
                        gen = getUIGenerator(iPanelUIID);
                        return [4, gen.generateHTML(iTextClass)];
                    case 1:
                        generatedHTML = _a.sent();
                        return [4, refreshList(listModelViewMenuJQ, generatedHTML)];
                    case 2:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    exports.populateModelViewPanel = populateModelViewPanel;

    function refreshList(ioListJQ, iHTMLToAppend) {
        ioListJQ.empty().append(iHTMLToAppend)
    }

    exports.refreshList = refreshList;

    function addPanelModeEvents(iPanelID, iInputEventIDSuffix, iButtonID) {
        var click = "click" + iInputEventIDSuffix;
        $(document).on(click, iPanelID + " .edrawings-menu-panel-arrow-collapse", (function (iJQEvent) {
            var msg = "Panel resize: " + click;
            console.debugLog("UIPanelResize", msg);
            iJQEvent.preventDefault();
            var panelJQ = $(iPanelID);
            panelJQ.toggleClass("edrawings-collapsed");
            var activeButtonJQ = iButtonID ? $(iButtonID) : undefined;
            positionMenuPanelArrowCollapseButton(panelJQ, activeButtonJQ);
            iJQEvent.stopImmediatePropagation()
        }));
        var panelJQ = $(iPanelID);
        panelJQ.removeClass("edrawings-collapsed");
        l_setMenuPanelArrowCollapseButtonPosition(panelJQ);
        fixMenuPanelInwardToolbar(panelJQ)
    }

    exports.addPanelModeEvents = addPanelModeEvents;

    function getText(iElement) {
        return $(iElement).text().trim()
    }

    exports.getText = getText;

    function getTarget(iTargetJQ) {
        return iTargetJQ.hasClass("config-tab-text") ? iTargetJQ.parent() : iTargetJQ
    }

    exports.getTarget = getTarget;

    function getSpanText(iTargetJQ) {
        var target = getTarget(iTargetJQ);
        if (!target.is("span")) {
            target = target.find("span")
        }
        if (!target || !target.length) return "";
        return target[0].innerText
    }

    exports.getSpanText = getSpanText;

    function loadPanel(iElemOrClassID, iPanelHTML) {
        return __awaiter(this, void 0, void 0, (function () {
            var loaded, iExcp_16;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!eDwServiceMgr.usesWebServices()) return [2, false];
                        loaded = false;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4, eDwServiceMgr.get().load(iElemOrClassID, iPanelHTML)];
                    case 2:
                        _a.sent();
                        loaded = true;
                        console.debugLog("PanelLoad", "Loaded panel id = " + iElemOrClassID + " HTML file = " + iPanelHTML);
                        return [3, 4];
                    case 3:
                        iExcp_16 = _a.sent();
                        console.debugLog("PanelLoad", "Failed to load " + iPanelHTML + ": " + iExcp_16.message);
                        return [3, 4];
                    case 4:
                        return [2, loaded]
                }
            }))
        }))
    }

    exports.loadPanel = loadPanel;

    function hide(iSelector, iOff) {
        var selJQ = $(iSelector);
        selJQ[iOff ? "addClass" : "removeClass"]("edrawings-ui-hide");
        return selJQ
    }

    exports.hide = hide;

    function getRequestedQueryStringParams(iURL, ioViewerFeatOpts, iWarnOfOtherParams) {
        if (iWarnOfOtherParams === void 0) {
            iWarnOfOtherParams = true
        }
        var hashes = iURL.slice(iURL.indexOf("?") + 1).split("&");
        for (var i = 0; i < hashes.length; i++) {
            var hash = hashes[i].split("=");
            if (hash.length > 1) {
                var strVal = hash[1];
                var val = strVal === "true" ? true : strVal === "false" ? false : strVal;
                if (ioViewerFeatOpts.hasOwnProperty(hash[0])) {
                    ioViewerFeatOpts[hash[0]] = val
                } else if (iWarnOfOtherParams) {
                    console.warn(hash[0] + " is not a valid query parameter.")
                }
            }
        }
    }

    exports.getRequestedQueryStringParams = getRequestedQueryStringParams;

    function getPosition(iTargetJQ) {
        var ret = {top: 0, left: 0};
        if (iTargetJQ) ret = iTargetJQ.position();
        return ret
    }

    exports.getPosition = getPosition;

    function scrollToTarget(iTargetJQ, iAnimationSpeed) {
        if (iAnimationSpeed === void 0) {
            iAnimationSpeed = "slow"
        }
        var animationSpeed = iAnimationSpeed;
        var targetOffset = iTargetJQ.offset();
        var targetParentJQ = iTargetJQ.parent();
        if (targetParentJQ.length && targetParentJQ[0] === $(document)[0]) {
            return false
        }
        var targetParentOffset = targetParentJQ.offset();
        var updated = false;
        if (targetParentJQ[0].scrollWidth > targetParentJQ.width()) {
            var targetParentPaddingLeft = parseInt(targetParentJQ.css("paddingLeft"));
            var diff = l_computeTargetMinimalAdjustment(targetOffset.left, parseInt(iTargetJQ.css("marginLeft")) + parseInt(iTargetJQ.css("borderLeftWidth")) + iTargetJQ[0].scrollWidth + parseInt(iTargetJQ.css("borderRightWidth")) + parseInt(iTargetJQ.css("marginRight")), targetParentOffset.left + parseInt(targetParentJQ.css("marginLeft")) + parseInt(targetParentJQ.css("borderLeftWidth")) + targetParentPaddingLeft, targetParentJQ[0].clientWidth - targetParentPaddingLeft - parseInt(targetParentJQ.css("paddingRight")));
            if (diff !== 0) {
                var pos = targetParentJQ.scrollLeft() + diff;
                if (Math.abs(diff) > targetParentJQ.width()) {
                    var targetJQpostionLeft = iTargetJQ.position().left;
                    pos = targetParentJQ.scrollLeft() + targetJQpostionLeft
                } else {
                    animationSpeed = "none"
                }
                l_scrollToTarget(targetParentJQ, pos, animationSpeed, "scrollLeft");
                updated = true
            }
        }
        if (targetParentJQ[0].scrollHeight > targetParentJQ.height()) {
            var targetParentPaddingTop = parseInt(targetParentJQ.css("paddingTop"));
            var diff = l_computeTargetMinimalAdjustment(targetOffset.top, parseInt(iTargetJQ.css("marginTop")) + parseInt(iTargetJQ.css("borderTopWidth")) + iTargetJQ[0].scrollHeight + parseInt(iTargetJQ.css("borderBottomWidth")) + parseInt(iTargetJQ.css("marginBottom")), targetParentOffset.top + parseInt(targetParentJQ.css("marginTop")) + parseInt(targetParentJQ.css("borderTopWidth")) + targetParentPaddingTop, targetParentJQ[0].clientHeight - targetParentPaddingTop - parseInt(targetParentJQ.css("paddingBottom")));
            if (diff !== 0) {
                var pos = targetParentJQ.scrollTop() + diff;
                if (Math.abs(diff) > targetParentJQ.height()) {
                    var targetJQpostionTop = iTargetJQ.position().top;
                    pos = targetParentJQ.scrollTop() + targetJQpostionTop
                } else {
                    animationSpeed = "none"
                }
                l_scrollToTarget(targetParentJQ, pos, animationSpeed, "scrollTop");
                updated = true
            }
        }
        return updated
    }

    exports.scrollToTarget = scrollToTarget;

    function getIDHC(iTargetJQ) {
        if (!iTargetJQ) return Number.NaN;
        return parseInt(iTargetJQ.data("hoopsid"), 10)
    }

    exports.getIDHC = getIDHC;

    function activateUI(iButtonID, iPanelID) {
        return __awaiter(this, void 0, void 0, (function () {
            var panelJQ, buttonJQ;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        if (iPanelID) {
                            panelJQ = hide(iPanelID, false).addClass("active");
                            fixMenuPanelInwardToolbar(panelJQ)
                        }
                        if (!iButtonID) return [3, 2];
                        buttonJQ = $(iButtonID);
                        buttonJQ.addClass("active-button");
                        scrollToTarget(buttonJQ, "none");
                        return [4, eDwEventMgr.get().fireEvent(eDwEvents_10.ActivateUIOpEvent, buttonJQ)];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        return [2]
                }
            }))
        }))
    }

    exports.activateUI = activateUI;

    function deactivateUI(iButtonCSSClassName, iPanelCSSClassName) {
        if (iButtonCSSClassName === void 0) {
            iButtonCSSClassName = ""
        }
        if (iPanelCSSClassName === void 0) {
            iPanelCSSClassName = ""
        }
        return __awaiter(this, void 0, void 0, (function () {
            var activeButtonsJQ, panelsJQ;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        activeButtonsJQ = $(iButtonCSSClassName + ".active-button");
                        if (!activeButtonsJQ.length) return [3, 2];
                        return [4, eDwEventMgr.get().fireEvent(eDwEvents_10.DeactivateUIOpEvent, activeButtonsJQ)];
                    case 1:
                        _a.sent();
                        activeButtonsJQ.removeClass("active-button");
                        _a.label = 2;
                    case 2:
                        panelsJQ = hide(iPanelCSSClassName + ".active", true).removeClass("active");
                        panelsJQ.each((function (iIdx, iPanel) {
                            fixMenuPanelInwardToolbar($(iPanel), true)
                        }));
                        return [2, activeButtonsJQ]
                }
            }))
        }))
    }

    exports.deactivateUI = deactivateUI;

    function isIDInJQuery(iListJQ, iID) {
        var inJQList = false;
        for (var key in iListJQ) {
            if (iListJQ[key].id === iID) {
                inJQList = true;
                break
            }
        }
        return inJQList
    }

    exports.isIDInJQuery = isIDInJQuery;

    function isStateOn(iID) {
        return $(iID).hasClass("state-on-button")
    }

    exports.isStateOn = isStateOn;

    function resetToHomeView(iViewer) {
        var _this = this;
        (function () {
            return __awaiter(_this, void 0, void 0, (function () {
                var resetCmd;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            resetCmd = new eDwResetCmd(iViewer);
                            return [4, eDwCommandMgr.get().run(resetCmd, "commit")];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        })()
    }

    exports.resetToHomeView = resetToHomeView;

    function getViewerElementName() {
        return "edrawings-viewer"
    }

    exports.getViewerElementName = getViewerElementName;

    function getViewerElementID() {
        return "#" + getViewerElementName()
    }

    exports.getViewerElementID = getViewerElementID;

    function makeResult(iExcp) {
        var result = {ErrorCode: "UnknownError", ErrorData: []};
        if (iExcp instanceof eDwResultError) {
            result = iExcp.Result
        } else if (iExcp instanceof eDwAJAXError) {
            result.ErrorCode = iExcp.ErrorCode;
            result.ErrorData = [iExcp.message]
        } else {
            result.ErrorCode = iExcp.name;
            result.ErrorData = [iExcp.message]
        }
        return result
    }

    exports.makeResult = makeResult;

    function viewFile(iModelName, iModelKey, iParams, iContainerName, iModelData) {
        return __awaiter(this, void 0, void 0, (function () {
            function createViewer() {
                var webViewerInfo = {};
                webViewerInfo.containerId = iContainerName;
                webViewerInfo.model = modelInfo.Key;
                webViewerInfo.buffer = modelInfo.Contents;
                webViewerInfo.boundingPreviewMode = eDwTypes_16.HC.BoundingPreviewMode.None;
                eDwEventMgr.get().addEventHandlerFunc(eDwEvents_10.GLContextLostEvent, c_onContextLost);
                var viewer = new eDwView(webViewerInfo, iParams);
                hide("#" + iContainerName, false);
                if (iModelName) {
                    $("#edrawings-filename-text").html(utils.decodeURIComponent(iModelName))
                }
                var modelName = !iModelName && modelInfo.Key ? modelInfo.Key : iModelName;
                if (!modelName) return null;
                if (modelName.search(".zip") > -1) {
                    modelName = modelName.substring(0, modelName.length - 4)
                }
                console.debugLog("ModelLoad", "Created new edw viewer");
                return viewer
            }

            var modelInfo;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        modelInfo = {Name: iModelName, Key: iModelKey, Contents: iModelData};
                        return [4, normalizeModelInfo(iParams, modelInfo)];
                    case 1:
                        _a.sent();
                        return [2, createViewer()]
                }
            }))
        }))
    }

    exports.viewFile = viewFile;

    function normalizeModelInfo(iParams, ioModelInfo) {
        return __awaiter(this, void 0, void 0, (function () {
            var ext, pos2, modelContent, iExcp_17, fileInfo;
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        ext = utils.getExtension(iParams.URL);
                        if (!(ext === "scs")) return [3, 5];
                        pos2 = iParams.URL.lastIndexOf("/");
                        ioModelInfo.Name = iParams.URL.substring(pos2 + 1);
                        ioModelInfo.Name = ioModelInfo.Name.slice(0, -(ext.length + 1));
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4, eDwServiceMgr.get().getFileFromServer(iParams.URL, true)];
                    case 2:
                        modelContent = _a.sent();
                        ioModelInfo.Contents = modelContent && modelContent.byteLength ? new Uint8Array(modelContent) : null;
                        ioModelInfo.Key = null;
                        return [3, 4];
                    case 3:
                        iExcp_17 = _a.sent();
                        if (iExcp_17 instanceof eDwResultError) {
                            eDwUIMessageReporter.showResultPanel(iExcp_17.Result)
                        }
                        return [3, 4];
                    case 4:
                        return [3, 7];
                    case 5:
                        if (!!ioModelInfo.Contents) return [3, 7];
                        return [4, eDwServiceMgr.get().getFileFromServerModelCache(ioModelInfo.Key, ioModelInfo.Key + ".scs", true)];
                    case 6:
                        fileInfo = _a.sent();
                        ioModelInfo.Contents = fileInfo.Contents && fileInfo.Contents.byteLength ? new Uint8Array(fileInfo.Contents) : null;
                        _a.label = 7;
                    case 7:
                        return [2]
                }
            }))
        }))
    }

    exports.normalizeModelInfo = normalizeModelInfo;

    function fixMenuPanelInwardToolbar(iPanelJQ, iToClear) {
        if (iToClear === void 0) {
            iToClear = false
        }
        if (iToClear) {
            iPanelJQ.removeClass("edrawings-collided");
            return
        }
        if (iPanelJQ.hasClass("edrawings-hud-menu")) {
            var panel = iPanelJQ[0];
            if (panel.scrollHeight > panel.clientHeight) {
                iPanelJQ.addClass("edrawings-collided")
            } else {
                iPanelJQ.removeClass("edrawings-collided")
            }
        } else if (iPanelJQ.hasClass("edrawings-submenu")) {
            var wrapperJQ = iPanelJQ.find(".edrawings-menu-panel-wrapper");
            var wasCollided = iPanelJQ.hasClass("edrawings-collided");
            if (iPanelJQ[0].scrollHeight > iPanelJQ[0].clientHeight && iPanelJQ[0].scrollHeight - iPanelJQ[0].clientHeight > 1 || wrapperJQ[0].scrollHeight > wrapperJQ[0].clientHeight && wrapperJQ[0].scrollHeight - wrapperJQ[0].clientHeight > 1) {
                if (!wasCollided) {
                    iPanelJQ.addClass("edrawings-collided")
                }
                iPanelJQ.addClass("edrawings-wiggle");
                setTimeout((function () {
                    iPanelJQ.removeClass("edrawings-wiggle")
                }), 0)
            } else {
                iPanelJQ.removeClass("edrawings-collided");
                if (wasCollided) {
                    fixMenuPanelInwardToolbar(iPanelJQ)
                }
            }
        }
    }

    exports.fixMenuPanelInwardToolbar = fixMenuPanelInwardToolbar;

    function positionMenuPanelArrowCollapseButton(iPanelJQ, iButtonJQ) {
        if (!iPanelJQ.hasClass("edrawings-collapsed")) {
            l_setMenuPanelArrowCollapseButtonPosition(iPanelJQ);
            fixMenuPanelInwardToolbar(iPanelJQ)
        } else {
            if (iButtonJQ) {
                var arrowCollapseButtonJQ = iPanelJQ.find(".edrawings-menu-panel-arrow-collapse");
                var activeButtonRect = iButtonJQ[0].getBoundingClientRect();
                var arrowCollapseButtonRect = arrowCollapseButtonJQ[0].getBoundingClientRect();
                var diffTop = activeButtonRect.top - arrowCollapseButtonRect.top;
                l_setMenuPanelArrowCollapseButtonPosition(arrowCollapseButtonJQ, arrowCollapseButtonJQ.position().top + diffTop)
            }
            fixMenuPanelInwardToolbar(iPanelJQ, true)
        }
    }

    exports.positionMenuPanelArrowCollapseButton = positionMenuPanelArrowCollapseButton;

    function executeScrolling(iDiffX, iDiffY, iContentJQ, iBarJQ) {
        var contentParentJQ = iContentJQ.parent();
        var leftButtonWrapperJQ = contentParentJQ.find(".edrawings-arrow-wrapper:has(> .edrawings-arrow-left)");
        var rightButtonWrapperJQ = contentParentJQ.find(".edrawings-arrow-wrapper:has(> .edrawings-arrow-right)");
        var upButtonWrapperJQ = contentParentJQ.find(".edrawings-arrow-wrapper:has(> .edrawings-arrow-up)");
        var downButtonWrapperJQ = contentParentJQ.find(".edrawings-arrow-wrapper:has(> .edrawings-arrow-down)");
        if (iContentJQ[0].scrollWidth > iContentJQ.width()) {
            var scrollLeft = iContentJQ.scrollLeft();
            var newScrollLeft = scrollLeft + iDiffX;
            iContentJQ.scrollLeft(newScrollLeft);
            adjustScrollArrows(iContentJQ.scrollLeft(), iContentJQ[0].scrollWidth, iContentJQ.width(), true, leftButtonWrapperJQ, rightButtonWrapperJQ, iBarJQ)
        }
        if (iContentJQ[0].scrollHeight > iContentJQ.height()) {
            var scrollTop = iContentJQ.scrollTop();
            var newScrollTop = scrollTop + iDiffY;
            iContentJQ.scrollTop(newScrollTop);
            adjustScrollArrows(iContentJQ.scrollTop(), iContentJQ[0].scrollHeight, iContentJQ.height(), false, upButtonWrapperJQ, downButtonWrapperJQ, iBarJQ)
        }
        return iDiffX !== 0 || iDiffY !== 0
    }

    exports.executeScrolling = executeScrolling;

    function enableScrollOnTouch(ioUIHTMLEventMgr, iContentJqSel, iBarJqSel, iHandlerOnScroll) {
        var _this = this;
        var contentJQ = $(iContentJqSel);
        var barJQ = iBarJqSel ? $(iBarJqSel) : undefined;
        var hasScrolled = false;
        var stopClickTarget;
        var stopClickPropagation = false;
        ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "touchstart", (function (iEventStart) {
            hasScrolled = false;
            stopClickPropagation = false;
            stopClickTarget = undefined;
            var touchEventStart = iEventStart;
            var lastScreenX = touchEventStart.changedTouches[0].screenX;
            var lastScreenY = touchEventStart.changedTouches[0].screenY;
            ioUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchmove");
            ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "touchmove", (function (iEventMove) {
                var touchEventMove = iEventMove;
                var xDiff = touchEventMove.changedTouches[0].screenX - lastScreenX;
                lastScreenX = touchEventMove.changedTouches[0].screenX;
                var yDiff = touchEventMove.changedTouches[0].screenY - lastScreenY;
                lastScreenY = touchEventMove.changedTouches[0].screenY;
                var updated = executeScrolling(-xDiff, -yDiff, contentJQ, barJQ);
                if (updated && iHandlerOnScroll) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, iHandlerOnScroll()];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }
                hasScrolled = hasScrolled || updated
            }))
        }));
        ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "touchend", (function (iEvent) {
            var touchEvent = iEvent;
            ioUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchmove");
            if (hasScrolled) {
                touchEvent.preventDefault();
                touchEvent.stopPropagation();
                stopClickPropagation = true;
                stopClickTarget = touchEvent.target
            } else {
                stopClickPropagation = false;
                stopClickTarget = undefined
            }
            hasScrolled = false
        }));
        ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "touchcancel", (function (iEvent) {
            ioUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchmove");
            hasScrolled = false;
            stopClickPropagation = false
        }));
        ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "mousedown", (function (iEvent) {
            hasScrolled = false;
            stopClickPropagation = false;
            if (!eDwKeyMgr_5.eDwKeyMgr.isLMBPressed(iEvent)) {
                return
            }
            var eventDown = iEvent;
            var lastScreenX = eventDown.screenX;
            var lastScreenY = eventDown.screenY;
            ioUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "mousemove");
            ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "mousemove", (function (iEventMove) {
                var eventMove = iEventMove;
                var xDiff = eventMove.screenX - lastScreenX;
                var yDiff = eventMove.screenY - lastScreenY;
                lastScreenX = eventMove.screenX;
                lastScreenY = eventMove.screenY;
                var updated = executeScrolling(-xDiff, -yDiff, contentJQ, barJQ);
                if (updated && iHandlerOnScroll) {
                    iHandlerOnScroll()
                }
                hasScrolled = hasScrolled || updated
            }))
        }));
        ioUIHTMLEventMgr.addEventHandler(iContentJqSel, "mouseup", (function (iEvent) {
            ioUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "mousemove");
            if (hasScrolled) {
                iEvent.stopImmediatePropagation();
                iEvent.preventDefault();
                stopClickPropagation = true;
                stopClickTarget = iEvent.target
            } else {
                stopClickPropagation = false;
                stopClickTarget = undefined
            }
            hasScrolled = false
        }));
        var propagationHandler = function (iEvent2) {
            if (stopClickPropagation && iEvent2.target === stopClickTarget) {
                iEvent2.stopImmediatePropagation();
                iEvent2.preventDefault()
            }
            stopClickPropagation = false;
            stopClickTarget = undefined
        };
        var nameSpace = iContentJqSel.replace(/[\.\s]/g, "");
        var dataKey = "click.edw." + nameSpace;
        contentJQ.off(dataKey, "*");
        contentJQ.on(dataKey, "*", propagationHandler)
    }

    exports.enableScrollOnTouch = enableScrollOnTouch;

    function disableScrollOnTouch(iUIHTMLEventMgr, iContentJqSel) {
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchstart");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchmove");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchend");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "touchcancel");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "mousedown");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "mousemove");
        iUIHTMLEventMgr.removeEventHandlers(iContentJqSel, "mouseup");
        var contentJQ = $(iContentJqSel);
        var nameSpace = iContentJqSel.replace(/[\.\s]/g, "");
        var dataKey = "click.edw." + nameSpace;
        contentJQ.off(dataKey, "*")
    }

    exports.disableScrollOnTouch = disableScrollOnTouch;

    function adjustScrollArrows(iOffset, iRange, iVisibleRange, isHorizonatalScrolling, iDecreaseWrapperJQ, iIncreaseWrapperJQ, iBarJQ) {
        if (iOffset <= 0) {
            iDecreaseWrapperJQ.addClass("edrawings-disabled-button");
            if (iBarJQ) {
                iBarJQ.addClass(isHorizonatalScrolling ? "edrawings-removed-arrow-left" : "edrawings-removed-arrow-up")
            }
        } else {
            iDecreaseWrapperJQ.removeClass("edrawings-disabled-button");
            if (iBarJQ) {
                iBarJQ.removeClass(isHorizonatalScrolling ? "edrawings-removed-arrow-left" : "edrawings-removed-arrow-up")
            }
        }
        if (iOffset + iVisibleRange >= iRange) {
            iIncreaseWrapperJQ.addClass("edrawings-disabled-button");
            if (iBarJQ) {
                iBarJQ.addClass(isHorizonatalScrolling ? "edrawings-removed-arrow-right" : "edrawings-removed-arrow-down")
            }
        } else {
            iIncreaseWrapperJQ.removeClass("edrawings-disabled-button");
            if (iBarJQ) {
                iBarJQ.removeClass(isHorizonatalScrolling ? "edrawings-removed-arrow-right" : "edrawings-removed-arrow-down")
            }
        }
    }

    exports.adjustScrollArrows = adjustScrollArrows;

    function getEventPositions(iEvent) {
        if (utils.isOfType(iEvent, "touches")) {
            var positions = [];
            var numTouches = iEvent.touches.length;
            for (var i = 0; i < numTouches; ++i) {
                var touch = iEvent.touches[i];
                positions.push(new eDwTypes_16.HC.Point2(touch.clientX, touch.clientY))
            }
            return positions
        }
        return [new eDwTypes_16.HC.Point2(iEvent.clientX, iEvent.clientY)]
    }

    exports.getEventPositions = getEventPositions;
    var l_generators = {};

    function l_populatePanel(iViewer, iCategoryName, iListID, iPanelUIID, iAdditionalClasses) {
        if (iAdditionalClasses === void 0) {
            iAdditionalClasses = ""
        }
        return __awaiter(this, void 0, void 0, (function () {
            var activeModelView, list, gen, _a, _b;
            return __generator(this, (function (_c) {
                switch (_c.label) {
                    case 0:
                        activeModelView = iViewer.getModel().getActiveModelView();
                        if (!activeModelView || !activeModelView.Hierarchy) return [2];
                        list = $(iListID);
                        list.empty();
                        gen = getUIGenerator(iPanelUIID);
                        _b = (_a = list).append;
                        return [4, gen.generateHTML(iAdditionalClasses)];
                    case 1:
                        _b.apply(_a, [_c.sent()]);
                        return [2]
                }
            }))
        }))
    }

    function l_populateLayerPanel(iViewer) {
        return __awaiter(this, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, l_populatePanel(iViewer, "layer", "#edrawings-layer-control-list", "#edrawings-layer-control-menu")];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    }

    function l_populateDebugPanel(iViewer) {
        var e_82, _a, e_83, _b;
        var list = $("#edrawings-debug-menu .edrawings-submenu-list");
        list.empty();
        var gen = getUIGenerator("#edrawings-debug-menu");
        var model = iViewer.getModel();
        var modelView = model.getActiveModelView();
        if (modelView && modelView.Hierarchy) {
            var layers = model.getLayers();
            try {
                for (var layers_3 = __values(layers), layers_3_1 = layers_3.next(); !layers_3_1.done; layers_3_1 = layers_3.next()) {
                    var layer = layers_3_1.value;
                    var layerElem = "<div>Layer " + layer.getName() + " (ID=" + layer.getIDHC() + ", Visible=" + layer.getAttribs().Visible + ") sub-layer IDs: ";
                    var subLayerIDsHC = layer.getNodeIDsHC();
                    try {
                        for (var subLayerIDsHC_1 = (e_83 = void 0, __values(subLayerIDsHC)), subLayerIDsHC_1_1 = subLayerIDsHC_1.next(); !subLayerIDsHC_1_1.done; subLayerIDsHC_1_1 = subLayerIDsHC_1.next()) {
                            var subLayerIDHC = subLayerIDsHC_1_1.value;
                            layerElem += subLayerIDHC + " "
                        }
                    } catch (e_83_1) {
                        e_83 = {error: e_83_1}
                    } finally {
                        try {
                            if (subLayerIDsHC_1_1 && !subLayerIDsHC_1_1.done && (_b = subLayerIDsHC_1.return)) _b.call(subLayerIDsHC_1)
                        } finally {
                            if (e_83) throw e_83.error
                        }
                    }
                    layerElem += "</div>";
                    list.append(layerElem)
                }
            } catch (e_82_1) {
                e_82 = {error: e_82_1}
            } finally {
                try {
                    if (layers_3_1 && !layers_3_1.done && (_a = layers_3.return)) _a.call(layers_3)
                } finally {
                    if (e_82) throw e_82.error
                }
            }
            list.append(gen.generateHTMLForNode(modelView.Hierarchy.HOOPSID, 0, " edrawings-tree-expanded ", true));
            list.append(gen.generateHTMLForChildNodes(modelView.Hierarchy.HOOPSID, true, 4))
        }
    }

    var c_onContextLost = function () {
        return __awaiter(void 0, void 0, void 0, (function () {
            return __generator(this, (function (_a) {
                switch (_a.label) {
                    case 0:
                        return [4, eDwUIMessageReporter.showMessagePanelFromCSScontent("Errors.ContextLost", "edrawings-glcontextlost")];
                    case 1:
                        _a.sent();
                        return [2]
                }
            }))
        }))
    };

    function l_setMenuPanelArrowCollapseButtonPosition(iPanelJQ, iTop) {
        var buttonJQ = iPanelJQ;
        if (!iPanelJQ.hasClass("edrawings-menu-panel-arrow-collapse")) {
            buttonJQ = iPanelJQ.find(".edrawings-menu-panel-arrow-collapse")
        }
        buttonJQ.css("top", typeof iTop === "undefined" ? "" : iTop)
    }

    function l_computeTargetMinimalAdjustment(iTargetSide, iTargetOffset, iReferenceSide, iReferenceOffset) {
        var diff = 0;
        if (iTargetSide < iReferenceSide) {
            diff = iTargetSide - iReferenceSide
        } else if (iTargetSide + iTargetOffset > iReferenceSide + iReferenceOffset) {
            diff = iTargetSide + iTargetOffset - (iReferenceSide + iReferenceOffset)
        }
        return diff
    }

    function l_scrollToTarget(iTargetJQ, iPos, iAnimationSpeed, iStartPos) {
        var _a;
        if (iAnimationSpeed === void 0) {
            iAnimationSpeed = "slow"
        }
        if (iStartPos === void 0) {
            iStartPos = "scrollTop"
        }
        if (!iTargetJQ) return;
        if (iAnimationSpeed === "none") {
            iTargetJQ[iStartPos](iPos)
        } else {
            iTargetJQ.animate((_a = {}, _a[iStartPos] = iPos, _a), iAnimationSpeed)
        }
    }

    function l_highlightAndScrollToTarget(ioTargetJQ, iTargetClass) {
        ioTargetJQ.addClass(iTargetClass);
        scrollToTarget(ioTargetJQ)
    }
}));
define("eDwUnits", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.cDefaultAngleUnit = exports.cDefaultLengthUnit = exports.LengthTypeValues = exports.AngleTypeValues = void 0;
    exports.AngleTypeValues = ["degree", "radian"];
    exports.LengthTypeValues = ["millimeter", "centimeter", "meter", "inch", "foot", "footAndInch"];
    exports.cDefaultLengthUnit = "millimeter";
    exports.cDefaultAngleUnit = "degree"
}));
define("eDwView", ["require", "exports", "eDwSelMgr", "eDwXSectionMgr", "eDwViewMgr", "eDwTimer", "eDwOperatorBaseDeps", "eDwEventMgr", "eDwHistoryMgr", "eDwModel", "eDwTypes", "eDwEvents", "eDwTouchOpsMgr", "eDwTableMgr", "color"], (function (require, exports, eDwSelMgr, eDwXSectionMgr, eDwViewMgr, eDwTimer, eDwOperatorBaseDeps_2, eDwEventMgr, eDwHistoryMgr, eDwModel, eDwTypes_17, eDwEvents_11, eDwTouchOpsMgr, eDwTableMgr, color_2) {
    "use strict";
    var eDwView = function () {
        function eDwView(iViewerInfo, iFeatureOptions) {
            this.mElemID = iViewerInfo.containerId || "";
            this.HCViewer = new eDwTypes_17.HC.WebViewer(iViewerInfo);
            this.mTimer = new eDwTimer;
            this.ViewerFeatureOpts = iFeatureOptions;
            this.mDrawMode = iFeatureOptions.RenderType || "ShadedWithEdges";
            this.OperatorMgr = new eDwOperatorBaseDeps_2.eDwOperatorMgr(this);
            this.TableMgr = new eDwTableMgr(this);
            var streamAll = this.HCViewer.getStreamingMode() === eDwTypes_17.HC.StreamingMode.All;
            var timeBeforeTimeout = streamAll ? 14400 : 120;
            var timeBeforeWarnTimeout = timeBeforeTimeout - 10;
            this.HCViewer.setClientTimeout(timeBeforeTimeout, timeBeforeWarnTimeout);
            this.mInitCamera = null;
            this.mModelKey = iViewerInfo.model || "";
            this.setupWebViewer()
        }

        eDwView.prototype.getHCView = function () {
            return this.HCViewer.view
        };
        eDwView.prototype.getHCMarkupManager = function () {
            return this.HCViewer.markupManager
        };
        eDwView.prototype.getModel = function () {
            if (!this.mModel) {
                this.mModel = new eDwModel(this)
            }
            return this.mModel
        };
        eDwView.prototype.processProductStructure = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var model, activeModelView, modelViewDefCamera;
                var _this = this;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.mInitCamera = this.getHCView().getCamera();
                            model = this.getModel();
                            activeModelView = model.getActiveModelView();
                            modelViewDefCamera = activeModelView.getDefaultCamera();
                            if (modelViewDefCamera) this.mInitCamera = modelViewDefCamera;
                            this.ViewMgr.setCamera(this.mInitCamera);
                            $("#" + this.mElemID).trigger("edw:ModelDataLoadComplete", this);
                            return [4, this.finishInit()];
                        case 1:
                            _a.sent();
                            if (this.HCViewer.getStreamingMode() === eDwTypes_17.HC.StreamingMode.All) {
                                this.HCViewer.waitForIdle().then((function () {
                                    l_closeHCConnection(_this)
                                }))
                            }
                            return [2]
                    }
                }))
            }))
        };
        eDwView.prototype.setupWebViewer = function () {
            var _this = this;
            var processingSelection = false;
            var eventMgr = eDwEventMgr.get();

            function deprecatedCallback(iDeprecatedFuncName) {
                var argArray = [];
                for (var key in arguments) {
                    argArray.push(arguments[key])
                }
                console.debugLog("Deprecated", "Deprecated call: " + argArray.join("."))
            }

            this.mHCCallbacksObj = {
                sceneReady: function () {
                    console.debugLog("ViewerLoad", "Scene ready");
                    _this.HCViewer.resizeCanvas()
                }, streamingActivated: function () {
                    console.debugLog("Viewer", "Streaming activated")
                }, streamingDeactivated: function () {
                    console.debugLog("Viewer", "Streaming deactivated")
                }, selection: function (iSelEvent) {
                    if (!processingSelection) {
                        processingSelection = true;
                        try {
                            (function () {
                                return __awaiter(_this, void 0, void 0, (function () {
                                    return __generator(this, (function (_a) {
                                        this.SelectionMgr.onSelection(iSelEvent);
                                        return [2]
                                    }))
                                }))
                            })()
                        } catch (iException) {
                        }
                        processingSelection = false
                    }
                }, timeoutWarning: function (iRemainingMinutes) {
                    console.debugLog("Viewer", "Inactivity timeout pending in " + iRemainingMinutes + " minutes.");
                    _this.mTimer.ellapsed().dumpToConsole()
                }, timeout: function () {
                    console.debugLog("Viewer", "Inactivity timeout");
                    _this.mTimer.ellapsed().dumpToConsole();
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.TimeoutEvent, this)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })();
                    l_closeHCConnection(_this)
                }, modelLoadFailure: function (iModelName, iReason) {
                    console.warn("Model " + iModelName + " load failed: " + iReason);
                    $("#" + _this.mElemID).trigger("edw:ModelLoadFailed", [_this, iModelName, iReason]);
                    l_closeHCConnection(_this)
                }, deprecated: deprecatedCallback, info: function (iInfoType, iMsg) {
                    console.debugLog("Debug", iInfoType.toString() + " " + iMsg)
                }, missingModel: function (iModelPath) {
                    console.debugLog("Debug", "Missing model: " + iModelPath);
                    l_closeHCConnection(_this)
                }, webGlContextLost: function () {
                    console.debugLog("Debug", "Browser lost GL context!  Render incomplete!!");
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.GLContextLostEvent, this)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })();
                    l_closeHCConnection(_this)
                }, assemblyTreeReady: function () {
                    console.debugLog("ViewerLoad", "Assembly tree ready.")
                }, modelStructureReady: function () {
                    console.debugLog("ViewerLoad", "Model structure ready.");
                    $("#" + _this.mElemID).trigger("edw:ModelLoaded", _this)
                }, modelSwitched: function () {
                    console.debugLog("ViewerLoad", "Model switch done.");
                    $("#" + _this.mElemID).trigger("edw:ModelLoaded", _this)
                }, viewCreated: function (iHCView) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.ViewCreatedEvent, iHCView)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }, viewLoaded: function (iHCView) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.ViewLoadedEvent, iHCView)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }, viewDeleted: function (iHCView) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.ViewDeletedEvent, iHCView)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }, camera: function (iCamera) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        return [4, eventMgr.fireEvent(eDwEvents_11.CameraChangeEvent, iCamera)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                }
            };
            this.HCViewer.setCallbacks(this.mHCCallbacksObj);
            this.HCViewer.start()
        };
        eDwView.prototype.getInitCamera = function () {
            return this.mInitCamera
        };
        eDwView.prototype.getCurrModelKey = function () {
            return this.mModelKey
        };
        eDwView.prototype.unregister = function () {
            var _this = this;
            if (this.HCViewer) this.HCViewer.unsetCallbacks(this.mHCCallbacksObj);
            this.OperatorMgr.unregisterAll();
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_11.DoneEvent, this)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwView.prototype.destroy = function () {
            this.HCViewer.shutdown()
        };
        eDwView.prototype.setExplosionLevel = function (iLevel) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.HCViewer.explodeManager.setMagnitude(iLevel)];
                            case 1:
                                _a.sent();
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_11.ExplodeLevelChangeEvent, this, iLevel)];
                            case 2:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwView.prototype.getExplosionLevel = function () {
            return this.HCViewer.explodeManager.getMagnitude()
        };
        eDwView.prototype.getDrawMode = function () {
            return this.mDrawMode
        };
        eDwView.prototype.setDrawMode = function (iValue) {
            var _this = this;
            var viewHC = this.getHCView();
            var settingsHC = viewHC.getHiddenLineSettings();
            switch (iValue) {
                case"ShadedWithEdges":
                    viewHC.setDrawMode(eDwTypes_17.HC.DrawMode.WireframeOnShaded);
                    this.SelectionMgr.setColorForViewMode(eDwTypes_17.HC.DrawMode.WireframeOnShaded);
                    break;
                case"Shaded":
                    viewHC.setDrawMode(eDwTypes_17.HC.DrawMode.Shaded);
                    this.SelectionMgr.setColorForViewMode(eDwTypes_17.HC.DrawMode.Shaded);
                    break;
                case"HiddenLinesRemoved":
                    settingsHC.setObscuredLineOpacity(0);
                    viewHC.setDrawMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    this.SelectionMgr.setColorForViewMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    break;
                case"HiddenLinesVisible":
                    settingsHC.setObscuredLineOpacity(.5);
                    viewHC.setDrawMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    this.SelectionMgr.setColorForViewMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    break;
                case"Wireframe":
                    settingsHC.setObscuredLineOpacity(1);
                    viewHC.setDrawMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    this.SelectionMgr.setColorForViewMode(eDwTypes_17.HC.DrawMode.HiddenLine);
                    break;
                default:
                    throw new Error("Unknown draw mode: " + iValue)
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                this.mDrawMode = iValue;
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_11.DrawModeChangeEvent, this, iValue)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwView.prototype.getPerspectiveMode = function () {
            return this.getHCView().getProjectionMode() === eDwTypes_17.HC.Projection.Perspective
        };
        eDwView.prototype.setPerspectiveMode = function (iValue) {
            var _this = this;
            if (!iValue) {
                this.getHCView().setProjectionMode(eDwTypes_17.HC.Projection.Orthographic)
            } else {
                this.getHCView().setProjectionMode(eDwTypes_17.HC.Projection.Perspective)
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_11.ProjModeChangeEvent, this, iValue)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            return iValue
        };
        eDwView.prototype.resetDrawMode = function () {
            this.setDrawMode(this.ViewerFeatureOpts.RenderType || "ShadedWithEdges")
        };
        eDwView.prototype.initializeManagers = function () {
            new eDwSelMgr(this);
            new eDwXSectionMgr(this);
            new eDwViewMgr(this);
            new eDwTouchOpsMgr(this)
        };
        eDwView.prototype.drawDebugBoundingBox = function (iBBox) {
            return __awaiter(this, void 0, void 0, (function () {
                var modelHC, vmin, vmax, p0, p1, p2, p3, p4, p5, p6, p7, polylineData0, polylineData1, polylineData2,
                    polylineData3, beautifulGreen, rgba, i, tmp, boxMesh, key, meshInstance;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            modelHC = this.getModel().getHCModel();
                            vmin = iBBox.min;
                            vmax = iBBox.max;
                            p0 = new eDwTypes_17.HC.Point3(vmin.x, vmin.y, vmax.z);
                            p1 = new eDwTypes_17.HC.Point3(vmin.x, vmax.y, vmax.z);
                            p2 = new eDwTypes_17.HC.Point3(vmax.x, vmax.y, vmax.z);
                            p3 = new eDwTypes_17.HC.Point3(vmax.x, vmin.y, vmax.z);
                            p4 = new eDwTypes_17.HC.Point3(vmin.x, vmin.y, vmin.z);
                            p5 = new eDwTypes_17.HC.Point3(vmin.x, vmax.y, vmin.z);
                            p6 = new eDwTypes_17.HC.Point3(vmax.x, vmax.y, vmin.z);
                            p7 = new eDwTypes_17.HC.Point3(vmax.x, vmin.y, vmin.z);
                            polylineData0 = [p0.x, p0.y, p0.z, p1.x, p1.y, p1.z, p2.x, p2.y, p2.z, p3.x, p3.y, p3.z, p0.x, p0.y, p0.z];
                            polylineData1 = [p4.x, p4.y, p4.z, p5.x, p5.y, p5.z, p6.x, p6.y, p6.z, p7.x, p7.y, p7.z, p4.x, p4.y, p4.z];
                            polylineData2 = [p4.x, p4.y, p4.z, p0.x, p0.y, p0.z, p1.x, p1.y, p1.z, p5.x, p5.y, p5.z, p4.x, p4.y, p4.z];
                            polylineData3 = [p7.x, p7.y, p7.z, p3.x, p3.y, p3.z, p2.x, p2.y, p2.z, p6.x, p6.y, p6.z, p7.x, p7.y, p7.z];
                            beautifulGreen = new color_2.Color(0, 255, 0);
                            rgba = [];
                            for (i = 0; i < 5; i++) {
                                tmp = [beautifulGreen.r, beautifulGreen.g, beautifulGreen.b, 255];
                                rgba = rgba.concat(tmp)
                            }
                            boxMesh = new eDwTypes_17.HC.MeshData;
                            boxMesh.addPolyline(polylineData0, rgba);
                            boxMesh.addPolyline(polylineData1, rgba);
                            boxMesh.addPolyline(polylineData2, rgba);
                            boxMesh.addPolyline(polylineData3, rgba);
                            return [4, modelHC.createMesh(boxMesh)];
                        case 1:
                            key = _a.sent();
                            meshInstance = new eDwTypes_17.HC.MeshInstanceData(key);
                            return [2, modelHC.createMeshInstance(meshInstance)]
                    }
                }))
            }))
        };
        eDwView.prototype.finishInit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, eDwEventMgr.get().fireEvent(eDwEvents_11.InitEvent, this)];
                        case 1:
                            _a.sent();
                            this.HCViewer.sheetManager.setBackgroundSheetEnabled(false);
                            eDwHistoryMgr.get().clear();
                            return [2]
                    }
                }))
            }))
        };
        return eDwView
    }();

    function l_closeHCConnection(iViewer) {
        if (!iViewer) return;
        var viewHC = iViewer.getHCView();
        viewHC.setCamera(viewHC.getCamera());
        console.debugLog("Viewer", "Closing viewer connection...");
        iViewer.HCViewer.closeConnection()
    }

    return eDwView
}));
define("eDwViewMgr", ["require", "exports", "eDwEventMgr", "eDwSelObj", "eDwEvents", "eDwTypes"], (function (require, exports, eDwEventMgr, eDwSelObj, eDwEvents_12, eDwTypes_18) {
    "use strict";
    var eDwViewMgr = function () {
        function eDwViewMgr(iViewer) {
            if (!iViewer) throw new Error("Must have viewer object");
            iViewer.ViewMgr = this;
            this.mViewAnimationIndex = 0;
            this.mViewAnimationActive = false;
            this.mAnimationTimeOutID = -1;
            this.mViewer = iViewer
        }

        eDwViewMgr.prototype.start = function () {
            var _this = this;
            if (this.mViewer.getModel().isDrawing()) return;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_12.StartAnimationEvent, this.mViewer)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            this.mViewAnimationActive = true;
            this.animateNextView()
        };
        eDwViewMgr.prototype.stop = function () {
            var _this = this;
            this.mViewAnimationActive = false;
            if (this.mAnimationTimeOutID > -1) {
                window.clearTimeout(this.mAnimationTimeOutID);
                this.mAnimationTimeOutID = -1
            }
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_12.StopAnimationEvent, this.mViewer)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwViewMgr.prototype.reset = function () {
            this.stop();
            this.mViewAnimationIndex = 0
        };
        eDwViewMgr.prototype.isActive = function () {
            return this.mViewAnimationActive
        };
        eDwViewMgr.prototype.setViewOrientation = function (iEyeDirHC, iDuration) {
            var _this = this;
            if (iDuration === void 0) {
                iDuration = 400
            }
            var centerHC = this.mViewer.getModel().getBoundingBox().center();
            var viewHC = this.mViewer.getHCView();
            var cameraHC = viewHC.getCamera().copy();
            var upVecHC = cameraHC.getUp();
            var eyeVecHC = cameraHC.getTarget().subtract(cameraHC.getPosition());
            var dist = eyeVecHC.length();
            switch (iEyeDirHC) {
                case eDwTypes_18.HC.ViewOrientation.Front:
                    eyeVecHC.set(0, 0, 1).scale(dist);
                    upVecHC.set(0, 1, 0);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Back:
                    eyeVecHC.set(0, 0, -1).scale(dist);
                    upVecHC.set(0, 1, 0);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Left:
                    eyeVecHC.set(-1, 0, 0).scale(dist);
                    upVecHC.set(0, 1, 0);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Right:
                    eyeVecHC.set(1, 0, 0).scale(dist);
                    upVecHC.set(0, 1, 0);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Top:
                    eyeVecHC.set(0, 1, 0).scale(dist);
                    upVecHC.set(0, 0, -1);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Bottom:
                    eyeVecHC.set(0, -1, 0).scale(dist);
                    upVecHC.set(0, 0, 1);
                    break;
                case eDwTypes_18.HC.ViewOrientation.Iso:
                    eyeVecHC.set(1, 1, 1).normalize().scale(dist);
                    upVecHC.set(-.408204, .816541, -.408204);
                    break;
                default:
                    throw new Error("Unsupported orientation: " + iEyeDirHC)
            }
            this.adjustOrientation(eyeVecHC, upVecHC);
            cameraHC.setPosition(eyeVecHC.add(centerHC));
            cameraHC.setUp(upVecHC);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, viewHC.fitWorld(iDuration, cameraHC)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })();
            return cameraHC
        };
        eDwViewMgr.prototype.setViewOrientationToDirection = function (normal) {
            var camera = this.mViewer.getHCView().getCamera();
            var position = camera.getPosition();
            var target = camera.getTarget();
            var up = camera.getUp();
            var delta = target.subtract(position);
            var distance = delta.length();
            var bbox = this.mViewer.getModel().getBoundingBox();
            var bbox_min = bbox.min;
            var bbox_max = bbox.max;
            target = eDwTypes_18.HC.Point3.add(bbox_max, bbox_min).scale(.5);
            var eyeVec = eDwTypes_18.HC.Point3.scale(normal, distance);
            position = eDwTypes_18.HC.Point3.add(target, eyeVec);
            var vTest = new eDwTypes_18.HC.Point3(1, 0, 0);
            var isParallel = eDwTypes_18.HC.Point3.dot(vTest, normal);
            if (Math.abs(Math.abs(isParallel) - 1) < .001) {
                vTest.set(0, 1, 0);
                var vec = eDwTypes_18.HC.Point3.cross(normal, vTest);
                vec = vec.normalize();
                up = eDwTypes_18.HC.Point3.cross(vec, normal);
                up = up.normalize()
            } else {
                up = eDwTypes_18.HC.Point3.cross(normal, vTest);
                up = up.normalize()
            }
            var dotProd = eDwTypes_18.HC.Point3.dot(up, new eDwTypes_18.HC.Point3(1, 0, 0));
            if (Math.abs(Math.abs(dotProd) - 1) < .001 && dotProd < 0) {
                up = up.negate()
            }
            dotProd = eDwTypes_18.HC.Point3.dot(up, new eDwTypes_18.HC.Point3(0, 1, 0));
            if (Math.abs(Math.abs(dotProd) - 1) < .001 && dotProd < 0) {
                up = up.negate()
            }
            dotProd = eDwTypes_18.HC.Point3.dot(up, new eDwTypes_18.HC.Point3(0, 0, 1));
            if (Math.abs(Math.abs(dotProd) - 1) < .001 && dotProd < 0) {
                up = up.negate()
            }
            camera.setPosition(position);
            camera.setTarget(target);
            camera.setUp(up);
            this.setCamera(camera, 500);
            return camera
        };
        eDwViewMgr.prototype.setCamera = function (iCameraHC, iTimeInMS) {
            if (iTimeInMS === void 0) {
                iTimeInMS = 400
            }
            if (!iCameraHC) return false;
            var cameraHC = iCameraHC.copy();
            cameraHC.setProjection(this.mViewer.getHCView().getCamera().getProjection());
            return this.mViewer.getHCView().setCamera(cameraHC, iTimeInMS)
        };
        eDwViewMgr.prototype.enableAmbientOcclusion = function (iEnable) {
            var _this = this;
            this.mViewer.getHCView().setAmbientOcclusionEnabled(iEnable);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, eDwEventMgr.get().fireEvent(eDwEvents_12.AmbientOcclChangeEvent, this, iEnable)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwViewMgr.prototype.fitScreenToNodes = function (iNodeIDsHC, ioCamera) {
            return __awaiter(this, void 0, void 0, (function () {
                var model, bboxHC, subtract, viewVec, centerHC, add, ratio, boxMaxLen;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!ioCamera) return [2];
                            model = this.mViewer.getModel();
                            return [4, model.getBoundingBoxOfIDsHC(iNodeIDsHC)];
                        case 1:
                            bboxHC = _a.sent();
                            if (bboxHC.isDegenerate()) return [2];
                            subtract = eDwTypes_18.HC.Point3.subtract;
                            viewVec = subtract(ioCamera.getPosition(), ioCamera.getTarget());
                            centerHC = bboxHC.center().copy();
                            ioCamera.setTarget(centerHC);
                            add = eDwTypes_18.HC.Point3.add;
                            ioCamera.setPosition(add(centerHC, viewVec));
                            ratio = ioCamera.getWidth() / ioCamera.getHeight();
                            if (this.mViewer.getModel().isDrawing()) {
                                bboxHC.min.z = bboxHC.max.z = 0
                            }
                            boxMaxLen = bboxHC.extents().length();
                            ioCamera.setHeight(boxMaxLen);
                            ioCamera.setWidth(boxMaxLen * ratio);
                            this.setCamera(ioCamera, 400);
                            return [2]
                    }
                }))
            }))
        };
        eDwViewMgr.prototype.pickFromPoint = function (iPnt2DHC, iPickConfig) {
            return __awaiter(this, void 0, void 0, (function () {
                var selObjHC, toLocalTransformHC, viewHC, iExcp_18;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            selObjHC = eDwTypes_18.HC.Selection.SelectionItem.create();
                            toLocalTransformHC = new eDwTypes_18.HC.Matrix;
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            viewHC = this.mViewer.getHCView();
                            return [4, viewHC.pickFromPoint(iPnt2DHC, iPickConfig)];
                        case 2:
                            selObjHC = _a.sent();
                            console.debugLog("eDwViewMgr", "eDwViewMgr.pickFromPoint() - " + selObjHC.getNodeId() + " - " + JSON.stringify(iPnt2DHC));
                            console.assert(!isNaN(toLocalTransformHC.m[0]), "Not number before");
                            toLocalTransformHC = eDwSelObj.getLocalTransform(selObjHC, this.mViewer.getModel());
                            console.assert(!isNaN(toLocalTransformHC.m[0]), "Not number after");
                            return [3, 4];
                        case 3:
                            iExcp_18 = _a.sent();
                            console.debugLog("eDwViewMgr", "eDwViewMgr.pickFromPoint() failed - " + iExcp_18.message);
                            return [3, 4];
                        case 4:
                            console.assert(!isNaN(toLocalTransformHC.m[0]), "Not number after 2");
                            return [2, new eDwSelObj(selObjHC, toLocalTransformHC)]
                    }
                }))
            }))
        };
        eDwViewMgr.prototype.onCameraUpdate = function () {
            this.mViewAnimationIndex += 1;
            if (this.mViewAnimationIndex >= eDwViewMgr.viewAnimations.length) {
                this.mViewAnimationIndex = 0;
                this.mViewAnimationActive = false;
                this.stop()
            }
            if (this.mViewAnimationActive) {
                this.animateNextView()
            }
        };
        eDwViewMgr.prototype.animateNextView = function () {
            var _this = this;
            if (this.mViewAnimationActive) {
                this.setViewOrientation(eDwViewMgr.viewAnimations[this.mViewAnimationIndex], 2e3);
                this.mAnimationTimeOutID = window.setTimeout((function () {
                    _this.onCameraUpdate()
                }), 2e3)
            }
        };
        eDwViewMgr.prototype.adjustOrientation = function (ioEveVecHC, ioUpVecHC) {
            if (this.mViewer.getModel().getProperty("zUp") === "true") {
                cCamZUpMat.transform(ioEveVecHC, ioEveVecHC);
                cCamZUpMat.transform(ioUpVecHC, ioUpVecHC)
            }
        };
        eDwViewMgr.viewAnimations = [eDwTypes_18.HC.ViewOrientation.Front, eDwTypes_18.HC.ViewOrientation.Back, eDwTypes_18.HC.ViewOrientation.Left, eDwTypes_18.HC.ViewOrientation.Right, eDwTypes_18.HC.ViewOrientation.Bottom, eDwTypes_18.HC.ViewOrientation.Top, eDwTypes_18.HC.ViewOrientation.Iso];
        return eDwViewMgr
    }();
    var cCamZUpMat = eDwTypes_18.HC.Matrix.createFromArray([0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1]);
    return eDwViewMgr
}));
define("eDwXSectionMgr", ["require", "exports", "eDwXSectionOperator", "eDwGeomUtils", "eDwTypes", "eDwTypes"], (function (require, exports, eDwXSectionOperator, eDwGeomUtils, eDwTypes_19, eDwTypes_20) {
    "use strict";
    var eDwXSectionMgr = function () {
        function eDwXSectionMgr(iViewer) {
            iViewer.XSectionMgr = this;
            this.mViewer = iViewer;
            var xSectionOp = new eDwXSectionOperator(iViewer);
            this.mXSectionOpID = iViewer.OperatorMgr.registerCustomOperator(xSectionOp);
            this.HCXSectionMgr = iViewer.HCViewer.cuttingManager;
            this.SectionCapVisibility = false;
            this.mXSectionIndex = eDwTypes_19.SectionPlaneOrientation.XY.Index;
            this.mSectionVisibility = true;
            this.mSectionsVisibilityState = [false, false, false]
        }

        eDwXSectionMgr.prototype.unregister = function () {
            this.mViewer.OperatorMgr.unregisterCustomOperatorByID(this.mXSectionOpID);
            this.mViewer.XSectionMgr = null
        };
        eDwXSectionMgr.prototype.turnOnSectionPlane = function (iOn) {
            var _this = this;
            if (this.getXSectionHC()) {
                if (iOn) {
                    (function () {
                        return __awaiter(_this, void 0, void 0, (function () {
                            var ret;
                            return __generator(this, (function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        ret = this.mViewer.OperatorMgr.push(this.mXSectionOpID);
                                        console.debugLog("Section", "Section plane operator push ret = " + ret);
                                        return [4, this.HCXSectionMgr.setCappingGeometryVisibility(true)];
                                    case 1:
                                        _a.sent();
                                        return [2]
                                }
                            }))
                        }))
                    })()
                } else {
                    var opID = this.mViewer.OperatorMgr.pop();
                    console.debugLog("Section", "Popped op ID = " + opID + " xSection op ID = " + this.mXSectionOpID)
                }
            }
        };
        eDwXSectionMgr.prototype.activateCurrent = function () {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.getXSectionHC().activate()];
                            case 1:
                                _a.sent();
                                return [4, this.setToCurrentSectionPlane()];
                            case 2:
                                _a.sent();
                                if (!!this.mSectionVisibility) return [3, 4];
                                return [4, this.updateSectionVisibility(false)];
                            case 3:
                                _a.sent();
                                _a.label = 4;
                            case 4:
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwXSectionMgr.prototype.deactivateCurrent = function () {
            var _this = this;
            this.mSectionsVisibilityState = [false, false, false];
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.getXSectionHC().deactivate()];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwXSectionMgr.prototype.isCurrentActive = function () {
            return this.getXSectionHC().isActive()
        };
        Object.defineProperty(eDwXSectionMgr.prototype, "SectionIndex", {
            get: function () {
                return this.mXSectionIndex
            }, enumerable: false, configurable: true
        });
        eDwXSectionMgr.prototype.setSectionPlane = function (ioSection, iAllowActivation) {
            if (iAllowActivation === void 0) {
                iAllowActivation = true
            }
            return __awaiter(this, void 0, void 0, (function () {
                var bbox, bboxExtents, sectionHC, boxCenter, sectionPlane, minPlanePt, maxPlanePt, vec, centerPt, dir,
                    mirrorPlaneNormal, mirrorPlane, maxOnPlnPt, minOnPlnPt, mirrorPlaneDist, distDir, revDistDir, pts;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, this.mViewer.getModel().calculateBoundingBox()];
                        case 1:
                            bbox = _a.sent();
                            bboxExtents = bbox.extents();
                            if (!ioSection || bboxExtents.equals(eDwTypes_20.HC.Point3.zero())) return [2];
                            sectionHC = this.getXSectionHC();
                            if (!(ioSection.Index !== this.mXSectionIndex)) return [3, 6];
                            if (!sectionHC) return [3, 5];
                            if (!sectionHC.isActive()) return [3, 3];
                            return [4, sectionHC.deactivate()];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            return [4, this.HCXSectionMgr.refreshPlaneGeometry()];
                        case 4:
                            _a.sent();
                            _a.label = 5;
                        case 5:
                            this.mXSectionIndex = ioSection.Index;
                            sectionHC = this.getXSectionHC();
                            _a.label = 6;
                        case 6:
                            boxCenter = bbox.center();
                            if (!(sectionHC.getCount() < 1)) return [3, 9];
                            sectionPlane = ioSection.Plane.copy();
                            sectionPlane.d = -sectionPlane.distanceToPoint(boxCenter);
                            minPlanePt = eDwGeomUtils.dropPointOnPlane(bbox.min, sectionPlane);
                            maxPlanePt = eDwGeomUtils.dropPointOnPlane(bbox.max, sectionPlane);
                            vec = maxPlanePt.copy().subtract(minPlanePt);
                            vec = vec.scale(.55);
                            centerPt = eDwGeomUtils.dropPointOnPlane(boxCenter, sectionPlane);
                            dir = sectionPlane.normal.copy();
                            centerPt = centerPt.add(dir.scale(sectionPlane.d));
                            mirrorPlaneNormal = eDwTypes_20.HC.Point3.zero();
                            eDwTypes_20.HC.Util.oneVectorCross(sectionPlane.normal.copy(), mirrorPlaneNormal);
                            mirrorPlane = eDwTypes_20.HC.Plane.createFromPointAndNormal(centerPt, mirrorPlaneNormal);
                            maxOnPlnPt = eDwTypes_20.HC.Point3.add(centerPt, vec);
                            minOnPlnPt = eDwTypes_20.HC.Point3.add(centerPt, vec.scale(-1));
                            mirrorPlaneDist = mirrorPlane.distanceToPoint(maxOnPlnPt);
                            distDir = mirrorPlaneNormal.copy().scale(2 * mirrorPlaneDist);
                            revDistDir = distDir.copy().scale(-1);
                            pts = [];
                            pts.push(minOnPlnPt);
                            pts.push(eDwTypes_20.HC.Point3.add(maxOnPlnPt, revDistDir));
                            pts.push(maxOnPlnPt);
                            pts.push(eDwTypes_20.HC.Point3.add(minOnPlnPt, distDir));
                            sectionHC = this.getXSectionHC();
                            return [4, sectionHC.addPlane(sectionPlane, pts)];
                        case 7:
                            _a.sent();
                            return [4, sectionHC.setColor(eDwTypes_20.HC.Color.createFromFloat(0, 1, 0))];
                        case 8:
                            _a.sent();
                            _a.label = 9;
                        case 9:
                            return [4, this.updateSectionVisibility(this.mSectionVisibility)];
                        case 10:
                            _a.sent();
                            return [4, this.HCXSectionMgr.setStandinGeometryPickable(true)];
                        case 11:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionMgr.prototype.flipSectionPlane = function () {
            var _this = this;
            var sectionHC = this.getXSectionHC();
            if (!sectionHC) return;
            var sectionPlane = sectionHC.getPlane(0);
            if (!sectionPlane) return;
            sectionPlane.normal.negate();
            sectionPlane.d = -sectionPlane.d;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, sectionHC.updatePlane(0, sectionPlane)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwXSectionMgr.prototype.setViewToSectionPlane = function () {
            var sectionHC = this.getXSectionHC();
            if (!sectionHC) return null;
            var sectionPlane = sectionHC.getPlane(0);
            if (!sectionPlane) return null;
            return this.mViewer.ViewMgr.setViewOrientationToDirection(sectionPlane.normal.copy())
        };
        eDwXSectionMgr.prototype.moveCurrentAlongNormal = function (iDistVec) {
            var _this = this;
            var camera = this.mViewer.getHCView().getCamera();
            var camPosition = camera.getPosition();
            var camTarget = camera.getTarget();
            var camUp = camera.getUp();
            var camZ = camTarget.subtract(camPosition);
            camZ = camZ.normalize();
            var camY = camUp.normalize();
            var camX = eDwTypes_20.HC.Point3.cross(camZ, camY);
            var realVec = camX.scale(iDistVec.x).add(camY.scale(iDistVec.y));
            realVec.add(camZ.scale(iDistVec.z));
            var sectionHC = this.getXSectionHC();
            var sectionPlaneHC = sectionHC.getPlane(0);
            var normal = sectionPlaneHC.normal.copy();
            normal = normal.normalize();
            var distance = eDwTypes_20.HC.Point3.dot(realVec, normal);
            if (Math.abs(distance) < 1e-6) return;
            sectionPlaneHC.d -= distance;
            var lenVec = normal.scale(distance);
            var newPosMat = new eDwTypes_20.HC.Matrix;
            newPosMat = newPosMat.setTranslationComponent(lenVec.x, lenVec.y, lenVec.z);
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, sectionHC.updatePlane(0, sectionPlaneHC, newPosMat, true, false)];
                            case 1:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwXSectionMgr.prototype.disableSectionCapVisibility = function (iDisable) {
            this.setSectionCapVisibility(iDisable ? false : this.mEnableSectionCaps)
        };
        eDwXSectionMgr.prototype.projectPoint = function (iPnt) {
            var sectionHC = this.getXSectionHC();
            var sectionPlaneHC = sectionHC.getPlane(0);
            return eDwGeomUtils.dropPointOnPlane(iPnt, sectionPlaneHC)
        };
        eDwXSectionMgr.prototype.getXSectionHC = function () {
            return this.HCXSectionMgr.getCuttingSection(this.mXSectionIndex)
        };
        eDwXSectionMgr.prototype.setSectionCapVisibility = function (iEnable) {
            var _this = this;
            (function () {
                return __awaiter(_this, void 0, void 0, (function () {
                    return __generator(this, (function (_a) {
                        switch (_a.label) {
                            case 0:
                                return [4, this.HCXSectionMgr.setCappingFaceColor(iEnable ? cSectionCapFaceColor : null)];
                            case 1:
                                _a.sent();
                                return [4, this.HCXSectionMgr.setCappingLineColor(iEnable ? null : cSectionCapOutlineColor)];
                            case 2:
                                _a.sent();
                                return [2]
                        }
                    }))
                }))
            })()
        };
        eDwXSectionMgr.prototype.updateSectionVisibility = function (iVisible) {
            return __awaiter(this, void 0, void 0, (function () {
                var activePlaneX, isSectionVisible, iExcp_19;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            activePlaneX = this.getXSectionHC();
                            activePlaneX.setOpacity(iVisible ? cSectionPlaneOpacity : 0);
                            isSectionVisible = this.mSectionsVisibilityState[this.mXSectionIndex];
                            this.mSectionsVisibilityState[this.mXSectionIndex] = iVisible;
                            if (!iVisible) return [3, 7];
                            if (!(activePlaneX.isActive() && isSectionVisible)) return [3, 4];
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            return [4, activePlaneX.deactivate()];
                        case 2:
                            _a.sent();
                            return [3, 4];
                        case 3:
                            iExcp_19 = _a.sent();
                            return [3, 4];
                        case 4:
                            return [4, this.HCXSectionMgr.refreshPlaneGeometry()];
                        case 5:
                            _a.sent();
                            return [4, activePlaneX.activate()];
                        case 6:
                            _a.sent();
                            _a.label = 7;
                        case 7:
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionMgr.prototype.setToCurrentSectionPlane = function () {
            return __awaiter(this, void 0, void 0, (function () {
                var orientation, orientations, _a, _b, _i, orientationName;
                return __generator(this, (function (_c) {
                    switch (_c.label) {
                        case 0:
                            orientations = eDwTypes_19.SectionPlaneOrientation;
                            _a = [];
                            for (_b in orientations) _a.push(_b);
                            _i = 0;
                            _c.label = 1;
                        case 1:
                            if (!(_i < _a.length)) return [3, 4];
                            orientationName = _a[_i];
                            orientation = orientations[orientationName];
                            if (!(orientation.Index === this.mXSectionIndex)) return [3, 3];
                            return [4, this.setSectionPlane(orientation)];
                        case 2:
                            _c.sent();
                            return [2];
                        case 3:
                            _i++;
                            return [3, 1];
                        case 4:
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwXSectionMgr.prototype, "SectionCapVisibility", {
            get: function () {
                return this.mEnableSectionCaps
            }, set: function (iEnable) {
                this.mEnableSectionCaps = iEnable;
                this.setSectionCapVisibility(iEnable)
            }, enumerable: false, configurable: true
        });
        Object.defineProperty(eDwXSectionMgr.prototype, "SectionVisibility", {
            set: function (iVisible) {
                var _this = this;
                this.mSectionVisibility = iVisible;
                (function () {
                    return __awaiter(_this, void 0, void 0, (function () {
                        return __generator(this, (function (_a) {
                            switch (_a.label) {
                                case 0:
                                    return [4, this.updateSectionVisibility(this.mSectionVisibility)];
                                case 1:
                                    _a.sent();
                                    return [2]
                            }
                        }))
                    }))
                })()
            }, enumerable: false, configurable: true
        });
        return eDwXSectionMgr
    }();
    var cSectionPlaneOpacity = .3;
    var cSectionCapFaceColor = new eDwTypes_20.HC.Color(128, 128, 128);
    var cSectionCapOutlineColor = new eDwTypes_20.HC.Color(255, 0, 0);
    return eDwXSectionMgr
}));
define("eDwXSectionOperator", ["require", "exports", "eDwTypes", "eDwOperatorBaseDeps", "eDwCommandMgr", "eDwMoveSectionPlaneCmd", "utils"], (function (require, exports, eDwTypes_21, eDwOperatorBaseDeps_3, eDwCommandMgr, eDwMoveSectionPlaneCmd, utils) {
    "use strict";
    var eDwXSectionOperator = function (_super) {
        __extends(eDwXSectionOperator, _super);

        function eDwXSectionOperator(iViewer) {
            return _super.call(this, iViewer) || this
        }

        eDwXSectionOperator.prototype.onActivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onActivate.call(this)];
                        case 1:
                            _a.sent();
                            this.Viewer.XSectionMgr.activateCurrent();
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionOperator.prototype.onDeactivate = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.Viewer.XSectionMgr.deactivateCurrent();
                            return [4, _super.prototype.onDeactivate.call(this)];
                        case 1:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionOperator.prototype.onMouseDown = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var selObj, selObjNodeIDHC, sectionMgr, typeOfSel, objHC, sectionMgrHC;
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!ioMouseEvent || !this.Viewer.XSectionMgr.isCurrentActive()) {
                                ioMouseEvent.setHandled(true);
                                return [2]
                            }
                            return [4, this.getPickResult(ioMouseEvent, this.Viewer.ViewMgr)];
                        case 1:
                            selObj = _a.sent();
                            selObjNodeIDHC = selObj.getIDHC();
                            if (utils.isNaN(selObjNodeIDHC) || selObjNodeIDHC >= 0) {
                                ioMouseEvent.setHandled(false);
                                return [2]
                            }
                            return [4, _super.prototype.onMouseDown.call(this, ioMouseEvent)];
                        case 2:
                            _a.sent();
                            sectionMgr = this.Viewer.XSectionMgr;
                            sectionMgr.disableSectionCapVisibility(true);
                            ioMouseEvent.setHandled(true);
                            if (selObjNodeIDHC) {
                                typeOfSel = selObj.getSelectionType();
                                objHC = typeOfSel === eDwTypes_21.HC.SelectionType.None ? null : selObj;
                                console.debugLog("Section", "sel obj = " + JSON.stringify(objHC));
                                sectionMgrHC = this.Viewer.XSectionMgr.HCXSectionMgr;
                                if (sectionMgrHC.getCuttingSectionFromNodeId(selObjNodeIDHC)) {
                                    this.mSectionDragPtHC = this.screenToWorld(ioMouseEvent.getPosition()) || this.mSectionDragPtHC
                                }
                            }
                            if (!this.mMoveSectionCmd) return [3, 4];
                            return [4, this.mMoveSectionCmd.cancel()];
                        case 3:
                            _a.sent();
                            _a.label = 4;
                        case 4:
                            this.mMoveSectionCmd = new eDwMoveSectionPlaneCmd(this.Viewer);
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionOperator.prototype.onMouseMove = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                var crossSectionMgr, pos2DHC, pnt3DHC, delta;
                return __generator(this, (function (_a) {
                    ioMouseEvent.setHandled(false);
                    crossSectionMgr = this.Viewer.XSectionMgr;
                    if (!crossSectionMgr.isCurrentActive()) {
                        return [2]
                    }
                    if (this.CurrInputInfo && this.mSectionDragPtHC) {
                        pos2DHC = ioMouseEvent.getPosition();
                        pnt3DHC = this.screenToWorld(pos2DHC);
                        if (!pnt3DHC) return [2];
                        delta = eDwTypes_21.HC.Point3.subtract(pnt3DHC, this.mSectionDragPtHC);
                        this.Viewer.XSectionMgr.moveCurrentAlongNormal(delta);
                        this.mSectionDragPtHC = pnt3DHC;
                        ioMouseEvent.setHandled(true)
                    }
                    return [2]
                }))
            }))
        };
        eDwXSectionOperator.prototype.onMouseUp = function (ioMouseEvent) {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.onMouseUp.call(this, ioMouseEvent)];
                        case 1:
                            _a.sent();
                            this.Viewer.XSectionMgr.disableSectionCapVisibility(false);
                            ioMouseEvent.setHandled(false);
                            delete this.mSectionDragPtHC;
                            if (!this.mMoveSectionCmd) return [3, 3];
                            return [4, eDwCommandMgr.get().run(this.mMoveSectionCmd, "commit")];
                        case 2:
                            _a.sent();
                            _a.label = 3;
                        case 3:
                            delete this.mMoveSectionCmd;
                            return [2]
                    }
                }))
            }))
        };
        eDwXSectionOperator.prototype.screenToWorld = function (iPos2DHC) {
            var viewHC = this.Viewer.getHCView();
            var normScrPos2DHC = viewHC.pointToWindowPosition(iPos2DHC);
            var inPnt3DHC = new eDwTypes_21.HC.Point3(normScrPos2DHC.x, normScrPos2DHC.y, 0);
            var projMatHC = viewHC.getProjectionMatrix();
            projMatHC.m[15] = 1;
            var invMatHC = eDwTypes_21.HC.Matrix.inverse(projMatHC);
            if (!invMatHC) return null;
            var tMatHC = invMatHC.transpose();
            var worldPnt3D = eDwTypes_21.HC.Point3.zero();
            var div = inPnt3DHC.x * tMatHC.m[3] + inPnt3DHC.y * tMatHC.m[7] + inPnt3DHC.z * tMatHC.m[11] + tMatHC.m[15];
            worldPnt3D.x = (inPnt3DHC.x * tMatHC.m[0] + inPnt3DHC.y * tMatHC.m[1] + inPnt3DHC.z * tMatHC.m[2] + tMatHC.m[3]) / div;
            worldPnt3D.y = (inPnt3DHC.x * tMatHC.m[4] + inPnt3DHC.y * tMatHC.m[5] + inPnt3DHC.z * tMatHC.m[6] + tMatHC.m[7]) / div;
            worldPnt3D.z = (inPnt3DHC.x * tMatHC.m[8] + inPnt3DHC.y * tMatHC.m[9] + inPnt3DHC.z * tMatHC.m[10] + tMatHC.m[11]) / div;
            return worldPnt3D
        };
        return eDwXSectionOperator
    }(eDwOperatorBaseDeps_3.eDwBaseOperator);
    return eDwXSectionOperator
}));
define("eDwZoomToFitCmd", ["require", "exports", "eDwSupportsHistoryCmd"], (function (require, exports, eDwSupportsHistoryCmd) {
    "use strict";
    var eDwZoomToFitCmd = function (_super) {
        __extends(eDwZoomToFitCmd, _super);

        function eDwZoomToFitCmd(iViewer, iNodeID, iCamera) {
            var _this = _super.call(this, iViewer) || this;
            _this.mInitialCamera = iCamera.copy();
            _this.mFinalCamera = iCamera.copy();
            _this.mNodeIDHC = iNodeID;
            return _this
        }

        eDwZoomToFitCmd.prototype.undo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.undo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mInitialCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwZoomToFitCmd.prototype.redo = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.redo.call(this)];
                        case 1:
                            if (!_a.sent()) return [2, false];
                            this.mViewer.ViewMgr.setCamera(this.mFinalCamera);
                            return [2, true]
                    }
                }))
            }))
        };
        eDwZoomToFitCmd.prototype.commit = function () {
            return __awaiter(this, void 0, void 0, (function () {
                return __generator(this, (function (_a) {
                    switch (_a.label) {
                        case 0:
                            return [4, _super.prototype.commit.call(this)];
                        case 1:
                            _a.sent();
                            return [4, this.mViewer.ViewMgr.fitScreenToNodes([this.mNodeIDHC], this.mFinalCamera)];
                        case 2:
                            _a.sent();
                            return [2]
                    }
                }))
            }))
        };
        Object.defineProperty(eDwZoomToFitCmd.prototype, "Aggregable", {
            get: function () {
                return true
            }, enumerable: false, configurable: true
        });
        return eDwZoomToFitCmd
    }(eDwSupportsHistoryCmd);
    return eDwZoomToFitCmd
}));

define("hcutils", ["require", "exports", "color", "eDwTypes"], (function (require, exports, color_3, eDwTypes_22) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.coerceFromHCColor = exports.coerceToHCColor = void 0;

    function coerceToHCColor(iColor) {
        if (!iColor) throw new ReferenceError;
        return new eDwTypes_22.HC.Color(iColor.r, iColor.g, iColor.b)
    }

    exports.coerceToHCColor = coerceToHCColor;

    function coerceFromHCColor(iColorHC) {
        if (!iColorHC) throw new ReferenceError;
        return new color_3.Color(iColorHC.r, iColorHC.g, iColorHC.b)
    }

    exports.coerceFromHCColor = coerceFromHCColor
}));
define("jqutils", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.getAsJQueryObj = void 0;

    function getAsJQueryObj(iObj) {
        return iObj ? $(iObj) : $()
    }

    exports.getAsJQueryObj = getAsJQueryObj
}));

//PLM TEST：不知道何用，暂注释
// requirejs.config({
//     baseUrl: "./js/3rdParty",
//     waitSeconds: 120,
//     paths: {
//         jquery: "jquery.min",
//         "jquery-ui": "jquery-ui.min",
//         "jquery.fullscreen": "jquery.fullscreen.min",
//         "jquery.iframe-transport": "jquery.iframe-transport",
//         "jquery.fileupload": "jquery.fileupload"
//     },
//     map: {"jquery.fileupload": {"jquery-ui/ui/widget": "jquery-ui"}},
//     shim: {
//         eDrawingsBase: {deps: ["jquery"]},
//         "jquery-ui": {deps: ["jquery"]},
//         "jquery.fullscreen": {deps: ["jquery"]},
//         "jquery.iframe-transport": {deps: ["jquery"]},
//         "jquery-ajax-native": {deps: ["jquery"]}
//     }
// });

requirejs(["eDrawingsWebViewer"], (function (eDwWebViewer) {
    console.excludeDebugLogCategories = ["UIEvents", "BaseSelOp", "Operator"];
    eDwWebViewer.start()
}));

define("utils", ["require", "exports"], (function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", {value: true});
    exports.capitalizeWord = exports.genUniqueID = exports.decodeURIComponent = exports.getEntries = exports.makeArray = exports.getFirstMatchedMethodObj = exports.formatString = exports.ReversibleStringEnum = exports.deepCopyArray = exports.getExtension = exports.isEqual = exports.isNumber = exports.isNaN = exports.appendToArray = exports.isOfType = exports.getObjectTypeName = exports.isInstanceOf = exports.populateMixinObjectFromClasses = exports.populateMixinObject = exports.MixinBase = exports.getUint8Array = exports.forAll = void 0;

    function forAll(iFunc, iDictionary) {
        if (!iDictionary) return;
        Object.keys(iDictionary).forEach((function (iKeyString) {
            var key = parseInt(iKeyString, 10);
            iFunc(key, iDictionary[key])
        }))
    }

    exports.forAll = forAll;

    function getUint8Array(iBase64EncodedString) {
        var binString = window.atob(iBase64EncodedString);
        var len = binString.length;
        var bytes = new Uint8Array(len);
        for (var i = 0; i < len; i++) {
            bytes[i] = binString.charCodeAt(i)
        }
        return bytes
    }

    exports.getUint8Array = getUint8Array;
    var MixinBase = function (_super) {
        __extends(MixinBase, _super);

        function MixinBase(iMixinConstructors) {
            var _this = _super.call(this) || this;
            populateMixinObjectFromClasses(_this, iMixinConstructors);
            return _this
        }

        return MixinBase
    }(Function);
    exports.MixinBase = MixinBase;

    function populateMixinObject(ioDestObj, iSrcObjs) {
        var e_84, _a, e_85, _b;
        try {
            for (var iSrcObjs_1 = __values(iSrcObjs), iSrcObjs_1_1 = iSrcObjs_1.next(); !iSrcObjs_1_1.done; iSrcObjs_1_1 = iSrcObjs_1.next()) {
                var srcObj = iSrcObjs_1_1.value;
                var mixinProps = Object.getOwnPropertyNames(srcObj);
                try {
                    for (var mixinProps_1 = (e_85 = void 0, __values(mixinProps)), mixinProps_1_1 = mixinProps_1.next(); !mixinProps_1_1.done; mixinProps_1_1 = mixinProps_1.next()) {
                        var mixinProp = mixinProps_1_1.value;
                        ioDestObj[mixinProp] = srcObj[mixinProp]
                    }
                } catch (e_85_1) {
                    e_85 = {error: e_85_1}
                } finally {
                    try {
                        if (mixinProps_1_1 && !mixinProps_1_1.done && (_b = mixinProps_1.return)) _b.call(mixinProps_1)
                    } finally {
                        if (e_85) throw e_85.error
                    }
                }
            }
        } catch (e_84_1) {
            e_84 = {error: e_84_1}
        } finally {
            try {
                if (iSrcObjs_1_1 && !iSrcObjs_1_1.done && (_a = iSrcObjs_1.return)) _a.call(iSrcObjs_1)
            } finally {
                if (e_84) throw e_84.error
            }
        }
    }

    exports.populateMixinObject = populateMixinObject;

    function populateMixinObjectFromClasses(ioDestObj, iConstructors) {
        populateMixinObject(ioDestObj, iConstructors.map((function (iConstructor) {
            return iConstructor.prototype
        })));
        ioDestObj.MixinConstructors = iConstructors
    }

    exports.populateMixinObjectFromClasses = populateMixinObjectFromClasses;

    function isInstanceOf(iInstance, iConstructor) {
        if (!iInstance) return false;

        function isMixinInstance() {
            if (!isOfType(iInstance, "MixinConstructors")) return false;
            var index = iInstance.MixinConstructors.indexOf(iConstructor);
            return index > -1 ? true : false
        }

        return iInstance instanceof iConstructor ? true : isMixinInstance()
    }

    exports.isInstanceOf = isInstanceOf;

    function getObjectTypeName(iObj) {
        if (!iObj) return "";
        return iObj.constructor.toString().split(" ")[1].split("(")[0]
    }

    exports.getObjectTypeName = getObjectTypeName;

    function isOfType(iArg, iDiscriminator) {
        var argType = typeof iArg;
        return iArg && (argType === "object" || argType === "function") ? iDiscriminator in iArg : false
    }

    exports.isOfType = isOfType;

    function appendToArray(iElemForArray, ioArray) {
        if (!iElemForArray || !ioArray) return;
        if (iElemForArray instanceof Promise) {
            ioArray.push(iElemForArray.catch((function (iExcp) {
                console.error(iExcp);
                return iExcp
            })))
        } else {
            ioArray.push(iElemForArray)
        }
    }

    exports.appendToArray = appendToArray;

    function isNaN(iInput) {
        return !isNumber(iInput)
    }

    exports.isNaN = isNaN;
    var cOrigNaN = window.isNaN;
    window.isNaN = isNaN;

    function isNumber(iInput) {
        return typeof iInput === "number" && (iInput === 0 || !cOrigNaN(iInput)) ? true : false
    }

    exports.isNumber = isNumber;

    function isEqual(iFirstValue, iSecondValue, iFuzzyComparison) {
        var e_86, _a, e_87, _b, e_88, _c;
        if (iFuzzyComparison === void 0) {
            iFuzzyComparison = false
        }
        if (!iFirstValue && !iSecondValue) return true;
        if (!iFirstValue || !iSecondValue) return false;
        if (iFirstValue !== Object(iFirstValue)) {
            return iFirstValue === iSecondValue
        }
        var firstEntries = getEntries(iFirstValue);
        var secondEntries = getEntries(iSecondValue);
        var dataPropKeys = new Set;
        try {
            for (var firstEntries_1 = __values(firstEntries), firstEntries_1_1 = firstEntries_1.next(); !firstEntries_1_1.done; firstEntries_1_1 = firstEntries_1.next()) {
                var firstEntry = firstEntries_1_1.value;
                dataPropKeys.add(firstEntry[0])
            }
        } catch (e_86_1) {
            e_86 = {error: e_86_1}
        } finally {
            try {
                if (firstEntries_1_1 && !firstEntries_1_1.done && (_a = firstEntries_1.return)) _a.call(firstEntries_1)
            } finally {
                if (e_86) throw e_86.error
            }
        }
        if (!iFuzzyComparison) {
            try {
                for (var secondEntries_1 = __values(secondEntries), secondEntries_1_1 = secondEntries_1.next(); !secondEntries_1_1.done; secondEntries_1_1 = secondEntries_1.next()) {
                    var secondEntry = secondEntries_1_1.value;
                    dataPropKeys.add(secondEntry[0])
                }
            } catch (e_87_1) {
                e_87 = {error: e_87_1}
            } finally {
                try {
                    if (secondEntries_1_1 && !secondEntries_1_1.done && (_b = secondEntries_1.return)) _b.call(secondEntries_1)
                } finally {
                    if (e_87) throw e_87.error
                }
            }
        }
        var numMatchedKeyValues = 0;
        try {
            for (var dataPropKeys_1 = __values(dataPropKeys), dataPropKeys_1_1 = dataPropKeys_1.next(); !dataPropKeys_1_1.done; dataPropKeys_1_1 = dataPropKeys_1.next()) {
                var key = dataPropKeys_1_1.value;
                if (iFirstValue[key] === iSecondValue[key]) ++numMatchedKeyValues; else break
            }
        } catch (e_88_1) {
            e_88 = {error: e_88_1}
        } finally {
            try {
                if (dataPropKeys_1_1 && !dataPropKeys_1_1.done && (_c = dataPropKeys_1.return)) _c.call(dataPropKeys_1)
            } finally {
                if (e_88) throw e_88.error
            }
        }
        return numMatchedKeyValues === dataPropKeys.size
    }

    exports.isEqual = isEqual;

    function getExtension(iString) {
        if (!iString) return "";
        var pos = iString.lastIndexOf(".");
        return pos === -1 ? "" : iString.substr(pos + 1).toLowerCase()
    }

    exports.getExtension = getExtension;

    function deepCopyArray(iArray) {
        return JSON.parse(JSON.stringify(iArray))
    }

    exports.deepCopyArray = deepCopyArray;
    var ReversibleStringEnum = function () {
        function ReversibleStringEnum(iReversibleMapData) {
            this.mMapping = iReversibleMapData;
            this.mReverseMapping = {};
            for (var key in iReversibleMapData) {
                this.mReverseMapping[iReversibleMapData[key]] = key
            }
        }

        ReversibleStringEnum.prototype.getValue = function (iKey) {
            var value = this.mMapping[iKey];
            return value ? value : this.mReverseMapping[iKey]
        };
        return ReversibleStringEnum
    }();
    exports.ReversibleStringEnum = ReversibleStringEnum;

    function formatString(iFormat) {
        var iArgs = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            iArgs[_i - 1] = arguments[_i]
        }
        var argIndex = 0;
        var replFormat = iFormat.replace(/\${([a-zA-Z0-9_-]+)}/g, (function (iPosParam) {
            var val = typeof iArgs[argIndex] !== "undefined" ? iArgs[argIndex] : iPosParam;
            ++argIndex;
            return val
        }));
        return replFormat
    }

    exports.formatString = formatString;

    function getFirstMatchedMethodObj(iObj, iPartialName) {
        if (!iObj || !iPartialName) return null;
        var props = $.map(iObj, (function (iValue, iKey) {
            return iKey.indexOf(iPartialName) > -1 ? iKey : null
        }));
        return props.length ? iObj[props[0]] : null
    }

    exports.getFirstMatchedMethodObj = getFirstMatchedMethodObj;

    function makeArray(iObj) {
        return iObj ? Object.keys(iObj).map((function (iKey) {
            return iObj[iKey]
        })) : []
    }

    exports.makeArray = makeArray;

    function getEntries(iObj) {
        var entries = [];
        for (var key in iObj) {
            var value = iObj[key];
            if (typeof iObj[key] !== "function") entries.push([key, value])
        }
        return entries
    }

    exports.getEntries = getEntries;

    function decodeURIComponent(iURI) {
        try {
            return window.decodeURIComponent(iURI)
        } catch (iExcp) {
        }
        return iURI
    }

    exports.decodeURIComponent = decodeURIComponent;
    var l_uniqueCounter = -1;

    function genUniqueID() {
        ++l_uniqueCounter;
        var now = Date.now().toString();
        return now + "-" + l_uniqueCounter
    }

    exports.genUniqueID = genUniqueID;

    function capitalizeWord(iWord) {
        return iWord ? iWord[0].toUpperCase() + iWord.slice(1) : ""
    }

    exports.capitalizeWord = capitalizeWord
}));
// Copyright 2018-2022 Dassault Systemes SolidWorks Corporation. All rights reserved.



</script>

</html>
